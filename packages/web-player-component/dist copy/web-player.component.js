!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["webplayer.component"]=t():e["webplayer.component"]=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){window,e.exports=function(e){function t(t){for(var n,i,a=t[0],o=t[1],s=0,l=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&l.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(u&&u(t);l.length;)l.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(){return Promise.resolve()},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpwebplayer=window.webpackJsonpwebplayer||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var u=o;return i(i.s=271)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=void 0,t=[],n={},r={};function i(e,n){for(var r in t){var i=t[r];if(i.context===e&&i.name===n)return i.instance}return null}function a(e,t){return t[e]}function o(e,t,n){e in n&&(n[e]=t)}function s(t,n,r){var i=void 0,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},r);for(var u in i=t.apply({context:n},r),s=s.apply({context:n,factory:e,parent:i},r))i.hasOwnProperty(u)&&(i[u]=s[u])}else i=t.apply({context:n},r);return i.getClassName=function(){return a},i}return e={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})},getSingletonInstance:i,setSingletonInstance:function(e,n,r){for(var i in t){var a=t[i];if(a.context===e&&a.name===n)return void(t[i].instance=r)}t.push({name:n,context:e,instance:r})},deleteSingletonInstances:function(e){t=t.filter((function(t){return t.context!==e}))},getSingletonFactory:function(e){var r=a(e.__dashjs_factory_name,n);return r||(r=function(n){var r=void 0;return void 0===n&&(n={}),{getInstance:function(){return r||(r=i(n,e.__dashjs_factory_name)),r||(r=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}},n[e.__dashjs_factory_name]=r),r},getSingletonFactoryByName:function(e){return a(e,n)},updateSingletonFactory:function(e,t){o(e,t,n)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},r[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,r)},updateClassFactory:function(e,t){o(e,t,r)}}}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability"}}]),e}());t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(3)),i=o(n(4)),a=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var s=1,u=2,l=3,c=4,d=5;function f(e){e=e||{};var t,n=this.context,a=(0,r.default)(n).getInstance(),o=e.settings,f=[],h=void 0,p=void 0,g=void 0;function m(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function v(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[s,this].concat(t))}function y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[u,this].concat(t))}function E(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[l,this].concat(t))}function T(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[c,this].concat(t))}function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];b.apply(void 0,[d,this].concat(t))}function b(e,t){var n="",r=null;h&&(r=(new Date).getTime(),n+="["+(r-g)+"]"),p&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),n.length>0&&(n+=" ");for(var s=arguments.length,u=Array(s>2?s-2:0),l=2;l<s;l++)u[l-2]=arguments[l];Array.apply(null,u).forEach((function(e){n+=e+" "})),f[e]&&o.get().debug.logLevel>=e&&f[e](n),o&&o.get().debug.dispatchEvent&&a.trigger(i.default.LOG,{message:n,level:e})}return t={getLogger:function(e){return{fatal:v.bind(e),error:y.bind(e),warn:E.bind(e),info:T.bind(e),debug:_.bind(e)}},setLogTimestampVisible:function(e){h=e},setCalleeNameVisible:function(e){p=e}},h=!0,p=!0,g=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(f[s]=m(window.console.error),f[u]=m(window.console.error),f[l]=m(window.console.warn),f[c]=m(window.console.info),f[d]=m(window.console.debug)),t}f.__dashjs_factory_name="Debug";var h=a.default.getSingletonFactory(f);h.LOG_LEVEL_NONE=0,h.LOG_LEVEL_FATAL=s,h.LOG_LEVEL_ERROR=u,h.LOG_LEVEL_WARNING=l,h.LOG_LEVEL_INFO=c,h.LOG_LEVEL_DEBUG=d,a.default.updateSingletonFactory(f.__dashjs_factory_name,h),t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(20));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e={};function t(t,n,r){var i=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0})),i):i}return{on:function(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);var o=a.priority||0;if(!(t(n,r,i)>=0)){e[n]=e[n]||[];var s={callback:r,scope:i,priority:o};i&&i.getStreamId&&(s.streamId=i.getStreamId()),i&&i.getType&&(s.mediaType=i.getType()),a&&a.mode&&(s.mode=a.mode);var u=e[n].some((function(t,r){if(t&&o>t.priority)return e[n].splice(r,0,s),!0}));u||e[n].push(s)}},off:function(n,r,i){if(n&&r&&e[n]){var a=t(n,r,i);a<0||(e[n][a]=null)}},trigger:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,r.streamId&&(n.streamId=r.streamId),r.mediaType&&(n.mediaType=r.mediaType),e[t].filter((function(e){return!(!e||r.streamId&&e.streamId&&e.streamId!==r.streamId||r.mediaType&&e.mediaType&&e.mediaType!==r.mediaType||r.mode&&e.mode&&e.mode!==r.mode||!e.mode&&r.mode&&r.mode===i.default.EVENT_MODE_ON_RECEIVE)})).forEach((function(e){return e&&e.callback.call(e.scope,n)}))}},reset:function(){e={}}}}o.__dashjs_factory_name="EventBus";var s=r.default.getSingletonFactory(o);s.EVENT_PRIORITY_LOW=0,s.EVENT_PRIORITY_HIGH=5e3,r.default.updateSingletonFactory(o.__dashjs_factory_name,s),t.default=s},function(e,t,n){"use strict";var r;function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}Object.defineProperty(t,"__esModule",{value:!0});var o=new(function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(103))&&r.__esModule?r:{default:r}).default));t.default=o},function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d}));var r,i,a,o,s=n(25);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(o=r||(r={}))[o.UNKNOWN=0]="UNKNOWN",o[o.HLS=1]="HLS",o[o.DASH=2]="DASH",o[o.MSS=3]="MSS",function(e){e[e.UNKNOWN_MANIFEST_TYPE=0]="UNKNOWN_MANIFEST_TYPE"}(i||(i={})),function(e){e.PLAY="play",e.PAUSE="pause",e.PLAYING="playing",e.TIME_UPDATE="timeupdate",e.SEEKING="seeking",e.SEEKED="seeked",e.WAITING="waiting",e.STALLED="stalled",e.VOLUME_CHANGE="volumechange",e.ENDED="ended",e.UNREADY="unready",e.READYING="readying",e.READY="ready",e.STATE_CHANGE="state_change",e.AUDIO_TRACK_CHANGE="audio_track_change",e.TEXT_TRACK_CHANGE="text_track_change",e.BUFFERING="buffering",e.LIVE_ENDED="live_ended"}(a||(a={}));var p,g=function(){function e(){this.emitter=Object(s.a)()}var t=e.prototype;return t.on=function(e,t){this.emitter.on.apply(this,arguments)},t.off=function(e,t){this.emitter.on.apply(this,arguments)},t.emit=function(e,t){this.emitter.emit.apply(this,arguments)},t.destroy=function(){this.emitter.all.clear()},e}();function m(e){return e?e.id+"|"+e.label+"|"+e.language:null}!function(e){e[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.READY=2]="READY",e[e.PLAYING=3]="PLAYING",e[e.PAUSED=4]="PAUSED",e[e.SEEKING=5]="SEEKING",e[e.BUFFERING=6]="BUFFERING"}(p||(p={}));var v,y=function(e){function t(t){var n,r=t.video;return(n=e.call(this)||this).state={playbackState:p.IDLE,currentTime:0,duration:0,isLive:!1,isAtLiveEdge:!1,isSeekable:!0,isMuted:r.muted,audioTracks:[],textTracks:[]},n.video=r,n.video.addEventListener("play",n.onPlay=n.onPlay.bind(d(n))),n.video.addEventListener("playing",n.onPlaying=n.onPlaying.bind(d(n))),n.video.addEventListener("pause",n.onPause=n.onPause.bind(d(n))),n.video.addEventListener("timeupdate",n.onTimeUpdate=n.onTimeUpdate.bind(d(n))),n.video.addEventListener("waiting",n.onWaiting=n.onWaiting.bind(d(n))),n.video.addEventListener("seeking",n.onSeeking=n.onSeeking.bind(d(n))),n.video.addEventListener("seeked",n.onSeeked=n.onSeeked.bind(d(n))),n.video.addEventListener("canplay",n.onLoadedData=n.onLoadedData.bind(d(n))),n.video.addEventListener("volumechange",n.onVolumeChange=n.onVolumeChange.bind(d(n))),n.video.addEventListener("ended",n.onEnded=n.onEnded.bind(d(n))),n.video.audioTracks&&n.video.audioTracks.addEventListener("change",n.onAudioTrackChange=n.onAudioTrackChange.bind(d(n))),n}c(t,e);var n=t.prototype;return n.updateState=function(e){var t=this;Object.keys(e).forEach((function(n){void 0!==t.state[n]&&(t.state[n]=e[n])})),this.emit(a.STATE_CHANGE,{state:this.state})},n.onLoadedData=function(){this.updateState({playbackState:this.video.paused?p.PAUSED:p.PLAYING,duration:this.duration,isLive:this.isLive,audioTracks:this.audioTracks,textTracks:this.textTracks})},n.onPlay=function(){this.updateState({playbackState:p.PLAYING}),this.emit(a.PLAY)},n.onPause=function(){this.updateState({playbackState:p.PAUSED}),this.emit(a.PAUSE)},n.onPlaying=function(){this.state.playbackState!==p.PLAYING&&this.updateState({playbackState:p.PLAYING}),this.emit(a.PLAYING)},n.onTimeUpdate=function(){this.updateState({currentTime:this.currentTime,duration:this.duration,isAtLiveEdge:this.currentTime>=this.duration-10,isSeekable:!this.isLive||this.duration>=300}),this.emit(a.TIME_UPDATE,{currentTime:this.currentTime,duration:this.duration})},n.onWaiting=function(){this.state.playbackState!==p.SEEKING&&(this.updateState({playbackState:p.BUFFERING}),this.emit(a.BUFFERING)),this.emit(a.WAITING)},n.onSeeking=function(){this.updateState({playbackState:p.SEEKING}),this.emit(a.SEEKING)},n.onSeeked=function(){this.updateState({playbackState:this.video.paused?p.PAUSED:p.PLAYING}),this.emit(a.SEEKED)},n.onVolumeChange=function(){this.state.isMuted!==this.isMuted&&this.updateState({isMuted:this.isMuted}),this.emit(a.VOLUME_CHANGE,{volume:this.video.volume})},n.onAudioTrackChange=function(){this.updateState({audioTracks:this.audioTracks}),this.emit(a.AUDIO_TRACK_CHANGE)},n.onTextTrackChange=function(){this.updateState({textTracks:this.textTracks}),this.emit(a.TEXT_TRACK_CHANGE)},n.onEnded=function(){this.emit(a.ENDED),this.updateState({playbackState:p.IDLE})},n.play=function(){var e=this.video.play();return e?e.then((function(){return!0}),(function(){return!1})):Promise.resolve(!0)},n.pause=function(){this.video.pause()},n.mute=function(){this.video.muted=!0},n.unmute=function(){this.video.muted=!1},n.load=function(e){var t=this;return this.updateState({playbackState:p.LOADING}),new Promise((function(n,r){t.video.src=e,t.video.load(),n()}))},n.stop=function(){this.video.src="",this.video.load(),this.updateState({playbackState:p.IDLE,isLive:!1,currentTime:this.currentTime,duration:this.duration})},n.seekToLive=function(){this.currentTime=this.duration-10},n.getVideoLevels=function(){},n.destroy=function(){this.stop(),this.video.removeEventListener("timeupdate",this.onTimeUpdate)},l(t,[{key:"currentLevel",set:function(e){},get:function(){}},{key:"isPlaying",get:function(){return!this.video.paused}},{key:"isMuted",get:function(){return this.video.muted}},{key:"isLive",get:function(){return 1/0===this.video.duration}},{key:"duration",get:function(){return this.isLive&&this.video.seekable.length?this.video.seekable.end(0):this.video.duration||0}},{key:"currentTime",get:function(){return this.video.currentTime},set:function(e){this.state.isSeekable&&(this.video.currentTime=this.isLive?Math.min(e,this.duration-10):e)}},{key:"audioTrack",get:function(){var e=this.audioTracks.find((function(e){return e.enabled}));return null==e?void 0:e.id},set:function(e){if(this.video.audioTracks)for(var t,n=h(this.video.audioTracks||[]);!(t=n()).done;){var r=t.value;r.enabled=r.id===e}}},{key:"audioTracks",get:function(){var e;return Array.from(null!=(e=this.video.audioTracks)?e:[]).map((function(e){return{id:e.id,label:e.label,language:e.language,enabled:e.enabled}}))}},{key:"textTrack",get:function(){return m(this.textTracks.find((function(e){return e.enabled})))},set:function(e){if(this.video.textTracks)for(var t,n=h(this.video.textTracks||[]);!(t=n()).done;){var r=t.value;r.enabled=m(r)===e}}},{key:"textTracks",get:function(){var e;return Array.from(null!=(e=this.video.textTracks)?e:[]).filter((function(e){return"metadata"!==e.kind})).map((function(e){return{id:m(e),label:e.label,language:e.language,enabled:e.enabled}}))}}]),t}(g),E={"application/x-mpegURL":r.HLS,"application/octet-stream":r.UNKNOWN,"binary/octet-stream":r.UNKNOWN,"application/vnd.apple.mpegurl":r.HLS,"application/dash+xml":r.DASH,"application/vnd.apple.mpegurl;charset=UTF-8":r.HLS,"application/vnd.ms-sstr+xml":r.MSS},T=((v={})[r.HLS]="application/vnd.apple.mpegurl",v[r.DASH]="application/dash+xml",v[r.MSS]="application/vnd.ms-sstr+xml",v);function _(e,t,n){if(!e.s){if(n instanceof b){if(!n.s)return void(n.o=_.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(_.bind(null,e,t),_.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var b=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{_(r,1,a(this.v))}catch(e){_(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?_(r,1,t?t(i):i):n?_(r,1,n(i)):_(r,2,i)}catch(e){_(r,2,e)}},r},e}(),A=function(e){function t(t){var n,r=t.video;return(n=e.call(this)||this).video=r,n}c(t,e);var o=t.prototype;return o.load=function(e){try{var t=this;return t.emit(a.READYING),t.reset(),t.currentSrc=e,Promise.resolve((o=e,fetch(o).then((function(e){return E[e.headers.get("content-type")]||(o.match(/\.m3u8/)?r.HLS:o.match(/\.mpd/)?r.DASH:o.toLowerCase().match(/\/manifest/)?r.MSS:r.UNKNOWN)})).catch((function(){return r.UNKNOWN})))).then((function(o){function s(){return t.tech=new u({video:t.video}),t.tech.on("*",t.onEvent.bind(t)),t.emit(a.READY),t.tech.load(e)}if(o===r.UNKNOWN)throw{errorCode:i.UNKNOWN_MANIFEST_TYPE};var u,l=function(e,t){var n,r=-1;e:{for(var i=0;i<t.length;i++){var a=t[i][0];if(a){var o=a();if(o&&o.then)break e;if(o===e){r=i;break}}else r=i}if(-1!==r){do{for(var s=t[r][1];!s;)r++,s=t[r][1];var u=s();if(u&&u.then){n=!0;break e}var l=t[r][2];r++}while(l&&!l());return u}}var c=new b,d=_.bind(null,c,2);return(n?u.then(f):o.then((function n(o){for(;;){if(o===e){r=i;break}if(++i===t.length){if(-1!==r)break;return void _(c,1,u)}if(a=t[i][0]){if((o=a())&&o.then)return void o.then(n).then(void 0,d)}else r=i}do{for(var s=t[r][1];!s;)r++,s=t[r][1];var u=s();if(u&&u.then)return void u.then(f).then(void 0,d);var l=t[r][2];r++}while(l&&!l());_(c,1,u)}))).then(void 0,d),c;function f(e){for(;;){var n=t[r][2];if(!n||n())break;r++;for(var i=t[r][1];!i;)r++,i=t[r][1];if((e=i())&&e.then)return void e.then(f).then(void 0,d)}_(c,1,e)}}(o,[[function(){return r.HLS},function(){var e=function(){if(!function(e){return!!document.createElement("video").canPlayType(T[e])}(r.HLS)||(e=window.navigator.userAgent.toLowerCase(),!/safari/.test(e)&&!/iphone|ipad|ipod/.test(e)||!/apple computer/.test(window.navigator.vendor.toLowerCase())))return Promise.resolve(Promise.resolve().then(n.bind(null,98))).then((function(e){u=e.default}));var e;u=y}();if(e&&e.then)return e.then((function(){}))}],[function(){return r.DASH},function(){return Promise.resolve(Promise.resolve().then(n.bind(null,99))).then((function(e){u=e.default}))}],[function(){return r.MSS},function(){return Promise.resolve(Promise.resolve().then(n.bind(null,100))).then((function(e){u=e.default}))}]]);return l&&l.then?l.then(s):s()}))}catch(e){return Promise.reject(e)}var o},o.onEvent=function(e,t){this.emit(e,t)},o.getVideoLevels=function(){if(this.tech)return this.tech.getVideoLevels()},o.play=function(){var e;return null==(e=this.tech)?void 0:e.play()},o.pause=function(){var e;return null==(e=this.tech)?void 0:e.pause()},o.stop=function(){return this.destroy()},o.seekTo=function(e){var t=e.position,n=e.change,r=e.percentage;this.tech&&(r?t=r/100*this.tech.duration:n&&(t=this.tech.currentTime+n),this.tech.currentTime=t)},o.seekToLive=function(){var e;return null==(e=this.tech)?void 0:e.seekToLive()},o.setAudioTrack=function(e){this.tech&&(this.tech.audioTrack=e)},o.setTextTrack=function(e){this.tech&&(this.tech.textTrack=e)},o.mute=function(){var e;null==(e=this.tech)||e.mute()},o.unmute=function(){var e;null==(e=this.tech)||e.unmute()},o.reset=function(){this.tech&&(this.tech.destroy(),this.tech=null,this.emit(a.UNREADY))},l(t,[{key:"isPlaying",get:function(){var e,t;return null!=(e=null==(t=this.tech)?void 0:t.isPlaying)&&e}},{key:"isMuted",get:function(){var e,t;return null!=(e=null==(t=this.tech)?void 0:t.isMuted)&&e}},{key:"currentTime",get:function(){var e;return null==(e=this.tech)?void 0:e.currentTime}},{key:"currentLevel",get:function(){if(this.tech)return this.tech.currentLevel},set:function(e){this.tech&&(this.tech.currentLevel=e)}}]),t}(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",i.LICENSE="license",i.OTHER_TYPE="other",t.HTTPRequest=i,t.HTTPRequestTrace=function e(){r(this,e),this.s=null,this.d=null,this.b=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.PATCH_LOCATION="PatchLocation",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId"}}]),e}());t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}());t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,e.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_CODEC_CODE=30,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="buffer is not defined",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(75))&&r.__esModule?r:{default:r}).default));t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r},a={DEFAULT:.5,STRONG:1,WEAK:0};function o(e,t,n){return{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:function(e){var t=a.DEFAULT;return e!==a.DEFAULT&&e!==a.STRONG&&e!==a.WEAK||(t=e),t}(n)}}o.__dashjs_factory_name="SwitchRequest";var s=i.default.getClassFactory(o);s.NO_CHANGE=-1,s.PRIORITY=a,i.default.updateClassFactory(o.__dashjs_factory_name,s),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(161));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0,t=[],n=this.context;function r(n,r,i){var a=function(n){var r=void 0;for(r=0;r<t.length;r++)if(t[r].regex.test(n))return t[r].utils;return e}(i||r);return a&&"function"==typeof a[n]?a[n](r,i):e[n](r,i)}return e=(0,i.default)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n})},parseBaseUrl:function(e){return r("parseBaseUrl",e)},parseOrigin:function(e){return r("parseOrigin",e)},parseScheme:function(e){return r("parseScheme",e)},isRelative:function(e){return r("isRelative",e)},isPathAbsolute:function(e){return r("isPathAbsolute",e)},isSchemeRelative:function(e){return r("isSchemeRelative",e)},isHTTPURL:function(e){return r("isHTTPURL",e)},isHTTPS:function(e){return r("isHTTPS",e)},removeHostname:function(e){return r("removeHostname",e)},resolve:function(e,t){return r("resolve",e,t)}}}o.__dashjs_factory_name="URLUtils";var s=r.default.getSingletonFactory(o);t.default=s},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.checkParameterType=function(e,t){if((void 0===e?"undefined":r(e))!==t)throw a.default.BAD_ARGUMENT_ERROR},t.checkInteger=function(e){if(null===e||isNaN(e)||e%1!=0)throw a.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},t.checkRange=function(e,t,n){if(e<t||e>n)throw a.default.BAD_ARGUMENT_ERROR+" : argument out of range"},t.checkIsVideoOrAudioType=function(e){if("string"!=typeof e||e!==a.default.AUDIO&&e!==a.default.VIDEO)throw a.default.BAD_ARGUMENT_ERROR};var i,a=(i=n(1))&&i.__esModule?i:{default:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return r(e,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===i.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?i.HTTPRequest.INIT_SEGMENT_TYPE:i.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}]),e}();a.ACTION_DOWNLOAD="download",a.ACTION_COMPLETE="complete",t.default=a},function(e,t,n){"use strict";var r=n(37),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=d;var a=Object.create(n(28));a.inherits=n(21);var o=n(71),s=n(49);a.inherits(d,o);for(var u=i(s.prototype),l=0;l<u.length;l++){var c=u[l];d.prototype[c]||(d.prototype[c]=s.prototype[c])}function d(e){if(!(this instanceof d))return new d(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),e}());t.default=i},function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var o=i.apply(null,r);o&&e.push(o)}else if("object"===a)for(var s in r)n.call(r,s)&&r[s]&&e.push(s)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){var r;"undefined"!=typeof window&&(r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
  !*** ./node_modules/eventemitter3/index.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function a(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new o(n,r||e,a),u=i?i+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function l(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(i=!1)),l.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},l.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,a=n.length,o=new Array(a);r<a;r++)o[r]=n[r].fn;return o},l.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},l.prototype.emit=function(e,t,n,r,a,o){var s=i?i+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,a),!0;case 6:return c.fn.call(c.context,t,n,r,a,o),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var f,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u)}}return!0},l.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},l.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},l.prototype.removeListener=function(e,t,n,r){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return u(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||u(this,a);else{for(var s=0,l=[],c=o.length;s<c;s++)(o[s].fn!==t||r&&!o[s].once||n&&o[s].context!==n)&&l.push(o[s]);l.length?this._events[a]=1===l.length?l[0]:l:u(this,a)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&u(this,t)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,e.exports=l},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
  !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
  \*****************************************************/
/*! no static exports found */function(e,t,n){var r,i,a,o,s;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,i=/^([^\/?#]*)([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=i.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(d)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=n.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},"./node_modules/webworkify-webpack/index.js":
/*!**************************************************!*\
  !*** ./node_modules/webworkify-webpack/index.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,n){function r(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var r=n(n.s=ENTRY_MODULE);return r.default||r}function i(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,r){var a={};a[r]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return a;for(var u,l=s[1],c=new RegExp("(\\\\n|\\W)"+i(l)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");u=c.exec(o);)"dll-reference"!==u[3]&&a[r].push(u[3]);for(c=new RegExp("\\("+i(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");u=c.exec(o);)e[u[2]]||(a[r].push(u[1]),e[u[2]]=n(u[1]).m),a[u[2]]=a[u[2]]||[],a[u[2]].push(u[4]);for(var d,f=Object.keys(a),h=0;h<f.length;h++)for(var p=0;p<a[f[h]].length;p++)d=a[f[h]][p],isNaN(1*d)||(a[f[h]][p]=1*a[f[h]][p]);return a}function o(e){return Object.keys(e).reduce((function(t,n){return t||e[n].length>0}),!1)}e.exports=function(e,t){t=t||{};var i={main:n.m},s=t.all?{main:Object.keys(i.main)}:function(e,t){for(var n={main:[t]},r={main:[]},i={main:{}};o(n);)for(var s=Object.keys(n),u=0;u<s.length;u++){var l=s[u],c=n[l].pop();if(i[l]=i[l]||{},!i[l][c]&&e[l][c]){i[l][c]=!0,r[l]=r[l]||[],r[l].push(c);for(var d=a(e,e[l][c],l),f=Object.keys(d),h=0;h<f.length;h++)n[f[h]]=n[f[h]]||[],n[f[h]]=n[f[h]].concat(d[f[h]])}}return r}(i,e),u="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),u=u+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var l=new window.Blob([u],{type:"text/javascript"});if(t.bare)return l;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),d=new window.Worker(c);return d.objectURL=c,d}},"./src/config.ts":
/*!***********************!*\
  !*** ./src/config.ts ***!
  \***********************/
/*! exports provided: hlsDefaultConfig, mergeConfig, enableStreamingMode */function(e,t,n){"use strict";n.r(t),n.d(t,"hlsDefaultConfig",(function(){return b})),n.d(t,"mergeConfig",(function(){return A})),n.d(t,"enableStreamingMode",(function(){return S}));var r=n(/*! ./controller/abr-controller */"./src/controller/abr-controller.ts"),i=n(/*! ./controller/audio-stream-controller */"./src/controller/audio-stream-controller.ts"),a=n(/*! ./controller/audio-track-controller */"./src/controller/audio-track-controller.ts"),o=n(/*! ./controller/subtitle-stream-controller */"./src/controller/subtitle-stream-controller.ts"),s=n(/*! ./controller/subtitle-track-controller */"./src/controller/subtitle-track-controller.ts"),u=n(/*! ./controller/buffer-controller */"./src/controller/buffer-controller.ts"),l=n(/*! ./controller/timeline-controller */"./src/controller/timeline-controller.ts"),c=n(/*! ./controller/cap-level-controller */"./src/controller/cap-level-controller.ts"),d=n(/*! ./controller/fps-controller */"./src/controller/fps-controller.ts"),f=n(/*! ./controller/eme-controller */"./src/controller/eme-controller.ts"),h=n(/*! ./utils/xhr-loader */"./src/utils/xhr-loader.ts"),p=n(/*! ./utils/fetch-loader */"./src/utils/fetch-loader.ts"),g=n(/*! ./utils/cues */"./src/utils/cues.ts"),m=n(/*! ./utils/mediakeys-helper */"./src/utils/mediakeys-helper.ts"),v=n(/*! ./utils/logger */"./src/utils/logger.ts");function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=T(T({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:h.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:r.default,bufferController:u.default,capLevelController:c.default,fpsController:d.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:m.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:g.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:o.SubtitleStreamController,subtitleTrackController:s.default,timelineController:l.TimelineController,audioStreamController:i.default,audioTrackController:a.default,emeController:f.default});function A(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return y({},e,t)}function S(e){var t=e.loader;t!==p.default&&t!==h.default?(v.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):Object(p.fetchSupported)()&&(e.loader=p.default,e.progressive=!0,e.enableSoftwareAES=!0,v.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":
/*!******************************************!*\
  !*** ./src/controller/abr-controller.ts ***!
  \******************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../utils/ewma-bandwidth-estimator */"./src/utils/ewma-bandwidth-estimator.ts"),a=n(/*! ../events */"./src/events.ts"),o=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),s=n(/*! ../errors */"./src/errors.ts"),u=n(/*! ../types/loader */"./src/types/loader.ts"),l=n(/*! ../utils/logger */"./src/utils/logger.ts");function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(e){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;var t=e.config;this.bwEstimator=new i.default(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}var t,n,d=e.prototype;return d.registerListeners=function(){var e=this.hls;e.on(a.Events.FRAG_LOADING,this.onFragLoading,this),e.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(a.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(a.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var e=this.hls;e.off(a.Events.FRAG_LOADING,this.onFragLoading,this),e.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(a.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(a.Events.ERROR,this.onError,this)},d.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},d.onFragLoading=function(e,t){var n,r=t.frag;r.type===u.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=r,this.partCurrent=null!=(n=t.part)?n:null,this.timer=self.setInterval(this.onCheck,100)))},d.onLevelLoaded=function(e,t){var n=this.hls.config;t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)},d._abandonRulesCheck=function(){var e=this.fragCurrent,t=this.partCurrent,n=this.hls,i=n.autoLevelEnabled,s=n.config,u=n.media;if(e&&u){var c=t?t.stats:e.stats,d=t?t.duration:e.duration;if(c.aborted)return l.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(i&&!u.paused&&u.playbackRate&&u.readyState){var f=performance.now()-c.loading.start,h=Math.abs(u.playbackRate);if(!(f<=500*d/h)){var p=n.levels,g=n.minAutoLevel,m=p[e.level],v=c.total||Math.max(c.loaded,Math.round(d*m.maxBitrate/8)),y=Math.max(1,c.bwEstimate?c.bwEstimate/8:1e3*c.loaded/f),E=(v-c.loaded)/y,T=u.currentTime,_=(o.BufferHelper.bufferInfo(u,T,s.maxBufferHole).end-T)/h;if(!(_>=2*d/h||E<=_)){var b,A=Number.POSITIVE_INFINITY;for(b=e.level-1;b>g&&!((A=d*p[b].maxBitrate/(6.4*y))<_);b--);if(!(A>=E)){var S=this.bwEstimator.getEstimate();l.logger.warn("Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+b+"\n      Current BW estimate: "+(Object(r.isFiniteNumber)(S)?(S/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+E.toFixed(3)+" s\n      Estimated load time for the next fragment: "+A.toFixed(3)+" s\n      Time to underbuffer: "+_.toFixed(3)+" s"),n.nextLoadLevel=b,this.bwEstimator.sample(f,c.loaded),this.clearTimer(),e.loader&&(this.fragCurrent=this.partCurrent=null,e.loader.abort()),n.trigger(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:c})}}}}}},d.onFragLoaded=function(e,t){var n=t.frag,i=t.part;if(n.type===u.PlaylistLevelType.MAIN&&Object(r.isFiniteNumber)(n.sn)){var o=i?i.stats:n.stats,s=i?i.duration:n.duration;if(this.clearTimer(),this.lastLoadedFragLevel=n.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var l=this.hls.levels[n.level],c=(l.loaded?l.loaded.bytes:0)+o.loaded,d=(l.loaded?l.loaded.duration:0)+s;l.loaded={bytes:c,duration:d},l.realBitrate=Math.round(8*c/d)}if(n.bitrateTest){var f={stats:o,frag:n,part:i,id:n.type};this.onFragBuffered(a.Events.FRAG_BUFFERED,f),n.bitrateTest=!1}}},d.onFragBuffered=function(e,t){var n=t.frag,r=t.part,i=r?r.stats:n.stats;if(!i.aborted&&n.type===u.PlaylistLevelType.MAIN&&"initSegment"!==n.sn){var a=i.parsing.end-i.loading.start;this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},d.onError=function(e,t){switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},d.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},d.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,n=this.hls,r=n.maxAutoLevel,i=n.config,a=n.minAutoLevel,s=n.media,u=t?t.duration:e?e.duration:0,c=s?s.currentTime:0,d=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,f=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,h=(o.BufferHelper.bufferInfo(s,c,i.maxBufferHole).end-c)/d,p=this.findBestLevel(f,a,r,h,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(p>=0)return p;l.logger.trace((h?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var g=u?Math.min(u,i.maxStarvationDelay):i.maxStarvationDelay,m=i.abrBandWidthFactor,v=i.abrBandWidthUpFactor;if(!h){var y=this.bitrateTestDelay;y&&(g=(u?Math.min(u,i.maxLoadingDelay):i.maxLoadingDelay)-y,l.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),m=v=1)}return p=this.findBestLevel(f,a,r,h+g,m,v),Math.max(p,0)},d.findBestLevel=function(e,t,n,r,i,a){for(var o,s=this.fragCurrent,u=this.partCurrent,c=this.lastLoadedFragLevel,d=this.hls.levels,f=d[c],h=!(null==f||null===(o=f.details)||void 0===o||!o.live),p=null==f?void 0:f.codecSet,g=u?u.duration:s?s.duration:0,m=n;m>=t;m--){var v=d[m];if(v&&(!p||v.codecSet===p)){var y,E=v.details,T=(u?null==E?void 0:E.partTarget:null==E?void 0:E.averagetargetduration)||g;y=m<=c?i*e:a*e;var _=d[m].maxBitrate,b=_*T/y;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+m+"/"+Math.round(y)+"/"+_+"/"+T+"/"+r+"/"+b),y>_&&(!b||h&&!this.bitrateTestDelay||b<r))return m}}return-1},t=e,(n=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var n=this.getNextABRAutoLevel();return-1!==e&&(n=Math.min(e,n)),n},set:function(e){this._nextAutoLevel=e}}])&&c(t.prototype,n),e}();t.default=d},"./src/controller/audio-stream-controller.ts":
/*!***************************************************!*\
  !*** ./src/controller/audio-stream-controller.ts ***!
  \***************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ./base-stream-controller */"./src/controller/base-stream-controller.ts"),a=n(/*! ../events */"./src/events.ts"),o=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),s=n(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),u=n(/*! ../types/level */"./src/types/level.ts"),l=n(/*! ../types/loader */"./src/types/loader.ts"),c=n(/*! ../loader/fragment */"./src/loader/fragment.ts"),d=n(/*! ../demux/chunk-cache */"./src/demux/chunk-cache.ts"),f=n(/*! ../demux/transmuxer-interface */"./src/demux/transmuxer-interface.ts"),h=n(/*! ../types/transmuxer */"./src/types/transmuxer.ts"),p=n(/*! ./fragment-finders */"./src/controller/fragment-finders.ts"),g=n(/*! ../utils/discontinuities */"./src/utils/discontinuities.ts"),m=n(/*! ./gap-controller */"./src/controller/gap-controller.ts"),v=n(/*! ../errors */"./src/errors.ts"),y=n(/*! ../utils/logger */"./src/utils/logger.ts");function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){var t,n;function _(t,n){var r;return(r=e.call(this,t,n,"[audio-stream-controller]")||this).videoBuffer=null,r.videoTrackCC=-1,r.waitingVideoCC=-1,r.audioSwitch=!1,r.trackId=-1,r.waitingData=null,r.mainDetails=null,r._registerListeners(),r}n=e,(t=_).prototype=Object.create(n.prototype),t.prototype.constructor=t,T(t,n);var b=_.prototype;return b.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},b._registerListeners=function(){var e=this.hls;e.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(a.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(a.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(a.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(a.Events.ERROR,this.onError,this),e.on(a.Events.BUFFER_RESET,this.onBufferReset,this),e.on(a.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(a.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(a.Events.FRAG_BUFFERED,this.onFragBuffered,this)},b._unregisterListeners=function(){var e=this.hls;e.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(a.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(a.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(a.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(a.Events.ERROR,this.onError,this),e.off(a.Events.BUFFER_RESET,this.onBufferReset,this),e.off(a.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(a.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(a.Events.FRAG_BUFFERED,this.onFragBuffered,this)},b.onInitPtsFound=function(e,t){var n=t.frag,r=t.id,a=t.initPTS;if("main"===r){var o=n.cc;this.initPTS[n.cc]=a,this.log("InitPTS for cc: "+o+" found from main: "+a),this.videoTrackCC=o,this.state===i.State.WAITING_INIT_PTS&&this.tick()}},b.startLoad=function(e){if(!this.levels)return this.startPosition=e,void(this.state=i.State.STOPPED);var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=i.State.IDLE):(this.loadedmetadata=!1,this.state=i.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},b.doTick=function(){switch(this.state){case i.State.IDLE:this.doTickIdle();break;case i.State.WAITING_TRACK:var t,n=this.levels,r=this.trackId,a=null==n||null===(t=n[r])||void 0===t?void 0:t.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=i.State.WAITING_INIT_PTS}break;case i.State.FRAG_LOADING_WAITING_RETRY:var s,u=performance.now(),l=this.retryDate;(!l||u>=l||null!==(s=this.media)&&void 0!==s&&s.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=i.State.IDLE);break;case i.State.WAITING_INIT_PTS:var c=this.waitingData;if(c){var d=c.frag,f=c.part,h=c.cache,g=c.complete;if(void 0!==this.initPTS[d.cc]){this.waitingData=null,this.state=i.State.FRAG_LOADING;var m={frag:d,part:f,payload:h.flush(),networkDetails:null};this._handleFragmentLoadProgress(m),g&&e.prototype._handleFragmentLoadComplete.call(this,m)}else if(this.videoTrackCC!==this.waitingVideoCC)y.logger.log("Waiting fragment cc ("+d.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var v=o.BufferHelper.bufferInfo(this.mediaBuffer,this.media.currentTime,this.config.maxBufferHole);Object(p.fragmentWithinToleranceTest)(v.end,this.config.maxFragLookUpTolerance,d)<0&&(y.logger.log("Waiting fragment cc ("+d.cc+") @ "+d.start+" cancelled because another fragment at "+v.end+" is needed"),this.clearWaitingFragment())}}else this.state=i.State.IDLE}this.onTickEnd()},b.clearWaitingFragment=function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=i.State.IDLE)},b.onTickEnd=function(){var e=this.media;if(e&&e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length&&(this.loadedmetadata=!0),this.lastCurrentTime=e.currentTime}},b.doTickIdle=function(){var e,t,n=this.hls,s=this.levels,u=this.media,l=this.trackId,c=n.config;if(s&&s[l]&&(u||!this.startFragRequested&&c.startFragPrefetch)){var d=this.getLoadPosition();if(Object(r.isFiniteNumber)(d)){var f=s[l].details;if(!f||f.live&&this.levelLastLoaded!==l||this.waitForCdnTuneIn(f))this.state=i.State.WAITING_TRACK;else{var h=0,p=this.mediaBuffer?this.mediaBuffer:this.media,g=this.videoBuffer?this.videoBuffer:this.media,v=d<c.maxBufferHole?Math.max(m.MAX_START_GAP_JUMP,c.maxBufferHole):c.maxBufferHole,y=o.BufferHelper.bufferInfo(p,d,v),E=o.BufferHelper.bufferInfo(g,d,v),T=y.len,_=Math.min(c.maxBufferLength,c.maxMaxBufferLength),b=Math.max(_,E.len),A=this.audioSwitch;if(!(T>=b)||A){if(!A&&this._streamEnded(y,f))return n.trigger(a.Events.BUFFER_EOS,{type:"audio"}),void(this.state=i.State.ENDED);var S=f.fragments[0].start;h=y.end,A&&(h=d,f.PTSKnown&&d<S&&(y.end>S||y.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),u.currentTime=S+.05));var w=this.getNextFragment(h,f);w&&("identity"!==(null===(e=w.decryptdata)||void 0===e?void 0:e.keyFormat)||null!==(t=w.decryptdata)&&void 0!==t&&t.key?this.loadFragment(w,f,h):this.loadKey(w,f))}}}}},b.onMediaDetaching=function(){this.videoBuffer=null,e.prototype.onMediaDetaching.call(this)},b.onAudioTracksUpdated=function(e,t){var n=t.audioTracks;this.resetTransmuxer(),this.levels=n.map((function(e){return new u.Level(e)}))},b.onAudioTrackSwitching=function(e,t){var n=!!t.url;this.trackId=t.id;var r=this.fragCurrent;null!=r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.audioSwitch=!0,this.state=i.State.IDLE):this.state=i.State.STOPPED,this.tick()},b.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0},b.onLevelLoaded=function(e,t){if(null===this.mainDetails){var n=this.mainDetails=t.details,r=this.levelLastLoaded;if(null!==r&&this.levels&&-1===this.startPosition&&n.live){var i=this.levels[r];if(!i.details||!i.details.fragments[0])return;Object(g.alignPDT)(i.details,n),this.setStartPosition(i.details,i.details.fragments[0].start)}}},b.onAudioTrackLoaded=function(e,t){var n,r=this.levels,a=t.details,o=t.id;if(r){this.log("Track "+o+" loaded ["+a.startSN+","+a.endSN+"],duration:"+a.totalduration);var s=r[o],u=0;if(a.live||null!==(n=s.details)&&void 0!==n&&n.live){var l;if(a.fragments[0]||(a.deltaUpdateFailed=!0),a.deltaUpdateFailed)return;!s.details&&null!==(l=this.mainDetails)&&void 0!==l&&l.hasProgramDateTime&&a.hasProgramDateTime?(Object(g.alignPDT)(a,this.mainDetails),u=a.fragments[0].start):u=this.alignPlaylists(a,s.details)}s.details=a,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(s.details,u),this.state!==i.State.WAITING_TRACK||this.waitForCdnTuneIn(a)||(this.state=i.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+o)},b._handleFragmentLoadProgress=function(e){var t,n=e.frag,r=e.part,a=e.payload,o=this.config,s=this.trackId,u=this.levels;if(u){var c=u[s];console.assert(c,"Audio track is defined on fragment load progress");var p=c.details;console.assert(p,"Audio track details are defined on fragment load progress");var g=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2",m=this.transmuxer;m||(m=this.transmuxer=new f.default(this.hls,l.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var v=this.initPTS[n.cc],E=null===(t=n.initSegment)||void 0===t?void 0:t.data;if(void 0!==v){var T=r?r.index:-1,_=-1!==T,b=new h.ChunkMetadata(n.level,n.sn,n.stats.chunkCount,a.byteLength,T,_);m.push(a,E,g,"",n,r,p.totalduration,!1,b,v)}else y.logger.log("Unknown video PTS for cc "+n.cc+", waiting for video PTS before demuxing audio frag "+n.sn+" of ["+p.startSN+" ,"+p.endSN+"],track "+s),(this.waitingData=this.waitingData||{frag:n,part:r,cache:new d.default,complete:!1}).cache.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=i.State.WAITING_INIT_PTS}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+n.sn+" of level "+n.level+" will not be buffered")},b._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:e.prototype._handleFragmentLoadComplete.call(this,t)},b.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},b.onBufferCreated=function(e,t){var n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},b.onFragBuffered=function(e,t){var n=t.frag,r=t.part;n.type===l.PlaylistLevelType.AUDIO&&(this.fragContextChanged(n)?this.warn("Fragment "+n.sn+(r?" p: "+r.index:"")+" of level "+n.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==n.sn&&(this.fragPrevious=n,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(a.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(n,r)))},b.onError=function(t,n){switch(n.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(l.PlaylistLevelType.AUDIO,n);break;case v.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case v.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==i.State.ERROR&&this.state!==i.State.STOPPED&&(this.state=n.fatal?i.State.ERROR:i.State.IDLE,this.warn(n.details+" while loading frag, switching to "+this.state+" state"));break;case v.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===n.parent&&(this.state===i.State.PARSING||this.state===i.State.PARSED)){var r=this.mediaBuffer,a=this.media.currentTime;r&&o.BufferHelper.isBuffered(r,a)&&o.BufferHelper.isBuffered(r,a+.5)?(this.reduceMaxBufferLength(),this.state=i.State.IDLE):(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"))}}},b.onBufferFlushed=function(e,t){var n=t.type;if(n===c.ElementaryStreamTypes.AUDIO){var r=this.mediaBuffer?this.mediaBuffer:this.media;this.afterBufferFlushed(r,n,l.PlaylistLevelType.AUDIO)}},b._handleTransmuxComplete=function(e){var t,n="audio",r=this.hls,o=e.remuxResult,s=e.chunkMeta,u=this.getCurrentContext(s);if(!u)return this.warn("The loading context changed while buffering fragment "+s.sn+" of level "+s.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(s.level);var l=u.frag,d=u.part,f=o.audio,h=o.text,p=o.id3,g=o.initSegment;if(!this.fragContextChanged(l)){if(this.state=i.State.PARSING,this.audioSwitch&&f&&this.completeAudioSwitch(),null!=g&&g.tracks&&(this._bufferInitSegment(g.tracks,l,s),r.trigger(a.Events.FRAG_PARSING_INIT_SEGMENT,{frag:l,id:n,tracks:g.tracks})),f){var m=f.startPTS,v=f.endPTS,y=f.startDTS,T=f.endDTS;d&&(d.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:m,endPTS:v,startDTS:y,endDTS:T}),l.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,m,v,y,T),this.bufferFragmentData(f,l,d,s)}if(null!=p&&null!==(t=p.samples)&&void 0!==t&&t.length){var _=E({frag:l,id:n},p);r.trigger(a.Events.FRAG_PARSING_METADATA,_)}if(h){var b=E({frag:l,id:n},h);r.trigger(a.Events.FRAG_PARSING_USERDATA,b)}}},b._bufferInitSegment=function(e,t,n){if(this.state===i.State.PARSING){e.video&&delete e.video;var r=e.audio;if(r){r.levelCodec=r.codec,r.id="audio",this.log("Init audio buffer, container:"+r.container+", codecs[parsed]=["+r.codec+"]"),this.hls.trigger(a.Events.BUFFER_CODECS,e);var o=r.initSegment;if(null!=o&&o.byteLength){var s={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:o};this.hls.trigger(a.Events.BUFFER_APPENDING,s)}this.tick()}}},b.loadFragment=function(t,n,a){var o=this.fragmentTracker.getState(t);this.fragCurrent=t,(this.audioSwitch||o===s.FragmentState.NOT_LOADED||o===s.FragmentState.PARTIAL)&&("initSegment"===t.sn?this._loadInitSegment(t):n.live&&!Object(r.isFiniteNumber)(this.initPTS[t.cc])?(this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=i.State.WAITING_INIT_PTS):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,n,a)))},b.completeAudioSwitch=function(){var t=this.hls,n=this.media,r=this.trackId;n&&(this.log("Switching audio track : flushing all audio"),e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,t.trigger(a.Events.AUDIO_TRACK_SWITCHED,{id:r})},_}(i.default);t.default=_},"./src/controller/audio-track-controller.ts":
/*!**************************************************!*\
  !*** ./src/controller/audio-track-controller.ts ***!
  \**************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../errors */"./src/errors.ts"),a=n(/*! ./base-playlist-controller */"./src/controller/base-playlist-controller.ts"),o=n(/*! ../types/loader */"./src/types/loader.ts");function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(t){var n;return(n=e.call(this,t,"[audio-track-controller]")||this).tracks=[],n.groupId=null,n.tracksInGroup=[],n.trackId=-1,n.trackName="",n.selectDefaultTrack=!0,n.registerListeners(),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var l,c,d=a.prototype;return d.registerListeners=function(){var e=this.hls;e.on(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(r.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(r.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(r.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(r.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var e=this.hls;e.off(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(r.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(r.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(r.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(r.Events.ERROR,this.onError,this)},d.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,e.prototype.destroy.call(this)},d.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},d.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[]},d.onAudioTrackLoaded=function(e,t){var n=t.id,r=t.details,i=this.tracksInGroup[n];if(i){var a=i.details;i.details=t.details,this.log("audioTrack "+n+" loaded ["+r.startSN+"-"+r.endSN+"]"),n===this.trackId&&(this.retryCount=0,this.playlistLoaded(n,t,a))}else this.warn("Invalid audio track id "+n)},d.onLevelLoading=function(e,t){this.switchLevel(t.level)},d.onLevelSwitching=function(e,t){this.switchLevel(t.level)},d.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.audioGroupIds){var n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n;var i=this.tracks.filter((function(e){return!n||e.groupId===n}));this.selectDefaultTrack&&!i.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),this.tracksInGroup=i;var a={audioTracks:i};this.log("Updating audio tracks, "+i.length+' track(s) found in "'+n+'" group-id'),this.hls.trigger(r.Events.AUDIO_TRACKS_UPDATED,a),this.selectInitialTrack()}}},d.onError=function(t,n){e.prototype.onError.call(this,t,n),!n.fatal&&n.context&&n.context.type===o.PlaylistContextType.AUDIO_TRACK&&n.context.id===this.trackId&&n.context.groupId===this.groupId&&this.retryLoadingOrFail(n)},d.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var n=t[this.trackId];this.log("Now switching to audio-track index "+e);var i=t[e],a=i.id,o=i.groupId,s=void 0===o?"":o,u=i.name,l=i.type,c=i.url;if(this.trackId=e,this.trackName=u,this.selectDefaultTrack=!1,this.hls.trigger(r.Events.AUDIO_TRACK_SWITCHING,{id:a,groupId:s,name:u,type:l,url:c}),!i.details||i.details.live){var d=this.switchParams(i.url,null==n?void 0:n.details);this.loadPlaylist(d)}}},d.selectInitialTrack=function(){var e=this.tracksInGroup;console.assert(e.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,n=this.findTrackId(t)||this.findTrackId();-1!==n?this.setAudioTrack(n):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},d.findTrackId=function(e){for(var t=this.tracksInGroup,n=0;n<t.length;n++){var r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1},d.loadPlaylist=function(e){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var n=t.id,i=t.groupId,a=t.url;if(e)try{a=e.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("loading audio-track playlist for id: "+n),this.clearTimer(),this.hls.trigger(r.Events.AUDIO_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:e||null})}},l=a,(c=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}])&&s(l.prototype,c),a}(a.default);t.default=l},"./src/controller/base-playlist-controller.ts":
/*!****************************************************!*\
  !*** ./src/controller/base-playlist-controller.ts ***!
  \****************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../types/level */"./src/types/level.ts"),a=n(/*! ./level-helper */"./src/controller/level-helper.ts"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=n(/*! ../errors */"./src/errors.ts"),u=function(){function e(e,t){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=o.logger.log.bind(o.logger,t+":"),this.warn=o.logger.warn.bind(o.logger,t+":"),this.hls=e}var t=e.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.onError=function(e,t){t.fatal&&t.type===s.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},t.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},t.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,t){var n=null==t?void 0:t.renditionReports;if(n)for(var a=0;a<n.length;a++){var o=n[a],s=""+o.URI;if(s===e.substr(-s.length)){var u=parseInt(o["LAST-MSN"]),l=parseInt(o["LAST-PART"]);if(t&&this.hls.config.lowLatencyMode){var c=Math.min(t.age-t.partTarget,t.targetduration);void 0!==l&&c>t.partTarget&&(l+=1)}if(Object(r.isFiniteNumber)(u))return new i.HlsUrlParameters(u,Object(r.isFiniteNumber)(l)?l:void 0,i.HlsSkip.No)}}},t.loadPlaylist=function(e){},t.shouldLoadTrack=function(e){return this.canLoad&&e&&!!e.url&&(!e.details||e.details.live)},t.playlistLoaded=function(e,t,n){var r=this,i=t.details,o=t.stats,s=o.loading.end?Math.max(0,self.performance.now()-o.loading.end):0;if(i.advancedDateTime=Date.now()-s,i.live||null!=n&&n.live){if(i.reloaded(n),n&&this.log("live playlist "+e+" "+(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED")),n&&i.fragments.length>0&&a.mergeDetails(n,i),!this.canLoad||!i.live)return;var u,l=void 0,c=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){var d=this.hls.config.lowLatencyMode,f=i.lastPartSn,h=i.endSN,p=i.lastPartIndex,g=f===h;-1!==p?(l=g?h+1:f,c=g?d?0:p:p+1):l=h+1;var m=i.age,v=m+i.ageHeader,y=Math.min(v-i.partTarget,1.5*i.targetduration);if(y>0){if(n&&y>n.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+n.tuneInGoal+" to: "+y+" with playlist age: "+i.age),y=0;else{var E=Math.floor(y/i.targetduration);l+=E,void 0!==c&&(c+=Math.round(y%i.targetduration/i.partTarget)),this.log("CDN Tune-in age: "+i.ageHeader+"s last advanced "+m.toFixed(2)+"s goal: "+y+" skip sn "+E+" to part "+c)}i.tuneInGoal=y}if(u=this.getDeliveryDirectives(i,t.deliveryDirectives,l,c),d||!g)return void this.loadPlaylist(u)}else u=this.getDeliveryDirectives(i,t.deliveryDirectives,l,c);var T=Object(a.computeReloadInterval)(i,o);void 0!==l&&i.canBlockReload&&(T-=i.partTarget||1),this.log("reload live playlist "+e+" in "+Math.round(T)+" ms"),this.timer=self.setTimeout((function(){return r.loadPlaylist(u)}),T)}else this.clearTimer()},t.getDeliveryDirectives=function(e,t,n,r){var a=Object(i.getSkipValue)(e,n);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,a=i.HlsSkip.No),new i.HlsUrlParameters(n,r,a)},t.retryLoadingOrFail=function(e){var t,n=this,r=this.hls.config,i=this.retryCount<r.levelLoadingMaxRetry;if(i)if(this.retryCount++,e.details.indexOf("LoadTimeOut")>-1&&null!==(t=e.context)&&void 0!==t&&t.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+e.details+'"'),this.loadPlaylist();else{var a=Math.min(Math.pow(2,this.retryCount)*r.levelLoadingRetryDelay,r.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout((function(){return n.loadPlaylist()}),a),this.warn("retry playlist loading #"+this.retryCount+" in "+a+' ms after "'+e.details+'"')}else this.warn('cannot recover from error "'+e.details+'"'),this.clearTimer(),e.fatal=!0;return i},e}()},"./src/controller/base-stream-controller.ts":
/*!**************************************************!*\
  !*** ./src/controller/base-stream-controller.ts ***!
  \**************************************************/
/*! exports provided: State, default */function(e,t,n){"use strict";n.r(t),n.d(t,"State",(function(){return _})),n.d(t,"default",(function(){return b}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../task-loop */"./src/task-loop.ts"),a=n(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),o=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),s=n(/*! ../utils/logger */"./src/utils/logger.ts"),u=n(/*! ../events */"./src/events.ts"),l=n(/*! ../errors */"./src/errors.ts"),c=n(/*! ./level-helper */"./src/controller/level-helper.ts"),d=n(/*! ../types/transmuxer */"./src/types/transmuxer.ts"),f=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),h=n(/*! ../utils/discontinuities */"./src/utils/discontinuities.ts"),p=n(/*! ./fragment-finders */"./src/controller/fragment-finders.ts"),g=n(/*! ../loader/fragment-loader */"./src/loader/fragment-loader.ts"),m=n(/*! ../crypt/decrypter */"./src/crypt/decrypter.ts"),v=n(/*! ../utils/time-ranges */"./src/utils/time-ranges.ts"),y=n(/*! ../types/loader */"./src/types/loader.ts");function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},b=function(e){var t,n;function i(t,n,r){var i;return(i=e.call(this)||this).hls=void 0,i.fragPrevious=null,i.fragCurrent=null,i.fragmentTracker=void 0,i.transmuxer=null,i._state=_.STOPPED,i.media=void 0,i.mediaBuffer=void 0,i.config=void 0,i.bitrateTest=!1,i.lastCurrentTime=0,i.nextLoadPosition=0,i.startPosition=0,i.loadedmetadata=!1,i.fragLoadError=0,i.retryDate=0,i.levels=null,i.fragmentLoader=void 0,i.levelLastLoaded=null,i.startFragRequested=!1,i.decrypter=void 0,i.initPTS=[],i.onvseeking=null,i.onvended=null,i.logPrefix="",i.log=void 0,i.warn=void 0,i.logPrefix=r,i.log=s.logger.log.bind(s.logger,r+":"),i.warn=s.logger.warn.bind(s.logger,r+":"),i.hls=t,i.fragmentLoader=new g.default(t.config),i.fragmentTracker=n,i.config=t.config,i.decrypter=new m.default(t,t.config),t.on(u.Events.KEY_LOADED,i.onKeyLoaded,function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,T(t,n);var b,A,S=i.prototype;return S.doTick=function(){this.onTickEnd()},S.onTickEnd=function(){},S.startLoad=function(e){},S.stopLoad=function(){this.fragmentLoader.abort();var e=this.fragCurrent;e&&this.fragmentTracker.removeFragment(e),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=_.STOPPED},S._streamEnded=function(e,t){var n=this.fragCurrent,r=this.fragmentTracker;if(!t.live&&n&&n.sn===t.endSN&&!e.nextStart){var i=r.getState(n);return i===a.FragmentState.PARTIAL||i===a.FragmentState.OK}return!1},S.onMediaAttached=function(e,t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.state===_.STOPPED&&this.startLoad(r.startPosition)},S.onMediaDetaching=function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},S.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,n=this.media,i=this.mediaBuffer,a=this.state,s=n?n.currentTime:0,u=o.BufferHelper.bufferInfo(i||n,s,e.maxBufferHole);if(this.log("media seeking to "+(Object(r.isFiniteNumber)(s)?s.toFixed(3):s)+", state: "+a),a===_.ENDED)this.resetLoadingState();else if(t&&!u.len){var l=e.maxFragLookUpTolerance,c=t.start-l,d=s>t.start+t.duration+l;(s<c||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.loader.abort()),this.resetLoadingState())}n&&(this.lastCurrentTime=s),this.loadedmetadata||u.len||(this.nextLoadPosition=this.startPosition=s),this.tickImmediate()},S.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},S.onKeyLoaded=function(e,t){if(this.state===_.KEY_LOADING&&t.frag===this.fragCurrent&&this.levels){this.state=_.IDLE;var n=this.levels[t.frag.level].details;n&&this.loadFragment(t.frag,n,t.frag.start)}},S.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},S.onHandlerDestroyed=function(){this.state=_.STOPPED,this.hls.off(u.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},S.loadKey=function(e,t){this.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=_.KEY_LOADING,this.fragCurrent=e,this.hls.trigger(u.Events.KEY_LOADING,{frag:e})},S.loadFragment=function(e,t,n){this._loadFragForPlayback(e,t,n)},S._loadFragForPlayback=function(e,t,n){var r=this;this._doFragLoad(e,t,n,(function(t){if(r.fragContextChanged(e))return r.warn("Fragment "+e.sn+(t.part?" p: "+t.part.index:"")+" of level "+e.level+" was dropped during download."),void r.fragmentTracker.removeFragment(e);e.stats.chunkCount++,r._handleFragmentLoadProgress(t)})).then((function(t){if(t){r.fragLoadError=0;var n=r.state;if(!r.fragContextChanged(e))return"payload"in t&&(r.log("Loaded fragment "+e.sn+" of level "+e.level),r.hls.trigger(u.Events.FRAG_LOADED,t),r.state===_.BACKTRACKING)?(r.fragmentTracker.backtrack(e,t),void r.resetFragmentLoading(e)):void r._handleFragmentLoadComplete(t);(n===_.FRAG_LOADING||n===_.BACKTRACKING||!r.fragCurrent&&n===_.PARSING)&&(r.fragmentTracker.removeFragment(e),r.state=_.IDLE)}})).catch((function(t){r.warn(t),r.resetFragmentLoading(e)}))},S.flushMainBuffer=function(e,t,n){if(void 0===n&&(n=null),e-t){var r={startOffset:e,endOffset:t,type:n};this.fragLoadError=0,this.hls.trigger(u.Events.BUFFER_FLUSHING,r)}},S._loadInitSegment=function(e){var t=this;this._doFragLoad(e).then((function(n){if(!n||t.fragContextChanged(e)||!t.levels)throw new Error("init load aborted");return n})).then((function(n){var r=t.hls,i=n.payload,a=e.decryptdata;if(i&&i.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){var o=self.performance.now();return t.decrypter.webCryptoDecrypt(new Uint8Array(i),a.key.buffer,a.iv.buffer).then((function(t){var i=self.performance.now();return r.trigger(u.Events.FRAG_DECRYPTED,{frag:e,payload:t,stats:{tstart:o,tdecrypt:i}}),n.payload=t,n}))}return n})).then((function(n){var r=t.fragCurrent,i=t.hls,a=t.levels;if(!a)throw new Error("init load aborted, missing levels");var o=a[e.level].details;console.assert(o,"Level details are defined when init segment is loaded");var s=e.stats;t.state=_.IDLE,t.fragLoadError=0,e.data=new Uint8Array(n.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),n.frag===r&&i.trigger(u.Events.FRAG_BUFFERED,{stats:s,frag:r,part:null,id:e.type}),t.tick()})).catch((function(n){t.warn(n),t.resetFragmentLoading(e)}))},S.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId},S.fragBufferedComplete=function(e,t){var n=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level+" "+v.default.toString(o.BufferHelper.getBuffered(n))),this.state=_.IDLE,this.tick()},S._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var n=e.frag,r=e.part,i=e.partsLoaded,a=!i||0===i.length||i.some((function(e){return!e})),o=new d.ChunkMetadata(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(o)}},S._handleFragmentLoadProgress=function(e){},S._doFragLoad=function(e,t,n,i){var a=this;if(void 0===n&&(n=null),!this.levels)throw new Error("frag load aborted, missing levels");if(n=Math.max(e.start,n||0),this.config.lowLatencyMode&&t){var o=t.partList;if(o&&i){n>e.end&&t.fragmentHint&&(e=t.fragmentHint);var s=this.getNextPart(o,e,n);if(s>-1){var l=o[s];return this.log("Loading part sn: "+e.sn+" p: "+l.index+" cc: "+e.cc+" of playlist ["+t.startSN+"-"+t.endSN+"] parts [0-"+s+"-"+(o.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(n.toFixed(3))),this.nextLoadPosition=l.start+l.duration,this.state=_.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:e,part:o[s],targetBufferTime:n}),this.doFragPartsLoad(e,o,s,i).catch((function(e){return a.handleFragLoadError(e)}))}if(!e.url||this.loadedEndOfParts(o,n))return Promise.resolve(null)}}return this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(t?"of ["+t.startSN+"-"+t.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(n.toFixed(3))),Object(r.isFiniteNumber)(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=_.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragmentLoader.load(e,i).catch((function(e){return a.handleFragLoadError(e)}))},S.doFragPartsLoad=function(e,t,n,r){var i=this;return new Promise((function(a,o){var s=[];!function n(l){var c=t[l];i.fragmentLoader.loadPart(e,c,r).then((function(r){s[c.index]=r;var o=r.part;i.hls.trigger(u.Events.FRAG_LOADED,r);var d=t[l+1];if(!d||d.fragment!==e)return a({frag:e,part:o,partsLoaded:s});n(l+1)})).catch(o)}(n)}))},S.handleFragLoadError=function(e){var t=e.data;return t&&t.details===l.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(u.Events.ERROR,t),null},S._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===_.PARSING){var n=t.frag,r=t.part,i=t.level,a=self.performance.now();n.stats.parsing.end=a,r&&(r.stats.parsing.end=a),this.updateLevelTiming(n,r,i,e.partial)}else this.fragCurrent||(this.state=_.IDLE)},S.getCurrentContext=function(e){var t=this.levels,n=e.level,r=e.sn,i=e.part;if(!t||!t[n])return this.warn("Levels object was unset while buffering fragment "+r+" of level "+n+". The current chunk will not be buffered."),null;var a=t[n],o=i>-1?c.getPartWith(a,r,i):null,s=o?o.fragment:c.getFragmentWithSN(a,r);return s?{frag:s,part:o,level:a}:null},S.bufferFragmentData=function(e,t,n,r){if(e&&this.state===_.PARSING){var i=e.data1,a=e.data2,o=i;if(i&&a&&(o=Object(f.appendUint8Array)(i,a)),o&&o.length){var s={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:o};this.hls.trigger(u.Events.BUFFER_APPENDING,s),e.dropped&&e.independent&&!n&&this.flushBufferGap(t)}}},S.flushBufferGap=function(e){var t=this.media;if(t)if(o.BufferHelper.isBuffered(t,t.currentTime)){var n=t.currentTime,r=o.BufferHelper.bufferInfo(t,n,0),i=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),s=Math.max(Math.min(e.start-a,r.end-a),n+a);e.start-s>a&&this.flushMainBuffer(s,e.start)}else this.flushMainBuffer(0,e.start)},S.reduceMaxBufferLength=function(e){var t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},S.getNextFragment=function(e,t){var n,r,i=t.fragments,a=i.length;if(!a)return null;var o,s=this.config,u=i[0].start;if(t.live){var l=s.initialLiveManifestSize;if(a<l)return this.warn("Not enough fragments to start playback (have: "+a+", need: "+l+")"),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(o=this.getInitialLiveFragment(t,i),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=u&&(o=i[0]);if(!o){var c=s.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,c,t)}return null===(n=o)||void 0===n||!n.initSegment||null!==(r=o)&&void 0!==r&&r.initSegment.data||this.bitrateTest||(o=o.initSegment),o},S.getNextPart=function(e,t,n){for(var r=-1,i=!1,a=!0,o=0,s=e.length;o<s;o++){var u=e[o];if(a=a&&!u.independent,r>-1&&n<u.start)break;var l=u.loaded;!l&&(i||u.independent||a)&&u.fragment===t&&(r=o),i=l}return r},S.loadedEndOfParts=function(e,t){var n=e[e.length-1];return n&&t>n.start&&n.loaded},S.getInitialLiveFragment=function(e,t){var n=this.fragPrevious,r=null;if(n){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),r=Object(p.findFragmentByPDT)(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){var i=n.sn+1;if(i>=e.startSN&&i<=e.endSN){var a=t[i-e.startSN];n.cc===a.cc&&(r=a,this.log("Live playlist, switching playlist, load frag with next SN: "+r.sn))}r||(r=Object(p.findFragWithCC)(t,n.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+r.sn)}}else{var o=this.hls.liveSyncPosition;null!==o&&(r=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r},S.getFragmentAtPosition=function(e,t,n){var r,i=this.config,o=this.fragPrevious,s=n.fragments,u=n.endSN,l=n.fragmentHint,c=i.maxFragLookUpTolerance,d=!!(i.lowLatencyMode&&n.partList&&l);if(d&&l&&!this.bitrateTest&&(s=s.concat(l),u=l.sn),e<t){var f=e>t-c?0:c;r=Object(p.findFragmentByPTS)(o,s,e,f)}else r=s[s.length-1];if(r){var h=r.sn-n.startSN,g=o&&r.level===o.level,m=s[h+1];if(this.fragmentTracker.getState(r)===a.FragmentState.BACKTRACKED){r=null;for(var v=h;s[v]&&this.fragmentTracker.getState(s[v])===a.FragmentState.BACKTRACKED;)r=o?s[v--]:s[--v];r||(r=m)}else o&&r.sn===o.sn&&!d&&g&&(r.sn<u&&this.fragmentTracker.getState(m)!==a.FragmentState.OK?(this.log("SN "+r.sn+" just loaded, load next one: "+m.sn),r=m):r=null)}return r},S.synchronizeToLiveEdge=function(e){var t=this.config,n=this.media;if(n){var r=this.hls.liveSyncPosition,i=n.currentTime,a=e.fragments[0].start,o=e.edge,s=i>=a-t.maxFragLookUpTolerance&&i<=o;if(null!==r&&n.duration>r&&(i<r||!s)){var u=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&n.readyState<4||i<o-u)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn("Playback: "+i.toFixed(3)+" is located too far from the end of live sliding playlist: "+o+", reset currentTime to : "+r.toFixed(3)),n.currentTime=r))}}},S.alignPlaylists=function(e,t){var n=this.levels,i=this.levelLastLoaded,a=null!==i?n[i]:null,o=0;return t&&e.fragments.length>0?(o=e.fragments[0].start,e.alignedSliding&&Object(r.isFiniteNumber)(o)?this.log("Live playlist sliding:"+o.toFixed(3)):o||(this.warn("["+this.constructor.name+"] Live playlist - outdated PTS, unknown sliding"),Object(h.alignStream)(this.fragPrevious,a,e))):(this.log("Live playlist - first load, unknown sliding"),Object(h.alignStream)(this.fragPrevious,a,e)),o},S.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},S.setStartPosition=function(e,t){var n=this.startPosition;if(-1===this.startPosition||-1===this.lastCurrentTime){var i=e.startTimeOffset;Object(r.isFiniteNumber)(i)?(i<0&&(this.log("Negative start time offset "+i+", count from end of last fragment"),i=t+e.totalduration+i),this.log("Start time offset found in playlist, adjust startPosition to "+i),this.startPosition=n=i):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n},S.getLoadPosition=function(){var e=this.media,t=0;return this.loadedmetadata?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t},S.handleFragLoadAborted=function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(t?" part"+t.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},S.resetFragmentLoading=function(e){this.fragCurrent&&this.fragContextChanged(e)||(this.state=_.IDLE)},S.onFragmentOrKeyLoadError=function(e,t){if(!t.fatal){var n=t.frag;if(n&&n.type===e){var r=this.fragCurrent;console.assert(r&&n.sn===r.sn&&n.level===r.level&&n.urlId===r.urlId,"Frag load error must match current frag to retry");var i=this.config;if(this.fragLoadError+1<=i.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(n.level))return;var a=Math.min(Math.pow(2,this.fragLoadError)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" failed to load, retrying in "+a+"ms"),this.retryDate=self.performance.now()+a,this.fragLoadError++,this.state=_.FRAG_LOADING_WAITING_RETRY}else t.levelRetry?(e===y.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=_.IDLE):(s.logger.error(t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.hls.stopLoad(),this.state=_.ERROR)}}},S.afterBufferFlushed=function(e,t,n){if(e){var r=o.BufferHelper.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===_.ENDED&&this.resetLoadingState()}},S.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=_.IDLE},S.resetLiveStartWhenNotLoaded=function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=this.levels?this.levels[e].details:null;if(null!=t&&t.live)return this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},S.updateLevelTiming=function(e,t,n,r){var i=this,a=n.details;console.assert(!!a,"level.details must be defined"),Object.keys(e.elementaryStreams).reduce((function(t,o){var s=e.elementaryStreams[o];if(s){var l=s.endPTS-s.startPTS;if(l<=0)return i.warn("Could not parse fragment "+e.sn+" "+o+" duration reliably ("+l+") resetting transmuxer to fallback to playlist timing"),i.resetTransmuxer(),t||!1;var d=r?0:c.updateFragPTSDTS(a,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return i.hls.trigger(u.Events.LEVEL_PTS_UPDATED,{details:a,level:n,drift:d,type:o,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t}),!1)?(this.state=_.PARSED,this.hls.trigger(u.Events.FRAG_PARSED,{frag:e,part:t})):this.resetLoadingState()},S.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},b=i,(A=[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}])&&E(b.prototype,A),i}(i.default)},"./src/controller/buffer-controller.ts":
/*!*********************************************!*\
  !*** ./src/controller/buffer-controller.ts ***!
  \*********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts"),o=n(/*! ../errors */"./src/errors.ts"),s=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),u=n(/*! ../utils/mediasource-helper */"./src/utils/mediasource-helper.ts"),l=n(/*! ../loader/fragment */"./src/loader/fragment.ts"),c=n(/*! ./buffer-operation-queue */"./src/controller/buffer-operation-queue.ts"),d=Object(u.getMediaSource)(),f=/([ha]vc.)(?:\.[^.,]+)+/,h=function(){function e(e){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var e=t.hls,n=t.media,r=t.mediaSource;a.logger.log("[buffer-controller]: Media source opened"),n&&(t.updateMediaElementDuration(),e.trigger(i.Events.MEDIA_ATTACHED,{media:n})),r&&r.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){a.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){a.logger.log("[buffer-controller]: Media source ended")},this.hls=e,this._initSourceBuffer(),this.registerListeners()}var t=e.prototype;return t.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null},t.registerListeners=function(){var e=this.hls;e.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(i.Events.BUFFER_RESET,this.onBufferReset,this),e.on(i.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(i.Events.BUFFER_EOS,this.onBufferEos,this),e.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(i.Events.FRAG_PARSED,this.onFragParsed,this),e.on(i.Events.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=function(){var e=this.hls;e.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(i.Events.BUFFER_RESET,this.onBufferReset,this),e.off(i.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(i.Events.BUFFER_EOS,this.onBufferEos,this),e.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(i.Events.FRAG_PARSED,this.onFragParsed,this),e.off(i.Events.FRAG_CHANGED,this.onFragChanged,this)},t._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new c.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},t.onManifestParsed=function(e,t){var n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.details=null,a.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(e,t){var n=this.media=t.media;if(n&&d){var r=this.mediaSource=new d;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(r),this._objectUrl=n.src}},t.onMediaDetaching=function(){var e=this.media,t=this.mediaSource,n=this._objectUrl;if(t){if(a.logger.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){a.logger.warn("[buffer-controller]: onMediaDetaching: "+e.message+" while calling endOfStream")}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):a.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(i.Events.MEDIA_DETACHED,void 0)},t.onBufferReset=function(){var e=this;this.getSourceBufferTypes().forEach((function(t){var n=e.sourceBuffer[t];try{n&&(e.removeBufferListeners(t),e.mediaSource&&e.mediaSource.removeSourceBuffer(n),e.sourceBuffer[t]=void 0)}catch(e){a.logger.warn("[buffer-controller]: Failed to reset the "+t+" buffer",e)}})),this._initSourceBuffer()},t.onBufferCodecs=function(e,t){var n=this,r=this.getSourceBufferTypes().length;Object.keys(t).forEach((function(e){if(r){var i=n.tracks[e];if(i&&"function"==typeof i.buffer.changeType){var a=t[e],o=a.codec,s=a.levelCodec,u=a.container;if((i.levelCodec||i.codec).replace(f,"$1")!==(s||o).replace(f,"$1")){var l=u+";codecs="+(s||o);n.appendChangeType(e,l)}}}else n.pendingTracks[e]=t[e]})),r||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},t.appendChangeType=function(e,t){var n=this,r=this.operationQueue,i={execute:function(){var i=n.sourceBuffer[e];i&&(a.logger.log("[buffer-controller]: changing "+e+" sourceBuffer type to "+t),i.changeType(t)),r.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){a.logger.warn("[buffer-controller]: Failed to change "+e+" SourceBuffer type",t)}};r.append(i,e)},t.onBufferAppending=function(e,t){var n=this,r=this.hls,u=this.operationQueue,l=this.tracks,c=t.data,d=t.type,f=t.frag,h=t.part,p=t.chunkMeta,g=p.buffering[d],m=self.performance.now();g.start=m;var v=f.stats.buffering,y=h?h.stats.buffering:null;0===v.start&&(v.start=m),y&&0===y.start&&(y.start=m);var E=l.audio,T="audio"===d&&1===p.id&&"audio/mpeg"===(null==E?void 0:E.container),_={execute:function(){if(g.executeStart=self.performance.now(),T){var e=n.sourceBuffer[d];if(e){var t=f.start-e.timestampOffset;Math.abs(t)>=.1&&(a.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+f.start+" (delta: "+t+") sn: "+f.sn+")"),e.timestampOffset=f.start)}}n.appendExecutor(c,d)},onStart:function(){},onComplete:function(){var e=self.performance.now();g.executeEnd=g.end=e,0===v.first&&(v.first=e),y&&0===y.first&&(y.first=e);var t=n.sourceBuffer,r={};for(var a in t)r[a]=s.BufferHelper.getBuffered(t[a]);n.appendError=0,n.hls.trigger(i.Events.BUFFER_APPENDED,{type:d,frag:f,part:h,chunkMeta:p,parent:f.type,timeRanges:r})},onError:function(e){a.logger.error("[buffer-controller]: Error encountered while trying to append to the "+d+" SourceBuffer",e);var t={type:o.ErrorTypes.MEDIA_ERROR,parent:f.type,details:o.ErrorDetails.BUFFER_APPEND_ERROR,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=o.ErrorDetails.BUFFER_FULL_ERROR:(n.appendError++,t.details=o.ErrorDetails.BUFFER_APPEND_ERROR,n.appendError>r.config.appendErrorMaxRetry&&(a.logger.error("[buffer-controller]: Failed "+r.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),t.fatal=!0)),r.trigger(i.Events.ERROR,t)}};u.append(_,d)},t.onBufferFlushing=function(e,t){var n=this,r=this.operationQueue,o=function(e){return{execute:n.removeExecutor.bind(n,e,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){n.hls.trigger(i.Events.BUFFER_FLUSHED,{type:e})},onError:function(t){a.logger.warn("[buffer-controller]: Failed to remove from "+e+" SourceBuffer",t)}}};t.type?r.append(o(t.type),t.type):this.getSourceBufferTypes().forEach((function(e){r.append(o(e),e)}))},t.onFragParsed=function(e,t){var n=this,r=t.frag,o=t.part,s=[],u=o?o.elementaryStreams:r.elementaryStreams;u[l.ElementaryStreamTypes.AUDIOVIDEO]?s.push("audiovideo"):(u[l.ElementaryStreamTypes.AUDIO]&&s.push("audio"),u[l.ElementaryStreamTypes.VIDEO]&&s.push("video")),0===s.length&&a.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+r.type+" level: "+r.level+" sn: "+r.sn),this.blockBuffers((function(){var e=self.performance.now();r.stats.buffering.end=e,o&&(o.stats.buffering.end=e);var t=o?o.stats:r.stats;n.hls.trigger(i.Events.FRAG_BUFFERED,{frag:r,part:o,stats:t,id:r.type})}),s)},t.onFragChanged=function(e,t){this.flushBackBuffer()},t.onBufferEos=function(e,t){var n=this;this.getSourceBufferTypes().reduce((function(e,r){var i=n.sourceBuffer[r];return t.type&&t.type!==r||i&&!i.ended&&(i.ended=!0,a.logger.log("[buffer-controller]: "+r+" sourceBuffer now EOS")),e&&!(i&&!i.ended)}),!0)&&this.blockBuffers((function(){var e=n.mediaSource;e&&"open"===e.readyState&&e.endOfStream()}))},t.onLevelUpdated=function(e,t){var n=t.details;n.fragments.length&&(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},t.flushBackBuffer=function(){var e=this.hls,t=this.details,n=this.media,a=this.sourceBuffer;if(n&&null!==t){var o=this.getSourceBufferTypes();if(o.length){var u=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(Object(r.isFiniteNumber)(u)&&!(u<0)){var l=n.currentTime,c=t.levelTargetDuration,d=Math.max(u,c),f=Math.floor(l/c)*c-d;o.forEach((function(n){var r=a[n];if(r){var o=s.BufferHelper.getBuffered(r);o.length>0&&f>o.start(0)&&(e.trigger(i.Events.BACK_BUFFER_REACHED,{bufferEnd:f}),t.live&&e.trigger(i.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:f}),e.trigger(i.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:f,type:n}))}}))}}}},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,n=this.media,i=this.mediaSource,o=e.fragments[0].start+e.totalduration,s=n.duration,u=Object(r.isFiniteNumber)(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(a.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=1/0,this.updateSeekableRange(e)):(o>u&&o>s||!Object(r.isFiniteNumber)(s))&&(a.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),i.duration=o)}},t.updateSeekableRange=function(e){var t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){var r=Math.max(0,n[0].start),i=Math.max(r,r+e.totalduration);t.setLiveSeekableRange(r,i)}},t.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,n=this.pendingTracks,r=Object.keys(n).length;if(r&&!e||2===r){this.createSourceBuffers(n),this.pendingTracks={};var a=this.getSourceBufferTypes();if(0===a.length)return void this.hls.trigger(i.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});a.forEach((function(e){t.executeNext(e)}))}},t.createSourceBuffers=function(e){var t=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");var r=0;for(var s in e)if(!t[s]){var u=e[s];if(!u)throw Error("source buffer exists for track "+s+", however track does not");var l=u.levelCodec||u.codec,c=u.container+";codecs="+l;a.logger.log("[buffer-controller]: creating sourceBuffer("+c+")");try{var d=t[s]=n.addSourceBuffer(c),f=s;this.addBufferListener(f,"updatestart",this._onSBUpdateStart),this.addBufferListener(f,"updateend",this._onSBUpdateEnd),this.addBufferListener(f,"error",this._onSBUpdateError),this.tracks[s]={buffer:d,codec:l,container:u.container,levelCodec:u.levelCodec,id:u.id},r++}catch(e){a.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+e.message),this.hls.trigger(i.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:c})}}r&&this.hls.trigger(i.Events.BUFFER_CREATED,{tracks:this.tracks})},t._onSBUpdateStart=function(e){this.operationQueue.current(e).onStart()},t._onSBUpdateEnd=function(e){var t=this.operationQueue;t.current(e).onComplete(),t.shiftAndExecuteNext(e)},t._onSBUpdateError=function(e,t){a.logger.error("[buffer-controller]: "+e+" SourceBuffer error",t),this.hls.trigger(i.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var n=this.operationQueue.current(e);n&&n.onError(t)},t.removeExecutor=function(e,t,n){var i=this.media,o=this.mediaSource,s=this.operationQueue,u=this.sourceBuffer[e];if(!i||!o||!u)return a.logger.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void s.shiftAndExecuteNext(e);var l=Object(r.isFiniteNumber)(i.duration)?i.duration:1/0,c=Object(r.isFiniteNumber)(o.duration)?o.duration:1/0,d=Math.max(0,t),f=Math.min(n,l,c);f>d?(a.logger.log("[buffer-controller]: Removing ["+d+","+f+"] from the "+e+" SourceBuffer"),console.assert(!u.updating,e+" sourceBuffer must not be updating"),u.remove(d,f)):s.shiftAndExecuteNext(e)},t.appendExecutor=function(e,t){var n=this.operationQueue,r=this.sourceBuffer[t];if(!r)return a.logger.warn("[buffer-controller]: Attempting to append to the "+t+" SourceBuffer, but it does not exist"),void n.shiftAndExecuteNext(t);r.ended=!1,console.assert(!r.updating,t+" sourceBuffer must not be updating"),r.appendBuffer(e)},t.blockBuffers=function(e,t){var n=this;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return a.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(e);var r=this.operationQueue,i=t.map((function(e){return r.appendBlocker(e)}));Promise.all(i).then((function(){e(),t.forEach((function(e){var t=n.sourceBuffer[e];t&&t.updating||r.shiftAndExecuteNext(e)}))}))},t.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},t.addBufferListener=function(e,t,n){var r=this.sourceBuffer[e];if(r){var i=n.bind(this,e);this.listeners[e].push({event:t,listener:i}),r.addEventListener(t,i)}},t.removeBufferListeners=function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach((function(e){t.removeEventListener(e.event,e.listener)}))},e}()},"./src/controller/buffer-operation-queue.ts":
/*!**************************************************!*\
  !*** ./src/controller/buffer-operation-queue.ts ***!
  \**************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(/*! ../utils/logger */"./src/utils/logger.ts"),i=function(){function e(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}var t=e.prototype;return t.append=function(e,t){var n=this.queues[t];n.push(e),1===n.length&&this.buffers[t]&&this.executeNext(t)},t.insertAbort=function(e,t){this.queues[t].unshift(e),this.executeNext(t)},t.appendBlocker=function(e){var t,n=new Promise((function(e){t=e})),r={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(r,e),n},t.executeNext=function(e){var t=this.buffers,n=this.queues,i=t[e],a=n[e];if(a.length){var o=a[0];try{o.execute()}catch(e){r.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(e),i&&i.updating||a.shift()}}},t.shiftAndExecuteNext=function(e){this.queues[e].shift(),this.executeNext(e)},t.current=function(e){return this.queues[e][0]},e}()},"./src/controller/cap-level-controller.ts":
/*!************************************************!*\
  !*** ./src/controller/cap-level-controller.ts ***!
  \************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../events */"./src/events.ts");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(e){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var t,n,a,o=e.prototype;return o.setStreamController=function(e){this.streamController=e},o.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},o.registerListeners=function(){var e=this.hls;e.on(r.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(r.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(r.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},o.unregisterListener=function(){var e=this.hls;e.off(r.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(r.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(r.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},o.onFpsDropLevelCapping=function(t,n){e.isLevelAllowed(n.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(n.droppedLevel)},o.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null},o.onManifestParsed=function(e,t){var n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()},o.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var e=this.hls.levels;if(e.length){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(t){var n=this,r=this.hls.levels;if(!r.length)return-1;var i=r.filter((function(r,i){return e.isLevelAllowed(i,n.restrictedLevels)&&i<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},o.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t},e.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},e.getMaxLevelByMediaSize=function(e,t,n){if(!e||!e.length)return-1;for(var r,i,a=e.length-1,o=0;o<e.length;o+=1){var s=e[o];if((s.width>=t||s.height>=n)&&(r=s,!(i=e[o+1])||r.width!==i.width||r.height!==i.height)){a=o;break}}return a},t=e,a=[{key:"contentScaleFactor",get:function(){var e=1;try{e=self.devicePixelRatio}catch(e){}return e}}],(n=[{key:"mediaWidth",get:function(){return this.getDimensions().width*e.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*e.contentScaleFactor}}])&&i(t.prototype,n),a&&i(t,a),e}();t.default=a},"./src/controller/eme-controller.ts":
/*!******************************************!*\
  !*** ./src/controller/eme-controller.ts ***!
  \******************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../errors */"./src/errors.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts"),o=n(/*! ../utils/mediakeys-helper */"./src/utils/mediakeys-helper.ts");function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(e){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=e,this._config=e.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var t,n,u=e.prototype;return u.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},u._registerListeners=function(){this.hls.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(r.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(r.Events.MANIFEST_PARSED,this.onManifestParsed,this)},u._unregisterListeners=function(){this.hls.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(r.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(r.Events.MANIFEST_PARSED,this.onManifestParsed,this)},u.getLicenseServerUrl=function(e){switch(e){case o.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},u._attemptKeySystemAccess=function(e,t,n){var r=this,i=function(e,t,n,r){switch(e){case o.KeySystems.WIDEVINE:return function(e,t,n){var r={audioCapabilities:[],videoCapabilities:[]};return e.forEach((function(e){r.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:n.audioRobustness||""})})),t.forEach((function(e){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:n.videoRobustness||""})})),[r]}(t,n,r);default:throw new Error("Unknown key-system: "+e)}}(e,t,n,this._drmSystemOptions);a.logger.log("Requesting encrypted media key-system access");var s=this.requestMediaKeySystemAccess(e,i);this.mediaKeysPromise=s.then((function(t){return r._onMediaKeySystemAccessObtained(e,t)})),s.catch((function(t){a.logger.error('Failed to obtain key-system "'+e+'" access:',t)}))},u._onMediaKeySystemAccessObtained=function(e,t){var n=this;a.logger.log('Access for key-system "'+e+'" obtained');var r={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(r);var i=Promise.resolve().then((function(){return t.createMediaKeys()})).then((function(t){return r.mediaKeys=t,a.logger.log('Media-keys created for key-system "'+e+'"'),n._onMediaKeysCreated(),t}));return i.catch((function(e){a.logger.error("Failed to create media-keys:",e)})),i},u._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},u._onNewMediaKeySession=function(e){var t=this;a.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(n){t._onKeySessionMessage(e,n.message)}),!1)},u._onKeySessionMessage=function(e,t){a.logger.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){a.logger.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},u.onMediaEncrypted=function(e){var t=this;if(a.logger.log('Media is encrypted using "'+e.initDataType+'" init data type'),!this.mediaKeysPromise)return a.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var n=function(n){t._media&&(t._attemptSetMediaKeys(n),t._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};this.mediaKeysPromise.then(n).catch(n)},u._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return a.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});a.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},u._generateRequestWithPreferredKeySession=function(e,t){var n=this,o=this._mediaKeysList[0];if(!o)return a.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(o.mediaKeysSessionInitialized)a.logger.warn("Key-Session already initialized but requested again");else{var s=o.mediaKeysSession;if(!s)return a.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return a.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});a.logger.log('Generating key-session request for "'+e+'" init data type'),o.mediaKeysSessionInitialized=!0,s.generateRequest(e,t).then((function(){a.logger.debug("Key-session generation succeeded")})).catch((function(e){a.logger.error("Error generating key-session request:",e),n.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},u._createLicenseXhr=function(e,t,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,n);var i=this._licenseXhrSetup;if(i)try{i.call(this.hls,r,e),i=void 0}catch(e){a.logger.error(e)}try{r.readyState||r.open("POST",e,!0),i&&i.call(this.hls,r,e)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return r},u._onLicenseRequestReadyStageChange=function(e,t,n,o){switch(e.readyState){case 4:if(200===e.status){this._requestLicenseFailureCount=0,a.logger.log("License request succeeded");var s=e.response,u=this._licenseResponseCallback;if(u)try{s=u.call(this.hls,e,t)}catch(e){a.logger.error(e)}o(s)}else{if(a.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var l=3-this._requestLicenseFailureCount+1;a.logger.warn("Retrying license request, "+l+" attempts left"),this._requestLicense(n,o)}}},u._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case o.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},u._requestLicense=function(e,t){a.logger.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n)return a.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var o=this.getLicenseServerUrl(n.mediaKeySystemDomain),s=this._createLicenseXhr(o,e,t);a.logger.log("Sending license request to URL: "+o);var u=this._generateLicenseRequestChallenge(n,e);s.send(u)}catch(e){a.logger.error("Failure requesting DRM license: "+e),this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},u.onMediaAttached=function(e,t){if(this._emeEnabled){var n=t.media;this._media=n,n.addEventListener("encrypted",this._onMediaEncrypted)}},u.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map((function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch((function(){}))}))).then((function(){return e.setMediaKeys(null)})).catch((function(){})))},u.onManifestParsed=function(e,t){if(this._emeEnabled){var n=t.levels.map((function(e){return e.audioCodec})).filter((function(e){return!!e})),r=t.levels.map((function(e){return e.videoCodec})).filter((function(e){return!!e}));this._attemptKeySystemAccess(o.KeySystems.WIDEVINE,n,r)}},t=e,(n=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&s(t.prototype,n),e}();t.default=u},"./src/controller/fps-controller.ts":
/*!******************************************!*\
  !*** ./src/controller/fps-controller.ts ***!
  \******************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../utils/logger */"./src/utils/logger.ts"),a=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(r.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.unregisterListeners=function(){this.hls.off(r.Events.MEDIA_ATTACHING,this.onMediaAttaching)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var n=this.hls.config;if(n.capLevelOnFPSDrop){var r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}},t.checkFPS=function(e,t,n){var a=performance.now();if(t){if(this.lastTime){var o=a-this.lastTime,s=n-this.lastDroppedFrames,u=t-this.lastDecodedFrames,l=1e3*s/o,c=this.hls;if(c.trigger(r.Events.FPS_DROP,{currentDropped:s,currentDecoded:u,totalDroppedFrames:n}),l>0&&s>c.config.fpsDroppedMonitoringThreshold*u){var d=c.currentLevel;i.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(r.Events.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=n,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}();t.default=a},"./src/controller/fragment-finders.ts":
/*!********************************************!*\
  !*** ./src/controller/fragment-finders.ts ***!
  \********************************************/
/*! exports provided: findFragmentByPDT, findFragmentByPTS, fragmentWithinToleranceTest, pdtWithinToleranceTest, findFragWithCC */function(e,t,n){"use strict";n.r(t),n.d(t,"findFragmentByPDT",(function(){return a})),n.d(t,"findFragmentByPTS",(function(){return o})),n.d(t,"fragmentWithinToleranceTest",(function(){return s})),n.d(t,"pdtWithinToleranceTest",(function(){return u})),n.d(t,"findFragWithCC",(function(){return l}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../utils/binary-search */"./src/utils/binary-search.ts");function a(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!Object(r.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(var i=0;i<e.length;++i){var a=e[i];if(u(t,n,a))return a}return null}function o(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var a=null;return e?a=t[e.sn-t[0].sn+1]:0===n&&0===t[0].start&&(a=t[0]),a&&0===s(n,r,a)?a:i.default.search(t,s.bind(null,n,r))||a}function s(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0);var r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-r<=e?1:n.start-r>e&&n.start?-1:0}function u(e,t,n){var r=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-r>e}function l(e,t){return i.default.search(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}},"./src/controller/fragment-tracker.ts":
/*!********************************************!*\
  !*** ./src/controller/fragment-tracker.ts ***!
  \********************************************/
/*! exports provided: FragmentState, FragmentTracker */function(e,t,n){"use strict";n.r(t),n.d(t,"FragmentState",(function(){return r})),n.d(t,"FragmentTracker",(function(){return o}));var r,i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../types/loader */"./src/types/loader.ts");!function(e){e.NOT_LOADED="NOT_LOADED",e.BACKTRACKED="BACKTRACKED",e.APPENDING="APPENDING",e.PARTIAL="PARTIAL",e.OK="OK"}(r||(r={}));var o=function(){function e(e){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e.on(i.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(i.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(i.Events.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var e=this.hls;e.off(i.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(i.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(i.Events.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},t.getAppendedFrag=function(e,t){if(t===a.PlaylistLevelType.MAIN){var n=this.activeFragment,r=this.activeParts;if(!n)return null;if(r)for(var i=r.length;i--;){var o=r[i],s=o?o.end:n.appendedPTS;if(o.start<=e&&void 0!==s&&e<=s)return i>9&&(this.activeParts=r.slice(i-9)),o}else if(n.start<=e&&void 0!==n.appendedPTS&&e<=n.appendedPTS)return n}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){for(var n=this.fragments,r=Object.keys(n),i=r.length;i--;){var a=n[r[i]];if((null==a?void 0:a.body.type)===t&&a.buffered){var o=a.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,n){var r=this;Object.keys(this.fragments).forEach((function(i){var a=r.fragments[i];if(a)if(a.buffered){var o=a.range[e];o&&o.time.some((function(e){var n=!r.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&r.removeFragment(a.body),n}))}else a.body.type===n&&r.removeFragment(a.body)}))},t.detectPartialFragments=function(e){var t=this,n=this.timeRanges,r=e.frag,i=e.part;if(n&&"initSegment"!==r.sn){var a=u(r),o=this.fragments[a];o&&(Object.keys(n).forEach((function(e){var a=r.elementaryStreams[e];if(a){var s=n[e],u=null!==i||!0===a.partial;o.range[e]=t.getBufferedTimes(r,i,u,s)}})),o.backtrack=o.loaded=null,Object.keys(o.range).length?o.buffered=!0:this.removeFragment(o.body))}},t.getBufferedTimes=function(e,t,n,r){for(var i={time:[],partial:n},a=t?t.start:e.start,o=t?t.end:e.end,s=e.minEndPTS||o,u=e.maxStartPTS||a,l=0;l<r.length;l++){var c=r.start(l)-this.bufferPadding,d=r.end(l)+this.bufferPadding;if(u>=c&&s<=d){i.time.push({startPTS:Math.max(a,r.start(l)),endPTS:Math.min(o,r.end(l))});break}if(a<d&&o>c)i.partial=!0,i.time.push({startPTS:Math.max(a,r.start(l)),endPTS:Math.min(o,r.end(l))});else if(o<=c)break}return i},t.getPartialFragment=function(e){var t,n,r,i=null,a=0,o=this.bufferPadding,u=this.fragments;return Object.keys(u).forEach((function(l){var c=u[l];c&&s(c)&&(n=c.body.start-o,r=c.body.end+o,e>=n&&e<=r&&(t=Math.min(e-n,r-e),a<=t&&(i=c.body,a=t)))})),i},t.getState=function(e){var t=u(e),n=this.fragments[t];return n?n.buffered?s(n)?r.PARTIAL:r.OK:n.backtrack?r.BACKTRACKED:r.APPENDING:r.NOT_LOADED},t.backtrack=function(e,t){var n=u(e),r=this.fragments[n];if(!r||r.backtrack)return null;var i=r.backtrack=t||r.loaded;return r.loaded=null,i},t.getBacktrackData=function(e){var t=u(e),n=this.fragments[t];if(n){var r,i=n.backtrack;if(null!=i&&null!==(r=i.payload)&&void 0!==r&&r.byteLength)return i;this.removeFragment(e)}return null},t.isTimeBuffered=function(e,t,n){for(var r,i,a=0;a<n.length;a++){if(r=n.start(a)-this.bufferPadding,i=n.end(a)+this.bufferPadding,e>=r&&t<=i)return!0;if(t<=r)return!1}return!1},t.onFragLoaded=function(e,t){var n=t.frag,r=t.part;if("initSegment"!==n.sn&&!n.bitrateTest&&!r){var i=u(n);this.fragments[i]={body:n,loaded:t,backtrack:null,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var n=this,r=t.frag,i=t.part,o=t.timeRanges;if(r.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=r,i){var s=this.activeParts;s||(this.activeParts=s=[]),s.push(i)}else this.activeParts=null;this.timeRanges=o,Object.keys(o).forEach((function(e){var t=o[e];if(n.detectEvictedFragments(e,t),!i)for(var a=0;a<t.length;a++)r.appendedPTS=Math.max(t.end(a),r.appendedPTS||0)}))},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=u(e);return!!this.fragments[t]},t.removeFragment=function(e){var t=u(e);e.stats.loaded=0,e.clearElementaryStreamInfo(),delete this.fragments[t]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},e}();function s(e){var t,n;return e.buffered&&((null===(t=e.range.video)||void 0===t?void 0:t.partial)||(null===(n=e.range.audio)||void 0===n?void 0:n.partial))}function u(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn}},"./src/controller/gap-controller.ts":
/*!******************************************!*\
  !*** ./src/controller/gap-controller.ts ***!
  \******************************************/
/*! exports provided: STALL_MINIMUM_DURATION_MS, MAX_START_GAP_JUMP, SKIP_BUFFER_HOLE_STEP_SECONDS, SKIP_BUFFER_RANGE_START, default */function(e,t,n){"use strict";n.r(t),n.d(t,"STALL_MINIMUM_DURATION_MS",(function(){return s})),n.d(t,"MAX_START_GAP_JUMP",(function(){return u})),n.d(t,"SKIP_BUFFER_HOLE_STEP_SECONDS",(function(){return l})),n.d(t,"SKIP_BUFFER_RANGE_START",(function(){return c})),n.d(t,"default",(function(){return d}));var r=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),i=n(/*! ../errors */"./src/errors.ts"),a=n(/*! ../events */"./src/events.ts"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=250,u=2,l=.1,c=.05,d=function(){function e(e,t,n,r){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}var t=e.prototype;return t.destroy=function(){this.hls=this.fragmentTracker=this.media=null},t.poll=function(e){var t=this.config,n=this.media,i=this.stalled,a=n.currentTime,l=n.seeking,c=this.seeking&&!l,d=!this.seeking&&l;if(this.seeking=l,a===e){if((d||c)&&(this.stalled=null),!n.paused&&!n.ended&&0!==n.playbackRate&&r.BufferHelper.getBuffered(n).length){var f=r.BufferHelper.bufferInfo(n,a,0),h=f.len>0,p=f.nextStart||0;if(h||p){if(l){var g=f.len>u,m=!p||p-a>u&&!this.fragmentTracker.getPartialFragment(a);if(g||m)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var v,y=Math.max(p,f.start||0)-a,E=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,T=(null==E||null===(v=E.details)||void 0===v?void 0:v.live)?2*E.details.targetduration:u;if(y>0&&y<=T)return void this._trySkipBufferHole(null)}var _=self.performance.now();if(null!==i){var b=_-i;!l&&b>=s&&this._reportStall(f.len);var A=r.BufferHelper.bufferInfo(n,a,t.maxBufferHole);this._tryFixBufferStall(A,b)}else this.stalled=_}}}else if(this.moved=!0,null!==i){if(this.stallReported){var S=self.performance.now()-i;o.logger.warn("playback not stuck anymore @"+a+", after "+Math.round(S)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var n=this.config,r=this.fragmentTracker,i=this.media.currentTime,a=r.getPartialFragment(i);a&&this._trySkipBufferHole(a)||e.len>n.maxBufferHole&&t>1e3*n.highBufferWatchdogPeriod&&(o.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,n=this.media;this.stallReported||(this.stallReported=!0,o.logger.warn("Playback stalling at @"+n.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,n=this.hls,s=this.media,u=s.currentTime,d=0,f=r.BufferHelper.getBuffered(s),h=0;h<f.length;h++){var p=f.start(h);if(u+t.maxBufferHole>=d&&u<p){var g=Math.max(p+c,s.currentTime+l);return o.logger.warn("skipping hole, adjusting currentTime from "+u+" to "+g),this.moved=!0,this.stalled=null,s.currentTime=g,e&&n.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+u+" to "+g,frag:e}),g}d=f.end(h)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,n=this.media,r=n.currentTime,s=(this.nudgeRetry||0)+1;if(this.nudgeRetry=s,s<e.nudgeMaxRetry){var u=r+s*e.nudgeOffset;o.logger.warn("Nudging 'currentTime' from "+r+" to "+u),n.currentTime=u,t.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else o.logger.error("Playhead still not moving while enough data buffered @"+r+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}()},"./src/controller/id3-track-controller.ts":
/*!************************************************!*\
  !*** ./src/controller/id3-track-controller.ts ***!
  \************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.ts"),a=n(/*! ../demux/id3 */"./src/demux/id3.ts"),o=function(){function e(e){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners()},t._registerListeners=function(){var e=this.hls;e.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(r.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(r.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},t._unregisterListeners=function(){var e=this.hls;e.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(r.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(r.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=function(){this.id3Track&&(Object(i.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Object(i.sendAddTrackEvent)(n,this.media),n}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media){var n=t.frag,r=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,o=0;o<r.length;o++){var s=a.getID3Frames(r[o].data);if(s){var u=r[o].pts,l=o<r.length-1?r[o+1].pts:n.end;l-u<=0&&(l=u+.25);for(var c=0;c<s.length;c++){var d=s[c];if(!a.isTimeStampFrame(d)){var f=new i(u,l,"");f.value=d,this.id3Track.addCue(f)}}}}}},t.onBufferFlushing=function(e,t){var n=t.startOffset,r=t.endOffset,a=t.type;if(!a||"audio"===a){var o=this.id3Track;o&&Object(i.removeCuesInRange)(o,n,r)}},e}();t.default=o},"./src/controller/latency-controller.ts":
/*!**********************************************!*\
  !*** ./src/controller/latency-controller.ts ***!
  \**********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(/*! ../errors */"./src/errors.ts"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return t.timeupdate()},this.hls=e,this.config=e.config,this.registerListeners()}var t,n,s=e.prototype;return s.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},s.registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(i.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(i.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(i.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(i.Events.ERROR,this.onError)},s.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},s.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},s.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},s.onLevelUpdated=function(e,t){var n=t.details;this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},s.onError=function(e,t){t.details===r.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,a.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},s.timeupdate=function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var n=this.computeLatency();if(null!==n){this._latency=n;var r=this.config,i=r.lowLatencyMode,a=r.maxLiveSyncPlaybackRate;if(i&&1!==a){var o=this.targetLatency;if(null!==o){var s=n-o,u=s<Math.min(this.maxLatency,o+t.targetduration);if(t.live&&u&&s>.05&&this.forwardBufferLength>1){var l=Math.min(2,Math.max(1,a)),c=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(l,Math.max(1,c))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},s.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},s.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},t=e,(n=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,n=e.partHoldBack,r=e.targetduration,i=this.config,a=i.liveSyncDuration,o=i.liveSyncDurationCount,s=i.lowLatencyMode,u=this.hls.userConfig,l=s&&n||t;(u.liveSyncDuration||u.liveSyncDurationCount||0===l)&&(l=void 0!==a?a:o*r);var c=r;return l+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;var r=n.edge,i=e-t-this.edgeStalled,a=r-n.totalduration,o=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,i),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var n=e.buffered.length;return n?e.buffered.end(n-1):t.edge-this.currentTime}}])&&o(t.prototype,n),e}()},"./src/controller/level-controller.ts":
/*!********************************************!*\
  !*** ./src/controller/level-controller.ts ***!
  \********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var r=n(/*! ../types/level */"./src/types/level.ts"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../errors */"./src/errors.ts"),o=n(/*! ../utils/codecs */"./src/utils/codecs.ts"),s=n(/*! ./level-helper */"./src/controller/level-helper.ts"),u=n(/*! ./base-playlist-controller */"./src/controller/base-playlist-controller.ts"),l=n(/*! ../types/loader */"./src/types/loader.ts");function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),p=function(e){var t,n;function u(t){var n;return(n=e.call(this,t,"[level-controller]")||this)._levels=[],n._firstLevel=-1,n._startLevel=void 0,n.currentLevelIndex=-1,n.manualLevelIndex=-1,n.onParsedComplete=void 0,n._registerListeners(),n}n=e,(t=u).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var p,g,m=u.prototype;return m._registerListeners=function(){var e=this.hls;e.on(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(i.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(i.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(i.Events.ERROR,this.onError,this)},m._unregisterListeners=function(){var e=this.hls;e.off(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(i.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(i.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(i.Events.ERROR,this.onError,this)},m.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,e.prototype.destroy.call(this)},m.startLoad=function(){this._levels.forEach((function(e){e.loadError=0})),e.prototype.startLoad.call(this)},m.onManifestLoaded=function(e,t){var n,u,l=[],c=[],d=[],f={},p=!1,g=!1,m=!1;if(t.levels.forEach((function(e){var t=e.attrs;p=p||!(!e.width||!e.height),g=g||!!e.videoCodec,m=m||!!e.audioCodec,h&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0);var n=e.bitrate+"-"+e.attrs.RESOLUTION+"-"+e.attrs.CODECS;(u=f[n])?u.url.push(e.url):(u=new r.Level(e),f[n]=u,l.push(u)),t&&(t.AUDIO&&Object(s.addGroupId)(u,"audio",t.AUDIO),t.SUBTITLES&&Object(s.addGroupId)(u,"text",t.SUBTITLES))})),(p||g)&&m&&(l=l.filter((function(e){var t=e.videoCodec,n=e.width,r=e.height;return!!t||!(!n||!r)}))),l=l.filter((function(e){var t=e.audioCodec,n=e.videoCodec;return(!t||Object(o.isCodecSupportedInMp4)(t,"audio"))&&(!n||Object(o.isCodecSupportedInMp4)(n,"video"))})),t.audioTracks&&(c=t.audioTracks.filter((function(e){return!e.audioCodec||Object(o.isCodecSupportedInMp4)(e.audioCodec,"audio")})),Object(s.assignTrackIdsByGroup)(c)),t.subtitles&&(d=t.subtitles,Object(s.assignTrackIdsByGroup)(d)),l.length>0){n=l[0].bitrate,l.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=l;for(var v=0;v<l.length;v++)if(l[v].bitrate===n){this._firstLevel=v,this.log("manifest loaded, "+l.length+" level(s) found, first bitrate: "+n);break}var y=m&&!g,E={levels:l,audioTracks:c,subtitleTracks:d,firstLevel:this._firstLevel,stats:t.stats,audio:m,video:g,altAudio:!y&&c.some((function(e){return!!e.url}))};this.hls.trigger(i.Events.MANIFEST_PARSED,E),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,reason:"no level with compatible codecs found in manifest"})},m.onError=function(t,n){if(e.prototype.onError.call(this,t,n),!n.fatal){var r=n.context,i=this._levels[this.currentLevelIndex];if(r&&(r.type===l.PlaylistContextType.AUDIO_TRACK&&i.audioGroupIds&&r.groupId===i.audioGroupIds[i.urlId]||r.type===l.PlaylistContextType.SUBTITLE_TRACK&&i.textGroupIds&&r.groupId===i.textGroupIds[i.urlId]))this.redundantFailover(this.currentLevelIndex);else{var o,s=!1,u=!0;switch(n.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:case a.ErrorDetails.KEY_LOAD_ERROR:case a.ErrorDetails.KEY_LOAD_TIMEOUT:if(n.frag){var c=this._levels[n.frag.level];c?(c.fragmentError++,c.fragmentError>this.hls.config.fragLoadingMaxRetry&&(o=n.frag.level)):o=n.frag.level}break;case a.ErrorDetails.LEVEL_LOAD_ERROR:case a.ErrorDetails.LEVEL_LOAD_TIMEOUT:r&&(r.deliveryDirectives&&(u=!1),o=r.level),s=!0;break;case a.ErrorDetails.REMUX_ALLOC_ERROR:o=n.level,s=!0}void 0!==o&&this.recoverLevel(n,o,s,u)}}},m.recoverLevel=function(e,t,n,r){var i=e.details,a=this._levels[t];if(a.loadError++,n){if(!this.retryLoadingOrFail(e))return void(this.currentLevelIndex=-1);e.levelRetry=!0}if(r){var o=a.url.length;if(o>1&&a.loadError<o)e.levelRetry=!0,this.redundantFailover(t);else if(-1===this.manualLevelIndex){var s=0===t?this._levels.length-1:t-1;this.currentLevelIndex!==s&&0===this._levels[s].loadError&&(this.warn(i+": switch to "+s),e.levelRetry=!0,this.hls.nextAutoLevel=s)}}},m.redundantFailover=function(e){var t=this._levels[e],n=t.url.length;if(n>1){var r=(t.urlId+1)%n;this.warn("Switching to redundant URL-id "+r),this._levels.forEach((function(e){e.urlId=r})),this.level=e}},m.onFragLoaded=function(e,t){var n=t.frag;if(void 0!==n&&n.type===l.PlaylistLevelType.MAIN){var r=this._levels[n.level];void 0!==r&&(r.fragmentError=0,r.loadError=0)}},m.onLevelLoaded=function(e,t){var n,r,i=t.level,a=t.details,o=this._levels[i];if(!o)return this.warn("Invalid level index "+i),void(null!==(r=t.deliveryDirectives)&&void 0!==r&&r.skip&&(a.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0,this.retryCount=0),this.playlistLoaded(i,t,o.details)):null!==(n=t.deliveryDirectives)&&void 0!==n&&n.skip&&(a.deltaUpdateFailed=!0)},m.onAudioTrackSwitched=function(e,t){var n=this.hls.levels[this.currentLevelIndex];if(n&&n.audioGroupIds){for(var r=-1,i=this.hls.audioTracks[t.id].groupId,a=0;a<n.audioGroupIds.length;a++)if(n.audioGroupIds[a]===i){r=a;break}r!==n.urlId&&(n.urlId=r,this.startLoad())}},m.loadPlaylist=function(e){var t=this.currentLevelIndex,n=this._levels[t];if(this.canLoad&&n&&n.url.length>0){var r=n.urlId,a=n.url[r];if(e)try{a=e.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Attempt loading level index "+t+(e?" at sn "+e.msn+" part "+e.part:"")+" with URL-id "+r+" "+a),this.clearTimer(),this.hls.trigger(i.Events.LEVEL_LOADING,{url:a,level:t,id:r,deliveryDirectives:e||null})}},m.removeLevel=function(e,t){var n=function(e,n){return n!==t},r=this._levels.filter((function(r,i){return i!==e||r.url.length>1&&void 0!==t&&(r.url=r.url.filter(n),r.audioGroupIds&&(r.audioGroupIds=r.audioGroupIds.filter(n)),r.textGroupIds&&(r.textGroupIds=r.textGroupIds.filter(n)),r.urlId=0,!0)})).map((function(e,t){var n=e.details;return null!=n&&n.fragments&&n.fragments.forEach((function(e){e.level=t})),e}));this._levels=r,this.hls.trigger(i.Events.LEVELS_UPDATED,{levels:r})},p=u,(g=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t,n=this._levels;if(0!==n.length&&(this.currentLevelIndex!==e||null===(t=n[e])||void 0===t||!t.details)){if(e<0||e>=n.length){var r=e<0;if(this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.OTHER_ERROR,details:a.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:r,reason:"invalid level idx"}),r)return;e=Math.min(e,n.length-1)}this.clearTimer();var o=this.currentLevelIndex,s=n[o],u=n[e];this.log("switching to level "+e+" from "+o),this.currentLevelIndex=e;var l=c({},u,{level:e,maxBitrate:u.maxBitrate,uri:u.uri,urlId:u.urlId});delete l._urlId,this.hls.trigger(i.Events.LEVEL_SWITCHING,l);var d=u.details;if(!d||d.live){var f=this.switchParams(u.uri,null==s?void 0:s.details);this.loadPlaylist(f)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&d(p.prototype,g),u}(u.default)},"./src/controller/level-helper.ts":
/*!****************************************!*\
  !*** ./src/controller/level-helper.ts ***!
  \****************************************/
/*! exports provided: addGroupId, assignTrackIdsByGroup, updatePTS, updateFragPTSDTS, mergeDetails, mapPartIntersection, mapFragmentIntersection, adjustSliding, computeReloadInterval, getFragmentWithSN, getPartWith */function(e,t,n){"use strict";n.r(t),n.d(t,"addGroupId",(function(){return a})),n.d(t,"assignTrackIdsByGroup",(function(){return o})),n.d(t,"updatePTS",(function(){return s})),n.d(t,"updateFragPTSDTS",(function(){return l})),n.d(t,"mergeDetails",(function(){return c})),n.d(t,"mapPartIntersection",(function(){return d})),n.d(t,"mapFragmentIntersection",(function(){return f})),n.d(t,"adjustSliding",(function(){return h})),n.d(t,"computeReloadInterval",(function(){return p})),n.d(t,"getFragmentWithSN",(function(){return g})),n.d(t,"getPartWith",(function(){return m}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../utils/logger */"./src/utils/logger.ts");function a(e,t,n){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(n);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(n)}}function o(e){var t={};e.forEach((function(e){var n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}function s(e,t,n){u(e[t],e[n])}function u(e,t){var n=t.startPTS;if(Object(r.isFiniteNumber)(n)){var i,a=0;t.sn>e.sn?(a=n-e.start,i=e):(a=e.start-n,i=t),i.duration!==a&&(i.duration=a)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function l(e,t,n,a,o,s){a-n<=0&&(i.logger.warn("Fragment should have a positive duration",t),a=n+t.duration,s=o+t.duration);var l=n,c=a,d=t.startPTS,f=t.endPTS;if(Object(r.isFiniteNumber)(d)){var h=Math.abs(d-n);Object(r.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(h,t.deltaPTS):t.deltaPTS=h,l=Math.max(n,d),n=Math.min(n,d),o=Math.min(o,t.startDTS),c=Math.min(a,f),a=Math.max(a,f),s=Math.max(s,t.endDTS)}t.duration=a-n;var p=n-t.start;t.appendedPTS=a,t.start=t.startPTS=n,t.maxStartPTS=l,t.startDTS=o,t.endPTS=a,t.minEndPTS=c,t.endDTS=s;var g,m=t.sn;if(!e||m<e.startSN||m>e.endSN)return 0;var v=m-e.startSN,y=e.fragments;for(y[v]=t,g=v;g>0;g--)u(y[g],y[g-1]);for(g=v;g<y.length-1;g++)u(y[g],y[g+1]);return e.fragmentHint&&u(y[y.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,p}function c(e,t){for(var n=null,a=e.fragments,o=a.length-1;o>=0;o--){var s=a[o].initSegment;if(s){n=s;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var u,c=0;if(f(e,t,(function(e,i){var a;e.relurl&&(c=e.cc-i.cc),Object(r.isFiniteNumber)(e.startPTS)&&Object(r.isFiniteNumber)(e.endPTS)&&(i.start=i.startPTS=e.startPTS,i.startDTS=e.startDTS,i.appendedPTS=e.appendedPTS,i.maxStartPTS=e.maxStartPTS,i.endPTS=e.endPTS,i.endDTS=e.endDTS,i.minEndPTS=e.minEndPTS,i.duration=e.endPTS-e.startPTS,i.duration&&(u=i),t.PTSKnown=t.alignedSliding=!0),i.elementaryStreams=e.elementaryStreams,i.loader=e.loader,i.stats=e.stats,i.urlId=e.urlId,e.initSegment?(i.initSegment=e.initSegment,n=e.initSegment):i.initSegment&&i.initSegment.relurl!=(null===(a=n)||void 0===a?void 0:a.relurl)||(i.initSegment=n)})),t.skippedSegments&&(t.deltaUpdateFailed=t.fragments.some((function(e){return!e})),t.deltaUpdateFailed)){i.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var p=t.skippedSegments;p--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}var g=t.fragments;if(c){i.logger.warn("discontinuity sliding from playlist, take drift into account");for(var m=0;m<g.length;m++)g[m].cc+=c}t.skippedSegments&&(t.startCC=t.fragments[0].cc),d(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),u?l(t,u,u.startPTS,u.endPTS,u.startDTS,u.endDTS):h(e,t),g.length&&(t.totalduration=t.edge-g[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var v=t.advancedDateTime;if(t.advanced&&v){var y=t.edge;t.driftStart||(t.driftStartTime=v,t.driftStart=y),t.driftEndTime=v,t.driftEnd=y}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function d(e,t,n){if(e&&t)for(var r=0,i=0,a=e.length;i<=a;i++){var o=e[i],s=t[i+r];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?n(o,s):r--}}function f(e,t,n){for(var r=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i;l<=a;l++){var c=u[o+l],d=s[l];r&&!d&&l<r&&(d=t.fragments[l]=c),c&&d&&n(c,d)}}function h(e,t){var n=t.startSN+t.skippedSegments-e.startSN,r=e.fragments,i=t.fragments;if(!(n<0||n>=r.length)){var a=r[n].start;if(a){for(var o=t.skippedSegments;o<i.length;o++)i[o].start+=a;t.fragmentHint&&(t.fragmentHint.start+=a)}}}function p(e,t){var n,r=1e3*e.levelTargetDuration,i=r/2,a=e.age,o=a>0&&a<3*r,s=t.loading.end-t.loading.start,u=e.availabilityDelay;if(!1===e.updated)if(o){var l=333*e.misses;n=Math.max(Math.min(i,2*s),l),e.availabilityDelay=(e.availabilityDelay||0)+n}else n=i;else o?(u=Math.min(u||r/2,a),e.availabilityDelay=u,n=u+r-a):n=r-s;return Math.round(n)}function g(e,t){if(!e||!e.details)return null;var n=e.details,r=n.fragments[t-n.startSN];return r||((r=n.fragmentHint)&&r.sn===t?r:null)}function m(e,t,n){if(!e||!e.details)return null;var r=e.details.partList;if(r)for(var i=r.length;i--;){var a=r[i];if(a.index===n&&a.fragment.sn===t)return a}return null}},"./src/controller/stream-controller.ts":
/*!*********************************************!*\
  !*** ./src/controller/stream-controller.ts ***!
  \*********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ./base-stream-controller */"./src/controller/base-stream-controller.ts"),a=n(/*! ../is-supported */"./src/is-supported.ts"),o=n(/*! ../events */"./src/events.ts"),s=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),u=n(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),l=n(/*! ../types/loader */"./src/types/loader.ts"),c=n(/*! ../loader/fragment */"./src/loader/fragment.ts"),d=n(/*! ../demux/transmuxer-interface */"./src/demux/transmuxer-interface.ts"),f=n(/*! ../types/transmuxer */"./src/types/transmuxer.ts"),h=n(/*! ./gap-controller */"./src/controller/gap-controller.ts"),p=n(/*! ../errors */"./src/errors.ts"),g=n(/*! ../utils/logger */"./src/utils/logger.ts");function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){var t,n;function y(t,n){var r;return(r=e.call(this,t,n,"[stream-controller]")||this).audioCodecSwap=!1,r.gapController=null,r.level=-1,r._forceStartLoad=!1,r.altAudio=!1,r.audioOnly=!1,r.fragPlaying=null,r.onvplaying=null,r.onvseeked=null,r.fragLastKbps=0,r.stalled=!1,r.couldBacktrack=!1,r.audioCodecSwitch=!1,r.videoBuffer=null,r._registerListeners(),r}n=e,(t=y).prototype=Object.create(n.prototype),t.prototype.constructor=t,v(t,n);var E,T,_=y.prototype;return _._registerListeners=function(){var e=this.hls;e.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(o.Events.ERROR,this.onError,this),e.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},_._unregisterListeners=function(){var e=this.hls;e.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(o.Events.ERROR,this.onError,this),e.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},_.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},_.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=n.startLevel;-1===r&&(n.config.testBandwidth?(r=0,this.bitrateTest=!0):r=n.nextAutoLevel),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=i.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=i.State.STOPPED},_.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this)},_.doTick=function(){switch(this.state){case i.State.IDLE:this.doTickIdle();break;case i.State.WAITING_LEVEL:var e,t=this.levels,n=this.level,r=null==t||null===(e=t[n])||void 0===e?void 0:e.details;if(r&&(!r.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(r))break;this.state=i.State.IDLE;break}break;case i.State.FRAG_LOADING_WAITING_RETRY:var a,o=self.performance.now(),s=this.retryDate;(!s||o>=s||null!==(a=this.media)&&void 0!==a&&a.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=i.State.IDLE)}this.onTickEnd()},_.onTickEnd=function(){e.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},_.doTickIdle=function(){var e,t,n=this.hls,a=this.levelLastLoaded,l=this.levels,c=this.media,d=n.config,f=n.nextLoadLevel;if(null!==a&&(c||!this.startFragRequested&&d.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&l&&l[f]){var p=l[f];this.level=n.nextLoadLevel=f;var g=p.details;if(!g||this.state===i.State.WAITING_LEVEL||g.live&&this.levelLastLoaded!==f)this.state=i.State.WAITING_LEVEL;else{var m=this.getLoadPosition();if(Object(r.isFiniteNumber)(m)){var v,y,E=p.maxBitrate;y=E?Math.max(8*d.maxBufferSize/E,d.maxBufferLength):d.maxBufferLength,y=Math.min(y,d.maxMaxBufferLength);var T=m<d.maxBufferHole?Math.max(h.MAX_START_GAP_JUMP,d.maxBufferHole):d.maxBufferHole,_=s.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:c,m,T);if(!(_.len>=y)){if(this._streamEnded(_,g)){var b={};return this.altAudio&&(b.type="video"),this.hls.trigger(o.Events.BUFFER_EOS,b),void(this.state=i.State.ENDED)}v=_.end;var A=this.getNextFragment(v,g);if(this.couldBacktrack&&!this.fragPrevious&&A&&"initSegment"!==A.sn){var S=A.sn-g.startSN;S>1&&(A=g.fragments[S-1],this.fragmentTracker.removeFragment(A))}A&&this.fragmentTracker.getState(A)===u.FragmentState.OK&&this.nextLoadPosition>v&&(A=this.getNextFragment(this.nextLoadPosition,g)),A&&(!A.initSegment||A.initSegment.data||this.bitrateTest||(A=A.initSegment),"identity"!==(null===(e=A.decryptdata)||void 0===e?void 0:e.keyFormat)||null!==(t=A.decryptdata)&&void 0!==t&&t.key?this.loadFragment(A,g,v):this.loadKey(A,g))}}}}},_.loadFragment=function(t,n,r){var i,a=this.fragmentTracker.getState(t);if(this.fragCurrent=t,a===u.FragmentState.BACKTRACKED){var o=this.fragmentTracker.getBacktrackData(t);if(o)return this._handleFragmentLoadProgress(o),void this._handleFragmentLoadComplete(o);a=u.FragmentState.NOT_LOADED}a===u.FragmentState.NOT_LOADED||a===u.FragmentState.PARTIAL?"initSegment"===t.sn?this._loadInitSegment(t):this.bitrateTest?(t.bitrateTest=!0,this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t)):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,n,r)):a===u.FragmentState.APPENDING?this.reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t):0===(null===(i=this.media)||void 0===i?void 0:i.buffered.length)&&this.fragmentTracker.removeAllFragments()},_.getAppendedFrag=function(e){var t=this.fragmentTracker.getAppendedFrag(e,l.PlaylistLevelType.MAIN);return t&&"fragment"in t?t.fragment:t},_.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,l.PlaylistLevelType.MAIN)},_.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},_.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},_.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var n,r=this.getAppendedFrag(t.currentTime);if(r&&r.start>1&&this.flushMainBuffer(0,r.start-1),!t.paused&&e){var i=e[this.hls.nextLoadLevel],a=this.fragLastKbps;n=a&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*a)+1:0}else n=0;var o=this.getBufferedFrag(t.currentTime+n);if(o){var s=this.followingBufferedFrag(o);if(s){this.abortCurrentFrag();var u=s.maxStartPTS?s.maxStartPTS:s.start,l=s.duration,c=Math.max(o.end,u+Math.min(Math.max(l-this.config.maxFragLookUpTolerance,.5*l),.75*l));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},_.abortCurrentFrag=function(){var e=this.fragCurrent;this.fragCurrent=null,null!=e&&e.loader&&e.loader.abort(),this.state===i.State.KEY_LOADING&&(this.state=i.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},_.flushMainBuffer=function(t,n){e.prototype.flushMainBuffer.call(this,t,n,this.altAudio?"video":null)},_.onMediaAttached=function(t,n){e.prototype.onMediaAttached.call(this,t,n);var r=n.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new h.default(this.config,r,this.fragmentTracker,this.hls)},_.onMediaDetaching=function(){var t=this.media;t&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),e.prototype.onMediaDetaching.call(this)},_.onMediaPlaying=function(){this.tick()},_.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;Object(r.isFiniteNumber)(t)&&this.log("Media seeked to "+t.toFixed(3)),this.tick()},_.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(o.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},_.onManifestParsed=function(e,t){var n,r=!1,i=!1;t.levels.forEach((function(e){(n=e.audioCodec)&&(-1!==n.indexOf("mp4a.40.2")&&(r=!0),-1!==n.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=r&&i&&!Object(a.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},_.onLevelLoading=function(e,t){var n=this.levels;if(n&&this.state===i.State.IDLE){var r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=i.State.WAITING_LEVEL)}},_.onLevelLoaded=function(e,t){var n,r=this.levels,a=t.level,s=t.details,u=s.totalduration;if(r){this.log("Level "+a+" loaded ["+s.startSN+","+s.endSN+"], cc ["+s.startCC+", "+s.endCC+"] duration:"+u);var l=this.fragCurrent;!l||this.state!==i.State.FRAG_LOADING&&this.state!==i.State.FRAG_LOADING_WAITING_RETRY||l.level!==t.level&&l.loader&&(this.state=i.State.IDLE,l.loader.abort());var c=r[a],d=0;if(s.live||null!==(n=c.details)&&void 0!==n&&n.live){if(s.fragments[0]||(s.deltaUpdateFailed=!0),s.deltaUpdateFailed)return;d=this.alignPlaylists(s,c.details)}if(c.details=s,this.levelLastLoaded=a,this.hls.trigger(o.Events.LEVEL_UPDATED,{details:s,level:a}),this.state===i.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(s))return;this.state=i.State.IDLE}this.startFragRequested?s.live&&this.synchronizeToLiveEdge(s):this.setStartPosition(s,d),this.tick()}else this.warn("Levels were reset while loading level "+a)},_._handleFragmentLoadProgress=function(e){var t,n=e.frag,r=e.part,i=e.payload,a=this.levels;if(a){var o=a[n.level],s=o.details;if(s){var u=o.videoCodec,c=s.PTSKnown||!s.live,h=null===(t=n.initSegment)||void 0===t?void 0:t.data,p=this._getAudioCodec(o),g=this.transmuxer=this.transmuxer||new d.default(this.hls,l.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=r?r.index:-1,v=-1!==m,y=new f.ChunkMetadata(n.level,n.sn,n.stats.chunkCount,i.byteLength,m,v),E=this.initPTS[n.cc];g.push(i,h,p,u,n,r,s.totalduration,c,y,E)}else this.warn("Dropping fragment "+n.sn+" of level "+n.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+n.sn+" of level "+n.level+" will not be buffered")},_.onAudioTrackSwitching=function(e,t){var n=this.altAudio,r=!!t.url,i=t.id;if(!r){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;null!=a&&a.loader&&(this.log("Switching to main audio track, cancel main fragment load"),a.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var s=this.hls;n&&s.trigger(o.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),s.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:i})}},_.onAudioTrackSwitched=function(e,t){var n=t.id,r=!!this.hls.audioTracks[n].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},_.onBufferCreated=function(e,t){var n,r,i=t.tracks,a=!1;for(var o in i){var s=i[o];if("main"===s.id){if(r=o,n=s,"video"===o){var u=i[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&n?(this.log("Alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media},_.onFragBuffered=function(e,t){var n=t.frag,r=t.part;if(!n||n.type===l.PlaylistLevelType.MAIN){if(this.fragContextChanged(n))return this.warn("Fragment "+n.sn+(r?" p: "+r.index:"")+" of level "+n.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===i.State.PARSED&&(this.state=i.State.IDLE));var a=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}},_.onError=function(e,t){switch(t.details){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(l.PlaylistLevelType.MAIN,t);break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==i.State.ERROR&&(t.fatal?(this.warn(""+t.details),this.state=i.State.ERROR):t.levelRetry||this.state!==i.State.WAITING_LEVEL||(this.state=i.State.IDLE));break;case p.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==i.State.PARSING&&this.state!==i.State.PARSED||(this.media&&s.BufferHelper.isBuffered(this.media,this.media.currentTime)&&s.BufferHelper.isBuffered(this.media,this.media.currentTime+.5)?(this.reduceMaxBufferLength(),this.state=i.State.IDLE):(this.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.immediateLevelSwitch()))}},_.checkBuffer=function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){var n=s.BufferHelper.getBuffered(e);!this.loadedmetadata&&n.length?(this.loadedmetadata=!0,this.seekToStartPos()):t.poll(this.lastCurrentTime),this.lastCurrentTime=e.currentTime}},_.onFragLoadEmergencyAborted=function(){this.state=i.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},_.onBufferFlushed=function(e,t){var n=t.type;if(n!==c.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var r=(n===c.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(r,n,l.PlaylistLevelType.MAIN)}},_.onLevelsUpdated=function(e,t){this.levels=t.levels},_.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},_.seekToStartPos=function(){var e=this.media,t=e.currentTime,n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void g.logger.log("could not seek to "+n+", already seeking at "+t);var r=s.BufferHelper.getBuffered(e),i=(r.length?r.start(0):0)-n;i>0&&i<this.config.maxBufferHole&&(g.logger.log("adjusting start position by "+i+" to match buffer start"),n+=i,this.startPosition=n),this.log("seek to target start position "+n+" from current time "+t),e.currentTime=n}},_._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},_._loadBitrateTestFrag=function(e){var t=this;this._doFragLoad(e).then((function(n){var r=t.hls;if(n&&!r.nextLoadLevel&&!t.fragContextChanged(e)){t.fragLoadError=0,t.state=i.State.IDLE,t.startFragRequested=!1,t.bitrateTest=!1;var a=e.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),r.trigger(o.Events.FRAG_LOADED,n)}}))},_._handleTransmuxComplete=function(e){var t,n="main",a=this.hls,s=e.remuxResult,u=e.chunkMeta,l=this.getCurrentContext(u);if(!l)return this.warn("The loading context changed while buffering fragment "+u.sn+" of level "+u.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(u.level);var d=l.frag,f=l.part,h=l.level,p=s.video,g=s.text,m=s.id3,v=s.initSegment,y=this.altAudio?void 0:s.audio;if(!this.fragContextChanged(d)){if(this.state=i.State.PARSING,v){v.tracks&&(this._bufferInitSegment(h,v.tracks,d,u),a.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:d,id:n,tracks:v.tracks}));var E=v.initPTS,T=v.timescale;Object(r.isFiniteNumber)(E)&&(this.initPTS[d.cc]=E,a.trigger(o.Events.INIT_PTS_FOUND,{frag:d,id:n,initPTS:E,timescale:T}))}if(p&&!1!==s.independent){if(h.details){var _=p.startPTS,b=p.endPTS,A=p.startDTS,S=p.endDTS;if(f)f.elementaryStreams[p.type]={startPTS:_,endPTS:b,startDTS:A,endDTS:S};else if(p.firstKeyFrame&&p.independent&&(this.couldBacktrack=!0),p.dropped&&p.independent){if(this.getLoadPosition()+this.config.maxBufferHole<_)return void this.backtrack(d);d.setElementaryStreamInfo(p.type,d.start,b,d.start,S,!0)}d.setElementaryStreamInfo(p.type,_,b,A,S),this.bufferFragmentData(p,d,f,u)}}else if(!1===s.independent)return void this.backtrack(d);if(y){var w=y.startPTS,I=y.endPTS,R=y.startDTS,C=y.endDTS;f&&(f.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:w,endPTS:I,startDTS:R,endDTS:C}),d.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,w,I,R,C),this.bufferFragmentData(y,d,f,u)}if(null!=m&&null!==(t=m.samples)&&void 0!==t&&t.length){var D={frag:d,id:n,samples:m.samples};a.trigger(o.Events.FRAG_PARSING_METADATA,D)}if(g){var M={frag:d,id:n,samples:g.samples};a.trigger(o.Events.FRAG_PARSING_USERDATA,M)}}},_._bufferInitSegment=function(e,t,n,r){var a=this;if(this.state===i.State.PARSING){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;var s=t.audio,u=t.video,l=t.audiovideo;if(s){var c=e.audioCodec,d=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==s.metadata.channelCount&&-1===d.indexOf("firefox")&&(c="mp4a.40.5")),-1!==d.indexOf("android")&&"audio/mpeg"!==s.container&&(c="mp4a.40.2",this.log("Android: force audio codec to "+c)),e.audioCodec&&e.audioCodec!==c&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+c+'"'),s.levelCodec=c,s.id="main",this.log("Init audio buffer, container:"+s.container+", codecs[selected/level/parsed]=["+(c||"")+"/"+(e.audioCodec||"")+"/"+s.codec+"]")}u&&(u.levelCodec=e.videoCodec,u.id="main",this.log("Init video buffer, container:"+u.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+u.codec+"]")),l&&this.log("Init audiovideo buffer, container:"+l.container+", codecs[level/parsed]=["+(e.attrs.CODECS||"")+"/"+l.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,t),Object.keys(t).forEach((function(e){var i=t[e].initSegment;null!=i&&i.byteLength&&a.hls.trigger(o.Events.BUFFER_APPENDING,{type:e,data:i,frag:n,part:null,chunkMeta:r,parent:n.type})})),this.tick()}},_.backtrack=function(e){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(e);var t=this.fragmentTracker.backtrack(e);this.fragPrevious=null,this.nextLoadPosition=e.start,t?this.resetFragmentLoading(e):this.state=i.State.BACKTRACKING},_.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var n=e.currentTime;if(s.BufferHelper.isBuffered(e,n)?t=this.getAppendedFrag(n):s.BufferHelper.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){var r=this.fragPlaying,i=t.level;r&&t.sn===r.sn&&r.level===i&&t.urlId===r.urlId||(this.hls.trigger(o.Events.FRAG_CHANGED,{frag:t}),r&&r.level===i||this.hls.trigger(o.Events.LEVEL_SWITCHED,{level:i}),this.fragPlaying=t)}}},E=y,(T=[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getAppendedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;if(e){var t=this.getAppendedFrag(e.currentTime);return this.followingBufferedFrag(t)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&m(E.prototype,T),y}(i.default)},"./src/controller/subtitle-stream-controller.ts":
/*!******************************************************!*\
  !*** ./src/controller/subtitle-stream-controller.ts ***!
  \******************************************************/
/*! exports provided: SubtitleStreamController */function(e,t,n){"use strict";n.r(t),n.d(t,"SubtitleStreamController",(function(){return h}));var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../utils/logger */"./src/utils/logger.ts"),a=n(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),o=n(/*! ./fragment-finders */"./src/controller/fragment-finders.ts"),s=n(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),u=n(/*! ./base-stream-controller */"./src/controller/base-stream-controller.ts"),l=n(/*! ../types/loader */"./src/types/loader.ts"),c=n(/*! ../types/level */"./src/types/level.ts");function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){var t,n;function h(t,n){var r;return(r=e.call(this,t,n,"[subtitle-stream-controller]")||this).levels=[],r.currentTrackId=-1,r.tracksBuffered=[],r._registerListeners(),r}n=e,(t=h).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n);var p,g,m=h.prototype;return m._registerListeners=function(){var e=this.hls;e.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(r.Events.ERROR,this.onError,this),e.on(r.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(r.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(r.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(r.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this)},m._unregisterListeners=function(){var e=this.hls;e.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(r.Events.ERROR,this.onError,this),e.off(r.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(r.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(r.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(r.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this)},m.startLoad=function(){this.stopLoad(),this.state=u.State.IDLE;var e=this.levels[this.currentTrackId];null!=e&&e.details&&(this.setInterval(500),this.tick())},m.onHandlerDestroyed=function(){this._unregisterListeners(),e.prototype.onHandlerDestroyed.call(this)},m.onSubtitleFragProcessed=function(e,t){var n=t.frag,r=t.success;if(this.fragPrevious=n,this.state=u.State.IDLE,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,o=n.start,s=0;s<i.length;s++)if(o>=i[s].start&&o<=i[s].end){a=i[s];break}var l=n.start+n.duration;a?a.end=l:(a={start:o,end:l},i.push(a))}}},m.onError=function(e,t){var n,r=t.frag;r&&r.type===l.PlaylistLevelType.SUBTITLE&&(null!==(n=this.fragCurrent)&&void 0!==n&&n.loader&&this.fragCurrent.loader.abort(),this.state=u.State.IDLE)},m.onSubtitleTracksUpdated=function(e,t){var n=this,r=t.subtitleTracks;this.tracksBuffered=[],this.levels=r.map((function(e){return new c.Level(e)})),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach((function(e){n.tracksBuffered[e.id]=[]})),this.mediaBuffer=null},m.onSubtitleTrackSwitch=function(e,t){if(this.currentTrackId=t.id,this.levels.length&&-1!==this.currentTrackId){var n=this.levels[this.currentTrackId];null!=n&&n.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(500)):this.mediaBuffer=null}else this.clearInterval()},m.onSubtitleTrackLoaded=function(e,t){var n,r=t.id,i=t.details,a=this.currentTrackId,o=this.levels;if(o.length&&i){var s=o[a];if(!(r>=o.length||r!==a)&&s){if(this.mediaBuffer=this.mediaBufferTimeRanges,i.live||null!==(n=s.details)&&void 0!==n&&n.live){if(i.deltaUpdateFailed)return;this.alignPlaylists(i,s.details)}s.details=i,this.levelLastLoaded=r,this.setInterval(500)}}},m._handleFragmentLoadComplete=function(e){var t=e.frag,n=e.payload,i=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){var o=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).then((function(e){var n=performance.now();a.trigger(r.Events.FRAG_DECRYPTED,{frag:t,payload:e,stats:{tstart:o,tdecrypt:n}})}))}},m.doTick=function(){if(this.media){if(this.state===u.State.IDLE){var e,t=this.config,n=this.currentTrackId,l=this.fragmentTracker,c=this.media,d=this.levels;if(!d.length||!d[n]||!d[n].details)return;var f=t.maxBufferHole,h=t.maxFragLookUpTolerance,p=Math.min(t.maxBufferLength,t.maxMaxBufferLength),g=a.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,c.currentTime,f),m=g.end;if(g.len>p)return;var v=d[n].details;console.assert(v,"Subtitle track details are defined on idle subtitle stream controller tick");var y,E=v.fragments,T=E.length,_=E[T-1].start+E[T-1].duration,b=this.fragPrevious;m<_?(b&&v.hasProgramDateTime&&(y=Object(o.findFragmentByPDT)(E,b.endProgramDateTime,h)),y||(y=Object(o.findFragmentByPTS)(b,E,m,h))):y=E[T-1],null!==(e=y)&&void 0!==e&&e.encrypted?(i.logger.log("Loading key for "+y.sn),this.state=u.State.KEY_LOADING,this.hls.trigger(r.Events.KEY_LOADING,{frag:y})):y&&l.getState(y)===s.FragmentState.NOT_LOADED&&this.loadFragment(y,v,m)}}else this.state=u.State.IDLE},m.loadFragment=function(t,n,r){this.fragCurrent=t,e.prototype.loadFragment.call(this,t,n,r)},p=h,(g=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&d(p.prototype,g),h}(u.default)},"./src/controller/subtitle-track-controller.ts":
/*!*****************************************************!*\
  !*** ./src/controller/subtitle-track-controller.ts ***!
  \*****************************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.ts"),a=n(/*! ./base-playlist-controller */"./src/controller/base-playlist-controller.ts"),o=n(/*! ../types/loader */"./src/types/loader.ts");function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){var t,n;function a(t){var n;return(n=e.call(this,t,"[subtitle-track-controller]")||this).media=null,n.tracks=[],n.groupId=null,n.tracksInGroup=[],n.trackId=-1,n.selectDefaultTrack=!0,n.queuedDefaultTrack=-1,n.trackChangeListener=function(){return n.onTextTracksChanged()},n.useTextTrackPolling=!1,n.subtitlePollingInterval=-1,n.subtitleDisplay=!0,n.registerListeners(),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n);var l,d,f=a.prototype;return f.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=null,e.prototype.destroy.call(this)},f.registerListeners=function(){var e=this.hls;e.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(r.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(r.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(r.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(r.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var e=this.hls;e.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(r.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(r.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(r.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(r.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(r.Events.ERROR,this.onError,this)},f.onMediaAttached=function(e,t){var n=this;this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?(self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval((function(){n.trackChangeListener()}),500)):this.media.textTracks.addEventListener("change",this.trackChangeListener))},f.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?self.clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),c(this.media.textTracks).forEach((function(e){Object(i.clearCurrentCues)(e)})),this.subtitleTrack=-1,this.media=null)},f.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},f.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks},f.onSubtitleTrackLoaded=function(e,t){var n=t.id,r=t.details,i=this.trackId,a=this.tracksInGroup[i];if(a){var o=a.details;a.details=t.details,this.log("subtitle track "+n+" loaded ["+r.startSN+"-"+r.endSN+"]"),n===this.trackId&&(this.retryCount=0,this.playlistLoaded(n,t,o))}else this.warn("Invalid subtitle track id "+n)},f.onLevelLoading=function(e,t){this.switchLevel(t.level)},f.onLevelSwitching=function(e,t){this.switchLevel(t.level)},f.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.textGroupIds){var n=t.textGroupIds[t.urlId];if(this.groupId!==n){var i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,a=this.tracks.filter((function(e){return!n||e.groupId===n}));this.tracksInGroup=a;var o=this.findTrackId(null==i?void 0:i.name)||this.findTrackId();this.groupId=n;var s={subtitleTracks:a};this.log("Updating subtitle tracks, "+a.length+' track(s) found in "'+n+'" group-id'),this.hls.trigger(r.Events.SUBTITLE_TRACKS_UPDATED,s),-1!==o&&this.setSubtitleTrack(o,i)}}},f.findTrackId=function(e){for(var t=this.tracksInGroup,n=0;n<t.length;n++){var r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1},f.onError=function(t,n){e.prototype.onError.call(this,t,n),!n.fatal&&n.context&&n.context.type===o.PlaylistContextType.SUBTITLE_TRACK&&n.context.id===this.trackId&&n.context.groupId===this.groupId&&this.retryLoadingOrFail(n)},f.loadPlaylist=function(e){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var n=t.id,i=t.groupId,a=t.url;if(e)try{a=e.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger(r.Events.SUBTITLE_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:e||null})}},f.toggleTrackModes=function(e){var t=this,n=this.media,r=this.subtitleDisplay,i=this.trackId;if(n){var a=c(n.textTracks),o=a.filter((function(e){return e.groupId===t.groupId}));if(-1===e)[].slice.call(a).forEach((function(e){e.mode="disabled"}));else{var s=o[i];s&&(s.mode="disabled")}var u=o[e];u&&(u.mode=r?"showing":"hidden")}},f.setSubtitleTrack=function(e,t){var n,i=this.tracksInGroup;if(this.media){if(this.trackId!==e&&this.toggleTrackModes(e),!(this.trackId===e&&(-1===e||null!==(n=i[e])&&void 0!==n&&n.details)||e<-1||e>=i.length)){this.clearTimer();var a=i[e];if(this.log("Switching to subtitle track "+e),this.trackId=e,a){var o=a.id,s=a.groupId,u=void 0===s?"":s,l=a.name,c=a.type,d=a.url;this.hls.trigger(r.Events.SUBTITLE_TRACK_SWITCH,{id:o,groupId:u,name:l,type:c,url:d});var f=this.switchParams(a.url,null==t?void 0:t.details);this.loadPlaylist(f)}else this.hls.trigger(r.Events.SUBTITLE_TRACK_SWITCH,{id:e})}}else this.queuedDefaultTrack=e},f.onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=c(this.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack=e}},l=a,(d=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1;var t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}}])&&s(l.prototype,d),a}(a.default);function c(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];"subtitles"===r.kind&&r.label&&t.push(e[n])}return t}t.default=l},"./src/controller/timeline-controller.ts":
/*!***********************************************!*\
  !*** ./src/controller/timeline-controller.ts ***!
  \***********************************************/
/*! exports provided: TimelineController */function(e,t,n){"use strict";n.r(t),n.d(t,"TimelineController",(function(){return f}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../utils/cea-608-parser */"./src/utils/cea-608-parser.ts"),o=n(/*! ../utils/output-filter */"./src/utils/output-filter.ts"),s=n(/*! ../utils/webvtt-parser */"./src/utils/webvtt-parser.ts"),u=n(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.ts"),l=n(/*! ../utils/imsc1-ttml-parser */"./src/utils/imsc1-ttml-parser.ts"),c=n(/*! ../types/loader */"./src/types/loader.ts"),d=n(/*! ../utils/logger */"./src/utils/logger.ts"),f=function(){function e(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var t=new o.default(this,"textTrack1"),n=new o.default(this,"textTrack2"),r=new o.default(this,"textTrack3"),s=new o.default(this,"textTrack4");this.cea608Parser1=new a.default(1,t,n),this.cea608Parser2=new a.default(3,r,s)}e.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(i.Events.FRAG_LOADING,this.onFragLoading,this),e.on(i.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(i.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(i.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(i.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(i.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(i.Events.FRAG_LOADING,this.onFragLoading,this),e.off(i.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(i.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(i.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(i.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(i.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,t,n,r,a){for(var o,s,u,l,c=!1,d=a.length;d--;){var f=a[d],h=(o=f[0],s=f[1],u=t,l=n,Math.min(s,l)-Math.max(o,u));if(h>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],n),c=!0,h/(n-t)>.5))return}if(c||a.push([t,n]),this.config.renderTextTracksNatively){var p=this.captionsTracks[e];this.Cues.newCue(p,t,n,r)}else{var g=this.Cues.newCue(null,t,n,r);this.hls.trigger(i.Events.CUES_PARSED,{type:"captions",cues:g,track:e})}},t.onInitPtsFound=function(e,t){var n=this,r=t.frag,a=t.id,o=t.initPTS,s=t.timescale,u=this.unparsedVttFrags;"main"===a&&(this.initPTS[r.cc]=o,this.timescale[r.cc]=s),u.length&&(this.unparsedVttFrags=[],u.forEach((function(e){n.onFragLoaded(i.Events.FRAG_LOADED,e)})))},t.getExistingTrack=function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n];if(r[e])return r}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,n=this.captionsTracks,r=this.media,i=t[e],a=i.label,o=i.languageCode,s=this.getExistingTrack(e);if(s)n[e]=s,Object(u.clearCurrentCues)(n[e]),Object(u.sendAddTrackEvent)(n[e],r);else{var l=this.createTextTrack("captions",a,o);l&&(l[e]=!0,n[e]=l)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}}},t.createTextTrack=function(e,t,n){var r=this.media;if(r)return r.addTextTrack(e,t,n)},t.onMediaAttaching=function(e,t){this.media=t.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Object(u.clearCurrentCues)(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)Object(u.clearCurrentCues)(t[n])}},t.onSubtitleTracksUpdated=function(e,t){var n=this;this.textTracks=[];var r=t.subtitleTracks||[],a=r.some((function(e){return e.textCodec===l.IMSC1_CODEC}));if(this.config.enableWebVTT||a&&this.config.enableIMSC1){var o=this.tracks&&r&&this.tracks.length===r.length;if(this.tracks=r||[],this.config.renderTextTracksNatively){var s=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,t){var r;if(t<s.length){for(var i=null,a=0;a<s.length;a++)if(h(s[a],e)){i=s[a];break}i&&(r=i)}r?Object(u.clearCurrentCues)(r):(r=n.createTextTrack("subtitles",e.name,e.lang))&&(r.mode="disabled"),r&&(r.groupId=e.groupId,n.textTracks.push(r))}))}else if(!o&&this.tracks&&this.tracks.length){var c=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}},t.onManifestLoaded=function(e,t){var n=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var r="textTrack"+t[1],i=n.captionsProperties[r];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}}))},t.onFragLoading=function(e,t){var n=this.cea608Parser1,r=this.cea608Parser2,i=this.lastSn;if(this.enabled&&n&&r&&t.frag.type===c.PlaylistLevelType.MAIN){var a=t.frag.sn;a!==i+1&&(n.reset(),r.reset()),this.lastSn=a}},t.onFragLoaded=function(e,t){var n=t.frag,a=t.payload,o=this.initPTS,s=this.unparsedVttFrags;if(n.type===c.PlaylistLevelType.SUBTITLE)if(a.byteLength){if(!Object(r.isFiniteNumber)(o[n.cc]))return s.push(t),void(o.length&&this.hls.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Missing initial subtitle PTS")}));var u=n.decryptdata;if(null==u||null==u.key||"AES-128"!==u.method){var d=this.tracks[n.level],f=this.vttCCs;f[n.cc]||(f[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),d&&d.textCodec===l.IMSC1_CODEC?this._parseIMSC1(n,a):this._parseVTTs(n,a,f)}}else this.hls.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,t){var n=this,r=this.hls;Object(l.parseIMSC1)(t,this.initPTS[e.cc],this.timescale[e.cc],(function(t){n._appendCues(t,e.level),r.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){d.logger.log("Failed to parse IMSC1: "+t),r.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))},t._parseVTTs=function(e,t,n){var r=this,a=this.hls;Object(s.parseWebVTT)(t,this.initPTS[e.cc],this.timescale[e.cc],n,e.cc,e.start,(function(t){r._appendCues(t,e.level),a.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(n){r._fallbackToIMSC1(e,t),d.logger.log("Failed to parse VTT cue: "+n),a.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})}))},t._fallbackToIMSC1=function(e,t){var n=this,r=this.tracks[e.level];r.textCodec||Object(l.parseIMSC1)(t,this.initPTS[e.cc],this.timescale[e.cc],(function(){r.textCodec=l.IMSC1_CODEC,n._parseIMSC1(e,t)}),(function(){r.textCodec="wvtt"}))},t._appendCues=function(e,t){var n=this.hls;if(this.config.renderTextTracksNatively){var r=this.textTracks[t];if("disabled"===r.mode)return;e.forEach((function(e){return Object(u.addCueToTrack)(r,e)}))}else{var a=this.tracks[t].default?"default":"subtitles"+t;n.trigger(i.Events.CUES_PARSED,{type:"subtitles",cues:e,track:a})}},t.onFragDecrypted=function(e,t){var n=t.frag;if(n.type===c.PlaylistLevelType.SUBTITLE){if(!Object(r.isFiniteNumber)(this.initPTS[n.cc]))return void this.unparsedVttFrags.push(t);this.onFragLoaded(i.Events.FRAG_LOADED,t)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,t){var n=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&n&&r)for(var i=0;i<t.samples.length;i++){var a=t.samples[i].bytes;if(a){var o=this.extractCea608Data(a);n.addData(t.samples[i].pts,o[0]),r.addData(t.samples[i].pts,o[1])}}},t.onBufferFlushing=function(e,t){var n=t.startOffset,r=t.endOffset,i=t.type;if(!i||"video"===i){var a=this.media;if(!a||a.currentTime<r)return;var o=this.captionsTracks;Object.keys(o).forEach((function(e){return Object(u.removeCuesInRange)(o[e],n,r)}))}},t.extractCea608Data=function(e){for(var t=31&e[0],n=2,r=[[],[]],i=0;i<t;i++){var a=e[n++],o=127&e[n++],s=127&e[n++],u=3&a;0===o&&0===s||0!=(4&a)&&(0!==u&&1!==u||(r[u].push(o),r[u].push(s)))}return r},e}();function h(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}},"./src/crypt/aes-crypto.ts":
/*!*********************************!*\
  !*** ./src/crypt/aes-crypto.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var r=function(){function e(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}()},"./src/crypt/aes-decryptor.ts":
/*!************************************!*\
  !*** ./src/crypt/aes-decryptor.ts ***!
  \************************************/
/*! exports provided: removePadding, default */function(e,t,n){"use strict";n.r(t),n.d(t,"removePadding",(function(){return i})),n.d(t,"default",(function(){return a}));var r=n(/*! ../utils/typed-array */"./src/utils/typed-array.ts");function i(e){var t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?Object(r.sliceUint8)(e,0,t-n):e}var a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<4;r++)n[r]=t.getUint32(4*r);return n},t.initTable=function(){var e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],a=n[2],o=n[3],s=this.invSubMix,u=s[0],l=s[1],c=s[2],d=s[3],f=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99,e[h]=m,t[m]=h;var v=f[h],y=f[v],E=f[y],T=257*f[m]^16843008*m;r[h]=T<<24|T>>>8,i[h]=T<<16|T>>>16,a[h]=T<<8|T>>>24,o[h]=T,T=16843009*E^65537*y^257*v^16843008*h,u[m]=T<<24|T>>>8,l[m]=T<<16|T>>>16,c[m]=T<<8|T>>>24,d[m]=T,h?(h=v^f[f[f[E^v]]],p^=f[f[p]]):h=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a,o,s,u,l=this.ksRows=4*(i+6+1),c=this.keySchedule=new Uint32Array(l),d=this.invKeySchedule=new Uint32Array(l),f=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],y=p[3];for(a=0;a<l;a++)a<i?s=c[a]=t[a]:(u=s,a%i==0?(u=f[(u=u<<8|u>>>24)>>>24]<<24|f[u>>>16&255]<<16|f[u>>>8&255]<<8|f[255&u],u^=h[a/i|0]<<24):i>6&&a%i==4&&(u=f[u>>>24]<<24|f[u>>>16&255]<<16|f[u>>>8&255]<<8|f[255&u]),c[a]=s=(c[a-i]^u)>>>0);for(o=0;o<l;o++)a=l-o,u=3&o?c[a]:c[a-4],d[o]=o<4||a<=4?u:g[f[u>>>24]]^m[f[u>>>16&255]]^v[f[u>>>8&255]]^y[f[255&u]],d[o]=d[o]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,n){for(var r,i,a,o,s,u,l,c,d,f,h,p,g,m,v=this.keySize+6,y=this.invKeySchedule,E=this.invSBox,T=this.invSubMix,_=T[0],b=T[1],A=T[2],S=T[3],w=this.uint8ArrayToUint32Array_(n),I=w[0],R=w[1],C=w[2],D=w[3],M=new Int32Array(e),L=new Int32Array(M.length),N=this.networkToHostOrderSwap;t<M.length;){for(d=N(M[t]),f=N(M[t+1]),h=N(M[t+2]),p=N(M[t+3]),s=d^y[0],u=p^y[1],l=h^y[2],c=f^y[3],g=4,m=1;m<v;m++)r=_[s>>>24]^b[u>>16&255]^A[l>>8&255]^S[255&c]^y[g],i=_[u>>>24]^b[l>>16&255]^A[c>>8&255]^S[255&s]^y[g+1],a=_[l>>>24]^b[c>>16&255]^A[s>>8&255]^S[255&u]^y[g+2],o=_[c>>>24]^b[s>>16&255]^A[u>>8&255]^S[255&l]^y[g+3],s=r,u=i,l=a,c=o,g+=4;r=E[s>>>24]<<24^E[u>>16&255]<<16^E[l>>8&255]<<8^E[255&c]^y[g],i=E[u>>>24]<<24^E[l>>16&255]<<16^E[c>>8&255]<<8^E[255&s]^y[g+1],a=E[l>>>24]<<24^E[c>>16&255]<<16^E[s>>8&255]<<8^E[255&u]^y[g+2],o=E[c>>>24]<<24^E[s>>16&255]<<16^E[u>>8&255]<<8^E[255&l]^y[g+3],L[t]=N(r^I),L[t+1]=N(o^R),L[t+2]=N(a^C),L[t+3]=N(i^D),I=d,R=f,C=h,D=p,t+=4}return L.buffer},e}()},"./src/crypt/decrypter.ts":
/*!********************************!*\
  !*** ./src/crypt/decrypter.ts ***!
  \********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n(/*! ./aes-crypto */"./src/crypt/aes-crypto.ts"),i=n(/*! ./fast-aes-key */"./src/crypt/fast-aes-key.ts"),a=n(/*! ./aes-decryptor */"./src/crypt/aes-decryptor.ts"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),u=n(/*! ../utils/typed-array */"./src/utils/typed-array.ts"),l=function(){function e(e,t,n){var r=(void 0===n?{}:n).removePKCS7Padding,i=void 0===r||r;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=e,this.config=t,this.removePKCS7Padding=i,i)try{var a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}var t=e.prototype;return t.destroy=function(){this.observer=null},t.isSync=function(){return this.config.enableSoftwareAES},t.flush=function(){var e=this.currentResult;if(e){var t=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Object(a.removePadding)(t):t}this.reset()},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},t.decrypt=function(e,t,n,r){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(e),t,n);var i=this.flush();i&&r(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(e),t,n).then(r)},t.softwareDecrypt=function(e,t,n){var r=this.currentIV,i=this.currentResult,o=this.remainderData;this.logOnce("JS AES decrypt"),o&&(e=Object(s.appendUint8Array)(o,e),this.remainderData=null);var l=this.getValidChunk(e);if(!l.length)return null;r&&(n=r);var c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new a.default),c.expandKey(t);var d=i;return this.currentResult=c.decrypt(l.buffer,0,n),this.currentIV=Object(u.sliceUint8)(l,-16).buffer,d||null},t.webCryptoDecrypt=function(e,t,n){var a=this,o=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new i.default(o,t)),this.fastAesKey.expandKey().then((function(t){return o?new r.default(o,n).decrypt(e.buffer,t):Promise.reject(new Error("web crypto not initialized"))})).catch((function(r){return a.onWebCryptoError(r,e,t,n)}))},t.onWebCryptoError=function(e,t,n,r){return o.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",e),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(t,n,r)},t.getValidChunk=function(e){var t=e,n=e.length-e.length%16;return n!==e.length&&(t=Object(u.sliceUint8)(e,0,n),this.remainderData=Object(u.sliceUint8)(e,n)),t},t.logOnce=function(e){this.logEnabled&&(o.logger.log("[decrypter.ts]: "+e),this.logEnabled=!1)},e}()},"./src/crypt/fast-aes-key.ts":
/*!***********************************!*\
  !*** ./src/crypt/fast-aes-key.ts ***!
  \***********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var r=function(){function e(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}()},"./src/demux/aacdemuxer.ts":
/*!*********************************!*\
  !*** ./src/demux/aacdemuxer.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./base-audio-demuxer */"./src/demux/base-audio-demuxer.ts"),i=n(/*! ./adts */"./src/demux/adts.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts"),o=n(/*! ../demux/id3 */"./src/demux/id3.ts");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(t,n){var r;return(r=e.call(this)||this).observer=void 0,r.config=void 0,r.observer=t,r.config=n,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var u=r.prototype;return u.resetInitSegment=function(t,n,r){e.prototype.resetInitSegment.call(this,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}},r.probe=function(e){if(!e)return!1;for(var t=(o.getID3Data(e,0)||[]).length,n=e.length;t<n;t++)if(i.probe(e,t))return a.logger.log("ADTS sync word found !"),!0;return!1},u.canParse=function(e,t){return i.canParse(e,t)},u.appendFrame=function(e,t,n){return i.initTrackConfig(e,this.observer,t,n,e.manifestCodec),i.appendFrame(e,t,n,this.initPTS,this.frameIndex)},r}(r.default);u.minProbeByteLength=9,t.default=u},"./src/demux/adts.ts":
/*!***************************!*\
  !*** ./src/demux/adts.ts ***!
  \***************************/
/*! exports provided: getAudioConfig, isHeaderPattern, getHeaderLength, getFullFrameLength, canGetFrameLength, isHeader, canParse, probe, initTrackConfig, getFrameDuration, parseFrameHeader, appendFrame */function(e,t,n){"use strict";n.r(t),n.d(t,"getAudioConfig",(function(){return o})),n.d(t,"isHeaderPattern",(function(){return s})),n.d(t,"getHeaderLength",(function(){return u})),n.d(t,"getFullFrameLength",(function(){return l})),n.d(t,"canGetFrameLength",(function(){return c})),n.d(t,"isHeader",(function(){return d})),n.d(t,"canParse",(function(){return f})),n.d(t,"probe",(function(){return h})),n.d(t,"initTrackConfig",(function(){return p})),n.d(t,"getFrameDuration",(function(){return g})),n.d(t,"parseFrameHeader",(function(){return m})),n.d(t,"appendFrame",(function(){return v}));var r=n(/*! ../utils/logger */"./src/utils/logger.ts"),i=n(/*! ../errors */"./src/errors.ts"),a=n(/*! ../events */"./src/events.ts");function o(e,t,n,o){var s,u,l,c,d=navigator.userAgent.toLowerCase(),f=o,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=1+((192&t[n+2])>>>6);var p=(60&t[n+2])>>>2;if(!(p>h.length-1))return l=(1&t[n+2])<<2,l|=(192&t[n+3])>>>6,r.logger.log("manifest codec:"+o+", ADTS type:"+s+", samplingIndex:"+p),/firefox/i.test(d)?p>=6?(s=5,c=new Array(4),u=p-3):(s=2,c=new Array(2),u=p):-1!==d.indexOf("android")?(s=2,c=new Array(2),u=p):(s=5,c=new Array(4),o&&(-1!==o.indexOf("mp4a.40.29")||-1!==o.indexOf("mp4a.40.5"))||!o&&p>=6?u=p-3:((o&&-1!==o.indexOf("mp4a.40.2")&&(p>=6&&1===l||/vivaldi/i.test(d))||!o&&1===l)&&(s=2,c=new Array(2)),u=p)),c[0]=s<<3,c[0]|=(14&p)>>1,c[1]|=(1&p)<<7,c[1]|=l<<3,5===s&&(c[1]|=(14&u)>>1,c[2]=(1&u)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:h[p],channelCount:l,codec:"mp4a.40."+s,manifestCodec:f};e.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+p})}function s(e,t){return 255===e[t]&&240==(246&e[t+1])}function u(e,t){return 1&e[t+1]?7:9}function l(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function c(e,t){return t+5<e.length}function d(e,t){return t+1<e.length&&s(e,t)}function f(e,t){return c(e,t)&&s(e,t)&&l(e,t)<=e.length-t}function h(e,t){if(d(e,t)){var n=u(e,t);if(t+n>=e.length)return!1;var r=l(e,t);if(r<=n)return!1;var i=t+r;return i===e.length||d(e,i)}return!1}function p(e,t,n,i,a){if(!e.samplerate){var s=o(t,n,i,a);if(!s)return;e.config=s.config,e.samplerate=s.samplerate,e.channelCount=s.channelCount,e.codec=s.codec,e.manifestCodec=s.manifestCodec,r.logger.log("parsed codec:"+e.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function g(e){return 9216e4/e}function m(e,t,n,r,i){var a=e.length,o=u(e,t),s=l(e,t);if((s-=o)>0&&t+o+s<=a)return{headerLength:o,frameLength:s,stamp:n+r*i}}function v(e,t,n,r,i){var a=m(t,n,r,i,g(e.samplerate));if(a){var o=a.stamp,s=a.headerLength,u=a.frameLength,l={unit:t.subarray(n+s,n+s+u),pts:o,dts:o};return e.samples.push(l),{sample:l,length:u+s}}}},"./src/demux/base-audio-demuxer.ts":
/*!*****************************************!*\
  !*** ./src/demux/base-audio-demuxer.ts ***!
  \*****************************************/
/*! exports provided: initPTSFn, default */function(e,t,n){"use strict";n.r(t),n.d(t,"initPTSFn",(function(){return l}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../demux/id3 */"./src/demux/id3.ts"),a=n(/*! ./dummy-demuxed-track */"./src/demux/dummy-demuxed-track.ts"),o=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),s=n(/*! ../utils/typed-array */"./src/utils/typed-array.ts"),u=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,n){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(){},t.resetContiguity=function(){},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,n){},t.demux=function(e,t){this.cachedData&&(e=Object(o.appendUint8Array)(this.cachedData,e),this.cachedData=null);var n,r,u=i.getID3Data(e,0),c=u?u.length:0,d=this._audioTrack,f=this._id3Track,h=u?i.getTimeStamp(u):void 0,p=e.length;for(0!==this.frameIndex&&null!==this.initPTS||(this.initPTS=l(h,t)),u&&u.length>0&&f.samples.push({pts:this.initPTS,dts:this.initPTS,data:u}),r=this.initPTS;c<p;){if(this.canParse(e,c)){var g=this.appendFrame(d,e,c);g?(this.frameIndex++,r=g.sample.pts,n=c+=g.length):c=p}else i.canParse(e,c)?(u=i.getID3Data(e,c),f.samples.push({pts:r,dts:r,data:u}),n=c+=u.length):c++;if(c===p&&n!==p){var m=Object(s.sliceUint8)(e,n);this.cachedData?this.cachedData=Object(o.appendUint8Array)(this.cachedData,m):this.cachedData=m}}return{audioTrack:d,avcTrack:Object(a.dummyTrack)(),id3Track:f,textTrack:Object(a.dummyTrack)()}},t.demuxSampleAes=function(e,t,n){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(a.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(a.dummyTrack)()}},t.destroy=function(){},e}(),l=function(e,t){return Object(r.isFiniteNumber)(e)?90*e:9e4*t};t.default=u},"./src/demux/chunk-cache.ts":
/*!**********************************!*\
  !*** ./src/demux/chunk-cache.ts ***!
  \**********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var r=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,n=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var n=new Uint8Array(t),r=0,i=0;i<e.length;i++){var a=e[i];n.set(a,r),r+=a.length}return n}(t,n),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}()},"./src/demux/dummy-demuxed-track.ts":
/*!******************************************!*\
  !*** ./src/demux/dummy-demuxed-track.ts ***!
  \******************************************/
/*! exports provided: dummyTrack */function(e,t,n){"use strict";function r(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}n.r(t),n.d(t,"dummyTrack",(function(){return r}))},"./src/demux/exp-golomb.ts":
/*!*********************************!*\
  !*** ./src/demux/exp-golomb.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../utils/logger */"./src/utils/logger.ts"),i=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?n<<t|this.readBits(t):n},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,n=8,r=0;r<e;r++)0!==n&&(n=(t+this.readEG()+256)%256),t=0===n?t:n},t.readSPS=function(){var e,t,n,r=0,i=0,a=0,o=0,s=this.readUByte.bind(this),u=this.readBits.bind(this),l=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),f=this.skipEG.bind(this),h=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);s();var g=s();if(u(5),d(3),s(),h(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){var m=l();if(3===m&&d(1),h(),h(),d(1),c())for(t=3!==m?8:12,n=0;n<t;n++)c()&&p(n<6?16:64)}h();var v=l();if(0===v)l();else if(1===v)for(d(1),f(),f(),e=l(),n=0;n<e;n++)f();h(),d(1);var y=l(),E=l(),T=u(1);0===T&&d(1),d(1),c()&&(r=l(),i=l(),a=l(),o=l());var _=[1,1];if(c()&&c())switch(s()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(y+1)-2*r-2*i),height:(2-T)*(E+1)*16-(T?2:4)*(a+o),pixelRatio:_}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=i},"./src/demux/id3.ts":
/*!**************************!*\
  !*** ./src/demux/id3.ts ***!
  \**************************/
/*! exports provided: isHeader, isFooter, getID3Data, canParse, getTimeStamp, isTimeStampFrame, getID3Frames, decodeFrame, utf8ArrayToStr, testables */function(e,t,n){"use strict";n.r(t),n.d(t,"isHeader",(function(){return i})),n.d(t,"isFooter",(function(){return a})),n.d(t,"getID3Data",(function(){return o})),n.d(t,"canParse",(function(){return u})),n.d(t,"getTimeStamp",(function(){return l})),n.d(t,"isTimeStampFrame",(function(){return c})),n.d(t,"getID3Frames",(function(){return f})),n.d(t,"decodeFrame",(function(){return h})),n.d(t,"utf8ArrayToStr",(function(){return y})),n.d(t,"testables",(function(){return E}));var r,i=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},a=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o=function(e,t){for(var n=t,r=0;i(e,t);)r+=10,r+=s(e,t+6),a(e,t+10)&&(r+=10),t+=r;if(r>0)return e.subarray(n,n+r)},s=function(e,t){var n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]},u=function(e,t){return i(e,t)&&s(e,t+6)+10<=e.length-t},l=function(e){for(var t=f(e),n=0;n<t.length;n++){var r=t[n];if(c(r))return v(r)}},c=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},d=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=s(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},f=function(e){for(var t=0,n=[];i(e,t);){for(var r=s(e,t+6),o=(t+=10)+r;t+8<o;){var u=d(e.subarray(t)),l=h(u);l&&n.push(l),t+=u.size+10}a(e,t)&&(t+=10)}return n},h=function(e){return"PRIV"===e.type?p(e):"W"===e.type[0]?m(e):g(e)},p=function(e){if(!(e.size<2)){var t=y(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}},g=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,n=y(e.data.subarray(t),!0);t+=n.length+1;var r=y(e.data.subarray(t));return{key:e.type,info:n,data:r}}var i=y(e.data.subarray(1));return{key:e.type,data:i}}},m=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,n=y(e.data.subarray(t),!0);t+=n.length+1;var r=y(e.data.subarray(t));return{key:e.type,info:n,data:r}}var i=y(e.data);return{key:e.type,data:i}},v=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),n=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}},y=function(e,t){void 0===t&&(t=!1);var n=T();if(n){var r=n.decode(e);if(t){var i=r.indexOf("\0");return-1!==i?r.substring(0,i):r}return r.replace(/\0/g,"")}for(var a,o,s,u=e.length,l="",c=0;c<u;){if(0===(a=e[c++])&&t)return l;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(a);break;case 12:case 13:o=e[c++],l+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[c++],s=e[c++],l+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&s)<<0)}}return l},E={decodeTextFrame:g};function T(){return r||void 0===self.TextDecoder||(r=new self.TextDecoder("utf-8")),r}},"./src/demux/mp3demuxer.ts":
/*!*********************************!*\
  !*** ./src/demux/mp3demuxer.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./base-audio-demuxer */"./src/demux/base-audio-demuxer.ts"),i=n(/*! ../demux/id3 */"./src/demux/id3.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts"),o=n(/*! ./mpegaudio */"./src/demux/mpegaudio.ts");function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,s(t,n);var u=r.prototype;return u.resetInitSegment=function(t,n,r){e.prototype.resetInitSegment.call(this,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}},r.probe=function(e){if(!e)return!1;for(var t=(i.getID3Data(e,0)||[]).length,n=e.length;t<n;t++)if(o.probe(e,t))return a.logger.log("MPEG Audio sync word found !"),!0;return!1},u.canParse=function(e,t){return o.canParse(e,t)},u.appendFrame=function(e,t,n){if(null!==this.initPTS)return o.appendFrame(e,t,n,this.initPTS,this.frameIndex)},r}(r.default);u.minProbeByteLength=4,t.default=u},"./src/demux/mp4demuxer.ts":
/*!*********************************!*\
  !*** ./src/demux/mp4demuxer.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),i=n(/*! ./dummy-demuxed-track */"./src/demux/dummy-demuxed-track.ts"),a=function(){function e(e,t){this.remainderData=null,this.config=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.resetContiguity=function(){},e.probe=function(e){return Object(r.findBox)({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0},t.demux=function(e){var t=e,n=Object(i.dummyTrack)();if(this.config.progressive){this.remainderData&&(t=Object(r.appendUint8Array)(this.remainderData,e));var a=Object(r.segmentValidRange)(t);this.remainderData=a.remainder,n.samples=a.valid||new Uint8Array}else n.samples=t;return{audioTrack:Object(i.dummyTrack)(),avcTrack:n,id3Track:Object(i.dummyTrack)(),textTrack:Object(i.dummyTrack)()}},t.flush=function(){var e=Object(i.dummyTrack)();return e.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(i.dummyTrack)(),avcTrack:e,id3Track:Object(i.dummyTrack)(),textTrack:Object(i.dummyTrack)()}},t.demuxSampleAes=function(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){},e}();a.minProbeByteLength=1024,t.default=a},"./src/demux/mpegaudio.ts":
/*!********************************!*\
  !*** ./src/demux/mpegaudio.ts ***!
  \********************************/
/*! exports provided: appendFrame, parseHeader, isHeaderPattern, isHeader, canParse, probe */function(e,t,n){"use strict";n.r(t),n.d(t,"appendFrame",(function(){return u})),n.d(t,"parseHeader",(function(){return l})),n.d(t,"isHeaderPattern",(function(){return c})),n.d(t,"isHeader",(function(){return d})),n.d(t,"canParse",(function(){return f})),n.d(t,"probe",(function(){return h}));var r=null,i=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],a=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],o=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],s=[0,1,1,4];function u(e,t,n,r,i){if(!(n+24>t.length)){var a=l(t,n);if(a&&n+a.frameLength<=t.length){var o=r+i*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(n,n+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),{sample:s,length:a.frameLength}}}}function l(e,t){var n=e[t+1]>>3&3,u=e[t+1]>>1&3,l=e[t+2]>>4&15,c=e[t+2]>>2&3;if(1!==n&&0!==l&&15!==l&&3!==c){var d=e[t+2]>>1&1,f=e[t+3]>>6,h=1e3*i[14*(3===n?3-u:3===u?3:4)+l-1],p=a[3*(3===n?0:2===n?1:2)+c],g=3===f?1:2,m=o[n][u],v=s[u],y=8*m*v,E=Math.floor(m*h/p+d)*v;if(null===r){var T=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);r=T?parseInt(T[1]):0}return!!r&&r<=87&&2===u&&h>=224e3&&0===f&&(e[t+3]=128|e[t+3]),{sampleRate:p,channelCount:g,frameLength:E,samplesPerFrame:y}}}function c(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function d(e,t){return t+1<e.length&&c(e,t)}function f(e,t){return c(e,t)&&4<=e.length-t}function h(e,t){if(t+1<e.length&&c(e,t)){var n=l(e,t),r=4;null!=n&&n.frameLength&&(r=n.frameLength);var i=t+r;return i===e.length||d(e,i)}return!1}},"./src/demux/sample-aes.ts":
/*!*********************************!*\
  !*** ./src/demux/sample-aes.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../crypt/decrypter */"./src/crypt/decrypter.ts"),i=n(/*! ./tsdemuxer */"./src/demux/tsdemuxer.ts"),a=function(){function e(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new r.default(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,t)},t.decryptAacSample=function(e,t,n,r){var i=e[t].unit,a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,(function(a){var o=new Uint8Array(a);i.set(o,16),r||s.decryptAacSamples(e,t+1,n)}))},t.decryptAacSamples=function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,n,r),!r)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),r=0,i=32;i<=e.length-16;i+=160,r+=16)n.set(e.subarray(i,i+16),r);return n},t.getAvcDecryptedUnit=function(e,t){for(var n=new Uint8Array(t),r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(n.subarray(r,r+16),i);return e},t.decryptAvcSample=function(e,t,n,r,a,o){var s=Object(i.discardEPB)(a.data),u=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(u.buffer,(function(i){a.data=l.getAvcDecryptedUnit(s,i),o||l.decryptAvcSamples(e,t,n+1,r)}))},t.decryptAvcSamples=function(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void r();for(var i=e[t].units;!(n>=i.length);n++){var a=i[n];if(!(a.data.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,n,r,a,o),!o)return}}}},e}();t.default=a},"./src/demux/transmuxer-interface.ts":
/*!*******************************************!*\
  !*** ./src/demux/transmuxer-interface.ts ***!
  \*******************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n(/*! webworkify-webpack */"./node_modules/webworkify-webpack/index.js"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../demux/transmuxer */"./src/demux/transmuxer.ts"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=n(/*! ../errors */"./src/errors.ts"),u=n(/*! ../utils/mediasource-helper */"./src/utils/mediasource-helper.ts"),l=n(/*! eventemitter3 */"./node_modules/eventemitter3/index.js"),c=Object(u.getMediaSource)()||{isTypeSupported:function(){return!1}},d=function(){function e(e,t,n,u){var d=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=e,this.id=t,this.onTransmuxComplete=n,this.onFlush=u;var f=e.config,h=function(t,n){(n=n||{}).frag=d.frag,n.id=d.id,e.trigger(t,n)};this.observer=new l.EventEmitter,this.observer.on(i.Events.FRAG_DECRYPTED,h),this.observer.on(i.Events.ERROR,h);var p={mp4:c.isTypeSupported("video/mp4"),mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(f.enableWorker&&"undefined"!=typeof Worker){var m;o.logger.log("demuxing in webworker");try{m=this.worker=r(/*! ../demux/transmuxer-worker.ts */"./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",this.onwmsg),m.onerror=function(t){e.trigger(i.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(t.message+"  ("+t.filename+":"+t.lineno+")")})},m.postMessage({cmd:"init",typeSupported:p,vendor:g,id:t,config:JSON.stringify(f)})}catch(e){o.logger.warn("Error in worker:",e),o.logger.error("Error while initializing DemuxerWorker, fallback to inline"),m&&self.URL.revokeObjectURL(m.objectURL),this.transmuxer=new a.default(this.observer,p,f,g,t),this.worker=null}}else this.transmuxer=new a.default(this.observer,p,f,g,t)}var t=e.prototype;return t.destroy=function(){var e=this.worker;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.worker=null;else{var t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}var n=this.observer;n&&n.removeAllListeners(),this.observer=null},t.push=function(e,t,n,r,i,s,u,l,c,d){var f=this;c.transmuxing.start=self.performance.now();var h=this.transmuxer,p=this.worker,g=s?s.start:i.start,m=i.decryptdata,v=this.frag,y=!(v&&i.cc===v.cc),E=!(v&&c.level===v.level),T=v?c.sn-v.sn:-1,_=this.part?c.part-this.part.index:1,b=!E&&(1===T||0===T&&1===_),A=self.performance.now();(E||T||0===i.stats.parsing.start)&&(i.stats.parsing.start=A),!s||!_&&b||(s.stats.parsing.start=A);var S=new a.TransmuxState(y,b,l,E,g);if(!b||y){o.logger.log("[transmuxer-interface, "+i.type+"]: Starting new transmux session for sn: "+c.sn+" p: "+c.part+" level: "+c.level+" id: "+c.id+"\n        discontinuity: "+y+"\n        trackSwitch: "+E+"\n        contiguous: "+b+"\n        accurateTimeOffset: "+l+"\n        timeOffset: "+g);var w=new a.TransmuxConfig(n,r,t,u,d);this.configureTransmuxer(w)}if(this.frag=i,this.part=s,p)p.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:c,state:S},e instanceof ArrayBuffer?[e]:[]);else if(h){var I=h.push(e,m,c,S);Object(a.isPromise)(I)?I.then((function(e){f.handleTransmuxComplete(e)})):this.handleTransmuxComplete(I)}},t.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var n=this.transmuxer,r=this.worker;if(r)r.postMessage({cmd:"flush",chunkMeta:e});else if(n){var i=n.flush(e);Object(a.isPromise)(i)?i.then((function(n){t.handleFlushResult(n,e)})):this.handleFlushResult(i,e)}},t.handleFlushResult=function(e,t){var n=this;e.forEach((function(e){n.handleTransmuxComplete(e)})),this.onFlush(t)},t.onWorkerMessage=function(e){var t=e.data,n=this.hls;switch(t.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}},t.configureTransmuxer=function(e){var t=this.worker,n=this.transmuxer;t?t.postMessage({cmd:"configure",config:e}):n&&n.configure(e)},t.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},e}()},"./src/demux/transmuxer-worker.ts":
/*!****************************************!*\
  !*** ./src/demux/transmuxer-worker.ts ***!
  \****************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(/*! ../demux/transmuxer */"./src/demux/transmuxer.ts"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts"),o=n(/*! eventemitter3 */"./node_modules/eventemitter3/index.js");function s(e){var t=new o.EventEmitter,n=function(t,n){e.postMessage({event:t,data:n})};t.on(i.Events.FRAG_DECRYPTED,n),t.on(i.Events.ERROR,n),e.addEventListener("message",(function(i){var o=i.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);e.transmuxer=new r.default(t,o.typeSupported,s,o.vendor,o.id),Object(a.enableLogs)(s.debug),n("init",null);break;case"configure":e.transmuxer.configure(o.config);break;case"demux":var l=e.transmuxer.push(o.data,o.decryptdata,o.chunkMeta,o.state);Object(r.isPromise)(l)?l.then((function(t){u(e,t)})):u(e,l);break;case"flush":var d=o.chunkMeta,f=e.transmuxer.flush(d);Object(r.isPromise)(f)?f.then((function(t){c(e,t,d)})):c(e,f,d)}}))}function u(e,t){if((n=t.remuxResult).audio||n.video||n.text||n.id3||n.initSegment){var n,r=[],i=t.remuxResult,a=i.audio,o=i.video;a&&l(r,a),o&&l(r,o),e.postMessage({event:"transmuxComplete",data:t},r)}}function l(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function c(e,t,n){t.forEach((function(t){u(e,t)})),e.postMessage({event:"flush",data:n})}},"./src/demux/transmuxer.ts":
/*!*********************************!*\
  !*** ./src/demux/transmuxer.ts ***!
  \*********************************/
/*! exports provided: default, isPromise, TransmuxConfig, TransmuxState */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y})),n.d(t,"isPromise",(function(){return T})),n.d(t,"TransmuxConfig",(function(){return _})),n.d(t,"TransmuxState",(function(){return b}));var r,i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../errors */"./src/errors.ts"),o=n(/*! ../crypt/decrypter */"./src/crypt/decrypter.ts"),s=n(/*! ../demux/aacdemuxer */"./src/demux/aacdemuxer.ts"),u=n(/*! ../demux/mp4demuxer */"./src/demux/mp4demuxer.ts"),l=n(/*! ../demux/tsdemuxer */"./src/demux/tsdemuxer.ts"),c=n(/*! ../demux/mp3demuxer */"./src/demux/mp3demuxer.ts"),d=n(/*! ../remux/mp4-remuxer */"./src/remux/mp4-remuxer.ts"),f=n(/*! ../remux/passthrough-remuxer */"./src/remux/passthrough-remuxer.ts"),h=n(/*! ./chunk-cache */"./src/demux/chunk-cache.ts"),p=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),g=n(/*! ../utils/logger */"./src/utils/logger.ts");try{r=self.performance.now.bind(self.performance)}catch(e){g.logger.debug("Unable to use Performance API on this environment"),r=self.Date.now}var m=[{demux:l.default,remux:d.default},{demux:u.default,remux:f.default},{demux:s.default,remux:d.default},{demux:c.default,remux:d.default}],v=1024;m.forEach((function(e){var t=e.demux;v=Math.max(v,t.minProbeByteLength)}));var y=function(){function e(e,t,n,r,i){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new h.default,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=i}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,n,i){var a=this,o=n.transmuxing;o.executeStart=r();var s=new Uint8Array(e),u=this.cache,l=this.config,c=this.currentTransmuxState,d=this.transmuxConfig;i&&(this.currentTransmuxState=i);var f=function(e,t){var n=null;return e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(n=t),n}(s,t);if(f&&"AES-128"===f.method){var h=this.getDecrypter();if(!l.enableSoftwareAES)return this.decryptionPromise=h.webCryptoDecrypt(s,f.key.buffer,f.iv.buffer).then((function(e){var t=a.push(e,null,n);return a.decryptionPromise=null,t})),this.decryptionPromise;var g=h.softwareDecrypt(s,f.key.buffer,f.iv.buffer);if(!g)return o.executeEnd=r(),E(n);s=new Uint8Array(g)}var m=i||c,v=m.contiguous,y=m.discontinuity,T=m.trackSwitch,_=m.accurateTimeOffset,b=m.timeOffset,A=d.audioCodec,S=d.videoCodec,w=d.defaultInitPts,I=d.duration,R=d.initSegmentData;if((y||T)&&this.resetInitSegment(R,A,S,I),y&&this.resetInitialTimestamp(w),v||this.resetContiguity(),this.needsProbing(s,y,T)){if(u.dataLength){var C=u.flush();s=Object(p.appendUint8Array)(C,s)}this.configureTransmuxer(s,d)}var D=this.transmux(s,f,b,_,n),M=this.currentTransmuxState;return M.contiguous=!0,M.discontinuity=!1,M.trackSwitch=!1,o.executeEnd=r(),D},t.flush=function(e){var t=this,n=e.transmuxing;n.executeStart=r();var o=this.decrypter,s=this.cache,u=this.currentTransmuxState,l=this.decryptionPromise;if(l)return l.then((function(){return t.flush(e)}));var c=[],d=u.timeOffset;if(o){var f=o.flush();f&&c.push(this.push(f,null,e))}var h=s.dataLength;s.reset();var p=this.demuxer,g=this.remuxer;if(!p||!g)return h>=v&&this.observer.emit(i.Events.ERROR,i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),n.executeEnd=r(),[E(e)];var m=p.flush(d);return T(m)?m.then((function(n){return t.flushRemux(c,n,e),c})):(this.flushRemux(c,m,e),c)},t.flushRemux=function(e,t,n){var i=t.audioTrack,a=t.avcTrack,o=t.id3Track,s=t.textTrack,u=this.currentTransmuxState,l=u.accurateTimeOffset,c=u.timeOffset;g.logger.log("[transmuxer.ts]: Flushed fragment "+n.sn+(n.part>-1?" p: "+n.part:"")+" of level "+n.level);var d=this.remuxer.remux(i,a,o,s,c,l,!0,this.id);e.push({remuxResult:d,chunkMeta:n}),n.transmuxing.executeEnd=r()},t.resetInitialTimestamp=function(e){var t=this.demuxer,n=this.remuxer;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,n,r){var i=this.demuxer,a=this.remuxer;i&&a&&(i.resetInitSegment(t,n,r),a.resetInitSegment(e,t,n))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,n,r,i){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,r,i):this.transmuxUnencrypted(e,n,r,i)},t.transmuxUnencrypted=function(e,t,n,r){var i=this.demuxer.demux(e,t,!1,!this.config.progressive),a=i.audioTrack,o=i.avcTrack,s=i.id3Track,u=i.textTrack;return{remuxResult:this.remuxer.remux(a,o,s,u,t,n,!1,this.id),chunkMeta:r}},t.transmuxSampleAes=function(e,t,n,r,i){var a=this;return this.demuxer.demuxSampleAes(e,t,n).then((function(e){return{remuxResult:a.remuxer.remux(e.audioTrack,e.avcTrack,e.id3Track,e.textTrack,n,r,!1,a.id),chunkMeta:i}}))},t.configureTransmuxer=function(e,t){for(var n,r=this.config,i=this.observer,a=this.typeSupported,o=this.vendor,s=t.audioCodec,l=t.defaultInitPts,c=t.duration,d=t.initSegmentData,h=t.videoCodec,p=0,v=m.length;p<v;p++)if(m[p].demux.probe(e)){n=m[p];break}n||(g.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),n={demux:u.default,remux:f.default});var y=this.demuxer,E=this.remuxer,T=n.remux,_=n.demux;E&&E instanceof T||(this.remuxer=new T(i,r,a,o)),y&&y instanceof _||(this.demuxer=new _(i,r,a),this.probe=_.probe),this.resetInitSegment(d,s,h,c),this.resetInitialTimestamp(l)},t.needsProbing=function(e,t,n){return!this.demuxer||!this.remuxer||t||n},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new o.default(this.observer,this.config)),e},e}(),E=function(e){return{remuxResult:{},chunkMeta:e}};function T(e){return"then"in e&&e.then instanceof Function}var _=function(e,t,n,r,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=i},b=function(e,t,n,r,i){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=i}},"./src/demux/tsdemuxer.ts":
/*!********************************!*\
  !*** ./src/demux/tsdemuxer.ts ***!
  \********************************/
/*! exports provided: discardEPB, default */function(e,t,n){"use strict";n.r(t),n.d(t,"discardEPB",(function(){return T}));var r=n(/*! ./adts */"./src/demux/adts.ts"),i=n(/*! ./mpegaudio */"./src/demux/mpegaudio.ts"),a=n(/*! ./exp-golomb */"./src/demux/exp-golomb.ts"),o=n(/*! ./id3 */"./src/demux/id3.ts"),s=n(/*! ./sample-aes */"./src/demux/sample-aes.ts"),u=n(/*! ../events */"./src/events.ts"),l=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),c=n(/*! ../utils/logger */"./src/utils/logger.ts"),d=n(/*! ../errors */"./src/errors.ts"),f={video:1,audio:2,id3:3,text:4},h=function(){function e(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}e.probe=function(t){var n=e.syncOffset(t);return!(n<0||(n&&c.logger.warn("MPEG2-TS detected but first sync word found @ offset "+n+", junk ahead ?"),0))},e.syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71===e[n]&&71===e[n+188]&&71===e[n+376])return n;n++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:f[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",r),this._audioTrack=e.createTrack("audio",r),this._id3Track=e.createTrack("id3",r),this._txtTrack=e.createTrack("text",r),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=n,this._duration=r},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._avcTrack,n=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},t.demux=function(t,n,r,i){var a;void 0===r&&(r=!1),void 0===i&&(i=!1),r||(this.sampleAes=null);var o=this._avcTrack,s=this._audioTrack,f=this._id3Track,h=o.pid,p=o.pesData,y=s.pid,E=f.pid,T=s.pesData,_=f.pesData,b=!1,A=this.pmtParsed,S=this._pmtId,w=t.length;if(this.remainderData&&(w=(t=Object(l.appendUint8Array)(this.remainderData,t)).length,this.remainderData=null),w<188&&!i)return this.remainderData=t,{audioTrack:s,avcTrack:o,id3Track:f,textTrack:this._txtTrack};var I=Math.max(0,e.syncOffset(t));(w-=(w+I)%188)<t.byteLength&&!i&&(this.remainderData=new Uint8Array(t.buffer,w,t.buffer.byteLength-w));for(var R=I;R<w;R+=188)if(71===t[R]){var C=!!(64&t[R+1]),D=((31&t[R+1])<<8)+t[R+2],M=void 0;if((48&t[R+3])>>4>1){if((M=R+5+t[R+4])===R+188)continue}else M=R+4;switch(D){case h:C&&(p&&(a=v(p))&&this.parseAVCPES(a,!1),p={data:[],size:0}),p&&(p.data.push(t.subarray(M,R+188)),p.size+=R+188-M);break;case y:C&&(T&&(a=v(T))&&(s.isAAC?this.parseAACPES(a):this.parseMPEGPES(a)),T={data:[],size:0}),T&&(T.data.push(t.subarray(M,R+188)),T.size+=R+188-M);break;case E:C&&(_&&(a=v(_))&&this.parseID3PES(a),_={data:[],size:0}),_&&(_.data.push(t.subarray(M,R+188)),_.size+=R+188-M);break;case 0:C&&(M+=t[M]+1),S=this._pmtId=g(t,M);break;case S:C&&(M+=t[M]+1);var L=m(t,M,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,r);(h=L.avc)>0&&(o.pid=h),(y=L.audio)>0&&(s.pid=y,s.isAAC=L.isAAC),(E=L.id3)>0&&(f.pid=E),b&&!A&&(c.logger.log("reparse from beginning"),b=!1,R=I-188),A=this.pmtParsed=!0;break;case 17:case 8191:break;default:b=!0}}else this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});o.pesData=p,s.pesData=T,f.pesData=_;var N={audioTrack:s,avcTrack:o,id3Track:f,textTrack:this._txtTrack};return i&&this.extractRemainingSamples(N),N},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,n=e.audioTrack,r=e.avcTrack,i=e.id3Track,a=r.pesData,o=n.pesData,s=i.pesData;a&&(t=v(a))?(this.parseAVCPES(t,!0),r.pesData=null):r.pesData=a,o&&(t=v(o))?(n.isAAC?this.parseAACPES(t):this.parseMPEGPES(t),n.pesData=null):(null!=o&&o.size&&c.logger.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=o),s&&(t=v(s))?(this.parseID3PES(t),i.pesData=null):i.pesData=s},t.demuxSampleAes=function(e,t,n){var r=this.demux(e,n,!0,!this.config.progressive),i=this.sampleAes=new s.default(this.observer,this.config,t);return this.decrypt(r,i)},t.decrypt=function(e,t){return new Promise((function(n){var r=e.audioTrack,i=e.avcTrack;r.samples&&r.isAAC?t.decryptAacSamples(r.samples,0,(function(){i.samples?t.decryptAvcSamples(i.samples,0,0,(function(){n(e)})):n(e)})):i.samples&&t.decryptAvcSamples(i.samples,0,0,(function(){n(e)}))}))},t.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},t.parseAVCPES=function(e,t){var n,r=this,i=this._avcTrack,s=this.parseAVCNALu(e.data),u=this.avcSample,l=!1;e.data=null,u&&s.length&&!i.audFound&&(y(u,i),u=this.avcSample=p(!1,e.pts,e.dts,"")),s.forEach((function(t){switch(t.type){case 1:n=!0,u||(u=r.avcSample=p(!0,e.pts,e.dts,"")),u.frame=!0;var s=t.data;if(l&&s.length>4){var c=new a.default(s).readSliceType();2!==c&&4!==c&&7!==c&&9!==c||(u.key=!0)}break;case 5:n=!0,u||(u=r.avcSample=p(!0,e.pts,e.dts,"")),u.key=!0,u.frame=!0;break;case 6:n=!0;var d=new a.default(T(t.data));d.readUByte();for(var f=0,h=0,g=!1,m=0;!g&&d.bytesAvailable>1;){f=0;do{f+=m=d.readUByte()}while(255===m);h=0;do{h+=m=d.readUByte()}while(255===m);if(4===f&&0!==d.bytesAvailable){if(g=!0,181===d.readUByte()&&49===d.readUShort()&&1195456820===d.readUInt()&&3===d.readUByte()){for(var v=d.readUByte(),_=31&v,b=[v,d.readUByte()],A=0;A<_;A++)b.push(d.readUByte()),b.push(d.readUByte()),b.push(d.readUByte());E(r._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(5===f&&0!==d.bytesAvailable){if(g=!0,h>16){for(var S=[],w=0;w<16;w++)S.push(d.readUByte().toString(16)),3!==w&&5!==w&&7!==w&&9!==w||S.push("-");for(var I=h-16,R=new Uint8Array(I),C=0;C<I;C++)R[C]=d.readUByte();E(r._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:S.join(""),userData:Object(o.utf8ArrayToStr)(R),userDataBytes:R})}}else if(h<d.bytesAvailable)for(var D=0;D<h;D++)d.readUByte()}break;case 7:if(n=!0,l=!0,!i.sps){var M=new a.default(t.data).readSPS();i.width=M.width,i.height=M.height,i.pixelRatio=M.pixelRatio,i.sps=[t.data],i.duration=r._duration;for(var L=t.data.subarray(1,4),N="avc1.",x=0;x<3;x++){var O=L[x].toString(16);O.length<2&&(O="0"+O),N+=O}i.codec=N}break;case 8:n=!0,i.pps||(i.pps=[t.data]);break;case 9:n=!1,i.audFound=!0,u&&y(u,i),u=r.avcSample=p(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}u&&n&&u.units.push(t)})),t&&u&&(y(u,i),this.avcSample=null)},t.getLastNalUnit=function(){var e,t,n=this.avcSample;if(!n||0===n.units.length){var r=this._avcTrack.samples;n=r[r.length-1]}if(null!==(e=n)&&void 0!==e&&e.units){var i=n.units;t=i[i.length-1]}return t},t.parseAVCNALu=function(e){var t,n,r=e.byteLength,i=this._avcTrack,a=i.naluState||0,o=a,s=[],u=0,l=-1,c=0;for(-1===a&&(l=0,c=31&e[0],a=0,u=1);u<r;)if(t=e[u++],a)if(1!==a)if(t)if(1===t){if(l>=0){var d={data:e.subarray(l,u-a-1),type:c};s.push(d)}else{var f=this.getLastNalUnit();if(f&&(o&&u<=4-o&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-o)),(n=u-a-1)>0)){var h=new Uint8Array(f.data.byteLength+n);h.set(f.data,0),h.set(e.subarray(0,n),f.data.byteLength),f.data=h}}u<r?(l=u,c=31&e[u],a=0):a=-1}else a=0;else a=3;else a=t?0:2;else a=t?0:1;if(l>=0&&a>=0){var p={data:e.subarray(l,r),type:c,state:a};s.push(p)}if(0===s.length){var g=this.getLastNalUnit();if(g){var m=new Uint8Array(g.data.byteLength+e.byteLength);m.set(g.data,0),m.set(e,g.data.byteLength),g.data=m}}return i.naluState=a,s},t.parseAACPES=function(e){var t,n,i,a,o=this._audioTrack,s=this.aacLastPTS,l=this.aacOverFlow,f=e.data;if(l){var h=new Uint8Array(l.byteLength+f.byteLength);h.set(l,0),h.set(f,l.byteLength),f=h}for(t=0,n=f.length;t<n-1&&!r.isHeader(f,t);t++);if(!t||(t<n-1?(i="AAC PES did not start with ADTS header,offset:"+t,a=!1):(i="no ADTS header found in AAC PES",a=!0),c.logger.warn("parsing error:"+i),this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:a,reason:i}),!a)){r.initTrackConfig(o,this.observer,f,t,this.audioCodec);var p,g=0,m=r.getFrameDuration(o.samplerate);if(void 0!==e.pts)p=e.pts;else{if(null===s)return void c.logger.warn("[tsdemuxer]: AAC PES unknown PTS");p=s}if(l&&null!==s){var v=s+m;Math.abs(v-p)>1&&(c.logger.log("[tsdemuxer]: AAC: align PTS for overlapping frames by "+Math.round((v-p)/90)),p=v)}for(var y=null;t<n;){if(r.isHeader(f,t)){if(t+5<n){var E=r.appendFrame(o,f,t,p,g);if(E){t+=E.length,y=E.sample.pts,g++;continue}}break}t++}this.aacOverFlow=t<n?f.subarray(t,n):null,this.aacLastPTS=y}},t.parseMPEGPES=function(e){var t=e.data,n=t.length,r=0,a=0,o=e.pts;if(void 0!==o)for(;a<n;)if(i.isHeader(t,a)){var s=i.appendFrame(this._audioTrack,t,a,o,r);if(!s)break;a+=s.length,r++}else a++;else c.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},t.parseID3PES=function(e){void 0!==e.pts?this._id3Track.samples.push(e):c.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();function p(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}function g(e,t){return(31&e[t+10])<<8|e[t+11]}function m(e,t,n,r){var i={audio:-1,avc:-1,id3:-1,isAAC:!0},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){var o=(31&e[t+1])<<8|e[t+2];switch(e[t]){case 207:if(!r){c.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=o);break;case 21:-1===i.id3&&(i.id3=o);break;case 219:if(!r){c.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=o);break;case 3:case 4:n?-1===i.audio&&(i.audio=o,i.isAAC=!1):c.logger.log("MPEG audio found, not supported in this browser");break;case 36:c.logger.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return i}function v(e){var t,n,r,i,a,o=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;){var u=new Uint8Array(s[0].length+s[1].length);u.set(s[0]),u.set(s[1],s[0].length),s[0]=u,s.splice(1,1)}if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;var l=t[7];192&l&&(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?i-(a=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(c.logger.warn(Math.round((i-a)/9e4)+"s delta between PTS and DTS, align them"),i=a):a=i);var d=(r=t[8])+9;if(e.size<=d)return null;e.size-=d;for(var f=new Uint8Array(e.size),h=0,p=s.length;h<p;h++){var g=(t=s[h]).byteLength;if(d){if(d>g){d-=g;continue}t=t.subarray(d),g-=d,d=0}f.set(t,o),o+=g}return n&&(n-=r+3),{data:f,pts:i,dts:a,len:n}}return null}function y(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var n=t.samples,r=n.length;if(!r)return void t.dropped++;var i=n[r-1];e.pts=i.pts,e.dts=i.dts}t.samples.push(e)}e.debug.length&&c.logger.log(e.pts+"/"+e.dts+":"+e.debug)}function E(e,t){var n=e.length;if(n>0){if(t.pts>=e[n-1].pts)e.push(t);else for(var r=n-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)}function T(e){for(var t=e.byteLength,n=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;var i=t-n.length,a=new Uint8Array(i),o=0;for(r=0;r<i;o++,r++)o===n[0]&&(o++,n.shift()),a[r]=e[o];return a}h.minProbeByteLength=188,t.default=h},"./src/errors.ts":
/*!***********************!*\
  !*** ./src/errors.ts ***!
  \***********************/
/*! exports provided: ErrorTypes, ErrorDetails */function(e,t,n){"use strict";var r,i;n.r(t),n.d(t,"ErrorTypes",(function(){return r})),n.d(t,"ErrorDetails",(function(){return i})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(r||(r={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown"}(i||(i={}))},"./src/events.ts":
/*!***********************!*\
  !*** ./src/events.ts ***!
  \***********************/
/*! exports provided: Events */function(e,t,n){"use strict";var r;n.r(t),n.d(t,"Events",(function(){return r})),function(e){e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached"}(r||(r={}))},"./src/hls.ts":
/*!********************!*\
  !*** ./src/hls.ts ***!
  \********************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),i=n(/*! ./loader/playlist-loader */"./src/loader/playlist-loader.ts"),a=n(/*! ./loader/key-loader */"./src/loader/key-loader.ts"),o=n(/*! ./controller/id3-track-controller */"./src/controller/id3-track-controller.ts"),s=n(/*! ./controller/latency-controller */"./src/controller/latency-controller.ts"),u=n(/*! ./controller/level-controller */"./src/controller/level-controller.ts"),l=n(/*! ./controller/fragment-tracker */"./src/controller/fragment-tracker.ts"),c=n(/*! ./controller/stream-controller */"./src/controller/stream-controller.ts"),d=n(/*! ./is-supported */"./src/is-supported.ts"),f=n(/*! ./utils/logger */"./src/utils/logger.ts"),h=n(/*! ./config */"./src/config.ts"),p=n(/*! eventemitter3 */"./node_modules/eventemitter3/index.js"),g=n(/*! ./events */"./src/events.ts"),m=n(/*! ./errors */"./src/errors.ts");function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new p.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var n=this.config=Object(h.mergeConfig)(e.DefaultConfig,t);this.userConfig=t,Object(f.enableLogs)(n.debug),this._autoLevelCapping=-1,n.progressive&&Object(h.enableStreamingMode)(n);var r=n.abrController,d=n.bufferController,g=n.capLevelController,m=n.fpsController,v=this.abrController=new r(this),y=this.bufferController=new d(this),E=this.capLevelController=new g(this),T=new m(this),_=new i.default(this),b=new a.default(this),A=new o.default(this),S=this.levelController=new u.default(this),w=new l.FragmentTracker(this),I=this.streamController=new c.default(this,w);E.setStreamController(I),T.setStreamController(I);var R=[S,I];this.networkControllers=R;var C=[_,b,v,y,E,T,A,w];this.audioTrackController=this.createController(n.audioTrackController,null,R),this.createController(n.audioStreamController,w,R),this.subtitleTrackController=this.createController(n.subtitleTrackController,null,R),this.createController(n.subtitleStreamController,w,R),this.createController(n.timelineController,null,C),this.emeController=this.createController(n.emeController,null,C),this.latencyController=this.createController(s.default,null,C),this.coreComponents=C}e.isSupported=function(){return Object(d.isSupported)()};var t,n,y,E=e.prototype;return E.createController=function(e,t,n){if(e){var r=t?new e(this,t):new e(this);return n&&n.push(r),r}return null},E.on=function(e,t,n){void 0===n&&(n=this),this._emitter.on(e,t,n)},E.once=function(e,t,n){void 0===n&&(n=this),this._emitter.once(e,t,n)},E.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},E.off=function(e,t,n,r){void 0===n&&(n=this),this._emitter.off(e,t,n,r)},E.listeners=function(e){return this._emitter.listeners(e)},E.emit=function(e,t,n){return this._emitter.emit(e,t,n)},E.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){f.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(g.Events.ERROR,{type:m.ErrorTypes.OTHER_ERROR,details:m.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1},E.listenerCount=function(e){return this._emitter.listenerCount(e)},E.destroy=function(){f.logger.log("destroy"),this.trigger(g.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0},E.attachMedia=function(e){f.logger.log("attachMedia"),this._media=e,this.trigger(g.Events.MEDIA_ATTACHING,{media:e})},E.detachMedia=function(){f.logger.log("detachMedia"),this.trigger(g.Events.MEDIA_DETACHING,void 0),this._media=null},E.loadSource=function(e){this.stopLoad();var t=this.media,n=this.url,i=this.url=r.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});f.logger.log("loadSource:"+i),t&&n&&n!==i&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t)),this.trigger(g.Events.MANIFEST_LOADING,{url:e})},E.startLoad=function(e){void 0===e&&(e=-1),f.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},E.stopLoad=function(){f.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},E.swapAudioCodec=function(){f.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},E.recoverMediaError=function(){f.logger.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},E.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},t=e,y=[{key:"version",get:function(){return"1.0.4"}},{key:"Events",get:function(){return g.Events}},{key:"ErrorTypes",get:function(){return m.ErrorTypes}},{key:"ErrorDetails",get:function(){return m.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:h.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}],(n=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){f.logger.log("set currentLevel:"+e),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){f.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){f.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){f.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){f.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(f.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e)}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var n=e.length,r=0;r<n;r++)if(e[r].maxBitrate>t)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&v(t.prototype,n),y&&v(t,y),e}();y.defaultConfig=void 0},"./src/is-supported.ts":
/*!*****************************!*\
  !*** ./src/is-supported.ts ***!
  \*****************************/
/*! exports provided: isSupported, changeTypeSupported */function(e,t,n){"use strict";n.r(t),n.d(t,"isSupported",(function(){return a})),n.d(t,"changeTypeSupported",(function(){return o}));var r=n(/*! ./utils/mediasource-helper */"./src/utils/mediasource-helper.ts");function i(){return self.SourceBuffer||self.WebKitSourceBuffer}function a(){var e=Object(r.getMediaSource)();if(!e)return!1;var t=i(),n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!n&&!!a}function o(){var e,t=i();return"function"==typeof(null==t||null===(e=t.prototype)||void 0===e?void 0:e.changeType)}},"./src/loader/fragment-loader.ts":
/*!***************************************!*\
  !*** ./src/loader/fragment-loader.ts ***!
  \***************************************/
/*! exports provided: default, LoadError */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d})),n.d(t,"LoadError",(function(){return h}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../errors */"./src/errors.ts");function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return o(e,arguments,l(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,e)})(e)}function o(e,t,n){return(o=s()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&u(i,n.prototype),i}).apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=Math.pow(2,17),d=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,t){var n=this,r=e.url;if(!r)return Promise.reject(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(r?"part list":"url")));this.abort();var a=this.config,o=a.fLoader,s=a.loader;return new Promise((function(r,u){n.loader&&n.loader.destroy();var l=n.loader=e.loader=o?new o(a):new s(a),d=f(e),p={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:c};e.stats=l.stats,l.load(d,p,{onSuccess:function(t,i,a,o){n.resetLoader(e,l),r({frag:e,part:null,payload:t.data,networkDetails:o})},onError:function(t,r,a){n.resetLoader(e,l),u(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:t,networkDetails:a}))},onAbort:function(t,r,a){n.resetLoader(e,l),u(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:a}))},onTimeout:function(t,r,a){n.resetLoader(e,l),u(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:a}))},onProgress:function(n,r,i,a){t&&t({frag:e,part:null,payload:i,networkDetails:a})}})}))},t.loadPart=function(e,t,n){var r=this;this.abort();var a=this.config,o=a.fLoader,s=a.loader;return new Promise((function(u,l){r.loader&&r.loader.destroy();var d=r.loader=e.loader=o?new o(a):new s(a),p=f(e,t),g={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:c};t.stats=d.stats,d.load(p,g,{onSuccess:function(i,a,o,s){r.resetLoader(e,d),r.updateStatsFromPart(e,t);var l={frag:e,part:t,payload:i.data,networkDetails:s};n(l),u(l)},onError:function(n,a,o){r.resetLoader(e,d),l(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:n,networkDetails:o}))},onAbort:function(n,a,o){e.stats.aborted=t.stats.aborted,r.resetLoader(e,d),l(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,networkDetails:o}))},onTimeout:function(n,a,o){r.resetLoader(e,d),l(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,networkDetails:o}))}})}))},t.updateStatsFromPart=function(e,t){var n=e.stats,r=t.stats,i=r.total;if(n.loaded+=r.loaded,i){var a=Math.round(e.duration/t.duration),o=Math.min(Math.round(n.loaded/i),a),s=(a-o)*Math.round(n.loaded/o);n.total=n.loaded+s}else n.total=Math.max(n.loaded,n.total);var u=n.loading,l=r.loading;u.start?u.first+=l.first-l.start:(u.start=l.start,u.first=l.first),u.end=l.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function f(e,t){void 0===t&&(t=null);var n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,rangeStart:0,rangeEnd:0},a=n.byteRangeStartOffset,o=n.byteRangeEndOffset;return Object(r.isFiniteNumber)(a)&&Object(r.isFiniteNumber)(o)&&(i.rangeStart=a,i.rangeEnd=o),i}var h=function(e){var t,n;function r(t){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return(n=e.call.apply(e,[this].concat(i))||this).data=void 0,n.data=t,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,u(t,n),r}(a(Error))},"./src/loader/fragment.ts":
/*!********************************!*\
  !*** ./src/loader/fragment.ts ***!
  \********************************/
/*! exports provided: ElementaryStreamTypes, BaseSegment, Fragment, Part */function(e,t,n){"use strict";n.r(t),n.d(t,"ElementaryStreamTypes",(function(){return r})),n.d(t,"BaseSegment",(function(){return f})),n.d(t,"Fragment",(function(){return h})),n.d(t,"Part",(function(){return p}));var r,i=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),a=n(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=n(/*! ./level-key */"./src/loader/level-key.ts"),u=n(/*! ./load-stats */"./src/loader/load-stats.ts");function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}!function(e){e.AUDIO="audio",e.VIDEO="video",e.AUDIOVIDEO="audiovideo"}(r||(r={}));var f=function(){function e(e){var t;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((t={})[r.AUDIO]=null,t[r.VIDEO]=null,t[r.AUDIOVIDEO]=null,t),this.baseurl=e}return e.prototype.setByteRange=function(e,t){var n=e.split("@",2),r=[];1===n.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(n[1]),r[1]=parseInt(n[0])+r[0],this._byteRange=r},d(e,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),h=function(e){function t(t,n){var r;return(r=e.call(this,n)||this)._decryptdata=null,r.rawProgramDateTime=null,r.programDateTime=null,r.tagList=[],r.duration=0,r.sn=0,r.levelkey=void 0,r.type=void 0,r.loader=null,r.level=-1,r.cc=0,r.startPTS=void 0,r.endPTS=void 0,r.appendedPTS=void 0,r.startDTS=void 0,r.endDTS=void 0,r.start=0,r.deltaPTS=void 0,r.maxStartPTS=void 0,r.minEndPTS=void 0,r.stats=new u.LoadStats,r.urlId=0,r.data=void 0,r.bitrateTest=!1,r.title=null,r.initSegment=null,r.type=t,r}l(t,e);var n=t.prototype;return n.createInitializationVector=function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},n.setDecryptDataFromLevelKey=function(e,t){var n=e;return"AES-128"===(null==e?void 0:e.method)&&e.uri&&!e.iv&&((n=s.LevelKey.fromURI(e.uri)).method=e.method,n.iv=this.createInitializationVector(t),n.keyFormat="identity"),n},n.setElementaryStreamInfo=function(e,t,n,r,i,a){void 0===a&&(a=!1);var o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,r),s.endDTS=Math.max(s.endDTS,i)):o[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:i,partial:a}},n.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[r.AUDIO]=null,e[r.VIDEO]=null,e[r.AUDIOVIDEO]=null},d(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(i.isFiniteNumber)(this.programDateTime))return null;var e=Object(i.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;return!(null===(e=this.decryptdata)||void 0===e||!e.keyFormat||!this.decryptdata.uri)}}]),t}(f),p=function(e){function t(t,n,r,i,a){var o;(o=e.call(this,r)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.stats=new u.LoadStats,o.duration=t.decimalFloatingPoint("DURATION"),o.gap=t.bool("GAP"),o.independent=t.bool("INDEPENDENT"),o.relurl=t.enumeratedString("URI"),o.fragment=n,o.index=i;var s=t.enumeratedString("BYTERANGE");return s&&o.setByteRange(s,a),a&&(o.fragOffset=a.fragOffset+a.duration),o}return l(t,e),d(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(f)},"./src/loader/key-loader.ts":
/*!**********************************!*\
  !*** ./src/loader/key-loader.ts ***!
  \**********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(/*! ../events */"./src/events.ts"),i=n(/*! ../errors */"./src/errors.ts"),a=n(/*! ../utils/logger */"./src/utils/logger.ts"),o=function(){function e(e){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){this.hls.on(r.Events.KEY_LOADING,this.onKeyLoading,this)},t._unregisterListeners=function(){this.hls.off(r.Events.KEY_LOADING,this.onKeyLoading)},t.destroy=function(){for(var e in this._unregisterListeners(),this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={}},t.onKeyLoading=function(e,t){var n=t.frag,i=n.type,o=this.loaders[i];if(n.decryptdata){var s=n.decryptdata.uri;if(s!==this.decrypturl||null===this.decryptkey){var u=this.hls.config;if(o&&(a.logger.warn("abort previous key loader for type:"+i),o.abort()),!s)return void a.logger.warn("key uri is falsy");var l=u.loader,c=n.loader=this.loaders[i]=new l(u);this.decrypturl=s,this.decryptkey=null;var d={url:s,frag:n,responseType:"arraybuffer"},f={timeout:u.fragLoadingTimeOut,maxRetry:0,retryDelay:u.fragLoadingRetryDelay,maxRetryDelay:u.fragLoadingMaxRetryTimeout,highWaterMark:0},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(d,f,h)}else this.decryptkey&&(n.decryptdata.key=this.decryptkey,this.hls.trigger(r.Events.KEY_LOADED,{frag:n}))}else a.logger.warn("Missing decryption data on fragment in onKeyLoading")},t.loadsuccess=function(e,t,n){var i=n.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=null,delete this.loaders[i.type],this.hls.trigger(r.Events.KEY_LOADED,{frag:i})):a.logger.error("after key load, decryptdata unset")},t.loaderror=function(e,t){var n=t.frag,a=n.loader;a&&a.abort(),delete this.loaders[n.type],this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})},t.loadtimeout=function(e,t){var n=t.frag,a=n.loader;a&&a.abort(),delete this.loaders[n.type],this.hls.trigger(r.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})},e}()},"./src/loader/level-details.ts":
/*!*************************************!*\
  !*** ./src/loader/level-details.ts ***!
  \*************************************/
/*! exports provided: LevelDetails */function(e,t,n){"use strict";n.r(t),n.d(t,"LevelDetails",(function(){return a}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=e}var t,n;return e.prototype.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},t=e,(n=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(r.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!==(e=this.fragments)&&void 0!==e&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&i(t.prototype,n),e}()},"./src/loader/level-key.ts":
/*!*********************************!*\
  !*** ./src/loader/level-key.ts ***!
  \*********************************/
/*! exports provided: LevelKey */function(e,t,n){"use strict";n.r(t),n.d(t,"LevelKey",(function(){return a}));var r=n(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(e,t){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=t?Object(r.buildAbsoluteURL)(e,t,{alwaysNormalize:!0}):e}var t,n;return e.fromURL=function(t,n){return new e(t,n)},e.fromURI=function(t){return new e(t)},t=e,(n=[{key:"uri",get:function(){return this._uri}}])&&i(t.prototype,n),e}()},"./src/loader/load-stats.ts":
/*!**********************************!*\
  !*** ./src/loader/load-stats.ts ***!
  \**********************************/
/*! exports provided: LoadStats */function(e,t,n){"use strict";n.r(t),n.d(t,"LoadStats",(function(){return r}));var r=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":
/*!***********************************!*\
  !*** ./src/loader/m3u8-parser.ts ***!
  \***********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),a=n(/*! ./fragment */"./src/loader/fragment.ts"),o=n(/*! ./level-details */"./src/loader/level-details.ts"),s=n(/*! ./level-key */"./src/loader/level-key.ts"),u=n(/*! ../utils/attr-list */"./src/utils/attr-list.ts"),l=n(/*! ../utils/logger */"./src/utils/logger.ts"),c=n(/*! ../utils/codecs */"./src/utils/codecs.ts"),d=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,f=/#EXT-X-MEDIA:(.*)/g,h=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),p=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),g=/\.(mp4|m4s|m4v|m4a)$/i,m=function(){function e(){}return e.findGroup=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.id===t)return r}},e.convertAVC1ToAVCOTI=function(e){var t=e.split(".");if(t.length>2){var n=t.shift()+".";return(n+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).substr(-4)}return e},e.resolve=function(e,t){return i.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,n){var r,i=[],a={},o=!1;for(d.lastIndex=0;null!=(r=d.exec(t));)if(r[1]){var s=new u.AttrList(r[1]),l={attrs:s,bitrate:s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),name:s.NAME,url:e.resolve(r[2],n)},c=s.decimalResolution("RESOLUTION");c&&(l.width=c.width,l.height=c.height),v((s.CODECS||"").split(/[ ,]+/).filter((function(e){return e})),l),l.videoCodec&&-1!==l.videoCodec.indexOf("avc1")&&(l.videoCodec=e.convertAVC1ToAVCOTI(l.videoCodec)),i.push(l)}else if(r[3]){var f=new u.AttrList(r[3]);f["DATA-ID"]&&(o=!0,a[f["DATA-ID"]]=f)}return{levels:i,sessionData:o?a:null}},e.parseMasterPlaylistMedia=function(t,n,r,i){var a;void 0===i&&(i=[]);var o=[],s=0;for(f.lastIndex=0;null!==(a=f.exec(t));){var l=new u.AttrList(a[1]);if(l.TYPE===r){var c={attrs:l,bitrate:0,id:s++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE||"",type:r,default:l.bool("DEFAULT"),autoselect:l.bool("AUTOSELECT"),forced:l.bool("FORCED"),lang:l.LANGUAGE,url:l.URI?e.resolve(l.URI,n):""};if(i.length){var d=e.findGroup(i,c.groupId)||i[0];y(c,d,"audioCodec"),y(c,d,"textCodec")}o.push(c)}}return o},e.parseLevelPlaylist=function(e,t,n,c,d){var f,m,v,y=new o.LevelDetails(t),T=y.fragments,_=null,b=0,A=0,S=0,w=0,I=null,R=new a.Fragment(c,t),C=-1,D=!1;for(h.lastIndex=0,y.m3u8=e;null!==(f=h.exec(e));){D&&(D=!1,(R=new a.Fragment(c,t)).start=S,R.sn=b,R.cc=w,R.level=n,_&&(R.initSegment=_,R.rawProgramDateTime=_.rawProgramDateTime));var M=f[1];if(M){R.duration=parseFloat(M);var L=(" "+f[2]).slice(1);R.title=L||null,R.tagList.push(L?["INF",M,L]:["INF",M])}else if(f[3])Object(r.isFiniteNumber)(R.duration)&&(R.start=S,v&&(R.levelkey=v),R.sn=b,R.level=n,R.cc=w,R.urlId=d,T.push(R),R.relurl=(" "+f[3]).slice(1),E(R,I),I=R,S+=R.duration,b++,A=0,D=!0);else if(f[4]){var N=(" "+f[4]).slice(1);I?R.setByteRange(N,I):R.setByteRange(N)}else if(f[5])R.rawProgramDateTime=(" "+f[5]).slice(1),R.tagList.push(["PROGRAM-DATE-TIME",R.rawProgramDateTime]),-1===C&&(C=T.length);else{if(!(f=f[0].match(p))){l.logger.warn("No matches on slow regex match for level playlist!");continue}for(m=1;m<f.length&&void 0===f[m];m++);var x=(" "+f[m]).slice(1),O=(" "+f[m+1]).slice(1),P=f[m+2]?(" "+f[m+2]).slice(1):"";switch(x){case"PLAYLIST-TYPE":y.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":b=y.startSN=parseInt(O);break;case"SKIP":var k=new u.AttrList(O),F=k.decimalInteger("SKIPPED-SEGMENTS");if(Object(r.isFiniteNumber)(F)){y.skippedSegments=F;for(var U=F;U--;)T.unshift(null);b+=F}var B=k.enumeratedString("RECENTLY-REMOVED-DATERANGES");B&&(y.recentlyRemovedDateranges=B.split("\t"));break;case"TARGETDURATION":y.targetduration=parseFloat(O);break;case"VERSION":y.version=parseInt(O);break;case"EXTM3U":break;case"ENDLIST":y.live=!1;break;case"#":(O||P)&&R.tagList.push(P?[O,P]:[O]);break;case"DIS":w++;case"GAP":R.tagList.push([x]);break;case"BITRATE":R.tagList.push([x,O]);break;case"DISCONTINUITY-SEQ":w=parseInt(O);break;case"KEY":var G,j=new u.AttrList(O),H=j.enumeratedString("METHOD"),K=j.URI,Y=j.hexadecimalInteger("IV"),V=j.enumeratedString("KEYFORMATVERSIONS"),q=j.enumeratedString("KEYID"),W=null!=(G=j.enumeratedString("KEYFORMAT"))?G:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(W)>-1){l.logger.warn("Keyformat "+W+" is not supported from the manifest");continue}if("identity"!==W)continue;H&&(v=s.LevelKey.fromURL(t,K),K&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(H)>=0&&(v.method=H,v.keyFormat=W,q&&(v.keyID=q),V&&(v.keyFormatVersions=V),v.iv=Y));break;case"START":var z=new u.AttrList(O).decimalFloatingPoint("TIME-OFFSET");Object(r.isFiniteNumber)(z)&&(y.startTimeOffset=z);break;case"MAP":var X=new u.AttrList(O);R.relurl=X.URI,X.BYTERANGE&&R.setByteRange(X.BYTERANGE),R.level=n,R.sn="initSegment",v&&(R.levelkey=v),R.initSegment=null,_=R,D=!0;break;case"SERVER-CONTROL":var Q=new u.AttrList(O);y.canBlockReload=Q.bool("CAN-BLOCK-RELOAD"),y.canSkipUntil=Q.optionalFloat("CAN-SKIP-UNTIL",0),y.canSkipDateRanges=y.canSkipUntil>0&&Q.bool("CAN-SKIP-DATERANGES"),y.partHoldBack=Q.optionalFloat("PART-HOLD-BACK",0),y.holdBack=Q.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var J=new u.AttrList(O);y.partTarget=J.decimalFloatingPoint("PART-TARGET");break;case"PART":var Z=y.partList;Z||(Z=y.partList=[]);var $=A>0?Z[Z.length-1]:void 0,ee=A++,te=new a.Part(new u.AttrList(O),R,t,ee,$);Z.push(te),R.duration+=te.duration;break;case"PRELOAD-HINT":var ne=new u.AttrList(O);y.preloadHint=ne;break;case"RENDITION-REPORT":var re=new u.AttrList(O);y.renditionReports=y.renditionReports||[],y.renditionReports.push(re);break;default:l.logger.warn("line parsed but not handled: "+f)}}}I&&!I.relurl?(T.pop(),S-=I.duration,y.partList&&(y.fragmentHint=I)):y.partList&&(E(R,I),R.cc=w,y.fragmentHint=R);var ie=T.length,ae=T[0],oe=T[ie-1];if((S+=y.skippedSegments*y.targetduration)>0&&ie&&oe){y.averagetargetduration=S/ie;var se=oe.sn;y.endSN="initSegment"!==se?se:0,ae&&(y.startCC=ae.cc,ae.initSegment||y.fragments.every((function(e){return e.relurl&&(t=e.relurl,g.test(null!=(n=null===(r=i.parseURL(t))||void 0===r?void 0:r.path)?n:""));var t,n,r}))&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(R=new a.Fragment(c,t)).relurl=oe.relurl,R.level=n,R.sn="initSegment",ae.initSegment=R,y.needSidxRanges=!0))}else y.endSN=0,y.startCC=0;return y.fragmentHint&&(S+=y.fragmentHint.duration),y.totalduration=S,y.endCC=w,C>0&&function(e,t){for(var n=e[t],r=t;r--;){var i=e[r];if(!i)return;i.programDateTime=n.programDateTime-1e3*i.duration,n=i}}(T,C),y},e}();function v(e,t){["video","audio","text"].forEach((function(n){var r=e.filter((function(e){return Object(c.isCodecType)(e,n)}));if(r.length){var i=r.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[n+"Codec"]=i.length>0?i[0]:r[0],e=e.filter((function(e){return-1===r.indexOf(e)}))}})),t.unknownCodecs=e}function y(e,t,n){var r=t[n];r&&(e[n]=r)}function E(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(r.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":
/*!***************************************!*\
  !*** ./src/loader/playlist-loader.ts ***!
  \***************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../events */"./src/events.ts"),a=n(/*! ../errors */"./src/errors.ts"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),u=n(/*! ./m3u8-parser */"./src/loader/m3u8-parser.ts"),l=n(/*! ../types/loader */"./src/types/loader.ts"),c=n(/*! ../utils/attr-list */"./src/utils/attr-list.ts");function d(e,t){var n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}var f=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.hls=e,this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(i.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(i.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=function(){var e=this.hls;e.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(i.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(i.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.createInternalLoader=function(e){var t=this.hls.config,n=t.pLoader,r=t.loader,i=new(n||r)(t);return e.loader=i,this.loaders[e.type]=i,i},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var n=t.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:l.PlaylistContextType.MANIFEST,url:n,deliveryDirectives:null})},t.onLevelLoading=function(e,t){var n=t.id,r=t.level,i=t.url,a=t.deliveryDirectives;this.load({id:n,groupId:null,level:r,responseType:"text",type:l.PlaylistContextType.LEVEL,url:i,deliveryDirectives:a})},t.onAudioTrackLoading=function(e,t){var n=t.id,r=t.groupId,i=t.url,a=t.deliveryDirectives;this.load({id:n,groupId:r,level:null,responseType:"text",type:l.PlaylistContextType.AUDIO_TRACK,url:i,deliveryDirectives:a})},t.onSubtitleTrackLoading=function(e,t){var n=t.id,r=t.groupId,i=t.url,a=t.deliveryDirectives;this.load({id:n,groupId:r,level:null,responseType:"text",type:l.PlaylistContextType.SUBTITLE_TRACK,url:i,deliveryDirectives:a})},t.load=function(e){var t,n,r,i,a,s,u=this.hls.config,c=this.getInternalLoader(e);if(c){var d=c.context;if(d&&d.url===e.url)return void o.logger.trace("[playlist-loader]: playlist request ongoing");o.logger.log("[playlist-loader]: aborting previous loader for type: "+e.type),c.abort()}switch(e.type){case l.PlaylistContextType.MANIFEST:n=u.manifestLoadingMaxRetry,r=u.manifestLoadingTimeOut,i=u.manifestLoadingRetryDelay,a=u.manifestLoadingMaxRetryTimeout;break;case l.PlaylistContextType.LEVEL:case l.PlaylistContextType.AUDIO_TRACK:case l.PlaylistContextType.SUBTITLE_TRACK:n=0,r=u.levelLoadingTimeOut;break;default:n=u.levelLoadingMaxRetry,r=u.levelLoadingTimeOut,i=u.levelLoadingRetryDelay,a=u.levelLoadingMaxRetryTimeout}if(c=this.createInternalLoader(e),null!==(t=e.deliveryDirectives)&&void 0!==t&&t.part&&(e.type===l.PlaylistContextType.LEVEL&&null!==e.level?s=this.hls.levels[e.level].details:e.type===l.PlaylistContextType.AUDIO_TRACK&&null!==e.id?s=this.hls.audioTracks[e.id].details:e.type===l.PlaylistContextType.SUBTITLE_TRACK&&null!==e.id&&(s=this.hls.subtitleTracks[e.id].details),s)){var f=s.partTarget,h=s.targetduration;f&&h&&(r=Math.min(1e3*Math.max(3*f,.8*h),r))}var p={timeout:r,maxRetry:n,retryDelay:i,maxRetryDelay:a,highWaterMark:0},g={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(e,p,g)},t.loadsuccess=function(e,t,n,r){if(void 0===r&&(r=null),n.isSidxRequest)return this.handleSidxRequest(e,n),void this.handlePlaylistLoaded(e,t,n,r);this.resetInternalLoader(n.type);var i=e.data;0===i.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(e,t,n,r):this.handleMasterPlaylist(e,t,n,r)):this.handleManifestParsingError(e,n,"no EXTM3U delimiter",r)},t.loaderror=function(e,t,n){void 0===n&&(n=null),this.handleNetworkError(t,n,!1,e)},t.loadtimeout=function(e,t,n){void 0===n&&(n=null),this.handleNetworkError(t,n,!0)},t.handleMasterPlaylist=function(e,t,n,r){var a=this.hls,s=e.data,l=d(e,n),f=u.default.parseMasterPlaylist(s,l),h=f.levels,p=f.sessionData;if(h.length){var g=h.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),m=h.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),v=u.default.parseMasterPlaylistMedia(s,l,"AUDIO",g),y=u.default.parseMasterPlaylistMedia(s,l,"SUBTITLES",m),E=u.default.parseMasterPlaylistMedia(s,l,"CLOSED-CAPTIONS");v.length&&(v.some((function(e){return!e.url}))||!h[0].audioCodec||h[0].attrs.AUDIO||(o.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new c.AttrList({}),bitrate:0,url:""}))),a.trigger(i.Events.MANIFEST_LOADED,{levels:h,audioTracks:v,subtitles:y,captions:E,url:l,stats:t,networkDetails:r,sessionData:p})}else this.handleManifestParsingError(e,n,"no level found in manifest",r)},t.handleTrackOrLevelPlaylist=function(e,t,n,o){var s=this.hls,f=n.id,h=n.level,p=n.type,g=d(e,n),m=Object(r.isFiniteNumber)(f)?f:0,v=Object(r.isFiniteNumber)(h)?h:m,y=function(e){switch(e.type){case l.PlaylistContextType.AUDIO_TRACK:return l.PlaylistLevelType.AUDIO;case l.PlaylistContextType.SUBTITLE_TRACK:return l.PlaylistLevelType.SUBTITLE;default:return l.PlaylistLevelType.MAIN}}(n),E=u.default.parseLevelPlaylist(e.data,g,v,y,m);if(E.fragments.length){if(p===l.PlaylistContextType.MANIFEST){var T={attrs:new c.AttrList({}),bitrate:0,details:E,name:"",url:g};s.trigger(i.Events.MANIFEST_LOADED,{levels:[T],audioTracks:[],url:g,stats:t,networkDetails:o,sessionData:null})}if(t.parsing.end=performance.now(),E.needSidxRanges){var _,b=null===(_=E.fragments[0].initSegment)||void 0===_?void 0:_.url;this.load({url:b,isSidxRequest:!0,type:p,level:h,levelDetails:E,id:f,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else n.levelDetails=E,this.handlePlaylistLoaded(e,t,n,o)}else s.trigger(i.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:g,reason:"no fragments found in level",level:"number"==typeof n.level?n.level:void 0})},t.handleSidxRequest=function(e,t){var n=Object(s.parseSegmentIndex)(new Uint8Array(e.data));if(n){var r=n.references,i=t.levelDetails;r.forEach((function(e,t){var r=e.info,a=i.fragments[t];0===a.byteRange.length&&a.setByteRange(String(1+r.end-r.start)+"@"+String(r.start)),a.initSegment&&a.initSegment.setByteRange(String(n.moovEndOffset)+"@0")}))}},t.handleManifestParsingError=function(e,t,n,r){this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:t.type===l.PlaylistContextType.MANIFEST,url:e.url,reason:n,response:e,context:t,networkDetails:r})},t.handleNetworkError=function(e,t,n,r){void 0===n&&(n=!1),o.logger.warn("[playlist-loader]: A network "+(n?"timeout":"error")+" occurred while loading "+e.type+" level: "+e.level+" id: "+e.id+' group-id: "'+e.groupId+'"');var s=a.ErrorDetails.UNKNOWN,u=!1,c=this.getInternalLoader(e);switch(e.type){case l.PlaylistContextType.MANIFEST:s=n?a.ErrorDetails.MANIFEST_LOAD_TIMEOUT:a.ErrorDetails.MANIFEST_LOAD_ERROR,u=!0;break;case l.PlaylistContextType.LEVEL:s=n?a.ErrorDetails.LEVEL_LOAD_TIMEOUT:a.ErrorDetails.LEVEL_LOAD_ERROR,u=!1;break;case l.PlaylistContextType.AUDIO_TRACK:s=n?a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case l.PlaylistContextType.SUBTITLE_TRACK:s=n?a.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:a.ErrorDetails.SUBTITLE_LOAD_ERROR,u=!1}c&&this.resetInternalLoader(e.type);var d={type:a.ErrorTypes.NETWORK_ERROR,details:s,fatal:u,url:e.url,loader:c,context:e,networkDetails:t};r&&(d.response=r),this.hls.trigger(i.Events.ERROR,d)},t.handlePlaylistLoaded=function(e,t,n,r){var a=n.type,o=n.level,s=n.id,u=n.groupId,c=n.loader,d=n.levelDetails,f=n.deliveryDirectives;if(null!=d&&d.targetduration){if(c)switch(d.live&&(c.getCacheAge&&(d.ageHeader=c.getCacheAge()||0),c.getCacheAge&&!isNaN(d.ageHeader)||(d.ageHeader=0)),a){case l.PlaylistContextType.MANIFEST:case l.PlaylistContextType.LEVEL:this.hls.trigger(i.Events.LEVEL_LOADED,{details:d,level:o||0,id:s||0,stats:t,networkDetails:r,deliveryDirectives:f});break;case l.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(i.Events.AUDIO_TRACK_LOADED,{details:d,id:s||0,groupId:u||"",stats:t,networkDetails:r,deliveryDirectives:f});break;case l.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(i.Events.SUBTITLE_TRACK_LOADED,{details:d,id:s||0,groupId:u||"",stats:t,networkDetails:r,deliveryDirectives:f})}}else this.handleManifestParsingError(e,n,"invalid target duration",r)},e}();t.default=f},"./src/polyfills/number.ts":
/*!*********************************!*\
  !*** ./src/polyfills/number.ts ***!
  \*********************************/
/*! exports provided: isFiniteNumber, MAX_SAFE_INTEGER */function(e,t,n){"use strict";n.r(t),n.d(t,"isFiniteNumber",(function(){return r})),n.d(t,"MAX_SAFE_INTEGER",(function(){return i}));var r=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":
/*!*********************************!*\
  !*** ./src/remux/aac-helper.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}();t.default=r},"./src/remux/mp4-generator.ts":
/*!************************************!*\
  !*** ./src/remux/mp4-generator.ts ***!
  \************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=Math.pow(2,32)-1,i=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,u,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))},e.box=function(e){for(var t=8,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=r.length,o=a;a--;)t+=r[a].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),a=0,t=8;a<o;a++)s.set(r[a],t),t+=r[a].byteLength;return s},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,n){n*=t;var i=Math.floor(n/(r+1)),a=Math.floor(n%(r+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))},e.moov=function(t){for(var n=t.length,r=[];n--;)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))},e.mvex=function(t){for(var n=t.length,r=[];n--;)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))},e.mvhd=function(t,n){n*=t;var i=Math.floor(n/(r+1)),a=Math.floor(n%(r+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)},e.sdtp=function(t){var n,r,i=t.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,a[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var n,r,i,a=[],o=[];for(n=0;n<t.sps.length;n++)i=(r=t.sps[n]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)i=(r=t.pps[n]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),u=t.width,l=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var n=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var n=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var n=t.id,i=t.duration*t.timescale,a=t.width,o=t.height,s=Math.floor(i/(r+1)),u=Math.floor(i%(r+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,u>>24,u>>16&255,u>>8&255,255&u,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))},e.traf=function(t,n){var i=e.sdtp(t),a=t.id,o=Math.floor(n/(r+1)),s=Math.floor(n%(r+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,n){var r,i,a,o,s,u,l=t.samples||[],c=l.length,d=12+16*c,f=new Uint8Array(d);for(n+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<c;r++)a=(i=l[r]).duration,o=i.size,s=i.flags,u=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*r);return e.box(e.types.trun,f)},e.initSegment=function(t){e.types||e.init();var n=e.moov(t),r=new Uint8Array(e.FTYP.byteLength+n.byteLength);return r.set(e.FTYP),r.set(n,e.FTYP.byteLength),r},e}();i.types=void 0,i.HDLR_TYPES=void 0,i.STTS=void 0,i.STSC=void 0,i.STCO=void 0,i.STSZ=void 0,i.VMHD=void 0,i.SMHD=void 0,i.STSD=void 0,i.FTYP=void 0,i.DINF=void 0,t.default=i},"./src/remux/mp4-remuxer.ts":
/*!**********************************!*\
  !*** ./src/remux/mp4-remuxer.ts ***!
  \**********************************/
/*! exports provided: default, normalizePts */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g})),n.d(t,"normalizePts",(function(){return m}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ./aac-helper */"./src/remux/aac-helper.ts"),a=n(/*! ./mp4-generator */"./src/remux/mp4-generator.ts"),o=n(/*! ../events */"./src/events.ts"),s=n(/*! ../errors */"./src/errors.ts"),u=n(/*! ../utils/logger */"./src/utils/logger.ts"),l=n(/*! ../types/loader */"./src/types/loader.ts"),c=n(/*! ../utils/timescale-conversion */"./src/utils/timescale-conversion.ts");function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f=null,h=null,p=!1,g=function(){function e(e,t,n,r){if(void 0===r&&(r=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===f){var i=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);f=i?parseInt(i[1]):0}if(null===h){var a=navigator.userAgent.match(/Safari\/(\d+)/i);h=a?parseInt(a[1]):0}p=!!f&&f<75||!!h&&h<600}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){u.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},t.resetNextTimestamp=function(){u.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},t.resetInitSegment=function(){u.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,n=e.reduce((function(e,n){var r=n.pts-e;return r<-4294967296?(t=!0,m(e,n.pts)):r>0?e:n.pts}),e[0].pts);return t&&u.logger.debug("PTS rollover detected"),n},t.remux=function(e,t,n,r,i,a,o,s){var c,d,f,h,p,g,v=i,y=i,E=e.pid>-1,T=t.pid>-1,_=t.samples.length,b=e.samples.length>0,A=_>1;if((!E||b)&&(!T||A)||this.ISGenerated||o){this.ISGenerated||(f=this.generateIS(e,t,i));var S=this.isVideoContiguous,w=-1;if(A&&(w=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!S&&this.config.forceKeyFrameOnDiscontinuity))if(g=!0,w>0){u.logger.warn("[mp4-remuxer]: Dropped "+w+" out of "+_+" video samples due to a missing keyframe");var I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(w),t.dropped+=w,y+=(t.samples[0].pts-I)/(t.timescale||9e4)}else-1===w&&(u.logger.warn("[mp4-remuxer]: No keyframe found out of "+_+" video samples"),g=!1);if(this.ISGenerated){if(b&&A){var R=this.getVideoStartPts(t.samples),C=(m(e.samples[0].pts,R)-R)/t.inputTimeScale;v+=Math.max(0,C),y+=Math.max(0,-C)}if(b){if(e.samplerate||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),f=this.generateIS(e,t,i)),d=this.remuxAudio(e,v,this.isAudioContiguous,a,T||A||s===l.PlaylistLevelType.AUDIO?y:void 0),A){var D=d?d.endPTS-d.startPTS:0;t.inputTimeScale||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),f=this.generateIS(e,t,i)),c=this.remuxVideo(t,y,S,D)}}else A&&(c=this.remuxVideo(t,y,S,0));c&&(c.firstKeyFrame=w,c.independent=-1!==w)}}return this.ISGenerated&&(n.samples.length&&(p=this.remuxID3(n,i)),r.samples.length&&(h=this.remuxText(r,i))),{audio:d,video:c,initSegment:f,independent:g,text:h,id3:p}},t.generateIS=function(e,t,n){var i,o,s,u=e.samples,l=t.samples,c=this.typeSupported,d={},f=!Object(r.isFiniteNumber)(this._initPTS),h="audio/mp4";if(f&&(i=o=1/0),e.config&&u.length&&(e.timescale=e.samplerate,e.isAAC||(c.mpeg?(h="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),d.audio={id:"audio",container:h,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array(0):a.default.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(s=e.inputTimeScale,i=o=u[0].pts-Math.round(s*n))),t.sps&&t.pps&&l.length&&(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:a.default.initSegment([t]),metadata:{width:t.width,height:t.height}},f)){s=t.inputTimeScale;var p=this.getVideoStartPts(l),g=Math.round(s*n);o=Math.min(o,m(l[0].dts,p)-g),i=Math.min(i,p-g)}if(Object.keys(d).length)return this.ISGenerated=!0,f&&(this._initPTS=i,this._initDTS=o),{tracks:d,initPTS:i,timescale:s}},t.remuxVideo=function(e,t,n,r){var i,l,h,g=e.inputTimeScale,y=e.samples,E=[],T=y.length,_=this._initPTS,b=this.nextAvcDts,A=8,S=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY,I=0,R=!1;n&&null!==b||(b=t*g-(y[0].pts-m(y[0].dts,y[0].pts)));for(var C=0;C<T;C++){var D=y[C];D.pts=m(D.pts-_,b),D.dts=m(D.dts-_,b),D.dts>D.pts&&(I=Math.max(Math.min(I,D.pts-D.dts),-18e3)),D.dts<y[C>0?C-1:C].dts&&(R=!0)}R&&y.sort((function(e,t){var n=e.dts-t.dts,r=e.pts-t.pts;return n||r})),l=y[0].dts,h=y[y.length-1].dts;var M=Math.round((h-l)/(T-1));if(I<0){if(I<-2*M){u.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(c.toMsFromMpegTsClock)(-M,!0)+" ms");for(var L=I,N=0;N<T;N++)y[N].dts=L=Math.max(L,y[N].pts-M),y[N].pts=Math.max(L,y[N].pts)}else{u.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(c.toMsFromMpegTsClock)(I,!0)+" ms to overcome this issue");for(var x=0;x<T;x++)y[x].dts=y[x].dts+I}l=y[0].dts}if(n){var O=l-b,P=O>M;if(P||O<-1){P?u.logger.warn("AVC: "+Object(c.toMsFromMpegTsClock)(O,!0)+" ms ("+O+"dts) hole between fragments detected, filling it"):u.logger.warn("AVC: "+Object(c.toMsFromMpegTsClock)(-O,!0)+" ms ("+O+"dts) overlapping between fragments detected"),l=b;var k=y[0].pts-O;y[0].dts=l,y[0].pts=k,u.logger.log("Video: First PTS/DTS adjusted: "+Object(c.toMsFromMpegTsClock)(k,!0)+"/"+Object(c.toMsFromMpegTsClock)(l,!0)+", delta: "+Object(c.toMsFromMpegTsClock)(O,!0)+" ms")}}p&&(l=Math.max(0,l));for(var F=0,U=0,B=0;B<T;B++){for(var G=y[B],j=G.units,H=j.length,K=0,Y=0;Y<H;Y++)K+=j[Y].data.length;U+=K,F+=H,G.length=K,G.dts=Math.max(G.dts,l),G.pts=Math.max(G.pts,G.dts,0),S=Math.min(G.pts,S),w=Math.max(G.pts,w)}h=y[T-1].dts;var V,q=U+4*F+8;try{V=new Uint8Array(q)}catch(e){return void this.observer.emit(o.Events.ERROR,o.Events.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:q,reason:"fail allocating video mdat "+q})}var W=new DataView(V.buffer);W.setUint32(0,q),V.set(a.default.types.mdat,4);for(var z=0;z<T;z++){for(var X=y[z],Q=X.units,J=0,Z=0,$=Q.length;Z<$;Z++){var ee=Q[Z],te=ee.data,ne=ee.data.byteLength;W.setUint32(A,ne),A+=4,V.set(te,A),A+=ne,J+=4+ne}if(z<T-1)i=y[z+1].dts-X.dts;else{var re=this.config,ie=X.dts-y[z>0?z-1:z].dts;if(re.stretchShortVideoTrack&&null!==this.nextAudioPts){var ae=Math.floor(re.maxBufferHole*g),oe=(r?S+r*g:this.nextAudioPts)-X.pts;oe>ae?((i=oe-ie)<0&&(i=ie),u.logger.log("[mp4-remuxer]: It is approximately "+oe/90+" ms to the next segment; using duration "+i/90+" ms for the last video frame.")):i=ie}else i=ie}var se=Math.round(X.pts-X.dts);E.push(new v(X.key,i,J,se))}if(E.length&&f&&f<70){var ue=E[0].flags;ue.dependsOn=2,ue.isNonSync=0}console.assert(void 0!==i,"mp4SampleDuration must be computed"),this.nextAvcDts=b=h+i,this.isVideoContiguous=!0;var le={data1:a.default.moof(e.sequenceNumber++,l,d({},e,{samples:E})),data2:V,startPTS:S/g,endPTS:(w+i)/g,startDTS:l/g,endDTS:b/g,type:"video",hasAudio:!1,hasVideo:!0,nb:E.length,dropped:e.dropped};return e.samples=[],e.dropped=0,console.assert(V.length,"MDAT length must not be zero"),le},t.remuxAudio=function(e,t,n,r,l){var c,f=e.inputTimeScale,h=f/(e.samplerate?e.samplerate:f),p=e.isAAC?1024:1152,g=p*h,y=this._initPTS,E=!e.isAAC&&this.typeSupported.mpeg,T=[],_=e.samples,b=E?0:8,A=this.nextAudioPts||-1,S=t*f;if(this.isAudioContiguous=n=n||_.length&&A>0&&(r&&Math.abs(S-A)<9e3||Math.abs(m(_[0].pts-y,S)-A)<20*g),_.forEach((function(e){e.pts=e.dts=m(e.pts-y,S)})),!n||A<0){if(!(_=_.filter((function(e){return e.pts>=0}))).length)return;A=0===l?0:r?Math.max(0,S):_[0].pts}if(e.isAAC)for(var w=void 0!==l,I=this.config.maxAudioFramesDrift,R=0,C=A;R<_.length;R++){var D=_[R],M=D.pts,L=M-C,N=Math.abs(1e3*L/f);if(L<=-I*g&&w)0===R&&(u.logger.warn("Audio frame @ "+(M/f).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*L/f)+" ms."),this.nextAudioPts=A=M),C=M;else if(L>=I*g&&N<1e4&&w){var x=Math.round(L/g);(C=M-x*g)<0&&(x--,C+=g),0===R&&(this.nextAudioPts=A=C),u.logger.warn("[mp4-remuxer]: Injecting "+x+" audio frame @ "+(C/f).toFixed(3)+"s due to "+Math.round(1e3*L/f)+" ms gap.");for(var O=0;O<x;O++){var P=Math.max(C,0);(c=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(u.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),c=D.unit.subarray()),_.splice(R,0,{unit:c,pts:P,dts:P}),C+=g,R++}}D.pts=D.dts=C,C+=g}for(var k,F=null,U=null,B=0,G=_.length;G--;)B+=_[G].unit.byteLength;for(var j=0,H=_.length;j<H;j++){var K=_[j],Y=K.unit,V=K.pts;if(null!==U)T[j-1].duration=Math.round((V-U)/h);else{if(n&&e.isAAC&&(V=A),F=V,!(B>0))return;B+=b;try{k=new Uint8Array(B)}catch(e){return void this.observer.emit(o.Events.ERROR,o.Events.ERROR,{type:s.ErrorTypes.MUX_ERROR,details:s.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}E||(new DataView(k.buffer).setUint32(0,B),k.set(a.default.types.mdat,4))}k.set(Y,b);var q=Y.byteLength;b+=q,T.push(new v(!0,p,q,0)),U=V}var W=T.length;if(W){var z=T[T.length-1];this.nextAudioPts=A=U+h*z.duration;var X=E?new Uint8Array(0):a.default.moof(e.sequenceNumber++,F/h,d({},e,{samples:T}));e.samples=[];var Q=F/f,J=A/f,Z={data1:X,data2:k,startPTS:Q,endPTS:J,startDTS:Q,endDTS:J,type:"audio",hasAudio:!0,hasVideo:!1,nb:W};return this.isAudioContiguous=!0,console.assert(k.length,"MDAT length must not be zero"),Z}},t.remuxEmptyAudio=function(e,t,n,r){var a=e.inputTimeScale,o=a/(e.samplerate?e.samplerate:a),s=this.nextAudioPts,l=(null!==s?s:r.startDTS*a)+this._initDTS,c=r.endDTS*a+this._initDTS,d=1024*o,f=Math.ceil((c-l)/d),h=i.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(u.logger.warn("[mp4-remuxer]: remux empty Audio"),h){for(var p=[],g=0;g<f;g++){var m=l+g*d;p.push({unit:h,pts:m,dts:m})}return e.samples=p,this.remuxAudio(e,t,n,!1)}u.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},t.remuxID3=function(e,t){var n=e.samples.length;if(n){for(var r=e.inputTimeScale,i=this._initPTS,a=this._initDTS,o=0;o<n;o++){var s=e.samples[o];s.pts=m(s.pts-i,t*r)/r,s.dts=m(s.dts-a,t*r)/r}var u=e.samples;return e.samples=[],{samples:u}}},t.remuxText=function(e,t){var n=e.samples.length;if(n){for(var r=e.inputTimeScale,i=this._initPTS,a=0;a<n;a++){var o=e.samples[a];o.pts=m(o.pts-i,t*r)/r}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}},e}();function m(e,t){var n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}var v=function(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags=new y(e)},y=function(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}},"./src/remux/passthrough-remuxer.ts":
/*!******************************************!*\
  !*** ./src/remux/passthrough-remuxer.ts ***!
  \******************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),a=n(/*! ../loader/fragment */"./src/loader/fragment.ts"),o=n(/*! ../utils/logger */"./src/utils/logger.ts"),s=function(){function e(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this.initPTS=e,this.lastEndDTS=null},t.resetNextTimestamp=function(){this.lastEndDTS=null},t.resetInitSegment=function(e,t,n){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e),this.emitInitSegment=!0},t.generateInitSegment=function(e){var t=this.audioCodec,n=this.videoCodec;if(!e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var r=this.initData=Object(i.parseInitSegment)(e);t||(t=l(r.audio,a.ElementaryStreamTypes.AUDIO)),n||(n=l(r.video,a.ElementaryStreamTypes.VIDEO));var s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:o.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s},t.remux=function(e,t,n,a,s){var l=this.initPTS,c=this.lastEndDTS,d={audio:void 0,video:void 0,text:a,id3:n,initSegment:void 0};Object(r.isFiniteNumber)(c)||(c=this.lastEndDTS=s||0);var f=t.samples;if(!f||!f.length)return d;var h={initPTS:void 0,timescale:1},p=this.initData;if(p&&p.length||(this.generateInitSegment(f),p=this.initData),!p||!p.length)return o.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1),Object(r.isFiniteNumber)(l)||(this.initPTS=h.initPTS=l=u(p,f,c));var g=Object(i.getDuration)(f,p),m=c,v=g+m;Object(i.offsetStartDTS)(p,f,l),g>0?this.lastEndDTS=v:(o.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var y=!!p.audio,E=!!p.video,T="";y&&(T+="audio"),E&&(T+="video");var _={data1:f,startPTS:m,startDTS:m,endPTS:v,endDTS:v,type:T,hasAudio:y,hasVideo:E,nb:1,dropped:0};return d.audio="audio"===_.type?_:void 0,d.video="audio"!==_.type?_:void 0,d.text=a,d.id3=n,d.initSegment=h,d},e}(),u=function(e,t,n){return Object(i.getStartDTS)(e,t)-n};function l(e,t){var n=null==e?void 0:e.codec;return n&&n.length>4?n:"hvc1"===n?"hvc1.1.c.L120.90":"av01"===n?"av01.0.04M.08":"avc1"===n||t===a.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}t.default=s},"./src/task-loop.ts":
/*!**************************!*\
  !*** ./src/task-loop.ts ***!
  \**************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var r=function(){function e(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},e}()},"./src/types/level.ts":
/*!****************************!*\
  !*** ./src/types/level.ts ***!
  \****************************/
/*! exports provided: HlsSkip, getSkipValue, HlsUrlParameters, Level */function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i;function a(e,t){var n=e.canSkipUntil,r=e.canSkipDateRanges,a=e.endSN;return n&&(void 0!==t?t-a:0)<n?r?i.v2:i.Yes:i.No}n.r(t),n.d(t,"HlsSkip",(function(){return i})),n.d(t,"getSkipValue",(function(){return a})),n.d(t,"HlsUrlParameters",(function(){return o})),n.d(t,"Level",(function(){return s})),function(e){e.No="",e.Yes="YES",e.v2="v2"}(i||(i={}));var o=function(){function e(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.toString()},e}(),s=function(){function e(e){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this.attrs=e.attrs,this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return e})).join(",").replace(/\.[^.,]+/g,"")}var t,n;return t=e,(n=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(e){var t=e%this.url.length;this._urlId!==t&&(this.details=void 0,this._urlId=t)}}])&&r(t.prototype,n),e}()},"./src/types/loader.ts":
/*!*****************************!*\
  !*** ./src/types/loader.ts ***!
  \*****************************/
/*! exports provided: PlaylistContextType, PlaylistLevelType */function(e,t,n){"use strict";var r,i;n.r(t),n.d(t,"PlaylistContextType",(function(){return r})),n.d(t,"PlaylistLevelType",(function(){return i})),function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(r||(r={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(i||(i={}))},"./src/types/transmuxer.ts":
/*!*********************************!*\
  !*** ./src/types/transmuxer.ts ***!
  \*********************************/
/*! exports provided: ChunkMetadata */function(e,t,n){"use strict";n.r(t),n.d(t,"ChunkMetadata",(function(){return r}));var r=function(e,t,n,r,i,a){void 0===r&&(r=0),void 0===i&&(i=-1),void 0===a&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=i,this.partial=a}},"./src/utils/attr-list.ts":
/*!********************************!*\
  !*** ./src/utils/attr-list.ts ***!
  \********************************/
/*! exports provided: AttrList */function(e,t,n){"use strict";n.r(t),n.d(t,"AttrList",(function(){return a}));var r=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,a=function(){function e(t){for(var n in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(n)&&(this[n]=t[n])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var n=this[e];return n?parseFloat(n):t},t.enumeratedString=function(e){return this[e]},t.bool=function(e){return"YES"===this[e]},t.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,n={};for(i.lastIndex=0;null!==(t=i.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n},e}()},"./src/utils/binary-search.ts":
/*!************************************!*\
  !*** ./src/utils/binary-search.ts ***!
  \************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default={search:function(e,t){for(var n=0,r=e.length-1,i=null,a=null;n<=r;){var o=t(a=e[i=(n+r)/2|0]);if(o>0)n=i+1;else{if(!(o<0))return a;r=i-1}}return null}}},"./src/utils/buffer-helper.ts":
/*!************************************!*\
  !*** ./src/utils/buffer-helper.ts ***!
  \************************************/
/*! exports provided: BufferHelper */function(e,t,n){"use strict";n.r(t),n.d(t,"BufferHelper",(function(){return a}));var r=n(/*! ../utils/logger */"./src/utils/logger.ts"),i={length:0,start:function(){return 0},end:function(){return 0}},a=function(){function e(){}return e.isBuffered=function(t,n){try{if(t)for(var r=e.getBuffered(t),i=0;i<r.length;i++)if(n>=r.start(i)&&n<=r.end(i))return!0}catch(e){}return!1},e.bufferInfo=function(t,n,r){try{if(t){var i,a=e.getBuffered(t),o=[];for(i=0;i<a.length;i++)o.push({start:a.start(i),end:a.end(i)});return this.bufferedInfo(o,n,r)}}catch(e){}return{len:0,start:n,end:n,nextStart:void 0}},e.bufferedInfo=function(e,t,n){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var r=[];if(n)for(var i=0;i<e.length;i++){var a=r.length;if(a){var o=r[a-1].end;e[i].start-o<n?e[i].end>o&&(r[a-1].end=e[i].end):r.push(e[i])}else r.push(e[i])}else r=e;for(var s,u=0,l=t,c=t,d=0;d<r.length;d++){var f=r[d].start,h=r[d].end;if(t+n>=f&&t<h)l=f,u=(c=h)-t;else if(t+n<f){s=f;break}}return{len:u,start:l||0,end:c||0,nextStart:s}},e.getBuffered=function(e){try{return e.buffered}catch(e){return r.logger.log("failed to get media.buffered",e),i}},e}()},"./src/utils/cea-608-parser.ts":
/*!*************************************!*\
  !*** ./src/utils/cea-608-parser.ts ***!
  \*************************************/
/*! exports provided: Row, CaptionScreen, default */function(e,t,n){"use strict";n.r(t),n.d(t,"Row",(function(){return m})),n.d(t,"CaptionScreen",(function(){return v}));var r,i=n(/*! ../utils/logger */"./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(e){var t=e;return a.hasOwnProperty(e)&&(t=a[e]),String.fromCharCode(t)},s={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},l={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},c={25:2,26:4,29:6,30:8,31:10,27:13,28:15},d=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(r||(r={}));var f=function(){function e(){this.time=null,this.verboseLevel=r.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&i.logger.log(this.time+" ["+e+"] "+t)},e}(),h=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},p=function(){function e(e,t,n,r,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),g=function(){function e(e,t,n,r,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new p(t,n,r,i,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),m=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<100;t++)this.chars.push(new g);this.logger=e,this.pos=0,this.currPenState=new p}var t=e.prototype;return t.equals=function(e){for(var t=!0,n=0;n<100;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(r.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(r.DEBUG,"Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=o(e);this.pos>=100?this.logger.log(r.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,n=0;n<100;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),v=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<15;t++)this.rows.push(new m(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(r.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(r.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<15;n++)this.rows[n].clear();var i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var o=a.rows[i].cueStartTime,s=this.logger.time;if(o&&null!==s&&o<s)for(var u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[i+u])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var c=e.indent,d=Math.max(c-1,0);l.setCursor(e.indent),e.color=l.chars[d].penState.foreground}var f={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(f)},t.setBkgData=function(e){this.logger.log(r.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(r.TEXT,this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(r.INFO,"Rolling up")}else this.logger.log(r.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},t.getTextAndFormat=function(){return this.rows},e}(),y=function(){function e(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new v(n),this.nonDisplayedMemory=new v(n),this.lastOutputScreen=new v(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(r.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(r.INFO,n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(r.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(r.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(r.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(r.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(r.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(r.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(r.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(r.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(r.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(r.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(r.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(r.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(r.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(r.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(r.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}this.logger.log(r.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),E=function(){function e(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var r=new f;this.channels=[null,new y(e,t,r),new y(e+1,n,r)],this.cmdHistory={a:null,b:null},this.logger=r}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var n,i,a,o=!1;this.logger.time=e;for(var s=0;s<t.length;s+=2)if(i=127&t[s],a=127&t[s+1],0!==i||0!==a){if(this.logger.log(r.DATA,"["+h([t[s],t[s+1]])+"] -> ("+h([i,a])+")"),(n=this.parseCmd(i,a))||(n=this.parseMidrow(i,a)),n||(n=this.parsePAC(i,a)),n||(n=this.parseBackgroundAttributes(i,a)),!n&&(o=this.parseChars(i,a))){var u=this.currentChannel;u&&u>0?this.channels[u].insertChars(o):this.logger.log(r.WARNING,"No channel found yet. TEXT-MODE?")}n||o||this.logger.log(r.WARNING,"Couldn't parse cleaned data "+h([i,a])+" orig: "+h([t[s],t[s+1]]))}},t.parseCmd=function(e,t){var n=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(_(e,t,n))return T(null,null,n),this.logger.log(r.DEBUG,"Repeated command ("+h([e,t])+") is dropped"),!0;var i=20===e||21===e||23===e?1:2,a=this.channels[i];return 20===e||21===e||28===e||29===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),T(e,t,n),this.currentChannel=i,!0},t.parseMidrow=function(e,t){var n=0;if((17===e||25===e)&&t>=32&&t<=47){if((n=17===e?1:2)!==this.currentChannel)return this.logger.log(r.ERROR,"Mismatch channel in midrow parsing"),!1;var i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(r.DEBUG,"MIDROW ("+h([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var n,r=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(_(e,t,r))return T(null,null,r),!0;var i=e<=23?1:2;n=t>=64&&t<=95?1===i?s[e]:l[e]:1===i?u[e]:c[e];var a=this.channels[i];return!!a&&(a.setPAC(this.interpretPAC(n,t)),T(e,t,r),this.currentChannel=i,!0)},t.interpretPAC=function(e,t){var n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},t.parseChars=function(e,t){var n,i,a=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19?(i=17===s?t+80:18===s?t+112:t+144,this.logger.log(r.INFO,"Special char '"+o(i)+"' in channel "+n),a=[i]):e>=32&&e<=127&&(a=0===t?[e]:[e,t]),a){var u=h(a);this.logger.log(r.DEBUG,"Char codes =  "+u.join(",")),T(e,t,this.cmdHistory)}return a},t.parseBackgroundAttributes=function(e,t){var n;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var r={};16===e||24===e?(n=Math.floor((t-32)/2),r.background=d[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0));var i=e<=23?1:2;return this.channels[i].setBkgData(r),T(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var n=this.channels[t];n&&n.cueSplitAtTime(e)}},e}();function T(e,t,n){n.a=e,n.b=t}function _(e,t,n){return n.a===e&&n.b===t}t.default=E},"./src/utils/codecs.ts":
/*!*****************************!*\
  !*** ./src/utils/codecs.ts ***!
  \*****************************/
/*! exports provided: isCodecType, isCodecSupportedInMp4 */function(e,t,n){"use strict";n.r(t),n.d(t,"isCodecType",(function(){return i})),n.d(t,"isCodecSupportedInMp4",(function(){return a}));var r={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function i(e,t){var n=r[t];return!!n&&!0===n[e.slice(0,4)]}function a(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./src/utils/cues.ts":
/*!***************************!*\
  !*** ./src/utils/cues.ts ***!
  \***************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ./vttparser */"./src/utils/vttparser.ts"),i=n(/*! ./webvtt-parser */"./src/utils/webvtt-parser.ts"),a=n(/*! ./texttrack-utils */"./src/utils/texttrack-utils.ts"),o=/\s/,s={newCue:function(e,t,n,s){for(var u,l,c,d,f,h=[],p=self.VTTCue||self.TextTrackCue,g=0;g<s.rows.length;g++)if(c=!0,d=0,f="",!(u=s.rows[g]).isEmpty()){for(var m=0;m<u.chars.length;m++)o.test(u.chars[m].uchar)&&c?d++:(f+=u.chars[m].uchar,c=!1);u.cueStartTime=t,t===n&&(n+=1e-4),d>=16?d--:d++;var v=Object(r.fixLineBreaks)(f.trim()),y=Object(i.generateCueId)(t,n,v);e&&e.cues&&e.cues.getCueById(y)||((l=new p(t,n,v)).id=y,l.line=g+1,l.align="left",l.position=10+Math.min(80,10*Math.floor(8*d/32)),h.push(l))}return e&&h.length&&(h.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),h.forEach((function(t){return Object(a.addCueToTrack)(e,t)}))),h}};t.default=s},"./src/utils/discontinuities.ts":
/*!**************************************!*\
  !*** ./src/utils/discontinuities.ts ***!
  \**************************************/
/*! exports provided: findFirstFragWithCC, shouldAlignOnDiscontinuities, findDiscontinuousReferenceFrag, adjustSlidingStart, alignStream, alignPDT */function(e,t,n){"use strict";n.r(t),n.d(t,"findFirstFragWithCC",(function(){return o})),n.d(t,"shouldAlignOnDiscontinuities",(function(){return s})),n.d(t,"findDiscontinuousReferenceFrag",(function(){return u})),n.d(t,"adjustSlidingStart",(function(){return c})),n.d(t,"alignStream",(function(){return d})),n.d(t,"alignPDT",(function(){return f}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ./logger */"./src/utils/logger.ts"),a=n(/*! ../controller/level-helper */"./src/controller/level-helper.ts");function o(e,t){for(var n=null,r=0,i=e.length;r<i;r++){var a=e[r];if(a&&a.cc===t){n=a;break}}return n}function s(e,t,n){return!(!t.details||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}function u(e,t){var n=e.fragments,r=t.fragments;if(r.length&&n.length){var a=o(n,r[0].cc);if(a&&(!a||a.startPTS))return a;i.logger.log("No frag in previous level to align on")}else i.logger.log("No fragments to align")}function l(e,t){if(e){var n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function c(e,t){for(var n=t.fragments,r=0,i=n.length;r<i;r++)l(n[r],e);t.fragmentHint&&l(t.fragmentHint,e),t.alignedSliding=!0}function d(e,t,n){t&&(function(e,t,n){if(s(e,n,t)){var a=u(n.details,t);a&&Object(r.isFiniteNumber)(a.start)&&(i.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),c(a.start,t))}}(e,n,t),!n.alignedSliding&&t.details&&f(n,t.details),n.alignedSliding||!t.details||n.skippedSegments||Object(a.adjustSliding)(t.details,n))}function f(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var n=t.fragments[0].programDateTime,a=e.fragments[0].programDateTime,o=(a-n)/1e3+t.fragments[0].start;o&&Object(r.isFiniteNumber)(o)&&(i.logger.log("Adjusting PTS using programDateTime delta "+(a-n)+"ms, sliding:"+o.toFixed(3)+" "+e.url+" "),c(o,e))}}},"./src/utils/ewma-bandwidth-estimator.ts":
/*!***********************************************!*\
  !*** ./src/utils/ewma-bandwidth-estimator.ts ***!
  \***********************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../utils/ewma */"./src/utils/ewma.ts"),i=function(){function e(e,t,n){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new r.default(e),this.fast_=new r.default(t)}var t=e.prototype;return t.update=function(e,t){var n=this.slow_,i=this.fast_;this.slow_.halfLife!==e&&(this.slow_=new r.default(e,n.getEstimate(),n.getTotalWeight())),this.fast_.halfLife!==t&&(this.fast_=new r.default(t,i.getEstimate(),i.getTotalWeight()))},t.sample=function(e,t){var n=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/n;this.fast_.sample(n,r),this.slow_.sample(n,r)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();t.default=i},"./src/utils/ewma.ts":
/*!***************************!*\
  !*** ./src/utils/ewma.ts ***!
  \***************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}var t=e.prototype;return t.sample=function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}();t.default=r},"./src/utils/fetch-loader.ts":
/*!***********************************!*\
  !*** ./src/utils/fetch-loader.ts ***!
  \***********************************/
/*! exports provided: fetchSupported, default */function(e,t,n){"use strict";n.r(t),n.d(t,"fetchSupported",(function(){return d}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ../loader/load-stats */"./src/loader/load-stats.ts"),a=n(/*! ../demux/chunk-cache */"./src/demux/chunk-cache.ts");function o(e){var t="function"==typeof Map?new Map:void 0;return(o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return s(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)})(e)}function s(e,t,n){return(s=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&l(i,n.prototype),i}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}var f=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||h,this.controller=new self.AbortController,this.stats=new i.LoadStats}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},t.abortInternal=function(){var e=this.response;e&&e.ok||(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(e,t,n){var i=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var o=function(e,t){var n={method:"GET",mode:"cors",credentials:"same-origin",signal:t};return e.rangeEnd&&(n.headers=new self.Headers({Range:"bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)})),n}(e,this.controller.signal),s=n.onProgress,u="arraybuffer"===e.responseType,l=u?"byteLength":"length";this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout((function(){i.abortInternal(),n.onTimeout(a,e,i.response)}),t.timeout),self.fetch(this.request).then((function(n){if(i.response=i.loader=n,!n.ok){var o=n.status,l=n.statusText;throw new p(l||"fetch, bad network response",o,n)}return a.loading.first=Math.max(self.performance.now(),a.loading.start),a.total=parseInt(n.headers.get("Content-Length")||"0"),s&&Object(r.isFiniteNumber)(t.highWaterMark)?i.loadProgressively(n,a,e,t.highWaterMark,s):u?n.arrayBuffer():n.text()})).then((function(o){var u=i.response;self.clearTimeout(i.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first),a.loaded=a.total=o[l];var c={url:u.url,data:o};s&&!Object(r.isFiniteNumber)(t.highWaterMark)&&s(a,e,o,u),n.onSuccess(c,a,e,u)})).catch((function(t){if(self.clearTimeout(i.requestTimeout),!a.aborted){var r=t.code||0;n.onError({code:r,text:t.message},e,t.details)}}))},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.loadProgressively=function(e,t,n,r,i){void 0===r&&(r=0);var o=new a.default,s=e.body.getReader();return function a(){return s.read().then((function(s){if(s.done)return o.dataLength&&i(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));var u=s.value,l=u.length;return t.loaded+=l,l<r||o.dataLength?(o.push(u),o.dataLength>=r&&i(t,n,o.flush(),e)):i(t,n,u,e),a()})).catch((function(){return Promise.reject()}))}()},e}();function h(e,t){return new self.Request(e.url,t)}var p=function(e){var t,n;function r(t,n,r){var i;return(i=e.call(this,t)||this).code=void 0,i.details=void 0,i.code=n,i.details=r,i}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),r}(o(Error));t.default=f},"./src/utils/imsc1-ttml-parser.ts":
/*!****************************************!*\
  !*** ./src/utils/imsc1-ttml-parser.ts ***!
  \****************************************/
/*! exports provided: IMSC1_CODEC, parseIMSC1 */function(e,t,n){"use strict";n.r(t),n.d(t,"IMSC1_CODEC",(function(){return c})),n.d(t,"parseIMSC1",(function(){return p}));var r=n(/*! ./mp4-tools */"./src/utils/mp4-tools.ts"),i=n(/*! ./vttparser */"./src/utils/vttparser.ts"),a=n(/*! ./vttcue */"./src/utils/vttcue.ts"),o=n(/*! ../demux/id3 */"./src/demux/id3.ts"),s=n(/*! ./timescale-conversion */"./src/utils/timescale-conversion.ts"),u=n(/*! ./webvtt-parser */"./src/utils/webvtt-parser.ts");function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c="stpp.ttml.im1t",d=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,f=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,h={left:"start",center:"center",right:"end",start:"start",end:"end"};function p(e,t,n,i,c){var d=Object(r.findBox)(new Uint8Array(e),["mdat"]);if(0!==d.length){var f=d[0],p=Object(o.utf8ArrayToStr)(new Uint8Array(e,f.start,f.end-f.start)),T=Object(s.toTimescaleFromScale)(t,1,n);try{i(function(e,t){var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");var r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},i=Object.keys(r).reduce((function(e,t){return e[t]=n.getAttribute("ttp:"+t)||r[t],e}),{}),o="preserve"!==n.getAttribute("xml:space"),s=m(g(n,"styling","style")),c=m(g(n,"layout","region")),d=g(n,"body","[begin]");return[].map.call(d,(function(e){var n=function e(t,n){return[].slice.call(t.childNodes).reduce((function(t,r,i){var a;return"br"===r.nodeName&&i?t+"\n":null!==(a=r.childNodes)&&void 0!==a&&a.length?e(r,n):n?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent}),"")}(e,o);if(!n||!e.hasAttribute("begin"))return null;var r=E(e.getAttribute("begin"),i),d=E(e.getAttribute("dur"),i),f=E(e.getAttribute("end"),i);if(null===r)throw y(e);if(null===f){if(null===d)throw y(e);f=r+d}var p=new a.default(r-t,f-t,n);p.id=Object(u.generateCueId)(p.startTime,p.endTime,p.text);var g=c[e.getAttribute("region")],m=s[e.getAttribute("style")];p.position=10,p.size=80;var T=function(e,t){var n="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((function(r,i){var a=v(t,n,i)||v(e,n,i);return a&&(r[i]=a),r}),{})}(g,m),_=T.textAlign;if(_){var b=h[_];b&&(p.lineAlign=b),p.align=_}return l(p,T),p})).filter((function(e){return null!==e}))}(p,T))}catch(e){c(e)}}else c(new Error("Could not parse IMSC1 mdat"))}function g(e,t,n){var r=e.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(n)):[]}function m(e){return e.reduce((function(e,t){var n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function v(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function y(e){return new Error("Could not parse ttml timestamp "+e)}function E(e,t){if(!e)return null;var n=Object(i.parseTimeStamp)(e);return null===n&&(d.test(e)?n=function(e,t){var n=d.exec(e),r=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+r/t.frameRate}(e,t):f.test(e)&&(n=function(e,t){var n=f.exec(e),r=Number(n[1]);switch(n[2]){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/t.frameRate;case"t":return r/t.tickRate}return r}(e,t))),n}},"./src/utils/logger.ts":
/*!*****************************!*\
  !*** ./src/utils/logger.ts ***!
  \*****************************/
/*! exports provided: enableLogs, logger */function(e,t,n){"use strict";n.r(t),n.d(t,"enableLogs",(function(){return s})),n.d(t,"logger",(function(){return u}));var r=function(){},i={trace:r,debug:r,log:r,warn:r,info:r,error:r},a=i;function o(e){var t=self.console[e];return t?t.bind(self.console,"["+e+"] >"):r}function s(e){if(self.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){a[t]=e[t]?e[t].bind(e):o(t)}))}(e,"debug","log","info","warn","error");try{a.log()}catch(e){a=i}}else a=i}var u=i},"./src/utils/mediakeys-helper.ts":
/*!***************************************!*\
  !*** ./src/utils/mediakeys-helper.ts ***!
  \***************************************/
/*! exports provided: KeySystems, requestMediaKeySystemAccess */function(e,t,n){"use strict";var r;n.r(t),n.d(t,"KeySystems",(function(){return r})),n.d(t,"requestMediaKeySystemAccess",(function(){return i})),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(r||(r={}));var i="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":
/*!*****************************************!*\
  !*** ./src/utils/mediasource-helper.ts ***!
  \*****************************************/
/*! exports provided: getMediaSource */function(e,t,n){"use strict";function r(){return self.MediaSource||self.WebKitMediaSource}n.r(t),n.d(t,"getMediaSource",(function(){return r}))},"./src/utils/mp4-tools.ts":
/*!********************************!*\
  !*** ./src/utils/mp4-tools.ts ***!
  \********************************/
/*! exports provided: bin2str, readUint16, readUint32, writeUint32, findBox, parseSegmentIndex, parseInitSegment, getStartDTS, getDuration, computeRawDurationFromSamples, offsetStartDTS, segmentValidRange, appendUint8Array */function(e,t,n){"use strict";n.r(t),n.d(t,"bin2str",(function(){return s})),n.d(t,"readUint16",(function(){return u})),n.d(t,"readUint32",(function(){return l})),n.d(t,"writeUint32",(function(){return c})),n.d(t,"findBox",(function(){return d})),n.d(t,"parseSegmentIndex",(function(){return f})),n.d(t,"parseInitSegment",(function(){return h})),n.d(t,"getStartDTS",(function(){return p})),n.d(t,"getDuration",(function(){return g})),n.d(t,"computeRawDurationFromSamples",(function(){return m})),n.d(t,"offsetStartDTS",(function(){return v})),n.d(t,"segmentValidRange",(function(){return y})),n.d(t,"appendUint8Array",(function(){return E}));var r=n(/*! ./typed-array */"./src/utils/typed-array.ts"),i=n(/*! ../loader/fragment */"./src/loader/fragment.ts"),a=Math.pow(2,32)-1,o=[].push;function s(e){return String.fromCharCode.apply(null,e)}function u(e,t){"data"in e&&(t+=e.start,e=e.data);var n=e[t]<<8|e[t+1];return n<0?65536+n:n}function l(e,t){"data"in e&&(t+=e.start,e=e.data);var n=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return n<0?4294967296+n:n}function c(e,t,n){"data"in e&&(t+=e.start,e=e.data),e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function d(e,t){var n,r,i,a=[];if(!t.length)return a;"data"in e?(n=e.data,r=e.start,i=e.end):(r=0,i=(n=e).byteLength);for(var u=r;u<i;){var c=l(n,u),f=c>1?u+c:i;if(s(n.subarray(u+4,u+8))===t[0])if(1===t.length)a.push({data:n,start:u+8,end:f});else{var h=d({data:n,start:u+8,end:f},t.slice(1));h.length&&o.apply(a,h)}u=f}return a}function f(e){var t=d(e,["moov"])[0],n=t?t.end:null,r=d(e,["sidx"]);if(!r||!r[0])return null;var i=[],a=r[0],o=a.data[0],s=0===o?8:16,c=l(a,s);s+=4,s+=0===o?8:16,s+=2;var f=a.end+0,h=u(a,s);s+=2;for(var p=0;p<h;p++){var g=s,m=l(a,g);g+=4;var v=2147483647&m;if(1==(2147483648&m)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var y=l(a,g);g+=4,i.push({referenceSize:v,subsegmentDuration:y,info:{duration:y/c,start:f,end:f+v-1}}),f+=v,s=g+=4}return{earliestPresentationTime:0,timescale:c,version:o,referencesCount:h,references:i,moovEndOffset:n}}function h(e){for(var t=[],n=d(e,["moov","trak"]),r=0;r<n.length;r++){var a=n[r],o=d(a,["tkhd"])[0];if(o){var u=o.data[o.start],c=0===u?12:20,f=l(o,c),h=d(a,["mdia","mdhd"])[0];if(h){var p=l(h,c=0===(u=h.data[h.start])?12:20),g=d(a,["mdia","hdlr"])[0];if(g){var m=s(g.data.subarray(g.start+8,g.start+12)),v={soun:i.ElementaryStreamTypes.AUDIO,vide:i.ElementaryStreamTypes.VIDEO}[m];if(v){var y=d(a,["mdia","minf","stbl","stsd"])[0],E=void 0;y&&(E=s(y.data.subarray(y.start+12,y.start+16))),t[f]={timescale:p,type:v},t[v]={timescale:p,id:f,codec:E}}}}}}return d(e,["moov","mvex","trex"]).forEach((function(e){var n=l(e,4),r=t[n];r&&(r.default={duration:l(e,12),flags:l(e,20)})})),t}function p(e,t){return d(t,["moof","traf"]).reduce((function(t,n){var r=d(n,["tfdt"])[0],i=r.data[r.start],a=d(n,["tfhd"]).reduce((function(t,n){var a=l(n,4),o=e[a];if(o){var s=l(r,4);1===i&&(s*=Math.pow(2,32),s+=l(r,8));var u=s/(o.timescale||9e4);if(isFinite(u)&&(null===t||u<t))return u}return t}),null);return null!==a&&isFinite(a)&&(null===t||a<t)?a:t}),null)||0}function g(e,t){for(var n=0,r=0,a=0,o=d(e,["moof","traf"]),s=0;s<o.length;s++){var u=o[s],c=d(u,["tfhd"])[0],h=t[l(c,4)];if(h){var p=h.default,g=l(c,0)|(null==p?void 0:p.flags),v=null==p?void 0:p.duration;8&g&&(v=l(c,2&g?12:8));for(var y=h.timescale||9e4,E=d(u,["trun"]),T=0;T<E.length;T++)n=v?v*l(E[T],4):m(E[T]),h.type===i.ElementaryStreamTypes.VIDEO?r+=n/y:h.type===i.ElementaryStreamTypes.AUDIO&&(a+=n/y)}}if(0===r&&0===a){var _=f(e);if(null!=_&&_.references)return _.references.reduce((function(e,t){return e+t.info.duration||0}),0)}return r||a}function m(e){var t=l(e,0),n=8;1&t&&(n+=4),4&t&&(n+=4);for(var r=0,i=l(e,4),a=0;a<i;a++)256&t&&(r+=l(e,n),n+=4),512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4);return r}function v(e,t,n){d(t,["moof","traf"]).forEach((function(t){d(t,["tfhd"]).forEach((function(r){var i=l(r,4),o=e[i];if(o){var s=o.timescale||9e4;d(t,["tfdt"]).forEach((function(e){var t=e.data[e.start],r=l(e,4);if(0===t)c(e,4,r-n*s);else{r*=Math.pow(2,32),r+=l(e,8),r-=n*s,r=Math.max(r,0);var i=Math.floor(r/(a+1)),o=Math.floor(r%(a+1));c(e,4,i),c(e,8,o)}}))}}))}))}function y(e){var t={valid:null,remainder:null},n=d(e,["moof"]);if(!n)return t;if(n.length<2)return t.remainder=e,t;var i=n[n.length-1];return t.valid=Object(r.sliceUint8)(e,0,i.start-8),t.remainder=Object(r.sliceUint8)(e,i.start-8),t}function E(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}},"./src/utils/output-filter.ts":
/*!************************************!*\
  !*** ./src/utils/output-filter.ts ***!
  \************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var r=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}()},"./src/utils/texttrack-utils.ts":
/*!**************************************!*\
  !*** ./src/utils/texttrack-utils.ts ***!
  \**************************************/
/*! exports provided: sendAddTrackEvent, addCueToTrack, clearCurrentCues, removeCuesInRange, getCuesInRange */function(e,t,n){"use strict";n.r(t),n.d(t,"sendAddTrackEvent",(function(){return i})),n.d(t,"addCueToTrack",(function(){return a})),n.d(t,"clearCurrentCues",(function(){return o})),n.d(t,"removeCuesInRange",(function(){return s})),n.d(t,"getCuesInRange",(function(){return u}));var r=n(/*! ./logger */"./src/utils/logger.ts");function i(e,t){var n;try{n=new Event("addtrack")}catch(e){(n=document.createEvent("Event")).initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function a(e,t){var n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(n){r.logger.debug("[texttrack-utils]: "+n);var i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i)}"disabled"===n&&(e.mode=n)}function o(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues){for(var n=e.cues.length;n--;)e.removeCue(e.cues[n]);"disabled"===t&&(e.mode=t)}}function s(e,t,n){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length){for(var i=u(e.cues,t,n),a=0;a<i.length;a++)e.removeCue(i[a]);"disabled"===r&&(e.mode=r)}}function u(e,t,n){var r=[],i=function(e,t){if(t<e[0].startTime)return 0;var n=e.length-1;if(t>e[n].endTime)return-1;for(var r=0,i=n;r<=i;){var a=Math.floor((i+r)/2);if(t<e[a].startTime)i=a-1;else{if(!(t>e[a].startTime&&r<n))return a;r=a+1}}return e[r].startTime-t<t-e[i].startTime?r:i}(e,t);if(i>-1)for(var a=i,o=e.length;a<o;a++){var s=e[a];if(s.startTime>=t&&s.endTime<=n)r.push(s);else if(s.startTime>n)return r}return r}},"./src/utils/time-ranges.ts":
/*!**********************************!*\
  !*** ./src/utils/time-ranges.ts ***!
  \**********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default={toString:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}}},"./src/utils/timescale-conversion.ts":
/*!*******************************************!*\
  !*** ./src/utils/timescale-conversion.ts ***!
  \*******************************************/
/*! exports provided: toTimescaleFromBase, toTimescaleFromScale, toMsFromMpegTsClock, toMpegTsClockFromTimescale */function(e,t,n){"use strict";function r(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=!1);var i=e*t*n;return r?Math.round(i):i}function i(e,t,n,i){return void 0===n&&(n=1),void 0===i&&(i=!1),r(e,t,1/n,i)}function a(e,t){return void 0===t&&(t=!1),r(e,1e3,1/9e4,t)}function o(e,t){return void 0===t&&(t=1),r(e,9e4,1/t)}n.r(t),n.d(t,"toTimescaleFromBase",(function(){return r})),n.d(t,"toTimescaleFromScale",(function(){return i})),n.d(t,"toMsFromMpegTsClock",(function(){return a})),n.d(t,"toMpegTsClockFromTimescale",(function(){return o}))},"./src/utils/typed-array.ts":
/*!**********************************!*\
  !*** ./src/utils/typed-array.ts ***!
  \**********************************/
/*! exports provided: sliceUint8 */function(e,t,n){"use strict";function r(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}n.r(t),n.d(t,"sliceUint8",(function(){return r}))},"./src/utils/vttcue.ts":
/*!*****************************!*\
  !*** ./src/utils/vttcue.ts ***!
  \*****************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t),t.default=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var n=t.toLowerCase();return!!~e.indexOf(n)&&n}function r(e){return n(t,e)}function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)e[o]=a[o]}return e}function a(t,a,o){var s=this,u={enumerable:!0};s.hasBeenReset=!1;var l="",c=!1,d=t,f=a,h=o,p=null,g="",m=!0,v="auto",y="start",E=50,T="middle",_=50,b="middle";Object.defineProperty(s,"id",i({},u,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(s,"pauseOnExit",i({},u,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",i({},u,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",i({},u,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",i({},u,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",i({},u,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",i({},u,{get:function(){return g},set:function(t){var r=function(t){return n(e,t)}(t);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");g=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",i({},u,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",i({},u,{get:function(){return v},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",i({},u,{get:function(){return y},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",i({},u,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",i({},u,{get:function(){return T},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",i({},u,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",i({},u,{get:function(){return b},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),s.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}()},"./src/utils/vttparser.ts":
/*!********************************!*\
  !*** ./src/utils/vttparser.ts ***!
  \********************************/
/*! exports provided: parseTimeStamp, fixLineBreaks, VTTParser */function(e,t,n){"use strict";n.r(t),n.d(t,"parseTimeStamp",(function(){return a})),n.d(t,"fixLineBreaks",(function(){return d})),n.d(t,"VTTParser",(function(){return f}));var r=n(/*! ./vttcue */"./src/utils/vttcue.ts"),i=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function a(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(r||0)}var n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}var o=function(){function e(){this.values=Object.create(null)}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t)},t.get=function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1},e}();function s(e,t,n,r){var i=r?e.split(r):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(n);2===o.length&&t(o[0],o[1])}}var u=new r.default(0,0,""),l="middle"===u.align?"middle":"center";function c(e,t,n){var r=e;function i(){var t=a(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function c(){e=e.replace(/^\s+/,"")}if(c(),t.startTime=i(),c(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),c(),t.endTime=i(),c(),function(e,t){var r=new o;s(e,(function(e,t){var i;switch(e){case"region":for(var a=n.length-1;a>=0;a--)if(n[a].id===t){r.set(e,n[a].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":i=t.split(","),r.integer(e,i[0]),r.percent(e,i[0])&&r.set("snapToLines",!1),r.alt(e,i[0],["auto"]),2===i.length&&r.alt("lineAlign",i[1],["start",l,"end"]);break;case"position":i=t.split(","),r.percent(e,i[0]),2===i.length&&r.alt("positionAlign",i[1],["start",l,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",l,"end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");var i=r.get("line","auto");"auto"===i&&-1===u.line&&(i=-1),t.line=i,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",l);var a=r.get("position","auto");"auto"===a&&50===u.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function d(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var f=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new i,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var t=e.prototype;return t.parse=function(e){var t=this;function n(){var e=t.buffer,n=0;for(e=d(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var r=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(i=n()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:i=n(),t.state){case"HEADER":/:/.test(i)?s(i,(function(e,t){}),/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new r.default(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{c(i,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var u=-1!==i.indexOf("--\x3e");if(!i||u&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){try{if((this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state||"BADWEBVTT"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){this.onparsingerror&&this.onparsingerror(e)}return this.onflush&&this.onflush(),this},e}()},"./src/utils/webvtt-parser.ts":
/*!************************************!*\
  !*** ./src/utils/webvtt-parser.ts ***!
  \************************************/
/*! exports provided: generateCueId, parseWebVTT */function(e,t,n){"use strict";n.r(t),n.d(t,"generateCueId",(function(){return d})),n.d(t,"parseWebVTT",(function(){return f}));var r=n(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),i=n(/*! ./vttparser */"./src/utils/vttparser.ts"),a=n(/*! ../demux/id3 */"./src/demux/id3.ts"),o=n(/*! ./timescale-conversion */"./src/utils/timescale-conversion.ts"),s=n(/*! ../remux/mp4-remuxer */"./src/remux/mp4-remuxer.ts"),u=/\r\n|\n\r|\n|\r/g,l=function(e,t,n){return void 0===n&&(n=0),e.substr(n,t.length)===t},c=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function d(e,t,n){return c(e.toString())+c(t.toString())+c(n)}function f(e,t,n,c,f,h,p,g){var m,v=new i.VTTParser,y=Object(a.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(u,"\n").split("\n"),E=[],T=Object(o.toMpegTsClockFromTimescale)(t,n),_="00:00.000",b=0,A=0,S=!0,w=!1;v.oncue=function(e){var t=c[f],n=c.ccOffset,r=(b-T)/9e4;if(null!=t&&t.new&&(void 0!==A?n=c.ccOffset=t.start:function(e,t,n){var r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;null!==(a=i)&&void 0!==a&&a.new;){var a;e.ccOffset+=r.start-i.start,r.new=!1,i=e[(r=i).prevCC]}e.presentationOffset=n}(c,f,r)),r&&(n=r-c.presentationOffset),w){var i=e.endTime-e.startTime,a=Object(s.normalizePts)(9e4*(e.startTime+n-A),9e4*h)/9e4;e.startTime=a,e.endTime=a+i}var o=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(o)),e.id||(e.id=d(e.startTime,e.endTime,o)),e.endTime>0&&E.push(e)},v.onparsingerror=function(e){m=e},v.onflush=function(){m?g(m):p(E)},y.forEach((function(e){if(S){if(l(e,"X-TIMESTAMP-MAP=")){S=!1,w=!0,e.substr(16).split(",").forEach((function(e){l(e,"LOCAL:")?_=e.substr(6):l(e,"MPEGTS:")&&(b=parseInt(e.substr(7)))}));try{A=function(e){var t=parseInt(e.substr(-3)),n=parseInt(e.substr(-6,2)),i=parseInt(e.substr(-9,2)),a=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(r.isFiniteNumber)(t)&&Object(r.isFiniteNumber)(n)&&Object(r.isFiniteNumber)(i)&&Object(r.isFiniteNumber)(a)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*n,(t+=6e4*i)+36e5*a}(_)/1e3}catch(e){w=!1,m=e}return}""===e&&(S=!1)}v.parse(e+"\n")})),v.flush()}},"./src/utils/xhr-loader.ts":
/*!*********************************!*\
  !*** ./src/utils/xhr-loader.ts ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../utils/logger */"./src/utils/logger.ts"),i=n(/*! ../loader/load-stats */"./src/loader/load-stats.ts"),a=/^age:\s*[\d.]+\s*$/m,o=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e?e.xhrSetup:null,this.stats=new i.LoadStats,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e=this.config,t=this.context;if(e){var n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(n,t.url)}catch(e){n.open("GET",t.url,!0),i(n,t.url)}n.readyState||n.open("GET",t.url,!0)}catch(e){return void this.callbacks.onError({code:n.status,text:e.message},t,n)}t.rangeEnd&&n.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),n.onreadystatechange=this.readystatechange.bind(this),n.onprogress=this.loadprogress.bind(this),n.responseType=t.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),e.timeout),n.send()}},t.readystatechange=function(){var e=this.context,t=this.loader,n=this.stats;if(e&&t){var i=t.readyState,a=this.config;if(!n.aborted&&i>=2)if(self.clearTimeout(this.requestTimeout),0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start)),4===i){t.onreadystatechange=null,t.onprogress=null;var o=t.status;if(o>=200&&o<300){var s,u;if(n.loading.end=Math.max(self.performance.now(),n.loading.first),u="arraybuffer"===e.responseType?(s=t.response).byteLength:(s=t.responseText).length,n.loaded=n.total=u,!this.callbacks)return;var l=this.callbacks.onProgress;if(l&&l(n,e,s,t),!this.callbacks)return;var c={url:t.responseURL,data:s};this.callbacks.onSuccess(c,n,e,t)}else n.retry>=a.maxRetry||o>=400&&o<499?(r.logger.error(o+" while loading "+e.url),this.callbacks.onError({code:o,text:t.statusText},e,t)):(r.logger.warn(o+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),n.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout)}},t.loadtimeout=function(){r.logger.warn("timeout while loading "+this.context.url);var e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&a.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},e}();t.default=o}}).default},e.exports=r())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.SOURCE_INITIALIZED="sourceInitialized",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.GAP_CAUSED_SEEK_TO_PERIOD_END="gapCausedSeekToPeriodEnd",e.GAP_CAUSED_INTERNAL_SEEK="gapCausedInternalSeek",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(33))&&r.__esModule?r:{default:r}).default));t.default=i},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeDollarsInTemplate=function(e){return e?e.split("$$").join("$"):e},t.replaceIDForTemplate=function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},t.replaceTokenForTemplate=o,t.getIndexBasedSegment=function(e,t,n,r){var i,a,o=void 0;o=n.segmentDuration,isNaN(o)&&(o=n.adaptation.period.duration),i=parseFloat((n.adaptation.period.start+r*o).toFixed(5)),a=parseFloat((i+o).toFixed(5));var l=s(n,o,i,e.calcMediaTimeFromPresentationTime(i,n),e.calcAvailabilityStartTimeFromPresentationTime(i,n.adaptation.period.mpd,t),e,a,t,r);return u(e,n,l,t)?l:null},t.getTimeBasedSegment=function(e,t,n,r,i,a,l,c,d,f){var h,p,g=r/a,m=Math.min(i/a,n.adaptation.period.mpd.maxSegmentDuration),v=void 0;return p=(h=e.calcPresentationTimeFromMediaTime(g,n))+m,u(e,n,v=s(n,m,h,g,n.adaptation.period.mpd.manifest.loadedTime,e,p,t,d),t)?(v.replacementTime=f||r,l=o(l,"Number",v.replacementNumber),l=o(l,"Time",v.replacementTime),v.media=l,v.mediaRange=c,v):null};var r,i=(r=n(52))&&r.__esModule?r:{default:r};function a(e,t){for(;e.length<t;)e="0"+e;return e}function o(e,t,n){var r=void 0,i=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=t.length,d="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((i=e.indexOf("$",r+c))<0)return e;if((o=e.indexOf("%0",r+c))>r&&o<i)switch(s=e.charAt(i-1),u=parseInt(e.substring(o+d,i-1),10),s){case"d":case"i":case"u":l=a(n.toString(),u);break;case"x":l=a(n.toString(16),u);break;case"X":l=a(n.toString(16),u).toUpperCase();break;case"o":l=a(n.toString(8),u);break;default:return e}else l=n;e=e.substring(0,r)+l+e.substring(i+1)}}function s(e,t,n,r,a,o,s,u,l){var c,d=new i.default;return d.representation=e,d.duration=t,d.presentationStartTime=n,d.mediaStartTime=r,d.availabilityStartTime=a,d.availabilityEndTime=o.calcAvailabilityEndTimeFromPresentationTime(s,e.adaptation.period.mpd,u),d.wallStartTime=o.calcWallTimeForSegment(d,u),d.replacementNumber=(c=l,d.representation.startNumber+c),d.availabilityIdx=l,d}function u(e,t,n,r){var i=e.getPeriodEnd(t,r),a=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,i);if(e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n.presentationStartTime)>=a){if(!r)return!1;if(t.segmentAvailabilityRange&&n.presentationStartTime>=t.segmentAvailabilityRange.end)return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=l(n(0)),a=l(n(30)),o=l(n(2)),s=l(n(1)),u=n(7);function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(){var e,t,n={debug:{logLevel:o.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:NaN,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,flushBufferAtTrackSwitch:!1,calcSegmentAvailabilityRangeFromTimeline:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!0,useAppendWindow:!0,manifestUpdateRetryInterval:100,stallThreshold:.5,filterUnsupportedEssentialProperties:!0,eventControllerRefreshDelay:100,utcSynchronization:{backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"}},liveCatchup:{minDrift:.02,maxDrift:0,playbackRate:.5,latencyThreshold:60,playbackBufferMin:.5,enabled:!1,mode:s.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:s.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:s.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:s.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE,fragmentRequestTimeout:0,retryIntervals:(e={},c(e,u.HTTPRequest.MPD_TYPE,500),c(e,u.HTTPRequest.XLINK_EXPANSION_TYPE,500),c(e,u.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.INIT_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.OTHER_TYPE,1e3),c(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},c(t,u.HTTPRequest.MPD_TYPE,3),c(t,u.HTTPRequest.XLINK_EXPANSION_TYPE,1),c(t,u.HTTPRequest.MEDIA_SEGMENT_TYPE,3),c(t,u.HTTPRequest.INIT_SEGMENT_TYPE,3),c(t,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),c(t,u.HTTPRequest.INDEX_SEGMENT_TYPE,3),c(t,u.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),c(t,u.HTTPRequest.OTHER_TYPE,3),c(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:s.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:s.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:s.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:s.default.CMCD_MODE_QUERY}}},i=a.default.clone(n);return{get:function(){return i},update:function(e){"object"===(void 0===e?"undefined":r(e))&&function e(t,n,i){for(var o in t)t.hasOwnProperty(o)&&n.hasOwnProperty(o)&&("object"===r(t[o])&&null!==t[o]?e(t[o],n[o],i.slice()+o+"."):n[o]=a.default.clone(t[o]))}(e,i,"")},reset:function(){i=a.default.clone(n)}}}d.__dashjs_factory_name="Settings";var f=i.default.getSingletonFactory(d);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"!==r.schemeIdUri.toLowerCase()||"cenc"!==r.value.toLowerCase()&&"cbcs"!==r.value.toLowerCase()||(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return t&&r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";var u=void 0,l=void 0;for(u=0;u<4;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=4,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<6;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;r+=6,o=o.toLowerCase(),t.getUint32(r),r+=4,n[o]=t.buffer.slice(s,i),r=i}else r=i;else r=i}return n}}]),e}();t.default=i},function(e,t,n){"use strict";t.a=function(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r&&r.push(n)||e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&r.splice(r.indexOf(n)>>>0,1)},emit:function(t,n){(e.get(t)||[]).slice().map((function(e){e(n)})),(e.get("*")||[]).slice().map((function(e){e(t,n)}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(15));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t,n=(e=e||{}).eventBus,r=e.events,a=e.dashMetrics,o=e.fragmentLoader,s=e.debug,u=e.streamInfo,l=e.type,c=void 0,d=void 0,f=void 0;function h(e){var t;return!!e&&(t=!1,d.some((function(n){if(r=e,a=n,!isNaN(r.index)&&r.startTime===a.startTime&&r.adaptationIndex===a.adaptationIndex&&r.type===a.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,n)||function(e,t){return e.action===i.default.ACTION_COMPLETE&&e.action===t.action}(e,n))return t=!0;var r,a})),t)}function p(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function g(e){d=d.filter((function(t){var n=p(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n}))}function m(e,t){t<=e+.5||(d=d.filter((function(n){var r=p(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r})))}function v(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?p(i):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return i}return null}function y(e,t){a.addSchedulingInfo(e,t),a.addRequestsQueue(e.mediaType,f,d)}function E(e){e.sender===o&&(f.splice(f.indexOf(e.request),1),e.response&&!e.error&&d.push(e.request),y(e.request,e.error?"failed":"executed"),n.trigger(r.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:u.id,mediaType:l}))}function T(e){e.sender===o&&n.trigger(r.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:u.id,mediaType:l})}function _(e){e.sender===o&&n.trigger(r.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:u.id,mediaType:l})}function b(){d=[],f=[]}return t={getStreamId:function(){return u.id},getType:function(){return l},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach((function(t){var r=function(e){var t=void 0;switch(e){case"loading":t=f;break;case"executed":t=d;break;default:t=[]}return t}(t);n=n.concat(function(e,t){return t.hasOwnProperty("time")?[v(e,t.time,t.threshold)]:e.filter((function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0}))}(r,e))})),n},isFragmentLoaded:h,isFragmentLoadedOrPending:function(e){var t=!1,n=0,r=void 0;if(!(t=h(e)))for(n=0;n<f.length;n++)r=f[n],e.url===r.url&&e.startTime===r.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:g,removeExecutedRequestsAfterTime:function(e){d=d.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)m(n,e.start(r)),n=e.end(r);t>0&&m(n,t)}else g()},abortRequests:function(){c.debug("abort requests"),o.abort(),f=[]},executeRequest:function(e){switch(e.action){case i.default.ACTION_COMPLETE:d.push(e),y(e,"executed"),c.debug("STREAM_COMPLETED"),n.trigger(r.STREAM_COMPLETED,{request:e},{streamId:e.mediaInfo.streamInfo.id,mediaType:e.mediaType});break;case i.default.ACTION_DOWNLOAD:y(e,"loading"),f.push(e),function(e){n.trigger(r.FRAGMENT_LOADING_STARTED,{request:e},{streamId:u.id,mediaType:l}),o.load(e)}(e);break;default:c.warn("Unknown request action.")}},reset:function(){n.off(r.LOADING_COMPLETED,E,this),n.off(r.LOADING_DATA_PROGRESS,T,this),n.off(r.LOADING_ABANDONED,_,this),o&&o.reset(),b()},addExecutedRequest:function(e){d.push(e)}},c=s.getLogger(t),b(),n.on(r.LOADING_COMPLETED,E,t),n.on(r.LOADING_DATA_PROGRESS,T,t),n.on(r.LOADING_ABANDONED,_,t),t}o.__dashjs_factory_name="FragmentModel";var s=r.default.getClassFactory(o);s.FRAGMENT_MODEL_LOADING="loading",s.FRAGMENT_MODEL_EXECUTED="executed",s.FRAGMENT_MODEL_CANCELED="canceled",s.FRAGMENT_MODEL_FAILED="failed",r.default.updateClassFactory(o.__dashjs_factory_name,s),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(2)),i=u(n(109)),a=u(n(0)),o=u(n(43)),s=u(n(111));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e,t=void 0,n=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.default.parseBuffer(e),r=(0,i.default)(n).create();return r.setData(t),r}function u(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function l(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return e={parse:a,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;n<r.byteLength;){var o=u(r,n),c=l(r,n+4);if(0===o)break;n+o<=r.byteLength&&(e.indexOf(c)>=0?i=new s.default(n,!0,o):a=n+o),n+=o}return i||new s.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=a(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,r=a(e),i=r.getBoxes("moof"),o=r.getBoxes("mfhd"),s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0;n=r.getBoxes("moof").length,t=o[o.length-1].sequence_number,u=0,d=[];var _=-1,b=-1;for(m=0;m<i.length;m++){var A=i[m],S=A.getChildBoxes("traf");for(p=0;p<S.length;p++){var w=S[p],I=w.getChildBox("tfhd"),R=w.getChildBox("tfdt");c=R.baseMediaDecodeTime;var C=w.getChildBoxes("trun"),D=w.getChildBoxes("subs");for(g=0;g<C.length;g++){var M=C[g];for(u=M.sample_count,E=(I.base_data_offset||0)+(M.data_offset||0),h=0;h<u;h++){s=void 0!==(f=M.samples[h]).sample_duration?f.sample_duration:I.default_sample_duration,l=void 0!==f.sample_size?f.sample_size:I.default_sample_size;var L={dts:c,cts:c+(void 0!==f.sample_composition_time_offset?f.sample_composition_time_offset:0),duration:s,offset:A.offset+E,size:l,subSizes:[l]};if(D)for(v=0;v<D.length;v++){var N=D[v];if(_<N.entry_count-1&&h>b&&(_++,b+=N.entries[_].sample_delta),h==b){L.subSizes=[];var x=N.entries[_];for(y=0;y<x.subsample_count;y++)L.subSizes.push(x.subsamples[y].subsample_size)}}d.push(L),E+=l,c+=s}}T=c-R.baseMediaDecodeTime}}return{sampleList:d,lastSequenceNumber:t,totalDuration:T,numSequences:n}},findInitRange:function(e){var n=null,r=a(e);if(!r)return n;var i=r.getBox("ftyp"),o=r.getBox("moov");return t.debug("Searching for initialization."),o&&o.isComplete&&(n=(i?i.offset:o.offset)+"-"+(o.offset+o.size-1),t.debug("Found the initialization.  Range: "+n)),n},parsePayload:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;n<r.byteLength;){var o=u(r,n),c=l(r,n+4);if(0===o)break;n+o<=r.byteLength&&(e.indexOf(c)>=0?i=new s.default(n,!0,o,c):a=n+o),n+=o}return i||new s.default(a,!1)}},t=(0,r.default)(n).getInstance().getLogger(e),e}l.__dashjs_factory_name="BoxParser",t.default=a.default.getSingletonFactory(l)},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(46).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(81));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=this.context,n=void 0,r=void 0;return n=(0,i.default)(t).getInstance(),{load:function(i){var a=n.getLoader(i&&i.request?i.request.url:null);(r=a(t).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.useFetch||null,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,requestTimeout:isNaN(e.requestTimeout)?0:e.requestTimeout,errors:e.errors})).load(i)},abort:function(){r&&r.abort()}}}o.__dashjs_factory_name="URLLoader";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"mixin",value:function(t,n,i){var a=void 0,o={};if(t)for(var s in n)n.hasOwnProperty(s)&&(a=n[s],s in t&&(t[s]===a||s in o&&o[s]===a)||("object"===r(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],a,i):t[s]=i(a)));return t}},{key:"clone",value:function(t){if(!t||"object"!==(void 0===t?"undefined":r(t)))return t;var n=void 0;if(t instanceof Array){n=[];for(var i=0,a=t.length;i<a;++i)i in t&&n.push(e.clone(t[i]))}else n={};return e.mixin(n,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach((function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)})),n.href}catch(t){return e}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(33))&&r.__esModule?r:{default:r}).default));t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(75))&&r.__esModule?r:{default:r}).default));t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i},function(e,t,n){!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)},function(e,t,n){!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=i[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=r.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){var n=t.split(","),r=[];for(var i in n){var a=n[i].split(" ");if(1===a.length&&"none"===a[0])return"none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){r.push(o);continue}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){r.push(o);continue}var u=e.parseColor(a[0]);if(null===u)return null;o[3]=u,r.push(o)}}return r},e.parsePosition=function(t){var n=t.split(" "),r=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var i in n)if(!r(n[i])){var a=e.parseLength(n[i]);if(null===a)return null;n[i]=a}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var u=n[s++];if(r(u)){var l={value:0,unit:"%"};2!==n.length&&s<n.length&&!r(n[s])&&(l=n[s++]),"right"===u?(o.h.edge=u,o.h.offset=l):"bottom"===u?(o.v.edge=u,o.v.offset=l):"left"===u?o.h.offset=l:"top"===u&&(o.v.offset=l)}else{if(1!==n.length&&2!==n.length)return null;1===s?o.h.offset=u:o.v.offset=u}}return o},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,r,i,a,o){return"%"===n&&i?new e.ComputedLength(i.rw*t/100,i.rh*t/100):"em"===n&&r?new e.ComputedLength(r.rw*t,r.rh*t):"c"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}(t)},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var u,l=[],c=!1,d=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):d=-1,l.length&&h())}function h(){if(!c){var e=s(f);c=!0;for(var t=l.length;t;){for(u=l,l=[];++d<t;)u&&u[d].run();d=-1,t=l.length}u=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var a,o,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(a=new Array(s-1),o=0;o<a.length;)a[o++]=arguments[o];return t.nextTick((function(){e.apply(null,a)}))}}}:e.exports=t}).call(this,n(36))},function(e,t,n){var r=n(46),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o),a(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}return r(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(24)),i=h(n(258)),a=h(n(259)),o=h(n(260)),s=h(n(261)),u=h(n(262)),l=h(n(263)),c=h(n(264)),d=h(n(265)),f=h(n(17));function h(e){return e&&e.__esModule?e:{default:e}}function p(){var e=this.context,t=void 0,n=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0;return t={initialize:function(){p=[];var t=void 0;t=(0,s.default)(e).getInstance({BASE64:g}),p.push(t),t=(0,o.default)(e).getInstance({BASE64:g}),p.push(t),t=(0,i.default)(e).getInstance({BASE64:g}),p.push(t),m=t,t=(0,a.default)(e).getInstance({BASE64:g,debug:n}),p.push(t),v=t},setProtectionData:function(e){for(var t,n,r=0;r<p.length;r++){var i=p[r];i.hasOwnProperty("init")&&i.init((t=i.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===m||e===v},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1},getKeySystems:function(){return p},setKeySystems:function(e){p=e},getKeySystemBySystemString:function(e){for(var t=0;t<p.length;t++)if(p[t].systemString===e)return p[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t=void 0,n=void 0,i=void 0,a=void 0,o=[];if(e){var s=r.default.findCencContentProtection(e);for(i=0;i<p.length;++i)for(n=p[i],a=0;a<e.length;++a)if((t=e[a]).schemeIdUri.toLowerCase()===n.schemeIdURI){var u=n.getInitData(t,s);o.push({ks:p[i],initData:u,cdmData:n.getCDMData(),sessionId:n.getSessionId(t)})}}return o},getSupportedKeySystems:function(e,t){for(var n=[],i=r.default.parsePSSHList(e),a=void 0,o=void 0,s=void 0,u=0;u<p.length;++u)o=(a=p[u]).systemString,s=!t||o in t,a.uuid in i&&s&&n.push({ks:a,initData:i[a.uuid],cdmData:a.getCDMData(),sessionId:a.getSessionId()});return n},getLicenseServer:function(t,n,r){if("license-release"===r||"individualization-request"===r)return null;var i=null;return n&&n.hasOwnProperty("drmtoday")?i=(0,u.default)(e).getInstance({BASE64:g}):t.systemString===f.default.WIDEVINE_KEYSTEM_STRING?i=(0,c.default)(e).getInstance():t.systemString===f.default.PLAYREADY_KEYSTEM_STRING?i=(0,l.default)(e).getInstance():t.systemString===f.default.CLEARKEY_KEYSTEM_STRING&&(i=(0,d.default)(e).getInstance()),i},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return h.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(n=e.debug,h=n.getLogger(t)),e.BASE64&&(g=e.BASE64))}}}p.__dashjs_factory_name="ProtectionKeyController",t.default=dashjs.FactoryMaker.getSingletonFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportsMediaSource=t.Debug=t.MediaPlayerFactory=t.MetricsReporting=t.Protection=t.MediaPlayer=void 0;var r=n(101),i=n(91),a=l(n(234)),o=l(n(253)),s=l(n(270)),u=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}dashjs.Protection=o.default,dashjs.MetricsReporting=a.default,dashjs.MediaPlayerFactory=s.default,dashjs.Debug=u.default,dashjs.supportsMediaSource=i.supportsMediaSource,t.default=dashjs,t.MediaPlayer=r.MediaPlayer,t.Protection=o.default,t.MetricsReporting=a.default,t.MediaPlayerFactory=s.default,t.Debug=u.default,t.supportsMediaSource=i.supportsMediaSource},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(1)),i=f(n(0)),a=f(n(107)),o=f(n(44)),s=f(n(131)),u=f(n(132)),l=f(n(3)),c=f(n(4)),d=n(14);function f(e){return e&&e.__esModule?e:{default:e}}function h(){var e,t=this.context,n=void 0,i=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0;function M(){var e=!0;return w&&!I&&(e=!1),e}function L(){w=!0,R=!1,C=!1}return e={setConfig:function(e){e&&(e.errHandler&&(i=e.errHandler),e.adapter&&(f=e.adapter),e.manifestModel&&(h=e.manifestModel),e.mediaController&&(p=e.mediaController),e.videoModel&&(g=e.videoModel),e.streamController&&(m=e.streamController),e.textTracks&&(v=e.textTracks),e.vttParser&&(y=e.vttParser),e.ttmlParser&&(E=e.ttmlParser),n.setConfig({errHandler:i,adapter:f,manifestModel:h,mediaController:p,videoModel:g,streamController:m,textTracks:v,vttParser:y,ttmlParser:E}))},getTextSourceBuffer:function(){return n},getAllTracksAreDisabled:function(){return w},addEmbeddedTrack:function(e){n.addEmbeddedTrack(e)},getTextDefaultLanguage:function(){return _&&_.lang||""},setTextDefaultLanguage:function(e){(0,d.checkParameterType)(e,"string"),_||(_={}),_.lang=e,b=!0},setTextDefaultEnabled:function(e){(0,d.checkParameterType)(e,"boolean"),(S=e)?w=!1:this.setTextTrack(-1)},getTextDefaultEnabled:function(){return void 0!==S&&S},setInitialSettings:function(e){_=e,b=!0},enableText:function(e){(0,d.checkParameterType)(e,"boolean"),!S&&e&&(S=!0),M()!==e&&(e&&this.setTextTrack(A),e||(A=this.getCurrentTrackIdx(),R?this.setTextTrack(-1):C=!0))},isTextEnabled:M,setTextTrack:function(e){var t=n.getConfig(),i=t.fragmentModel,a=t.fragmentedTracks,o=t.videoModel,s=void 0,u=void 0;w=-1===e;var l=v.getCurrentTrackIdx();if(l!==e){w&&p&&p.saveTextSettingsDisabled(),v.setModeForTrackIdx(l,r.default.TEXT_HIDDEN),v.setCurrentTrackIdx(e),v.setModeForTrackIdx(e,r.default.TEXT_SHOWING);var c=v.getCurrentTrackInfo();if(c&&c.isFragmented&&!c.isEmbedded)for(var d=0;d<a.length;d++){var f=a[d];if(c.lang===f.lang&&c.index===f.index&&(f.id?c.id===f.id:c.id===f.index))if(f!==p.getCurrentTrackFor(r.default.FRAGMENTED_TEXT,m.getActiveStreamInfo()))i.abortRequests(),i.removeExecutedRequestsBeforeTime(),n.remove(),v.deleteCuesFromTrackIdx(l),p.setTrack(f),n.setCurrentFragmentedTrackIdx(d);else if(-1===l){for(var h=m.getActiveStreamProcessors(),g=0;g<h.length;g++)if(h[g].getType()===r.default.FRAGMENTED_TEXT){u=h[g];break}u.setBufferingTime(o.getTime()),u.getScheduleController().start()}}else if(c&&!c.isFragmented){for(var y=m.getActiveStreamProcessors(),E=0;E<y.length;E++)if(y[E].getType()===r.default.TEXT){s=(u=y[E]).getMediaInfoArr();break}if(u&&s)for(var T=0;T<s.length;T++)if(s[T].index===c.index&&s[T].lang===c.lang){u.selectMediaInfo(s[T]);break}}}},getCurrentTrackIdx:function(){return v.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0,d.checkParameterType)(e,"boolean"),I=e},reset:function(){L(),n.resetEmbedded(),n.reset()}},_=null,A=-1,I=!1,R=!1,b=!1,C=!1,v=(0,o.default)(t).getInstance(),y=(0,s.default)(t).getInstance(),E=(0,u.default)(t).getInstance(),n=(0,a.default)(t).getInstance(),T=(0,l.default)(t).getInstance(),v.initialize(),T.on(c.default.TEXT_TRACKS_QUEUE_INITIALIZED,(function(e){var t=this,n=e.tracks,r=e.index;_&&n.some((function(e,n){if(p.matchSettings(_,e))return t.setTextTrack(n),r=n,!0})),(!1===S||void 0===S&&!_||C)&&this.setTextTrack(-1),A=r,T.trigger(c.default.TEXT_TRACKS_ADDED,{enabled:M(),index:r,tracks:n}),R=!0}),e),T.on(c.default.CURRENT_TRACK_CHANGED,(function(e){if(!b&&e&&e.newMediaInfo){var t=e.newMediaInfo;t.type===r.default.FRAGMENTED_TEXT&&(_={lang:t.lang,role:t.roles[0],accessibility:t.accessibility[0]})}}),e),T.on(c.default.PERIOD_SWITCH_STARTED,(function(e){void 0===D&&null!==e.fromStreamInfo&&(D=this.getCurrentTrackIdx())}),e),T.on(c.default.STREAM_COMPLETED,(function(){void 0===D&&(D=this.getCurrentTrackIdx())}),e),T.on(c.default.PERIOD_SWITCH_COMPLETED,(function(){void 0!==D&&(this.setTextTrack(D),D=void 0)}),e),L(),e}h.__dashjs_factory_name="TextController",t.default=i.default.getSingletonFactory(h)},function(e,t,n){
/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */
var r={parseBuffer:function(e){return new i(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(a.prototype._boxProcessors[e]=t)},createFile:function(){return new i},createBox:function(e,t,n){var r=a.create(e);return t&&t.append(r,n),r},createFullBox:function(e,t,n){var i=r.createBox(e,t,n);return i.version=0,i.flags=0,i},Utils:{}};r.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),r.push(String.fromCharCode(a))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},r.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},r.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var r,i=-1;if("number"==typeof n)i=n;else{if("string"==typeof n)r=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=r.parseBuffer,t.addBoxProcessor=r.addBoxProcessor,t.createFile=r.createFile,t.createBox=r.createBox,t.createFullBox=r.createFullBox,t.Utils=r.Utils,r.Cursor=function(e){this.offset=void 0===e?0:e};var i=function(e){this._cursor=new r.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var n=[];return i._sweep.call(this,e,n,t),n},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=a.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,n){for(var r in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;i._sweep.call(this.boxes[r],e,t,n)}},i.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},i.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)};var a=function(){this._cursor=new r.Cursor};a.parse=function(e){var t=new a;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},a.create=function(e){var t=new a;return t.type=e,t.boxes=[],t},a.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],a.prototype._boxProcessors={},a.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},a.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i])},a.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},a.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r])},a.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i])},a.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t])},a.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(a.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},a.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},a.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(n+4);t=r*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},a.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(i+2));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(i+4),r=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,r},a.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},a.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},a.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},a.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},a.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?r.Utils.dataViewToString(t):t},a.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},a.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},a.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(a.parse(this))},a.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)},a.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},a.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},a.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(n+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(i+2,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(i+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},a.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},a.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r)},a.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},a.prototype._writeUTF8String=function(e){var t=r.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)n.setUint8(i,t[i]);else this.size+=t.length},a.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},a.prototype._boxProcessors.avc1=a.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},a.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},a.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)}))},a.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},a.prototype._boxProcessors.free=a.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},a.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},a.prototype._boxProcessors.ftyp=a.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},a.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},a.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},a.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},a.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},a.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},a.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},a.prototype._boxProcessors.mp4a=a.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},a.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},a.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},a.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},a.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},a.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},a.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},a.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},a.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,(function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)}))}))},a.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},a.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,(function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)}))}))},a.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},a.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},a.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},a.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},a.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},a.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},a.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},a.prototype._boxProcessors["url "]=a.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},a.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},a.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},a.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},a.prototype._boxProcessors.vtte=function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(1)),i=c(n(3)),a=c(n(4)),o=c(n(0)),s=c(n(2)),u=n(69),l=n(14);function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e,t=this.context,n=(0,i.default)(t).getInstance(),o=void 0,c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0,w=void 0;function I(e){var t=f[e].kind,n=void 0!==f[e].id?f[e].id:f[e].lang,r=f[e].lang,i=f[e].isTTML,a=f[e].isEmbedded;return d.addTextTrack(t,n,r,i,a)}function R(e,t,n,r,i,a){var o=0,s=0;e/t>n/r?o=(s=t)/r*n:s=(o=e)/n*r;var u,l,c=0,d=0;return o/s>i?(d=s,c=s*i):(c=o,d=o/i),u=(e-c)/2,l=(t-d)/2,a?{x:u+.1*c,y:l+.1*d,w:.8*c,h:.8*d}:{x:u,y:l,w:c,h:d}}function C(e,t){var r=d.getClientWidth(),i=d.getClientHeight(),o=d.getVideoWidth(),s=d.getVideoHeight(),u=d.getVideoRelativeOffsetTop(),l=d.getVideoRelativeOffsetLeft();if(0!==o&&0!==s){var c=o/s,f=!1;e.isFromCEA608&&(c=3.5/3,f=!0);var h=R.call(this,r,i,o,s,c,f),p=h.w,T=h.h,A=h.x,w=h.y;if(p!=v||T!=y||A!=g||w!=m||t){if(g=A+l,m=w+u,v=p,y=T,E){var I=E.style;I&&(I.left=g+"px",I.top=m+"px",I.width=v+"px",I.height=y+"px",I.zIndex=_&&document[_]||b?S:null,n.trigger(a.default.CAPTION_CONTAINER_RESIZE))}var C=e.activeCues;if(C)for(var D=C.length,M=0;M<D;++M){var L=C[M];L.scaleCue(L)}}}}function D(e){var t=v,n=y,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e.cellResolution){var u=[t/e.cellResolution[0],n/e.cellResolution[1]];if(e.linePadding)for(r in e.linePadding)if(e.linePadding.hasOwnProperty(r)){i=(e.linePadding[r]*u[0]).toString();for(var l=document.getElementsByClassName("spanPadding"),c=0;c<l.length;c++)l[c].style.cssText=l[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i),l[c].style.cssText=l[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.fontSize){for(r in e.fontSize)if(e.fontSize.hasOwnProperty(r)){"%"===e.fontSize[r][0]?a=e.fontSize[r][1]/100:"c"===e.fontSize[r][0]&&(a=e.fontSize[r][1]),i=(a*u[1]).toString(),s="defaultFontSize"!==r?document.getElementsByClassName(r):document.getElementsByClassName("paragraph");for(var d=0;d<s.length;d++)s[d].style.cssText=s[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.lineHeight)for(r in e.lineHeight)if(e.lineHeight.hasOwnProperty(r)){"%"===e.lineHeight[r][0]?o=e.lineHeight[r][1]/100:"c"===e.fontSize[r][0]&&(o=e.lineHeight[r][1]),i=(o*u[1]).toString(),s=document.getElementsByClassName(r);for(var f=0;f<s.length;f++)s[f].style.cssText=s[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}}}if(e.isd){var h=document.getElementById(e.cueID);h&&E.removeChild(h),M(e)}}function M(e){if(E){var t=document.createElement("div");E.appendChild(t),A=(0,u.renderHTML)(e.isd,t,(function(t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),a=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(r.test(t)){var o=r.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[o]}return null}),E.clientHeight,E.clientWidth,!1,(function(e){o.info("renderCaption :",e)}),A,!0),t.id=e.cueID,n.trigger(a.default.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:p})}}function L(e){return e>=0&&f[e]?d.getTextTrack(f[e].kind,f[e].id,f[e].lang,f[e].isTTML,f[e].isEmbedded):null}function N(e){var t=this;if(e!==p){var n=L(p=e);x.call(this,n),T&&(clearInterval(T),T=null),n&&"html"===n.renderingType&&(C.call(this,n,!0),window.ResizeObserver?(w=new window.ResizeObserver((function(){C.call(t,n,!0)}))).observe(d.getElement()):T=setInterval(C.bind(this,n),500))}}function x(e){U.call(this),e&&"html"===e.renderingType?k.call(this):F.call(this)}function O(e,t,n){return(isNaN(t)||e.startTime>=t)&&(isNaN(n)||e.endTime<=n)}function P(e,t,n){if(e.cues)for(var r=e.cues,i=r.length-1;i>=0;i--)O(r[i],t,n)&&e.removeCue(r[i])}function k(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=d.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){o.info(""+e.message)}}}function F(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function U(){if(E)for(;E.firstChild;)E.removeChild(E.firstChild)}return e={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(c=window.VTTCue||window.TextTrackCue,f=[],h=[],p=-1,g=0,m=0,v=0,y=0,E=null,T=null,b=!1,S=2147483647,A=null,void 0!==document.fullscreenElement?_="fullscreenElement":void 0!==document.webkitIsFullScreen?_="webkitIsFullScreen":document.msFullscreenElement?_="msFullscreenElement":document.mozFullScreen&&(_="mozFullScreen"))},setDisplayCConTop:function(e){(0,l.checkParameterType)(e,"boolean"),b=e,E&&!document[_]&&(E.style.zIndex=e?S:null)},addTextTrack:function(e,t){if(f.length!==t){if(f.push(e),f.length===t){f.sort((function(e,t){return e.index-t.index})),E=d.getTTMLRenderingDiv();for(var i=-1,s=0;s<f.length;s++){var u=I.call(this,s);h.push(u),f[s].defaultTrack&&(u.default=!0,i=s);var l=L(s);l&&(l.mode=r.default.TEXT_SHOWING,E&&(f[s].isTTML||f[s].isEmbedded)?l.renderingType="html":l.renderingType="default"),this.addCaptions(s,0,f[s].captionData),n.trigger(a.default.TEXT_TRACK_ADDED)}if(N.call(this,i),i>=0){n.on(a.default.PLAYBACK_METADATA_LOADED,(function e(){var t=L(i);t&&C.call(this,t,!0),n.off(a.default.PLAYBACK_METADATA_LOADED,e,this)}),this);for(var c=0;c<f.length;c++){var g=L(c);g&&(g.mode=c===i?r.default.TEXT_SHOWING:r.default.TEXT_HIDDEN)}}n.trigger(a.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:p,tracks:f})}}else o.error("Trying to add too many tracks.")},addCaptions:function(e,t,i){var s=L(e),u=this;if(s&&Array.isArray(i)&&0!==i.length)for(var l=0;l<i.length;l++){var d=void 0,f=i[l];s.cellResolution=f.cellResolution,s.isFromCEA608=f.isFromCEA608,"html"===f.type&&E?((d=new c(f.start-t,f.end-t,"")).cueHTMLElement=f.cueHTMLElement,d.isd=f.isd,d.images=f.images,d.embeddedImages=f.embeddedImages,d.cueID=f.cueID,d.scaleCue=D.bind(u),d.cellResolution=f.cellResolution,d.lineHeight=f.lineHeight,d.linePadding=f.linePadding,d.fontSize=f.fontSize,E.style.left=g+"px",E.style.top=m+"px",E.style.width=v+"px",E.style.height=y+"px",d.onenter=function(){s.mode===r.default.TEXT_SHOWING&&(this.isd?(M(this),o.debug("Cue enter id:"+this.cueID)):(E.appendChild(this.cueHTMLElement),D.call(u,this),n.trigger(a.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:p})))},d.onexit=function(){if(E)for(var e=E.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(o.debug("Cue exit id:"+e[t].id),E.removeChild(e[t]),--t)}):f.data&&(d=new c(f.start-t,f.end-t,f.data),f.styles&&(void 0!==f.styles.align&&"align"in d&&(d.align=f.styles.align),void 0!==f.styles.line&&"line"in d&&(d.line=f.styles.line),void 0!==f.styles.position&&"position"in d&&(d.position=f.styles.position),void 0!==f.styles.size&&"size"in d&&(d.size=f.styles.size)),d.onenter=function(){s.mode===r.default.TEXT_SHOWING&&n.trigger(a.default.CAPTION_RENDERED,{currentTrackIdx:p})});try{d?s.addCue(d):o.error("impossible to display subtitles.")}catch(e){throw P(s),s.addCue(d),e}}},getCurrentTrackIdx:function(){return p},setCurrentTrackIdx:N,getTrackIdxForId:function(e){for(var t=-1,n=0;n<f.length;n++)if(f[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return f[p]},setModeForTrackIdx:function(e,t){var n=L(e);n&&n.mode!==t&&(n.mode=t)},deleteCuesFromTrackIdx:function(e,t,n){var r=L(e);r&&P(r,t,n)},deleteAllTextTracks:function(){for(var e=h?h.length:0,t=0;t<e;t++){var n=L(t);n&&(P.call(this,n),n.mode="disabled")}h=[],f=[],T&&(clearInterval(T),T=null),w&&d&&(w.unobserve(d.getElement()),w=null),p=-1,U.call(this)},deleteTextTrack:function(e){d.removeChild(h[e]),h.splice(e,1)},setConfig:function(e){e&&e.videoModel&&(d=e.videoModel)}},o=(0,s.default)(t).getInstance().getLogger(e),e}d.__dashjs_factory_name="TextTracks",t.default=o.default.getSingletonFactory(d)},function(e,t,n){!function(e,t,n){function r(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s}for(var i in e.all=[new r(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new r(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new r(t.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"displayAlign","before",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null}),(function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,1);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new r(t.ns_tts,"fontFamily","default",["span"],!0,!0,(function(e){var t=e.split(","),n=[];for(var r in t)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n}),null),new r(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,(function(e,t,n,r){return"%"!==r.unit?null:Math.abs(r.value)>100?100*Math.sign(r.value):r.value})),new r(t.ns_tts,"fontSize","1c",["span"],!0,!0,n.parseLength,(function(t,r,i,a,o){return n.toComputedLength(a.value,a.unit,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)})),new r(t.ns_tts,"fontStyle","normal",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"fontWeight","normal",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(e){return"normal"===e?e:n.parseLength(e)}),(function(t,r,i,a,o){var s;if("normal"===a)s=a;else if(null===(s=n.toComputedLength(a.value,a.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s})),new r(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new r(t.ns_tts,"origin","auto",["region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null}),(function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,0);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new r(t.ns_tts,"overflow","hidden",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"padding","0px",["region"],!1,!0,(function(e){var t=e.split(" ");if(t.length>4)return null;var r=[];for(var i in t){var a=n.parseLength(t[i]);if(!a)return null;r.push(a)}return r}),(function(t,r,i,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else{if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]]}var u=i.styleAttrs[e.byName.writingMode.qname];if("lrtb"===u||"lr"===u)s=[s[0],s[3],s[2],s[1]];else if("rltb"===u||"rl"===u)s=[s[0],s[1],s[2],s[3]];else if("tblr"===u)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==u&&"tb"!==u)return null;s=[s[3],s[2],s[1],s[0]]}var l=[];for(var c in s)if(0===s[c].value)l[c]=new n.ComputedLength(0,0);else if(l[c]=n.toComputedLength(s[c].value,s[c].unit,i.styleAttrs[e.byName.fontSize.qname],"0"===c||"2"===c?i.styleAttrs[e.byName.extent.qname].h:i.styleAttrs[e.byName.extent.qname].w,"0"===c||"2"===c?t.cellLength.h:t.cellLength.w,"0"===c||"2"===c?t.pxLength.h:t.pxLength.w),null===l[c])return null;return l})),new r(t.ns_tts,"position","top left",["region"],!1,!0,(function(e){return n.parsePosition(e)}),(function(t,r,i,a){var o,s;return null===(o=n.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new n.ComputedLength(-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-i.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new n.ComputedLength(-o.rw-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-i.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-i.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-i.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}))})),new r(t.ns_tts,"ruby","none",["span"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(e){return"center"!==e&&"spaceAround"!==e?null:e}),null),new r(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(e){var t=e.split(" "),r=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(r[0]=t[0],2===t.length&&"none"!==t[0]){var i=n.parseLength(t[1]);if(!i)return null;r[1]=i}return r}),(function(t,r,i,a,o){return"none"===a[0]?a:null===(s=null===a[1]?new n.ComputedLength(.5*i.styleAttrs[e.byName.fontSize.qname].rw,.5*i.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(a[1].value,a[1].unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s];var s})),new r(t.ns_tts,"showBackground","always",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"textAlign","start",["p"],!0,!0,(function(e){return e}),(function(e,t,n,r,i){return"left"===r?"start":"right"===r?"end":r})),new r(t.ns_tts,"textCombine","none",["span"],!0,!0,(function(e){var t=e.split(" ");return 1!==t.length||"none"!==t[0]&&"all"!==t[0]?null:[t[0]]}),null),new r(t.ns_tts,"textDecoration","none",["span"],!0,!0,(function(e){return e.split(" ")}),null),new r(t.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(e){var t=e.split(" "),r={style:null,symbol:null,color:null,position:null};for(var i in t)if("none"===t[i]||"auto"===t[i])r.style=t[i];else if("filled"===t[i]||"open"===t[i])r.style=t[i];else if("circle"===t[i]||"dot"===t[i]||"sesame"===t[i])r.symbol=t[i];else if("current"===t[i])r.color=t[i];else if("outside"===t[i]||"before"===t[i]||"after"===t[i])r.position=t[i];else if(r.color=n.parseColor(t[i]),null===r.color)return null;return null==r.style&&null==r.symbol?r.style="auto":(r.symbol=r.symbol||"circle",r.style=r.style||"filled"),r.position=r.position||"outside",r.color=r.color||"current",r}),null),new r(t.ns_tts,"textOutline","none",["span"],!0,!0,(function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||r.length>2)return null;var i=n.parseColor(r[0]);if(t.color=i,null!==i&&r.shift(),1!==r.length)return null;var a=n.parseLength(r[0]);return a?(t.thickness=a,t):null}),(function(t,r,i,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=i.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=n.toComputedLength(a.thickness.value,a.thickness.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s})),new r(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,(function(t,r,i,a){if("none"===a)return a;var o=[];for(var s in a){var u={};if(u.x_off=n.toComputedLength(a[s][0].value,a[s][0].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===u.x_off)return null;if(u.y_off=n.toComputedLength(a[s][1].value,a[s][1].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.y_off)return null;if(null===a[s][2])u.b_radius=0;else if(u.b_radius=n.toComputedLength(a[s][2].value,a[s][2].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.b_radius)return null;null===a[s][3]?u.color=i.styleAttrs[e.byName.color.qname]:u.color=a[s][3],o.push(u)}return o})),new r(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"zIndex","auto",["region"],!1,!0,(function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t}),null),new r(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,(function(e,t,r,i,a){return n.toComputedLength(i.value,i.unit,null,null,e.cellLength.w,null)})),new r(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(e){return e}),null),new r(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(e){return e}),null),new r(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(e){return"true"===e}),null),new r(t.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(e){return"true"===e}),null)],e.byQName={},e.all)e.byQName[e.all[i].qname]=e.all[i];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"==typeof imscNames?n(34):imscNames,"undefined"==typeof imscUtils?n(35):imscUtils)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(115),i=n(116),a=n(70);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):f(e,t);if("Buffer"===t.type&&a(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(c(t),e=s(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(e).length;default:if(r)return G(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var c=-1;for(a=n;a<s;a++)if(l(e,a)===l(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var d=!0,f=0;f<u;f++)if(l(e,a+f)!==l(t,f)){d=!1;break}if(d)return a}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function T(e,t,n,r){return H(G(t,e.length-n),e,n,r)}function _(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function b(e,t,n,r){return _(e,t,n,r)}function A(e,t,n,r){return H(j(t),e,n,r)}function S(e,t,n,r){return H(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function w(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,l=e[i],c=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=n)switch(d){case 1:l<128&&(c=l);break;case 2:128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(u=(15&l)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function D(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=B(e[a]);return i}function M(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function L(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function x(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function O(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function P(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(e,t,n,r,a){return a||P(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,a){return a||P(e,0,n,8),i.write(e,t,n,r,52,8),n+8}t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return l(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return d(null,e)},u.allocUnsafeSlow=function(e){return d(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),c=e.slice(t,n),d=0;d<s;++d)if(l[d]!==c[d]){a=l[d],o=c[d];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return k(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return k(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=u.isBuffer(e)?e:G(new u(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function j(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(13))},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,a=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==a&&e.removeListener("error",a),n([].slice.call(arguments))}var a;"error"!==t&&(a=function(n){e.removeListener(t,i),r(n)},e.once("error",a)),e.once(t,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,a,o,s;if(l(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,s=u,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)a(u,this,t);else{var l=u.length,c=m(u,l);for(n=0;n<l;++n)a(c[n],this,t)}return!0},s.prototype.addListener=function(e,t){return d(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return d(this,e,t,!0)},s.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,a,o;if(l(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){(t=e.exports=n(71)).Stream=t,t.Readable=t,t.Writable=n(49),t.Duplex=n(16),t.Transform=n(74),t.PassThrough=n(124)},function(e,t,n){"use strict";(function(t,r,i){var a=n(37);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(void 0),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=y;var s,u=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:a.nextTick;y.WritableState=v;var l=Object.create(n(28));l.inherits=n(21);var c,d={deprecate:n(123)},f=n(72),h=n(38).Buffer,p=i.Uint8Array||function(){},g=n(73);function m(){}function v(e,t){s=s||n(16),e=e||{};var r=t instanceof s;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,l=e.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(l||0===l)?l:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(a.nextTick(i,r),a.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),S(e,t))}(e,n,r,t,i);else{var o=b(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||_(e,n),r?u(T,e,n,o,i):T(e,n,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function y(e){if(s=s||n(16),!(c.call(y,this)||this instanceof s))return new y(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),f.call(this)}function E(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function T(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),S(e,t)}function _(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,E(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,c=n.encoding,d=n.callback;if(E(e,t,!1,t.objectMode?1:l.length,l,c,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function b(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function A(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),S(e,t)}))}function S(e,t){var n=b(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(A,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}l.inherits(y,f),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:d.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===y&&e&&e._writableState instanceof v}})):c=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,n){var r,i=this._writableState,o=!1,s=!i.objectMode&&(r=e,h.isBuffer(r)||r instanceof p);return s&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=m),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),a.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),a.nextTick(r,o),i=!1),i}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,r,i,a){if(!n){var o=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,n)),t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else E(e,t,!1,s,r,i,a);return u}(this,i,s,e,t,n)),o},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||_(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,S(e,t),n&&(t.finished?a.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(36),n(121).setImmediate,n(13))},function(e,t,n){"use strict";var r=n(38).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=l,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=d,t=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.StringDecoder=a,a.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=o(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=o(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=o(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(){var e={};return{save:function(t){var n=t.streamId,r=t.representationId;e[n]=e[n]||{},e[n][r]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}a.__dashjs_factory_name="InitCache",t.default=i.default.getSingletonFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}a.__dashjs_factory_name="RequestModifier",t.default=i.default.getSingletonFactory(a)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var a=function e(){r(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure",t.PlayList=i,t.PlayListTrace=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(e){var t=(e=e||{}).requestModifier;return{load:function(e){var n=new Date,r=e.request,i=new XMLHttpRequest;if(i.open(e.method,e.url,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=n),t&&(i=t.modifyRequestHeader(i)),e.headers)for(var a in e.headers){var o=e.headers[a];o&&i.setRequestHeader(a,o)}i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.ontimeout=e.ontimeout,i.timeout=e.timeout,i.send(),e.response=i},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}a.__dashjs_factory_name="XHRLoader";var o=i.default.getClassFactory(a);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=T(n(1)),i=T(n(8)),a=T(n(167)),o=T(n(168)),s=T(n(169)),u=T(n(170)),l=T(n(83)),c=T(n(84)),d=T(n(85)),f=T(n(171)),h=T(n(86)),p=T(n(12)),g=T(n(0)),m=T(n(2)),v=T(n(6)),y=T(n(10)),E=n(57);function T(e){return e&&e.__esModule?e:{default:e}}function _(){var e,t=void 0,n=void 0,g=void 0,T=this.context,_=(0,p.default)(T).getInstance(),b=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function A(e,t){var n=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=!1,d=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(s=e.ContentComponent_asArray),u=t!==r.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var f=x(e.Representation_asArray[0]);if(f&&f.length>0&&E.THUMBNAILS_SCHEME_ID_URIS.indexOf(f[0].schemeIdUri)>=0)return t===r.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(i.default.CODECS)&&(0===(l=e.Representation_asArray[0].codecs).search(r.default.STPP)||0===l.search(r.default.WVTT)))return t===r.default.FRAGMENTED_TEXT}if(s){if(s.length>1)return t===r.default.MUXED;s[0]&&s[0].contentType===t&&(c=!0,d=!0)}if(e.hasOwnProperty(i.default.MIME_TYPE)&&(c=u.test(e.mimeType),d=!0),!d)for(n=0,a=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!d&&n<a;)(o=e.Representation_asArray[n]).hasOwnProperty(i.default.MIME_TYPE)&&(c=u.test(o.mimeType),d=!0),n++;return c}function S(e){return A(e,r.default.AUDIO)}function w(e){return A(e,r.default.VIDEO)}function I(e){return A(e,r.default.FRAGMENTED_TEXT)}function R(e){return A(e,r.default.IMAGE)}function C(e){return"text/vtt"===e||"application/ttml+xml"===e}function D(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort((function(e,t){return e.bandwidth-t.bandwidth})),e}function M(e,t){return e&&e.Period_asArray&&b(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function L(e){return e&&e.Period_asArray?e.Period_asArray:[]}function N(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===i.default.DYNAMIC),t}function x(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map((function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}})):null}function O(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=s.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(i.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function P(e,t){var n=[],a=void 0;if(!e)return n;for(a=0;a<e.length;a++){var o=new f.default;if(o.timescale=1,o.representation=t,!e[a].hasOwnProperty(r.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=e[a].schemeIdUri,e[a].hasOwnProperty(i.default.TIMESCALE)&&(o.timescale=e[a].timescale),e[a].hasOwnProperty(i.default.VALUE)&&(o.value=e[a].value),n.push(o)}return n}function k(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some((function(n){if(n){var a=new d.default,o=n.__text||n;return _.isRelative(o)&&(r=!0,e.baseUri&&(o=_.resolve(o,e.baseUri))),a.url=o,n.hasOwnProperty(i.default.SERVICE_LOCATION)&&n.serviceLocation.length?a.serviceLocation=n.serviceLocation:a.serviceLocation=o,n.hasOwnProperty(i.default.DVB_PRIORITY)&&(a.dvb_priority=n[i.default.DVB_PRIORITY]),n.hasOwnProperty(i.default.DVB_WEIGHT)&&(a.dvb_weight=n[i.default.DVB_WEIGHT]),n.hasOwnProperty(i.default.AVAILABILITY_TIME_OFFSET)&&(a.availabilityTimeOffset=n[i.default.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(i.default.AVAILABILITY_TIME_COMPLETE)&&(a.availabilityTimeComplete="false"!==n[i.default.AVAILABILITY_TIME_COMPLETE]),t.push(a),r}})),t}return e={getIsTypeOf:A,getIsTextTrack:C,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(i.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(i.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=M(t,n);return r.length>0&&b(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var r=M(t,n),i=0;i<r.length;i++)if((0,h.default)(T).getInstance().areEqual(r[i],e))return i;return-1},getAdaptationForId:function(e,t,n){var r,a=M(t,n),o=void 0;for(o=0,r=a.length;o<r;o++)if(a[o].hasOwnProperty(i.default.ID)&&a[o].id===e)return a[o];return null},getAdaptationsForType:function(e,t,n){var r,i=M(e,t),a=void 0,o=[];for(a=0,r=i.length;a<r;a++)A(i[a],n)&&o.push(D(i[a]));return o},getRealPeriods:L,getRealPeriodForIndex:function(e,t){var n=L(t);return n.length>0&&b(e)?n[e]:null},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=b(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r&&(r=r.replace(/\sprofiles=[^;]*/g,"")),r},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(i.default.CENC_DEFAULT_KID)?e[i.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(i.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:N,getId:function(e){return e&&e[i.default.ID]||null},hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(i.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(i.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getPublishTime:function(e){return e&&e.hasOwnProperty(i.default.PUBLISH_TIME)?new Date(e[i.default.PUBLISH_TIME]):null},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=D(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map((function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}}))},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&b(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,r,o,s,u=[],l=function(e){if(e&&e.period&&b(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&b(e.index))return D(t.AdaptationSet_asArray[e.index])}}(e),c=void 0,d=void 0;if(l&&l.Representation_asArray){if(e&&e.period&&b(e.period.index)){var f=k(e.period.mpd.manifest);f&&(d=f[0])}for(var h=0,p=l.Representation_asArray.length;h<p;++h){var g=l.Representation_asArray[h],m=new a.default;if(m.index=h,m.adaptation=e,g.hasOwnProperty(i.default.ID)&&(m.id=g.id),g.hasOwnProperty(i.default.CODECS)&&(m.codecs=g.codecs),g.hasOwnProperty(i.default.CODEC_PRIVATE_DATA)&&(m.codecPrivateData=g.codecPrivateData),g.hasOwnProperty(i.default.BANDWITH)&&(m.bandwidth=g.bandwidth),g.hasOwnProperty(i.default.WIDTH)&&(m.width=g.width),g.hasOwnProperty(i.default.HEIGHT)&&(m.height=g.height),g.hasOwnProperty(i.default.SCAN_TYPE)&&(m.scanType=g.scanType),g.hasOwnProperty(i.default.MAX_PLAYOUT_RATE)&&(m.maxPlayoutRate=g.maxPlayoutRate),g.hasOwnProperty(i.default.SEGMENT_BASE)?(c=g.SegmentBase,m.segmentInfoType=i.default.SEGMENT_BASE):g.hasOwnProperty(i.default.SEGMENT_LIST)?(c=g.SegmentList).hasOwnProperty(i.default.SEGMENT_TIMELINE)?m.segmentInfoType=i.default.SEGMENT_TIMELINE:m.segmentInfoType=i.default.SEGMENT_LIST:g.hasOwnProperty(i.default.SEGMENT_TEMPLATE)?((c=g.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE)?m.segmentInfoType=i.default.SEGMENT_TIMELINE:m.segmentInfoType=i.default.SEGMENT_TEMPLATE,c.hasOwnProperty(i.default.INITIALIZATION_MINUS)&&(m.initialization=c.initialization.split("$Bandwidth$").join(g.bandwidth).split("$RepresentationID$").join(g.id))):m.segmentInfoType=i.default.BASE_URL,m.essentialProperties=x(g),c){if(c.hasOwnProperty(i.default.INITIALIZATION)){var v=c.Initialization;v.hasOwnProperty(i.default.SOURCE_URL)&&(m.initialization=v.sourceURL),v.hasOwnProperty(i.default.RANGE)&&(m.range=v.range)}else g.hasOwnProperty(i.default.MIME_TYPE)&&C(g.mimeType)&&(m.range=0);c.hasOwnProperty(i.default.TIMESCALE)&&(m.timescale=c.timescale),c.hasOwnProperty(i.default.DURATION)?m.segmentDuration=c.duration/m.timescale:g.hasOwnProperty(i.default.SEGMENT_TEMPLATE)&&(c=g.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE)&&(m.segmentDuration=(o=void 0,o=(r=c.SegmentTimeline).S_asArray[0],s=r.S_asArray[1],(o.hasOwnProperty("d")?o.d:s.t-o.t)/m.timescale)),c.hasOwnProperty(i.default.MEDIA)&&(m.media=c.media),c.hasOwnProperty(i.default.START_NUMBER)&&(m.startNumber=c.startNumber),c.hasOwnProperty(i.default.INDEX_RANGE)&&(m.indexRange=c.indexRange),c.hasOwnProperty(i.default.PRESENTATION_TIME_OFFSET)&&(m.presentationTimeOffset=c.presentationTimeOffset/m.timescale),c.hasOwnProperty(i.default.AVAILABILITY_TIME_OFFSET)?m.availabilityTimeOffset=c.availabilityTimeOffset:d&&void 0!==d.availabilityTimeOffset&&(m.availabilityTimeOffset=d.availabilityTimeOffset),c.hasOwnProperty(i.default.AVAILABILITY_TIME_COMPLETE)?m.availabilityTimeComplete="false"!==c.availabilityTimeComplete:d&&void 0!==d.availabilityTimeComplete&&(m.availabilityTimeComplete=d.availabilityTimeComplete)}m.MSETimeOffset=(n=(t=m).presentationTimeOffset,t.adaptation.period.start-n),m.path=[e.period.index,e.index,h],u.push(m)}}return u},getAdaptationsForPeriod:function(e){var t=e&&b(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],a=void 0,s=void 0,u=void 0;if(t&&t.AdaptationSet_asArray)for(u=0;u<t.AdaptationSet_asArray.length;u++)s=t.AdaptationSet_asArray[u],a=new o.default,s.hasOwnProperty(i.default.ID)&&(a.id=s.id),a.index=u,a.period=e,A(s,r.default.MUXED)?a.type=r.default.MUXED:S(s)?a.type=r.default.AUDIO:w(s)?a.type=r.default.VIDEO:I(s)?a.type=r.default.FRAGMENTED_TEXT:R(s)?a.type=r.default.IMAGE:a.type=r.default.TEXT,n.push(a);return n},getRegularPeriods:function(e){var a,o=!!e&&N(e.manifest),u=[],l=null,c=null,d=null,f=null,h=void 0;for(h=0,a=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;h<a;h++)(c=e.manifest.Period_asArray[h]).hasOwnProperty(i.default.START)?(f=new s.default).start=c.start:null!==l&&l.hasOwnProperty(i.default.DURATION)&&null!==d?(f=new s.default).start=parseFloat((d.start+d.duration).toFixed(5)):0!==h||o||((f=new s.default).start=0),null!==d&&isNaN(d.duration)&&(null!==f?d.duration=parseFloat((f.start-d.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==f&&(f.id=O(c,h),f.index=h,f.mpd=e,c.hasOwnProperty(i.default.DURATION)&&(f.duration=c.duration),u.push(f),l=c,d=f),c=null,f=null;return 0===u.length||null!==d&&isNaN(d.duration)&&(d.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error(r.default.MISSING_CONFIG_ERROR)}();var t=N(e.mpd.manifest),i=void 0;return e.mpd.manifest.mediaPresentationDuration?i=e.mpd.manifest.mediaPresentationDuration:e.duration?i=e.duration:t?i=Number.POSITIVE_INFINITY:n.error(new v.default(y.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),i}(d)-d.start).toFixed(5))),u},getMpd:function(e){var t=new u.default;return e&&(t.manifest=e,e.hasOwnProperty(i.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(i.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(i.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(i.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(i.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(i.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(i.default.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=t?t.Period_asArray:null,a=n&&e&&b(e.index)?n[e.index].EventStream_asArray:null,o=[],s=void 0,u=void 0;if(a)for(s=0;s<a.length;s++){var l=new f.default;if(l.period=e,l.timescale=1,!a[s].hasOwnProperty(r.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(l.schemeIdUri=a[s][r.default.SCHEME_ID_URI],a[s].hasOwnProperty(i.default.TIMESCALE)&&(l.timescale=a[s][i.default.TIMESCALE]),a[s].hasOwnProperty(i.default.VALUE)&&(l.value=a[s][i.default.VALUE]),a[s].hasOwnProperty(i.default.PRESENTATION_TIME_OFFSET)&&(l.presentationTimeOffset=a[s][i.default.PRESENTATION_TIME_OFFSET]),u=0;a[s].Event_asArray&&u<a[s].Event_asArray.length;u++){var d=a[s].Event_asArray[u],h=new c.default;if(h.presentationTime=0,h.eventStream=l,d.hasOwnProperty(i.default.PRESENTATION_TIME)){h.presentationTime=d.presentationTime;var p=l.presentationTimeOffset?l.presentationTimeOffset/l.timescale:0;h.calculatedPresentationTime=h.presentationTime/l.timescale+e.start-p}d.hasOwnProperty(i.default.DURATION)&&(h.duration=d.duration/l.timescale),d.hasOwnProperty(i.default.ID)&&(h.id=d.id),d.Signal&&d.Signal.Binary?h.messageData=g.decodeArray(d.Signal.Binary.toString()):h.messageData=d.messageData||d.__text,o.push(h)}}return o},getEssentialPropertiesForRepresentation:x,getEventStreamForAdaptationSet:function(e,t){var n=void 0,r=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.period&&b(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&b(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),P(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,r=void 0,i=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&b(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&b(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&b(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),P(n,t)},getUTCTimingSources:function(e){var t=N(e),n=!!e&&e.hasOwnProperty(i.default.AVAILABILITY_START_TIME),a=e?e.UTCTiming_asArray:null,o=[];return(t||n)&&a&&a.forEach((function(e){var t=new l.default;e.hasOwnProperty(r.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(i.default.VALUE)&&(t.value=e.value.toString(),o.push(t)))})),o},getBaseURLsFromElement:k,getRepresentationSortFunction:function(){return function(e,t){return e.bandwidth-t.bandwidth}},getLocation:function(e){if(e&&e.hasOwnProperty(r.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getPatchLocation:function(e){if(e&&e.hasOwnProperty(i.default.PATCH_LOCATION))return e.PatchLocation=e.PatchLocation_asArray[0],e.PatchLocation},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(i.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(i.default.SERVICE_DESCRIPTION)){var n=!0,a=!1,o=void 0;try{for(var s,u=e.ServiceDescription_asArray[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var l=s.value,c=void 0,d=void 0,f=void 0,h=void 0;for(var p in l)l.hasOwnProperty(p)&&(p===i.default.ID?c=l[p]:p===i.default.SERVICE_DESCRIPTION_SCOPE?d=l[p].schemeIdUri:p===i.default.SERVICE_DESCRIPTION_LATENCY?f={target:l[p].target,max:l[p].max,min:l[p].min}:p===i.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(h={max:l[p].max,min:l[p].min}));d===r.default.SERVICE_DESCRIPTION_LL_SCHEME&&(f||h)&&t.push({id:c,schemeIdUri:d,latency:f,playbackRate:h})}}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}}return t},getSupplementalPropperties:function(e){var t={};if(e&&e.hasOwnProperty(i.default.SUPPLEMENTAL_PROPERTY)){var n=!0,a=!1,o=void 0;try{for(var s,u=e.SupplementalProperty_asArray[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var l=s.value;l.hasOwnProperty(r.default.SCHEME_ID_URI)&&l.hasOwnProperty(i.default.VALUE)&&(t[l[r.default.SCHEME_ID_URI]]=l[i.default.VALUE])}}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}}return t},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(g=e.BASE64))}},t=(0,m.default)(T).getInstance().getLogger(e),e}_.__dashjs_factory_name="DashManifestModel",t.default=g.default.getSingletonFactory(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THUMBNAILS_SCHEME_ID_URIS=void 0;var r=h(n(1)),i=h(n(8)),a=h(n(0)),o=h(n(173)),s=h(n(12)),u=n(22),l=h(n(4)),c=h(n(27)),d=h(n(55)),f=h(n(80));function h(e){return e&&e.__esModule?e:{default:e}}var p=t.THUMBNAILS_SCHEME_ID_URIS=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function g(e){var t,n=this.context,a=e.adapter,h=e.baseURLController,g=e.streamInfo,m=e.timelineConverter,v=e.debug,y=e.eventBus,E=e.events,T=e.dashConstants,_=(0,s.default)(n).getInstance(),b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0;function C(){M(),I=(0,d.default)(n).create({}),R=(0,c.default)(n).getInstance(),(A=(0,f.default)(n).create({streamInfo:g,timelineConverter:m,baseURLController:h,debug:v,eventBus:y,events:E,dashConstants:T,urlUtils:_})).initialize(!!a&&a.getIsDynamic()),function(){if(g&&a&&(w=a.getMediaInfoForType(g,r.default.IMAGE))){var e=a.getVoRepresentations(w);e&&e.length>0&&e.forEach((function(e){(e.segmentInfoType===i.default.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===i.default.SEGMENT_TIMELINE)&&D(e),e.segmentInfoType===i.default.SEGMENT_BASE&&D(e,!0)})),b.length>0&&(b.sort((function(e,t){return e.bitrate-t.bitrate})),S=b.length-1)}}()}function D(e,t){var n=new o.default;n.id=e.id,n.bitrate=e.bandwidth,n.width=e.width,n.height=e.height,n.tilesHor=1,n.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach((function(e){if(p.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(n.tilesHor=parseInt(t[0],10),n.tilesVert=parseInt(t[1],10))}})),t?y.trigger(l.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{streamId:g.id,mediaType:r.default.IMAGE,mimeType:w.mimeType,representation:e,callback:function(e,t,r,i){var o=[];r=function(e,t){var n,r=[],i=0,o=void 0,s=void 0,l=void 0;for(o=0,n=e.length;o<n;o++)s=e[o],(l=(0,u.getTimeBasedSegment)(m,a.getIsDynamic(),t,s.startTime,s.duration,s.timescale,s.media,s.mediaRange,i))&&(r.push(l),l=null,i++);return r}(r,i),n.segmentDuration=r[0].duration,n.readThumbnail=function(e,t){var n=null;o.some((function(t){if(t.start<=e&&t.end>e)return n=t.url,!0})),n?t(n):r.some((function(n){if(n.mediaStartTime<=e&&n.mediaStartTime+n.duration>e){var r=h.resolve(i.path);return I.load({method:"get",url:r.url,request:{range:n.mediaRange,responseType:"arraybuffer"},onload:function(e){var r=R.getSamplesInfo(e.target.response),i=new Blob([e.target.response.slice(r.sampleList[0].offset,r.sampleList[0].offset+r.sampleList[0].size)],{type:"image/jpeg"}),a=window.URL.createObjectURL(i);o.push({start:n.mediaStartTime,end:n.mediaStartTime+n.duration,url:a}),t&&t(a)}}),!0}}))}}}):(n.startNumber=e.startNumber,n.segmentDuration=e.segmentDuration,n.timescale=e.timescale,n.templateUrl=function(e){var t=_.isRelative(e.media)?_.resolve(e.media,h.resolve(e.path).url):e.media;return t?(0,u.replaceIDForTemplate)(t,e.id):""}(e)),n.tilesHor>0&&n.tilesVert>0&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,b.push(n))}function M(){b=[],S=-1,w=null}return t={initialize:C,getTracks:function(){return b},reset:M,setTrackByIndex:function(e){b&&0!==b.length&&(e>=b.length&&(e=b.length-1),S=e)},getCurrentTrack:function(){return S<0?null:b[S]},getCurrentTrackIndex:function(){return S},getThumbnailRequestForTime:function(e){for(var t=void 0,n=a.getVoRepresentations(w),r=0;r<n.length;r++)if(b[S].id===n[r].id){t=n[r];break}return A.getSegmentRequestForTime(w,t,e)}},C(),t}g.__dashjs_factory_name="ThumbnailTracks",t.default=a.default.getClassFactory(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}return r(e,[{key:"toJWK",value:function(){var e=void 0,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=W(n(65)),i=W(n(1)),a=W(n(8)),o=W(n(9)),s=W(n(102)),u=W(n(104)),l=W(n(180)),c=W(n(181)),d=W(n(182)),f=W(n(188)),h=W(n(200)),p=W(n(91)),g=W(n(201)),m=W(n(44)),v=W(n(53)),y=W(n(42)),E=W(n(202)),T=W(n(204)),_=W(n(205)),b=W(n(77)),A=W(n(81)),S=W(n(206)),w=W(n(82)),I=W(n(207)),R=W(n(2)),C=W(n(10)),D=W(n(3)),M=W(n(4)),L=W(n(20)),N=W(n(0)),x=W(n(23)),O=n(92),P=W(n(208)),k=W(n(212)),F=W(n(220)),U=W(n(232)),B=n(7),G=W(n(233)),j=W(n(43)),H=W(n(6)),K=n(14),Y=W(n(87)),V=W(n(12)),q=W(n(27));function W(e){return e&&e.__esModule?e:{default:e}}function z(){var e,t="You must first call initialize() and set a source before calling this method",n="You must first call initialize() and set a valid source and view before calling this method",W="You must first call attachView() to set the video element before calling this method",z="You must first call attachSource() with a valid source before calling this method",X=this.context,Q=(0,D.default)(X).getInstance(),J=(0,x.default)(X).getInstance(),Z=(0,R.default)(X).getInstance({settings:J}),$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,ce=void 0,de=void 0,fe=void 0,he=void 0,pe=void 0,ge=void 0,me=void 0,ve=void 0,ye=void 0,Ee=void 0,Te=void 0,_e=void 0,be=void 0,Ae=void 0,Se=void 0,we=void 0,Ie=void 0,Re=void 0,Ce=void 0,De=void 0,Me=void 0,Le=void 0,Ne=void 0,xe=void 0;function Oe(){ze(null),Ve(null),te=null,ce&&(ce.reset(),ce=null),de&&(de.reset(),de=null),Me.reset(),J.reset(),he&&(he.reset(),he=null)}function Pe(){return!!ee&&!!Ie.getElement()}function ke(){return(0,O.getVersionString)()}function Fe(){if(!ie)throw n;return be.isPaused()}function Ue(e){var t=Ae.getCurrentDVRInfo();if(!t)return 0;var n=be.getLiveDelay(),r=t.range.start+e;return r>t.range.end-n&&(r=t.range.end-n),r}function Be(e){if(!ie)throw n;var t=Ye().currentTime;if(void 0!==e)t=Te.getTimeRelativeToStreamId(t,e);else if(be.getIsDynamic()){var r=Ae.getCurrentDVRInfo();t=null===r||0===t?0:Math.max(0,t-r.range.start)}return t}function Ge(){if(!ie)throw n;var e=Ye().duration;if(be.getIsDynamic()){var t=Ae.getCurrentDVRInfo();e=t?t.range.end-t.range.start:0}return e}function je(e){(0,K.checkParameterType)(e,"boolean"),ae=e}function He(){ge.restoreDefaultUTCTimingSources()}function Ke(){return Ae}function Ye(){if(!Ie.getElement())throw W;return Ie.getElement()}function Ve(e){if(!ne)throw"MediaPlayer not initialized!";Ie.setElement(e),e&&(Ze(),function(){if(!de){var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(X).create();de=t.createMetricsReporting({debug:Z,eventBus:Q,mediaElement:Ye(),adapter:pe,dashMetrics:Ae,events:M.default,constants:i.default,metricsConstants:o.default})}}}(),function(){if(!fe){var e=dashjs.MssHandler;"function"==typeof e&&(C.default.extend(e.errors),fe=e(X).create({eventBus:Q,mediaPlayerModel:ge,dashMetrics:Ae,manifestModel:Se,playbackController:be,streamController:Te,protectionController:ce,baseURLController:ve,errHandler:me,events:M.default,constants:i.default,debug:Z,initSegmentType:B.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:G.default,ISOBoxer:j.default,settings:J}))}}(),Te&&Te.switchToVideoElement()),ie&&Qe(),tt()}function qe(e){if(!re)throw t;var n=Te.getActiveStreamInfo();return le.getTracksFor(e,n)}function We(e,t){var n=-1;e.some((function(e,r){if(e===t)return n=r,!0})),n<0||e.splice(n,1)}function ze(e){if(!ne)throw"MediaPlayer not initialized!";"string"==typeof e&&Ce.initialize(e),ee=e,(re||ie)&&Qe(),Pe()&&tt()}function Xe(){if(!re)throw t;var e=Te.getActiveStreamInfo();return e?Te.getStreamById(e.id):null}function Qe(){ie=!1,re=!1,pe.reset(),Te.reset(),_e.reset(),be.reset(),oe.reset(),le.reset(),Re.reset(),ce&&(J.get().streaming.keepProtectionMediaKeys?ce.stop():(ce.reset(),ce=null,Ze())),we.reset()}function Je(){return(0,f.default)(X).create({debug:Z,errHandler:me,dashMetrics:Ae,mediaPlayerModel:ge,requestModifier:(0,v.default)(X).getInstance(),mssHandler:fe,settings:J})}function Ze(){if(ce)return ce;var e=dashjs.Protection;if("function"==typeof e){var t=e(X).create();return M.default.extend(e.events),L.default.extend(e.events,{publicOnly:!0}),C.default.extend(e.errors),ye||(ye=(0,p.default)(X).getInstance()),(ce=t.createProtectionSystem({debug:Z,errHandler:me,videoModel:Ie,capabilities:ye,eventBus:Q,events:M.default,BASE64:G.default,constants:i.default,cmcdModel:we,settings:J}))&&(ce.setLicenseRequestFilters(Le),ce.setLicenseResponseFilters(Ne)),ce}return null}function $e(){if(!ne)throw"MediaPlayer not initialized!";if(he)return he;var e=dashjs.OfflineController;if("function"==typeof e){M.default.extend(e.events),L.default.extend(e.events,{publicOnly:!0}),C.default.extend(e.errors);var t=Je(),n=(0,Y.default)(X).create();return n.setConfig({manifestModel:Se,adapter:pe,manifestLoader:t,errHandler:me}),he=e(X).create({debug:Z,manifestUpdater:n,baseURLController:ve,manifestLoader:t,manifestModel:Se,mediaPlayerModel:ge,abrController:oe,playbackController:be,adapter:pe,errHandler:me,dashMetrics:Ae,timelineConverter:ue,schemeLoaderFactory:se,eventBus:Q,events:M.default,errors:C.default,constants:i.default,settings:J,dashConstants:a.default,urlUtils:(0,V.default)(X).getInstance()})}return null}function et(e){var t=Ae.getCurrentDVRInfo();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function tt(){var e;he&&he.resetRecords(),!re&&ee&&(re=!0,$.info("Streaming Initialized"),e=Je(),Te||(Te=(0,u.default)(X).getInstance()),Ee.setConfig({capabilities:ye,adapter:pe,settings:J}),Ee.setCustomCapabilitiesFilters(xe),Te.setConfig({capabilities:ye,capabilitiesFilter:Ee,manifestLoader:e,manifestModel:Se,mediaPlayerModel:ge,protectionController:ce,adapter:pe,dashMetrics:Ae,errHandler:me,timelineConverter:ue,videoModel:Ie,playbackController:be,abrController:oe,mediaController:le,textController:Re,settings:J,baseURLController:ve}),_e.setConfig({settings:J,playbackController:be,streamController:Te,videoModel:Ie,timelineConverter:ue,adapter:pe}),be.setConfig({streamController:Te,dashMetrics:Ae,mediaPlayerModel:ge,adapter:pe,videoModel:Ie,timelineConverter:ue,uriFragmentModel:Ce,settings:J}),oe.setConfig({streamController:Te,domStorage:De,mediaPlayerModel:ge,dashMetrics:Ae,adapter:pe,videoModel:Ie,settings:J}),Re.setConfig({errHandler:me,manifestModel:Se,adapter:pe,mediaController:le,streamController:Te,videoModel:Ie}),we.setConfig({abrController:oe,dashMetrics:Ae,playbackController:be}),Te.initialize(ae,te),_e.initialize(),we.initialize(),"string"==typeof ee?Te.load(ee):Te.loadWithManifest(ee)),!ie&&Pe()&&(ie=!0,$.info("Playback Initialized"))}return e={initialize:function(e,t,n){ye||(ye=(0,p.default)(X).getInstance()),me=(0,h.default)(X).getInstance(),ye.supportsMediaSource()?ne||(ne=!0,ue=(0,U.default)(X).getInstance(),oe||(oe=(0,b.default)(X).getInstance()).setConfig({settings:J}),se||(se=(0,A.default)(X).getInstance()),be||(be=(0,s.default)(X).getInstance()),le||(le=(0,c.default)(X).getInstance()),Te||(Te=(0,u.default)(X).getInstance()),_e||(_e=(0,l.default)(X).getInstance()),Ee||(Ee=(0,g.default)(X).getInstance()),pe=(0,k.default)(X).getInstance(),Se=(0,T.default)(X).getInstance(),we=(0,w.default)(X).getInstance(),Ae=(0,F.default)(X).getInstance({settings:J}),Re=(0,y.default)(X).getInstance(),De=(0,I.default)(X).getInstance({settings:J}),pe.setConfig({constants:i.default,cea608parser:r.default,errHandler:me,BASE64:G.default}),ve||(ve=(0,d.default)(X).create()),ve.setConfig({adapter:pe}),(Me=(0,P.default)(X).getInstance({dashMetrics:Ae,mediaPlayerModel:ge,errHandler:me,baseURLController:ve,events:M.default,eventBus:Q,debug:Z,boxParser:(0,q.default)(X).getInstance(),requestModifier:(0,v.default)(X).getInstance(),errors:C.default})).initialize(),le.setConfig({domStorage:De,settings:J}),He(),je(void 0===n||n),$e(),e&&Ve(e),t&&ze(t),$.info("[dash.js "+ke()+"] MediaPlayer has been initialized")):me.error(new H.default(C.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,C.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(ye=e.capabilities),e.capabilitiesFilter&&(Ee=e.capabilitiesFilter),e.streamController&&(Te=e.streamController),e.gapController&&(_e=e.gapController),e.playbackController&&(be=e.playbackController),e.mediaPlayerModel&&(ge=e.mediaPlayerModel),e.abrController&&(oe=e.abrController),e.schemeLoaderFactory&&(se=e.schemeLoaderFactory),e.mediaController&&(le=e.mediaController),e.settings&&(J=e.settings))},on:function(e,t,n,r){Q.on(e,t,n,r)},off:function(e,t,n){Q.off(e,t,n)},extend:function(e,t,n){N.default.extend(e,t,n,X)},attachView:Ve,attachSource:ze,isReady:Pe,preload:function(){if(Ie.getElement()||re)return!1;if(!ee)throw z;tt()},play:function(){if(!ie)throw n;(!ae||Fe()&&ie)&&be.play()},isPaused:Fe,pause:function(){if(!ie)throw n;be.pause()},isSeeking:function(){if(!ie)throw n;return be.isSeeking()},isDynamic:function(){if(!ie)throw n;return be.getIsDynamic()},seek:function(e){if(!ie)throw n;if((0,K.checkParameterType)(e,"number"),isNaN(e))throw i.default.BAD_ARGUMENT_ERROR;var t=be.getIsDynamic()?Ue(e):e;be.seek(t)},setPlaybackRate:function(e){Ye().playbackRate=e},getPlaybackRate:function(){return Ye().playbackRate},setMute:function(e){(0,K.checkParameterType)(e,"boolean"),Ye().muted=e},isMuted:function(){return Ye().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw i.default.BAD_ARGUMENT_ERROR;Ye().volume=e},getVolume:function(){return Ye().volume},time:Be,duration:Ge,timeAsUTC:function(){if(!ie)throw n;return Be()<0?NaN:et(Be())},durationAsUTC:function(){if(!ie)throw n;return et(Ge())},getActiveStream:Xe,getDVRWindowSize:function(){var e=Ae.getCurrentDVRInfo();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:Ue,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o},getVersion:ke,getDebug:function(){return Z},getBufferLength:function(e){var t=[i.default.VIDEO,i.default.AUDIO,i.default.FRAGMENTED_TEXT];if(e)return-1!==t.indexOf(e)?Ke().getCurrentBufferLevel(e)||NaN:($.warn("getBufferLength requested for invalid type"),NaN);var n=t.map((function(e){return qe(e).length>0?Ke().getCurrentBufferLevel(e):Number.MAX_VALUE})).reduce((function(e,t){return Math.min(e,t)}));return n===Number.MAX_VALUE?NaN:n},getTTMLRenderingDiv:function(){return Ie?Ie.getTTMLRenderingDiv():null},getVideoElement:Ye,getSource:function(){if(!ee)throw z;return ee},getCurrentLiveLatency:function(){if(!ne)throw"MediaPlayer not initialized!";return ie?be.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!re)throw t;return oe.getTopBitrateInfoFor(e)},setAutoPlay:je,getAutoPlay:function(){return ae},getDashMetrics:Ke,getQualityFor:function(e){if(!re)throw t;if(e===i.default.IMAGE){var n=Xe();if(!n)return-1;var r=n.getThumbnailController();return r?r.getCurrentTrackIndex():-1}return oe.getQualityFor(e)},setQualityFor:function(e,n){if(!re)throw t;if(e===i.default.IMAGE){var r=Xe();if(!r)return;var a=r.getThumbnailController();a&&a.setTrackByIndex(n)}oe.setPlaybackQuality(e,Te.getActiveStreamInfo(),n)},updatePortalSize:function(){oe.setElementSize(),oe.setWindowResizeEventCalled(!0)},setTextDefaultLanguage:function(e){$.warn('setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead'),void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.setTextDefaultLanguage(e)},getTextDefaultLanguage:function(){return $.warn('getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead'),void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.setTextDefaultEnabled(e)},getTextDefaultEnabled:function(){return void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.getTextDefaultEnabled()},enableText:function(e){void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.enableText(e)},enableForcedTextStreaming:function(e){void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.enableForcedTextStreaming(e)},isTextEnabled:function(){return void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.isTextEnabled()},setTextTrack:function(e){if(!ie)throw n;void 0===Re&&(Re=(0,y.default)(X).getInstance()),Re.setTextTrack(e)},getBitrateInfoListFor:function(e){if(!re)throw t;var n=Xe();return n?n.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!re)throw t;return pe.getStreamsInfo(e)},getTracksFor:qe,getTracksForTypeFromManifest:function(e,n,r){if(!re)throw t;return(r=r||pe.getStreamsInfo(n,1)[0])?pe.getAllMediaInfoForType(r,e,n):[]},getCurrentTrackFor:function(e){if(!re)throw t;var n=Te.getActiveStreamInfo();return le.getCurrentTrackFor(e,n)},setInitialMediaSettingsFor:function(e,t){if(!ne)throw"MediaPlayer not initialized!";le.setInitialSettings(e,t),e===i.default.FRAGMENTED_TEXT&&Re.setInitialSettings(t)},getInitialMediaSettingsFor:function(e){if(!ne)throw"MediaPlayer not initialized!";return le.getInitialSettings(e)},setCurrentTrack:function(e){if(!re)throw t;le.setTrack(e)},getTrackSwitchModeFor:function(e){if(!ne)throw"MediaPlayer not initialized!";return le.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!ne)throw"MediaPlayer not initialized!";le.setSwitchMode(e,t)},setSelectionModeForInitialTrack:function(e){if(!ne)throw"MediaPlayer not initialized!";le.setSelectionModeForInitialTrack(e)},getSelectionModeForInitialTrack:function(){if(!ne)throw"MediaPlayer not initialized!";return le.getSelectionModeForInitialTrack()},addABRCustomRule:function(e,t,n){ge.addABRCustomRule(e,t,n)},removeABRCustomRule:function(e){ge.removeABRCustomRule(e)},removeAllABRCustomRule:function(){ge.removeABRCustomRule()},getAverageThroughput:function(e){var t=oe.getThroughputHistory();return t?t.getAverageThroughput(e):0},retrieveManifest:function(e,t){var n=Je(),r=this;Q.on(M.default.INTERNAL_MANIFEST_LOADED,(function e(i){i.error?t(null,i.error):t(i.manifest),Q.off(M.default.INTERNAL_MANIFEST_LOADED,e,r),n.reset()}),r),Ce.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){ge.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){ge.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){ge.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:He,setXHRWithCredentialsForType:function(e,t){ge.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return ge.getXHRWithCredentialsForType(e)},getProtectionController:function(){return Ze()},attachProtectionController:function(e){ce=e},setProtectionData:function(e){te=e,Te&&Te.setProtectionData(te)},registerLicenseRequestFilter:function(e){Le.push(e),ce&&ce.setLicenseRequestFilters(Le)},registerLicenseResponseFilter:function(e){Ne.push(e),ce&&ce.setLicenseResponseFilters(Ne)},unregisterLicenseRequestFilter:function(e){We(Le,e),ce&&ce.setLicenseRequestFilters(Le)},unregisterLicenseResponseFilter:function(e){We(Ne,e),ce&&ce.setLicenseResponseFilters(Ne)},registerCustomCapabilitiesFilter:function(e){xe.push(e),Ee&&Ee.setCustomCapabilitiesFilters(xe)},unregisterCustomCapabilitiesFilter:function(e){We(xe,e),Ee&&Ee.setCustomCapabilitiesFilters(xe)},displayCaptionsOnTop:function(e){var t=(0,m.default)(X).getInstance();t.setConfig({videoModel:Ie}),t.initialize(),t.setDisplayCConTop(e)},attachTTMLRenderingDiv:function(e){if(!Ie.getElement())throw W;Ie.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=NaN;return Re&&(e=Re.getCurrentTrackIdx()),e},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var n=be.getIsDynamic()?Ue(e):e,r=Te.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i){var a=Te.getTimeRelativeToStreamId(n,r.getId());return i.provide(a,t)}t(null)}else t(null)}},getDashAdapter:function(){return pe},getOfflineController:function(){return $e()},getSettings:function(){return J.get()},updateSettings:function(e){J.update(e)},resetSettings:function(){J.reset()},reset:Oe,destroy:function(){Oe(),Le=[],Ne=[],xe=[],N.default.deleteSingletonInstances(X)}},$=Z.getLogger(e),ne=!1,ie=!1,re=!1,ae=!0,ce=null,he=null,te=null,pe=null,Me=null,M.default.extend(L.default),ge=(0,_.default)(X).getInstance(),Ie=(0,S.default)(X).getInstance(),Ce=(0,E.default)(X).getInstance(),Le=[],Ne=[],xe=[],e}z.__dashjs_factory_name="MediaPlayer";var X=N.default.getClassFactory(z);X.events=L.default,X.errors=C.default,N.default.updateClassFactory(z.__dashjs_factory_name,X),t.default=X},function(e,t,n){"use strict";!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},i={17:2,18:4,21:6,22:8,23:10,19:13,20:15},a={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},o={25:2,26:4,29:6,30:8,31:10,27:13,28:15},s=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],u={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},l=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},c=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};c.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var d=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new c(t,n,r,i,a)};d.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var f=function(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new d);this.pos=0,this.currPenState=new c};f.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(u.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>32&&(u.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=32?u.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var h=function(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new f);this.currRow=14,this.nrRollUpRows=null,this.reset()};h.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){u.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){u.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){u.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){u.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),u.log("INFO","Rolling up")}else u.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+': "'+a+'"'):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var p=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new h,this.nonDisplayedMemory=new h,this.lastOutputScreen=new h,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};p.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,u.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";u.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(u.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){u.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){u.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){u.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){u.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){u.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){u.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){u.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){u.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){u.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){u.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){u.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(u.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,u.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){u.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}u.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=u.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var g=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new p(1,t),new p(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};g.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,u.setTime(e);for(var o=0;o<t.length;o+=2)r=127&t[o],i=127&t[o+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,u.log("DEBUG","Repeated command ("+l([r,i])+") is dropped")):0!==r||0!==i?(u.log("DATA","["+l([t[o],t[o+1]])+"] -> ("+l([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),n||(a=this.parseChars(r,i))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):u.log("WARNING","No channel found yet. TEXT-MODE?")),n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,u.log("WARNING","Couldn't parse cleaned data "+l([r,i])+" orig: "+l([t[o],t[o+1]])))):this.dataCounters.padding+=2},parseCmd:function(e,t){var n;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return u.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),u.log("DEBUG","MIDROW ("+l([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,s;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,s=64<=t&&t<=95?1===n?r[e]:a[e]:1===n?i[e]:o[e];var u=this.interpretPAC(s,t);return this.channels[n-1].setPAC(u),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r,i=null,a=null,o=null;if(e>=25?(i=2,o=e-8):(i=1,o=e),17<=o&&o<=19?(r=17===o?t+80:18===o?t+112:t+144,u.log("INFO","Special char '"+n(r)+"' in channel "+i),a=[r],this.lastCmdA=e,this.lastCmdB=t):32<=e&&e<=127&&(a=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null),a){var s=l(a);u.log("DEBUG","Char codes =  "+s.join(","))}return a},parseBackgroundAttributes:function(e,t){var n,r,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=s[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}},e.logger=u,e.PenState=c,e.CaptionScreen=h,e.Cea608Parser=g,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[],o=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+n;){if(r=e.getUint32(i),6==(31&e.getUint8(i+4)))for(var s=i+5,u=-1;s<i+4+r-1;){u=0;for(var l=255;255===l;)u+=l=e.getUint8(s),s++;var c=0;for(l=255;255===l;)c+=l=e.getUint8(s),s++;o(u,c,e,s)&&a.push([s,c]),s+=c}i+=r+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&l)+(127&c)!=0&&(0===u?(r[0].push(l),r[0].push(c)):1===u&&(r[1].push(l),r[1].push(c)))}return r}}(t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=v(n(1)),i=v(n(9)),a=v(n(26)),o=v(n(67)),s=v(n(133)),u=v(n(77)),l=v(n(3)),c=v(n(4)),d=v(n(0)),f=v(n(2)),h=v(n(51)),p=v(n(6)),g=v(n(10)),m=n(7);function v(e){return e&&e.__esModule?e:{default:e}}function y(e){e=e||{};var t,n=this.context,d=(0,l.default)(n).getInstance(),v=e.errHandler,y=e.fragmentModel,E=e.representationController,T=e.mediaController,_=e.adapter,b=e.textController,A=e.abrController,S=e.playbackController,w=e.streamInfo,I=e.type,R=e.settings,C=void 0,D=void 0,M=void 0,L=void 0,N=void 0,x=void 0,O=void 0,P=void 0,k=void 0,F=void 0,U=void 0,B=void 0,G=void 0,j=void 0,H=void 0,K=void 0,Y=void 0,V=void 0,q=void 0,W=void 0,z=void 0,X=void 0;function Q(e){return _.convertDataToRepresentationInfo(E.getRepresentationForQuality(e))}function J(e,t){if(!Y||!e)return null;var r=e[0];if(x)try{k=t&&t[I]?(0,o.default)(n).create(x,r,ne.bind(this),t[I]):(0,o.default)(n).create(x,r,ne.bind(this),null),R.get().streaming.useAppendWindow&&k.updateAppendWindow(w),"function"==typeof k.getBuffer().initialize&&k.getBuffer().initialize(I,w,e,y)}catch(e){C.fatal("Caught error on create SourceBuffer: "+e),v.error(new p.default(g.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,g.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+I))}else k=(0,s.default)(n).create(ne.bind(this));return ye(Q(D)),k}function Z(e){C.info("Init fragment finished loading saving to",I+"'s init cache"),Y.save(e.chunk),C.debug("Append Init fragment",I," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),ee(e.chunk)}function $(e){var t=e.chunk;if(z){X=t;var n=k&&k.getAllBufferRanges();n&&n.length>0&&S.getTimeToStreamEnd()>R.get().streaming.stallThreshold&&(C.debug("Clearing buffer because track changed - "+(n.end(n.length-1)+.5)),ge([{start:0,end:n.end(n.length-1)+.5,force:!0}]))}else ee(t)}function ee(e){k.append(e),e.mediaInfo.type===r.default.VIDEO&&Re(c.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function te(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)C.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",S.getTime())}function ne(e){if(e.error){if(22===e.error.code&&(K=!0,N=.8*we(),C.warn("Quota exceeded, Critical Buffer: "+N),N>0)){var t=Math.max(.2*N,1),n=N-t,i=Math.min(R.get().streaming.bufferTimeAtTopQuality,.9*n),a=Math.min(R.get().streaming.bufferTimeAtTopQualityLongForm,.9*n),o={streaming:{bufferToKeep:parseFloat(t.toFixed(5)),bufferTimeAtTopQuality:parseFloat(i.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(a.toFixed(5))}};R.update(o)}22!==e.error.code&&Ie()||(C.warn("Clearing playback buffer to overcome quota exceed situation"),Re(c.default.QUOTA_EXCEEDED,{criticalBufferLevel:N,quotaExceededTime:e.chunk.start}),ge(pe()))}else{K=!1,(G=e.chunk)&&!isNaN(G.index)&&(O=Math.max(G.index,O),de());var s=k.getAllBufferRanges();if(G.segmentType===m.HTTPRequest.MEDIA_SEGMENT_TYPE)te(s),oe(),function(){if((I===r.default.AUDIO||I===r.default.VIDEO)&&!isNaN(V)){var e=S.getTime(),t=le(V,0);if(e!==V||!t){var n=E.getCurrentRepresentation().segmentDuration;(t=le(V,n))&&(Math.abs(e-V)>n?V<=t.end&&(S.seek(Math.max(V,t.start),!1,!0),V=NaN):e<t.start&&(S.seek(t.start,!1,!0),V=NaN))}}}();else if(z){var u=S.getTime();C.debug("AppendToBuffer seek target should be "+u),Re(c.default.SEEK_TARGET,{time:u})}var l=!1;U&&(U.indexOf(G)>0&&(l=!0),U=null),G&&!l&&Re(G.endFragment?c.default.BYTES_APPENDED_END_FRAGMENT:c.default.BYTES_APPENDED,{quality:G.quality,startTime:G.start,index:G.index,bufferedRanges:s,mediaType:I})}}function re(e){D!==e.newQuality&&(ye(this.getRepresentationInfo(e.newQuality)),D=e.newQuality)}function ie(e){k&&(V=e.seekTime,M&&(q=!0,M=!1,P=Number.POSITIVE_INFINITY),I!==r.default.FRAGMENTED_TEXT?k&&k.waitForUpdateEnd((function(){var e=function(){if(k){var e=[],t=k.getAllBufferRanges();if(!t||0===t.length)return e;var n=S.getTime(),r=t.end(t.length-1)+.5,i=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];if(i){var o={start:0,end:i.startTime-R.get().streaming.stallThreshold},s=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime-i.duration/2,threshold:.01})[0];s&&s.startTime!=i.startTime&&(o.end=s.startTime),o.start<o.end&&o.end>t.start(0)&&e.push(o);var u={start:i.startTime+i.duration+R.get().streaming.stallThreshold,end:r},l=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime+i.duration+R.get().streaming.stallThreshold,threshold:.01})[0];l&&l.startTime!==i.startTime&&(u.start=l.startTime+l.duration+R.get().streaming.stallThreshold),u.start<u.end&&u.start<r&&e.push(u)}else C.debug("getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -",r),e.push({start:0,end:r});return e}}();e&&0!==e.length||oe(),ge(e)})):oe())}function ae(){V=NaN}function oe(){(!z||I===r.default.FRAGMENTED_TEXT&&b.isTextEnabled())&&ce()}function se(){fe()}function ue(){V=NaN,fe()}function le(e,t){var n=k.getAllBufferRanges(),r=0,i=0,a=null,o=null,s=0,u=void 0,l=void 0,c=isNaN(t)?.15:t;if(null!=n){for(l=0,u=n.length;l<u;l++)if(r=n.start(l),i=n.end(l),null===a)s=Math.abs(r-e),(e>=r&&e<i||s<=c)&&(a=r,o=i);else{if(!((s=r-o)<=c))break;o=i}if(null!==a)return{start:a,end:o}}return null}function ce(){var e,t,n;S&&(e=(isNaN(V)?S.getTime():V)||0,R.get().streaming.jumpGaps&&(t=R.get().streaming.smallGapLimit),L=null===(n=le(e,t))?0:n.end-e,Re(c.default.BUFFER_LEVEL_UPDATED,{bufferLevel:L}),fe())}function de(){O>=P-1&&!M&&void 0===k.discharge&&(M=!0,C.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for "+I),Re(c.default.BUFFERING_COMPLETED))}function fe(){I!==r.default.AUDIO&&I!==r.default.VIDEO||(q&&!M&&L>0&&S&&S.getTimeToStreamEnd()-L<.1&&(q=!1,M=!0,C.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED for type "+I),Re(c.default.BUFFERING_COMPLETED)),(!R.get().streaming.lowLatencyEnabled&&L<R.get().streaming.stallThreshold||0===L)&&!M?he(i.default.BUFFER_EMPTY):(M||L>=w.manifestInfo.minBufferTime)&&he(i.default.BUFFER_LOADED))}function he(e){B===e||e===i.default.BUFFER_EMPTY&&0===S.getTime()||I===r.default.FRAGMENTED_TEXT&&!b.isTextEnabled()||(B=e,Re(c.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Re(e===i.default.BUFFER_LOADED?c.default.BUFFER_LOADED:c.default.BUFFER_EMPTY),C.debug(e===i.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function pe(){var e=[],t=k.getAllBufferRanges();if(!t||0===t.length)return e;var n=S.getTime(),r=Math.max(0,n-R.get().streaming.bufferToKeep),i=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];if(i)r=Math.min(i.startTime,r);else if(0===n&&S.getIsDynamic())return[];if(t.start(0)<=r){for(var o={start:0,end:r},s=0;s<t.length&&t.end(s)<=r;s++)o.end=t.end(s);o.start<o.end&&e.push(o)}return e}function ge(e){e&&k&&0!==e.length&&(W.push.apply(W,e),H||me())}function me(){if(0===W.length||!k)return C.debug("Nothing to prune, halt pruning"),W=[],void(H=!1);var e=k.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return C.debug("SourceBuffer is empty (or does not exist), halt pruning"),W=[],void(H=!1);var t=W.shift();C.debug("Removing buffer from:",t.start,"to",t.end),H=!0,S.getTime()<t.end&&(M=!1,O=0),k.remove(t.start,t.end,t.force)}function ve(e){k===e.buffer&&(C.debug("onRemoved buffer from:",e.from,"to",e.to),te(k.getAllBufferRanges()),0===W.length&&(H=!1),e.unintended&&(C.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),Re(c.default.SEEK_TARGET,{time:e.from,mediaType:I,streamId:w.id})),H?me():(z?(z=!1,X&&ee(X)):ce(),Re(c.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Ie(),quotaExceeded:K})))}function ye(e){e&&void 0!==e.MSETimeOffset&&k&&k.updateTimestampOffset&&k.updateTimestampOffset(e.MSETimeOffset)}function Ee(e){e.error||M||ye(e.currentRepresentation)}function Te(e){P=e.request.index,de()}function _e(e){if(e.newMediaInfo.streamInfo.id===w.id&&e.newMediaInfo.type===I){var t=k&&k.getAllBufferRanges();t&&(C.info("Track change asked"),T.getSwitchMode(I)===r.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&S.getTimeToStreamEnd()>R.get().streaming.stallThreshold&&(M=!1,P=Number.POSITIVE_INFINITY))}}function be(){++j*(R.get().streaming.wallclockTimeUpdateInterval/1e3)>=R.get().streaming.bufferPruningInterval&&(j=0,k&&I!==r.default.FRAGMENTED_TEXT&&(M||ge(pe())))}function Ae(){fe()}function Se(e,t){x=e,k&&t&&"function"==typeof k.discharge&&(F=k,J(t))}function we(){var e,t=k.getAllBufferRanges(),n=0,r=void 0;if(!t)return n;for(r=0,e=t.length;r<e;r++)n+=t.end(r)-t.start(r);return n}function Ie(){return we()<N}function Re(e,t){var n=t||{};d.trigger(e,n,{streamId:w.id,mediaType:I})}function Ce(e,t){N=Number.POSITIVE_INFINITY,B=void 0,D=u.default.QUALITY_DEFAULT,P=Number.POSITIVE_INFINITY,O=0,G=null,M=!1,H=!1,K=!1,q=!1,L=0,j=0,W=[],V=NaN,k&&(e||k.abort(),k.reset(t),k=null),z=!1}return t={initialize:function(e){Se(e),D=A.getQualityFor(I),d.on(c.default.DATA_UPDATE_COMPLETED,Ee,this),d.on(c.default.INIT_FRAGMENT_LOADED,Z,this),d.on(c.default.MEDIA_FRAGMENT_LOADED,$,this),d.on(c.default.QUALITY_CHANGE_REQUESTED,re,this),d.on(c.default.STREAM_COMPLETED,Te,this),d.on(c.default.PLAYBACK_PLAYING,ue,this),d.on(c.default.PLAYBACK_PROGRESS,oe,this),d.on(c.default.PLAYBACK_TIME_UPDATED,oe,this),d.on(c.default.PLAYBACK_RATE_CHANGED,Ae,this),d.on(c.default.PLAYBACK_SEEKING,ie,this),d.on(c.default.PLAYBACK_SEEKED,ae,this),d.on(c.default.PLAYBACK_STALLED,se,this),d.on(c.default.WALLCLOCK_TIME_UPDATED,be,this),d.on(c.default.CURRENT_TRACK_CHANGED,_e,this,{priority:l.default.EVENT_PRIORITY_HIGH}),d.on(c.default.SOURCEBUFFER_REMOVE_COMPLETED,ve,this)},getStreamId:function(){return w.id},getType:function(){return I},getBufferControllerType:function(){return"BufferController"},getRepresentationInfo:Q,createBuffer:J,dischargePreBuffer:function(){if(k&&F&&"function"==typeof F.discharge){var e=F.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+I+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";C.debug(t)}else C.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");U=[];for(var r=F.discharge(),i=null,a=0;a<r.length;a++){var o=r[a];if("InitializationSegment"!==o.segmentType){var s=Y.extract(o.streamId,o.representationId);s&&i!==s&&(U.push(s),k.append(s),i=s)}U.push(o),k.append(o)}F.reset(),F=null}},getBuffer:function(){return k},setBuffer:function(e){k=e},getBufferLevel:function(){return L},getRangeAt:le,setMediaSource:Se,getMediaSource:function(){return x},appendInitSegment:function(e){var t=Y.extract(w.id,e);return!!t&&(C.info("Append Init fragment",I," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),ee(t),!0)},replaceBuffer:function(){z=!0},getIsBufferingCompleted:function(){return M},getIsPruningInProgress:function(){return H},reset:function(e,t){d.off(c.default.DATA_UPDATE_COMPLETED,Ee,this),d.off(c.default.INIT_FRAGMENT_LOADED,Z,this),d.off(c.default.MEDIA_FRAGMENT_LOADED,$,this),d.off(c.default.QUALITY_CHANGE_REQUESTED,re,this),d.off(c.default.STREAM_COMPLETED,Te,this),d.off(c.default.PLAYBACK_PLAYING,ue,this),d.off(c.default.PLAYBACK_PROGRESS,oe,this),d.off(c.default.PLAYBACK_TIME_UPDATED,oe,this),d.off(c.default.PLAYBACK_RATE_CHANGED,Ae,this),d.off(c.default.PLAYBACK_SEEKING,ie,this),d.off(c.default.PLAYBACK_SEEKED,ae,this),d.off(c.default.PLAYBACK_STALLED,se,this),d.off(c.default.WALLCLOCK_TIME_UPDATED,be,this),d.off(c.default.CURRENT_TRACK_CHANGED,_e,this),d.off(c.default.SOURCEBUFFER_REMOVE_COMPLETED,ve,this),Ce(e,t)},updateAppendWindow:function(){k&&!M&&k.updateAppendWindow(w)}},C=(0,f.default)(n).getInstance().getLogger(t),Y=(0,h.default)(n).getInstance(),Ce(),t}y.__dashjs_factory_name="BufferController",t.default=d.default.getClassFactory(y)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(2)),i=c(n(6)),a=c(n(3)),o=c(n(4)),s=c(n(0)),u=c(n(42)),l=c(n(10));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,s){var c,d=this.context,f=(0,a.default)(d).getInstance(),h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=[],E=[],T=n;function _(){try{return g.buffered}catch(e){return p.error("getAllBufferRanges exception: "+e.message),null}}function b(t){g&&C((function(){try{var n=e.duration,r=0;t&&!isNaN(t.start)&&!isNaN(t.duration)&&isFinite(t.duration)&&(n=t.start+t.duration),t&&!isNaN(t.start)&&(r=t.start),g.appendWindowStart=0,g.appendWindowEnd=n,g.appendWindowStart=r,p.debug("Updated append window. Set start to "+g.appendWindowStart+" and end to "+g.appendWindowEnd)}catch(e){p.warn("Failed to set append window")}}))}function A(){var e=this;if(E.length>0){m=!0;var t=E[0];E.splice(0,1);var n=[],r=function(){var r=_();!function(e,t,n,r){t&&t.length>0&&t.length<n.length&&function(e,t){for(var n=0;n<e.length;n++){var r=Math.round(e.start(n)),i=Math.round(e.end(n));if(i===t.start||r===t.end||t.start>=r&&t.end<=i)return!0}return!1}(t,r)&&f.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0})}(e,n,r,t),E.length>0?A.call(this):(m=!1,T&&T({chunk:t}))};try{0===t.bytes.length?r.call(this):(n=_(),g.appendBuffer?g.appendBuffer(t.bytes):g.append(t.bytes,t),C(r.bind(this)))}catch(e){p.fatal('SourceBuffer append failed "'+e+'"'),E.length>0?A():m=!1,T&&T({chunk:t,error:new i.default(e.code,e.message)})}}}function S(){if(y.length>0){var e=y.shift();g.updating?C(e):(e(),S())}}function w(){g.updating||S()}function I(){g.updating||S()}function R(){p.error("SourceBufferSink error")}function C(e){y.push(e),g.updating||S()}return c={getType:function(){return h},getAllBufferRanges:_,getBuffer:function(){return g},append:function(e){e?(E.push(e),m||C(A.bind(this))):T({chunk:e,error:new i.default(l.default.APPEND_ERROR_CODE,l.default.APPEND_ERROR_MESSAGE)})},remove:function(t,n,r){var a=this;C((function(){try{t>=0&&n>t&&(r||"ended"!==e.readyState)&&g.remove(t,n),C((function(){f.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:t,to:n,unintended:!1})}))}catch(e){f.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:t,to:n,unintended:!1,error:new i.default(e.code,e.message)})}}))},abort:function(){try{("open"===e.readyState||g.setTextTrack&&"ended"===e.readyState)&&g.abort()}catch(e){p.error('SourceBuffer append abort failed: "'+e+'"')}E=[]},reset:function(t){if(g){if("function"==typeof g.removeEventListener&&(g.removeEventListener("updateend",I,!1),g.removeEventListener("error",R,!1),g.removeEventListener("abort",R,!1)),clearInterval(v),y=[],!t){try{g.getClassName&&"TextSourceBuffer"===g.getClassName()||(p.debug("Removing sourcebuffer from media source"),e.removeSourceBuffer(g))}catch(e){p.error("Failed to remove source buffer from media source.")}g=null}m=!1}E=[],T=null},updateTimestampOffset:function(e){g.timestampOffset===e||isNaN(e)||C((function(){e<0&&(e+=.001),g.timestampOffset=e}))},hasDiscontinuitiesAfter:function(e){try{var t=_();if(t&&t.length>1)for(var n=0,r=t.length;n<r;n++)if(n>0&&e<t.start(n)&&t.start(n)>t.end(n-1)+.1)return!0}catch(e){p.error("hasDiscontinuities exception: "+e.message)}return!1},waitForUpdateEnd:C,updateAppendWindow:b},function(){p=(0,r.default)(d).getInstance().getLogger(c),m=!1,h=t.type;var n=t.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");if((g=s||e.addSourceBuffer(n)).changeType&&s&&(p.debug("Doing period transition with changeType"),g.changeType(n)),b(),"function"==typeof g.addEventListener)try{g.addEventListener("updateend",I,!1),g.addEventListener("error",R,!1),g.addEventListener("abort",R,!1)}catch(e){v=setInterval(w,50)}else v=setInterval(w,50)}catch(e){if(!t.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw e;var i=(0,u.default)(d).getInstance();g=i.getTextSourceBuffer()}}(),c}d.__dashjs_factory_name="SourceBufferSink";var f=s.default.getClassFactory(d);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r},a=n(14);function o(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,a.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,a.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}o.__dashjs_factory_name="CustomTimeRanges",t.default=i.default.getClassFactory(o)},function(e,t,n){t.generateISD=n(112).generateISD,t.fromXML=n(113).fromXML,t.renderHTML=n(129).render},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(t,r){var i=n(37);e.exports=E;var a,o=n(70);E.ReadableState=y,n(47).EventEmitter;var s=function(e,t){return e.listeners(t).length},u=n(72),l=n(38).Buffer,c=t.Uint8Array||function(){},d=Object.create(n(28));d.inherits=n(21);var f=n(118),h=void 0;h=f&&f.debuglog?f.debuglog("stream"):function(){};var p,g=n(119),m=n(73);d.inherits(E,u);var v=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var r=t instanceof(a=a||n(16));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(50).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function E(e){if(a=a||n(16),!(this instanceof E))return new E(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function T(e,t,n,r,i){var a,o=e._readableState;return null===t?(o.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,A(e)}}(e,o)):(i||(a=function(e,t){var n,r;return r=t,l.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(o,t)),a?e.emit("error",a):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):_(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?_(e,o,t,!1):w(e,o)):_(e,o,t,!1))):r||(o.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function _(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&A(e)),w(e,t)}function b(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function A(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(S,e):S(e))}function S(e){h("emit readable"),e.emit("readable"),D(e)}function w(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(I,e,t))}function I(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function R(e){h("readable nexttick read 0"),e.read(0)}function C(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function M(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0==(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=l.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0==(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(o));break}++i}return t.length-=i,n}(e,t),r}(e,t.buffer,t.decoder),n);var n}function L(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function x(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}Object.defineProperty(E.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=m.destroy,E.prototype._undestroy=m.undestroy,E.prototype._destroy=function(e,t){this.push(null),t(e)},E.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),T(this,e,t,!1,n)},E.prototype.unshift=function(e){return T(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(e){return p||(p=n(50).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this},E.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):A(this),null;if(0===(e=b(e,t))&&t.ended)return 0===t.length&&L(this),null;var r,i=t.needReadable;return h("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",i=!0),t.ended||t.reading?h("reading or ended",i=!1):i&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=b(n,t))),null===(r=e>0?M(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&L(this)),null!==r&&this.emit("data",r),r},E.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},E.prototype.pipe=function(e,t){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,h("pipe count=%d opts=%j",a.pipesCount,t);var u=t&&!1===t.end||e===r.stdout||e===r.stderr?y:l;function l(){h("onend"),e.end()}a.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",(function t(r,i){h("onunpipe"),r===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,h("cleanup"),e.removeListener("close",m),e.removeListener("finish",v),e.removeListener("drain",c),e.removeListener("error",g),e.removeListener("unpipe",t),n.removeListener("end",l),n.removeListener("end",y),n.removeListener("data",p),d=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,D(e))}}(n);e.on("drain",c);var d=!1,f=!1;function p(t){h("ondata"),f=!1,!1!==e.write(t)||f||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==x(a.pipes,e))&&!d&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,f=!0),n.pause())}function g(t){h("onerror",t),y(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",v),y()}function v(){h("onfinish"),e.removeListener("close",m),y()}function y(){h("unpipe"),n.unpipe(e)}return n.on("data",p),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",m),e.once("finish",v),e.emit("pipe",n),a.flowing||(h("pipe resume"),n.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var o=x(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},E.prototype.on=function(e,t){var n=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&A(this):i.nextTick(R,this))}return n},E.prototype.addListener=E.prototype.on,E.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(C,e,t))}(this,e)),this},E.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},E.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){h("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<v.length;a++)e.on(v[a],this.emit.bind(this,v[a]));return this._read=function(t){h("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),E._fromList=M}).call(this,n(13),n(36))},function(e,t,n){e.exports=n(47).EventEmitter},function(e,t,n){"use strict";var r=n(37);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";e.exports=o;var r=n(16),i=Object.create(n(28));function a(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){u(e,t,n)})):u(this,null,null)}function u(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(21),i.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=E(n(78)),i=E(n(1)),a=E(n(9)),o=E(n(79)),s=E(n(26)),u=E(n(3)),l=E(n(4)),c=E(n(0)),d=E(n(146)),f=E(n(11)),h=E(n(147)),p=E(n(148)),g=E(n(149)),m=E(n(2)),v=n(7),y=n(14);function E(e){return e&&e.__esModule?e:{default:e}}function T(){var e=this.context,t=(0,m.default)(e).getInstance(),n=(0,u.default)(e).getInstance(),c=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0,M=void 0,L=void 0,N=void 0,x=void 0,O=void 0,P=void 0,k=void 0,F=void 0,U=void 0,B=void 0,G=void 0,j=void 0,H=void 0;function K(){(T=(0,r.default)(e).create({dashMetrics:j,mediaPlayerModel:N,settings:H})).initialize()}function Y(){b={},A={},w={},S={},P={},U={},B={},G={},void 0===R&&(R=!1),O=void 0,k=void 0,F=void 0,clearTimeout(I),I=null}function V(e){e.mediaType===i.default.VIDEO&&(void 0!==O&&k.push(O,L.getPlaybackQuality()),O=e.newQuality)}function q(e){e.metric!==a.default.HTTP_REQUEST||!e.value||e.value.type!==v.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==i.default.AUDIO&&e.mediaType!==i.default.VIDEO||F.push(e.mediaType,e.value,H.get().streaming.abr.useDeadTimeLatency),e.metric!==a.default.BUFFER_LEVEL||e.mediaType!==i.default.AUDIO&&e.mediaType!==i.default.VIDEO||function(e,t){var n=H.get().streaming.abr.ABRStrategy;n===i.default.ABR_STRATEGY_L2A?(U[e]=!1,G[e]=!1,B[e]=!0):n===i.default.ABR_STRATEGY_LoLP?(U[e]=!1,G[e]=!0,B[e]=!1):n===i.default.ABR_STRATEGY_BOLA?(U[e]=!0,G[e]=!1,B[e]=!1):n===i.default.ABR_STRATEGY_THROUGHPUT?(U[e]=!1,G[e]=!1,B[e]=!1):function(e,t){var n=N.getStableBufferTime(),r=n,i=.5*n,a=U[e],o=t>(a?i:r);U[e]=o,o!==a&&(o?E.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):E.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e,t)}(e.mediaType,.001*e.value.level)}function W(e,t){return b[t]=b[t]||{},b[t].hasOwnProperty(e)||(b[t][e]=0),function(e,t){if(t!==i.default.VIDEO||!H.get().streaming.abr.limitBitrateByPortal||!S[t])return e;R||ae();var n=M.getAdaptationForType(0,t).Representation,r=e;if(C>0&&D>0){for(;r>0&&n[r]&&C<n[r].width&&C-n[r-1].width<n[r].width-C;)r-=1;for(;r<n.length-1&&n[r].width===n[r+1].width;)r+=1}return r}(function(e,t,n){var r=H.get().streaming.abr.maxRepresentationRatio[t];return isNaN(r)||r>=1||r<0?e:Math.min(e,Math.round(n*r))}(function(e,t){var n=e;if(!S[t])return n;var r=X(t);void 0!==r&&(n=Math.max(e,r));var i=z(t);return void 0!==i&&(n=Math.min(n,i)),n}(b[t][e],e),e,b[t][e]),e)}function z(e){var t=function(e){return H.get().streaming.abr.maxBitrate[e]}(e);return t>-1?$(S[e].getMediaInfo(),t):void 0}function X(e){var t=function(e){return H.get().streaming.abr.minBitrate[e]}(e);if(t>-1){var n=S[e].getMediaInfo(),r=ee(n),i=$(n,t);return r[i]&&i<r.length-1&&r[i].bitrate<1e3*t&&i++,i}}function Q(e,t,n,r){var i=t.id,a=ie(e);(0,y.checkInteger)(n);var o=W(e,i);n!==a&&n>=0&&n<=o&&J(e,a,n,o,r)}function J(e,t,r,i,a){if(e&&S[e]){var o=S[e].getStreamInfo(),s=o?o.id:null;if(H.get().debug.logLevel===m.default.LOG_LEVEL_DEBUG){var u=j.getCurrentBufferLevel(e);E.info("["+e+"] switch from "+t+" to "+r+"/"+i+" (buffer: "+u+") "+(a?JSON.stringify(a):"."))}!function(e,t,n){A[t]=A[t]||{},A[t][e]=n}(e,s,r),n.trigger(l.default.QUALITY_CHANGE_REQUESTED,{oldQuality:t,newQuality:r,reason:a},{streamId:o.id,mediaType:e});var c=F.getAverageThroughput(e);isNaN(c)||x.setSavedBitrateSettings(e,c)}}function Z(e,t){w[e].state=t}function $(e,t,n){var r=e&&e.type?S[e.type].getRepresentationInfo():null;if(H.get().streaming.abr.useDeadTimeLatency&&n&&r&&r.fragmentDuration){n/=1e3;var i=r.fragmentDuration;if(n>i)return 0;t*=1-n/i}for(var a=ee(e),o=a.length-1;o>=0;o--)if(1e3*t>=a[o].bitrate)return o;return 0}function ee(e){var t=[];if(!e||!e.bitrateList)return t;for(var n=e.bitrateList,r=e.type,i=void 0,a=0,s=n.length;a<s;a++)(i=new o.default).mediaType=r,i.qualityIndex=a,i.bitrate=n[a].bandwidth,i.width=n[a].width,i.height=n[a].height,i.scanType=n[a].scanType,t.push(i);return t}function te(e){return U[e]}function ne(e){return B[e]}function re(e){return G[e]}function ie(e){if(e&&S[e]){var t=S[e].getStreamInfo(),n=t?t.id:null;if(n)return A[n]=A[n]||{},A[n].hasOwnProperty(e)||(A[n][e]=0),A[n][e]}return 0}function ae(){if(L){var e=H.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;C=L.getClientWidth()*e,D=L.getClientHeight()*e}}function oe(t){var n=t.request.mediaType;if(H.get().streaming.abr.autoSwitchBitrate[n]){var r=S[n];if(!r)return;var i=(0,d.default)(e).create({abrController:c,streamProcessor:r,currentRequest:t.request,useBufferOccupancyABR:te(n),useL2AABR:ne(n),useLoLPABR:re(n),videoModel:L}),o=T.shouldAbandonFragment(i);if(o.quality>f.default.NO_CHANGE){var u=r.getFragmentModel();u.getRequests({state:s.default.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(u.abortRequests(),Z(n,a.default.ABANDON_LOAD),P[n].reset(),P[n].push({oldValue:ie(n),newValue:o.quality,confidence:1,reason:o.reason}),Q(n,_.getActiveStreamInfo(),o.quality,o.reason),clearTimeout(I),I=setTimeout((function(){Z(n,a.default.ALLOW_LOAD),I=null}),H.get().streaming.abandonLoadTimeout))}}}return c={isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=ie(i.default.AUDIO),r=ie(i.default.VIDEO);return n===W(i.default.AUDIO,t)&&r===W(i.default.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return function(e,t,n){b[t]=b[t]||{},b[t][e]=n}(t,n,r),r},getThroughputHistory:function(){return F},getBitrateList:ee,getQualityForBitrate:$,getTopBitrateInfoFor:function(e){if(e&&S&&S[e]){var t=S[e].getStreamInfo();if(t&&t.id){var n=W(e,t.id),r=ee(S[e].getMediaInfo());return r[n]?r[n]:null}}return null},getMaxAllowedIndexFor:z,getMinAllowedIndexFor:X,getInitialBitrateFor:function(e){if(function(){if(!x||!x.hasOwnProperty("getSavedBitrateSettings"))throw new Error(i.default.MISSING_CONFIG_ERROR)}(),e===i.default.TEXT||e===i.default.FRAGMENTED_TEXT)return NaN;var t=x.getSavedBitrateSettings(e),n=H.get().streaming.abr.initialBitrate[e],r=H.get().streaming.abr.initialRepresentationRatio[e];if(-1===n)if(r>-1){var a=M.getAdaptationForType(0,e).Representation;n=Array.isArray(a)?a[Math.max(Math.round(a.length*r)-1,0)].bandwidth:0}else n=isNaN(t)?e===i.default.VIDEO?1e3:100:t;return n},getQualityFor:ie,getAbandonmentStateFor:function(e){return w[e]?w[e].state:null},setPlaybackQuality:Q,checkPlaybackQuality:function(t){if(t&&S&&S[t]){var n=S[t].getStreamInfo(),r=n?n.id:null,i=ie(t),o=(0,d.default)(e).create({abrController:c,streamProcessor:S[t],currentValue:i,switchHistory:P[t],droppedFramesHistory:k,useBufferOccupancyABR:te(t),useL2AABR:ne(t),useLoLPABR:re(t),videoModel:L});if(k){var s=L.getPlaybackQuality();s&&k.push(O,s)}if(H.get().streaming.abr.autoSwitchBitrate[t]){var u=X(t),l=W(t,r),h=T.getMaxQuality(o),p=h.quality;if(void 0!==u&&(p>f.default.NO_CHANGE?p:i)<u&&(p=u),p>l&&(p=l),P[t].push({oldValue:i,newValue:p}),p>f.default.NO_CHANGE&&p!=i)(w[t].state===a.default.ALLOW_LOAD||p>i)&&J(t,i,p,l,h.reason);else if(H.get().debug.logLevel===m.default.LOG_LEVEL_DEBUG){var g=j.getCurrentBufferLevel(t,!0);E.debug("["+t+"] stay on "+i+"/"+l+" (buffer: "+g+")")}}}},getTopQualityIndexFor:W,setElementSize:ae,setWindowResizeEventCalled:function(e){R=e},createAbrRulesCollection:K,registerStreamType:function(t,r){P[t]=P[t]||(0,h.default)(e).create(),S[t]=r,w[t]=w[t]||{},w[t].state=a.default.ALLOW_LOAD,U[t]=!1,B[t]=!1,G[t]=!1,n.on(l.default.LOADING_PROGRESS,oe,c),t===i.default.VIDEO&&(n.on(l.default.QUALITY_CHANGE_RENDERED,V,c),k=k||(0,p.default)(e).create(),ae()),n.on(l.default.METRIC_ADDED,q,c),n.on(l.default.PERIOD_SWITCH_COMPLETED,K,c),F=F||(0,g.default)(e).create({settings:H})},unRegisterStreamType:function(e){delete S[e]},setConfig:function(e){e&&(e.streamController&&(_=e.streamController),e.domStorage&&(x=e.domStorage),e.mediaPlayerModel&&(N=e.mediaPlayerModel),e.dashMetrics&&(j=e.dashMetrics),e.adapter&&(M=e.adapter),e.videoModel&&(L=e.videoModel),e.settings&&(H=e.settings))},reset:function(){Y(),n.off(l.default.LOADING_PROGRESS,oe,c),n.off(l.default.QUALITY_CHANGE_RENDERED,V,c),n.off(l.default.METRIC_ADDED,q,c),n.off(l.default.PERIOD_SWITCH_COMPLETED,K,c),T&&T.reset()}},E=t.getLogger(c),Y(),c}T.__dashjs_factory_name="AbrController";var _=c.default.getSingletonFactory(T);_.QUALITY_DEFAULT=0,c.default.updateSingletonFactory(T.__dashjs_factory_name,_),t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(134)),i=p(n(135)),a=p(n(136)),o=p(n(137)),s=p(n(138)),u=p(n(139)),l=p(n(140)),c=p(n(141)),d=p(n(0)),f=p(n(11)),h=p(n(1));function p(e){return e&&e.__esModule?e:{default:e}}function g(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,d=e.dashMetrics,p=e.settings,g=void 0,m=void 0;function v(e){return e.filter((function(e){return e.quality>f.default.NO_CHANGE}))}function y(e){var n,r={},i=null,a=void 0,o=void 0,s=void 0,u=void 0;if(0!==e.length){for(r[f.default.PRIORITY.STRONG]={quality:f.default.NO_CHANGE,reason:null},r[f.default.PRIORITY.WEAK]={quality:f.default.NO_CHANGE,reason:null},r[f.default.PRIORITY.DEFAULT]={quality:f.default.NO_CHANGE,reason:null},a=0,n=e.length;a<n;a+=1)(o=e[a]).quality!==f.default.NO_CHANGE&&(r[o.priority].quality===f.default.NO_CHANGE||r[o.priority].quality>o.quality)&&(r[o.priority].quality=o.quality,r[o.priority].reason=o.reason||null);return r[f.default.PRIORITY.WEAK].quality!==f.default.NO_CHANGE&&(i=r[f.default.PRIORITY.WEAK]),r[f.default.PRIORITY.DEFAULT].quality!==f.default.NO_CHANGE&&(i=r[f.default.PRIORITY.DEFAULT]),r[f.default.PRIORITY.STRONG].quality!==f.default.NO_CHANGE&&(i=r[f.default.PRIORITY.STRONG]),i&&(s=i.quality,u=i.reason),(0,f.default)(t).create(s,u)}}return{initialize:function(){g=[],m=[],p.get().streaming.abr.useDefaultABRRules&&(p.get().streaming.abr.ABRStrategy===h.default.ABR_STRATEGY_L2A?g.push((0,l.default)(t).create({dashMetrics:d,mediaPlayerModel:n,settings:p})):p.get().streaming.abr.ABRStrategy===h.default.ABR_STRATEGY_LoLP?g.push((0,c.default)(t).create({dashMetrics:d})):(g.push((0,u.default)(t).create({dashMetrics:d,mediaPlayerModel:n,settings:p})),g.push((0,r.default)(t).create({dashMetrics:d})),g.push((0,i.default)(t).create({dashMetrics:d})),g.push((0,s.default)(t).create()),g.push((0,o.default)(t).create()),m.push((0,a.default)(t).create({dashMetrics:d,mediaPlayerModel:n,settings:p})))),n.getABRCustomRules().forEach((function(e){"qualitySwitchRules"===e.type&&g.push(e.rule(t).create()),"abandonFragmentRules"===e.type&&m.push(e.rule(t).create())}))},reset:function(){[g,m].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),g=[],m=[]},getMaxQuality:function(e){return y(v(g.map((function(t){return t.getMaxIndex(e)}))))||(0,f.default)(t).create()},getMinSwitchRequest:y,shouldAbandonFragment:function(e){return y(v(m.map((function(t){return t.shouldAbandon(e)}))))||(0,f.default)(t).create()},getQualitySwitchRules:function(){return g}}}g.__dashjs_factory_name="ABRRulesCollection";var m=d.default.getClassFactory(g);m.QUALITY_SWITCH_RULES="qualitySwitchRules",m.ABANDON_FRAGMENT_RULES="abandonFragmentRules",d.default.updateSingletonFactory(g.__dashjs_factory_name,m),t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(15)),i=n(7),a=u(n(0)),o=n(22),s=u(n(156));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t=this.context,n=e.eventBus,a=e.events,u=e.debug,l=e.dashConstants,c=e.urlUtils,d=e.type,f=e.streamInfo,h=e.timelineConverter,p=e.dashMetrics,g=e.baseURLController,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0;function w(){return d}function I(){y=-1,E=null}function R(){I(),T=null,S=null,A=null}function C(e,t,n){var r=g.resolve(n.path),i=void 0,a=void 0;return r&&t!==r.url&&c.isRelative(t)?(i=r.url,a=r.serviceLocation,t&&(i=c.resolve(t,i))):i=t,!c.isRelative(i)&&(e.url=i,e.serviceLocation=a,!0)}function D(e){var t,r,i;r=(t=e.representation).hasInitialization(),i=t.hasSegments(),r&&i?n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{representation:t},{streamId:f.id,mediaType:d}):S.update(t,A,r,i)}function M(e,t){if(null==t)return null;var n=new r.default,a=t.representation,s=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].bandwidth,u=t.media;return u=(0,o.replaceTokenForTemplate)(u,"Number",t.replacementNumber),u=(0,o.replaceTokenForTemplate)(u,"Time",t.replacementTime),u=(0,o.replaceTokenForTemplate)(u,"Bandwidth",s),u=(0,o.replaceIDForTemplate)(u,a.id),u=(0,o.unescapeDollarsInTemplate)(u),n.mediaType=w(),n.type=i.HTTPRequest.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.mediaStartTime=t.mediaStartTime,n.duration=t.duration,n.timescale=a.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.wallStartTime=t.wallStartTime,n.quality=a.index,n.index=t.availabilityIdx,n.mediaInfo=e,n.adaptationIndex=a.adaptation.index,n.representationId=a.id,C(n,u,a)?n:void 0}function L(e){var t=!1;if(!e)return t;if(_){if(b)t=!0;else if(E){var n=parseFloat((E.presentationStartTime-e.adaptation.period.start).toFixed(5));t=(E.duration>0?n+1.5*E.duration:n)>=e.adaptation.period.duration}}else y>=e.availableSegmentsNumber&&(t=!0);return t}function N(e){var t=e.representation;t.segments&&n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{representation:t},{streamId:f.id,mediaType:d})}function x(e){if(!e.error){var t,r=e.segments,i=e.representation,s=[],u=0,l=void 0,c=void 0,g=void 0;for(l=0,t=r?r.length:0;l<t;l++)c=r[l],(g=(0,o.getTimeBasedSegment)(h,_,i,c.startTime,c.duration,c.timescale,c.media,c.mediaRange,u))&&(s.push(g),g=null,u++);s.length>0&&(i.segmentAvailabilityRange={start:s[0].presentationStartTime,end:s[s.length-1].presentationStartTime},i.availableSegmentsNumber=s.length,i.segments=s,_&&function(e){h.setExpectedLiveEdge(e),p.updateManifestUpdateInfo({presentationStartTime:e})}(s[s.length-1].presentationStartTime-8)),i.hasInitialization()&&n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{representation:i},{streamId:f.id,mediaType:d})}}function O(){v.debug("Dynamic stream complete"),b=!0}return m={initialize:function(e){_=e,b=!1,S.initialize(e)},getStreamId:function(){return f.id},getType:w,getStreamInfo:function(){return f},getInitRequest:function(e,t){return t?function(e,t,n){var a=new r.default,s=t.adaptation.period,u=s.start;if(a.mediaType=n,a.type=i.HTTPRequest.INIT_SEGMENT_TYPE,a.range=t.range,a.availabilityStartTime=h.calcAvailabilityStartTimeFromPresentationTime(u,s.mpd,_),a.availabilityEndTime=h.calcAvailabilityEndTimeFromPresentationTime(u+s.duration,s.mpd,_),a.quality=t.index,a.mediaInfo=e,a.representationId=t.id,C(a,t.initialization,t))return a.url=(0,o.replaceTokenForTemplate)(a.url,"Bandwidth",t.bandwidth),a}(e,t,w()):null},getRequestForSegment:M,getSegmentRequestForTime:function(e,t,n,i){var a=null;if(!t||!t.segmentInfoType)return a;var o=y,s=!!i&&i.keepIdx,u=!(!i||!i.ignoreIsFinished);T!==n&&(T=n,v.debug("Getting the request for time : "+n));var c=S.getSegmentByTime(t,n);return c?(y=c.availabilityIdx,E=c,v.debug("Index for time "+n+" is "+y),a=M(e,c)):!u&&L(t)&&((a=new r.default).action=r.default.ACTION_COMPLETE,a.index=y-1,a.mediaType=d,a.mediaInfo=e,v.debug("Signal complete in getSegmentRequestForTime")),s&&o>=0&&(y=t.segmentInfoType===l.SEGMENT_TIMELINE&&_?y:o),a},getNextSegmentRequest:function(e,t){var n=null;if(!t||!t.segmentInfoType)return null;T=null;var i=y+1;v.debug("Getting the next request at index: "+i);var a=S.getSegmentByIndex(t,i,E?E.mediaStartTime:-1);return a||!function(e){return!isFinite(e.adaptation.period.duration)}(t)||b?(a?(n=M(e,a),y=a.availabilityIdx):y=_?i-1:i,a?E=a:L(t)&&((n=new r.default).action=r.default.ACTION_COMPLETE,n.index=y-1,n.mediaType=w(),n.mediaInfo=e,v.debug("Signal complete")),n):(v.debug(w()+" No segment found at index: "+i+". Wait for next loop"),null)},setCurrentIndex:function(e){y=e},getCurrentIndex:function(){return y},isMediaFinished:L,reset:function(){R(),n.off(a.INITIALIZATION_LOADED,N,m),n.off(a.SEGMENTS_LOADED,x,m),n.off(a.REPRESENTATION_UPDATE_STARTED,D,m),n.off(a.DYNAMIC_TO_STATIC,O,m)},resetIndex:I,setMimeType:function(e){A=e},getNextSegmentRequestIdempotent:function(e,t){var n=y+1,r=S.getSegmentByIndex(t,n,E?E.mediaStartTime:-1);return r?M(e,r):null}},v=u.getLogger(m),R(),S=(0,s.default)(t).create(e),n.on(a.INITIALIZATION_LOADED,N,m),n.on(a.SEGMENTS_LOADED,x,m),n.on(a.REPRESENTATION_UPDATE_STARTED,D,m),n.on(a.DYNAMIC_TO_STATIC,O,m),m}l.__dashjs_factory_name="DashHandler",t.default=a.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(165));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;function t(){e={}}function n(){t()}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return i.default},registerLoader:function(t,n){e[t]=n},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:n}}o.__dashjs_factory_name="SchemeLoaderFactory";var s=r.default.getSingletonFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(3)),i=h(n(20)),a=h(n(31)),o=h(n(0)),s=h(n(2)),u=h(n(23)),l=h(n(1)),c=n(7),d=h(n(56)),f=h(n(30));function h(e){return e&&e.__esModule?e:{default:e}}function p(){var e=void 0,t=void 0,n=void 0,o=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=this.context,T=(0,r.default)(E).getInstance(),_=(0,u.default)(E).getInstance();function b(){n={pr:1,nor:null,st:null,sf:null,sid:""+f.default.generateUuid(),cid:null},v={},m={},y={},S()}function A(){S()}function S(){if(p){var e=p.getStreamController();if(e&&"function"==typeof e.getActiveStream){var t=e.getActiveStream();t&&(g=t.getProcessors())}}}function w(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;e[u]&&(n[u]=e[u])}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}function I(e){try{return e.type===c.HTTPRequest.MPD_TYPE?((t=R()).ot="m",t):e.type===c.HTTPRequest.MEDIA_SEGMENT_TYPE?(function(e){y.hasOwnProperty(e)||(y[e]=!1),m.hasOwnProperty(e)||(m[e]=!1),v.hasOwnProperty(e)||(v[e]=!1)}(e.mediaType),function(e){var t=R(),r=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),i=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(e){return null}}(e),a=function(e){try{return 100*parseInt(o.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(e){return null}}(e.mediaType),s=function(e){try{var t=n.pr,r=h.getCurrentBufferLevel(e);return isNaN(t)||isNaN(r)?null:100*parseInt(r/t*10)}catch(e){return null}}(e.mediaType),u=C(e.mediaType),c=function(e){try{var t=o.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(e){return null}}(e.mediaType),d=n.pr,f=function(e){if(g&&0!==g.length){var t=!0,n=!1,r=void 0;try{for(var i,a=g[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(o.getType()===e)return o.probeNextRequest()}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}}(e.mediaType),E=void 0;e.mediaType===l.default.VIDEO&&(E="v"),e.mediaType===l.default.AUDIO&&(E="a"),e.mediaType===l.default.FRAGMENTED_TEXT&&(E="application/mp4"===e.mediaInfo.mimeType?"tt":"c");var T=_.get().streaming.cmcd.rtp;if(T||(T=function(e){var t=p.getPlaybackRate();t||(t=1);var n=e.quality,r=e.mediaType,i=e.mediaInfo,a=e.duration,o=C(r);0===o&&(o=500);var s=i.bitrateList[n].bandwidth*a/1e3/(o/t/1e3),u=_.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(_.get().streaming.cmcd.rtpSafetyFactor)?_.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(s*u/100)+1)}(e)),t.rtp=T,f)if(e.url!==f.url){var b=new URL(f.url);t.nor=b.pathname}else f.range&&(t.nrr=f.range);return r&&(t.br=r),E&&(t.ot=E),isNaN(i)||(t.d=i),isNaN(a)||(t.mtp=a),isNaN(s)||(t.dl=s),isNaN(u)||(t.bl=u),isNaN(c)||(t.tb=c),isNaN(d)||1===d||(t.pr=d),v[e.mediaType]&&(t.bs=!0,v[e.mediaType]=!1),!m[e.mediaType]&&y[e.mediaType]||(t.su=!0,m[e.mediaType]=!1,y[e.mediaType]=!0),t}(e)):e.type===c.HTTPRequest.INIT_SEGMENT_TYPE?function(){var e=R();return e.ot="i",e.su=!0,e}():e.type===c.HTTPRequest.OTHER_TYPE||e.type===c.HTTPRequest.XLINK_EXPANSION_TYPE?function(){var e=R();return e.ot="o",e}():e.type===c.HTTPRequest.LICENSE?function(e){var t=R();return t.ot="k",t}():null}catch(e){return null}var t}function R(){var e={},t=_.get().streaming.cmcd.cid?_.get().streaming.cmcd.cid:n.cid;return e.v=1,e.sid=_.get().streaming.cmcd.sid?_.get().streaming.cmcd.sid:n.sid,e.sid=""+e.sid,t&&(e.cid=""+t),isNaN(n.pr)||1===n.pr||null===n.pr||(e.pr=n.pr),n.st&&(e.st=n.st),n.sf&&(e.sf=n.sf),e}function C(e){try{var t=h.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(e){return null}}function D(e){try{n.pr=e.playbackRate}catch(e){}}function M(t){try{var r=e.getIsDynamic(t.data)?"l":"v",i=t.protocol&&"MSS"===t.protocol?"s":"d";n.st=""+r,n.sf=""+i}catch(e){}}function L(e){try{e.state&&e.mediaType&&e.state===i.default.BUFFER_EMPTY&&(v[e.mediaType]||(v[e.mediaType]=!0),m[e.mediaType]||(m[e.mediaType]=!0))}catch(e){}}function N(){for(var e in v)v.hasOwnProperty(e)&&(v[e]=!0);for(var t in m)m.hasOwnProperty(t)&&(m[t]=!0)}function x(e){try{if(!e)return null;var t=Object.keys(e).sort((function(e,t){return e.localeCompare(t)})),n=t.length,r=t.reduce((function(t,r,i){return"v"===r&&1===e[r]||("string"!=typeof e[r]||"ot"===r&&"sf"===r&&"st"===r?t+=r+"="+e[r]:t+=r+'="'+e[r].replace(/"/g,'"')+'"',i<n-1&&(t+=",")),t}),"");return r.replace(/=true/g,"")}catch(e){return null}}return t={getQueryParameter:function(e){try{if(_.get().streaming.cmcd&&_.get().streaming.cmcd.enabled){var t=I(e),n=x(t);return T.trigger(a.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:n}),{key:"CMCD",value:n}}return null}catch(e){return null}},getHeaderParameters:function(e){try{if(_.get().streaming.cmcd&&_.get().streaming.cmcd.enabled){var t=I(e),n=w(t,["br","d","ot","tb"]),r=w(t,["bl","dl","mtp","nor","nrr","su"]),i=w(t,["bs","rtp"]),o=w(t,["cid","pr","sf","sid","st","v"]),s={"CMCD-Object":x(n),"CMCD-Request":x(r),"CMCD-Status":x(i),"CMCD-Session":x(o)};return T.trigger(a.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t}),s}return null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(o=e.abrController),e.dashMetrics&&(h=e.dashMetrics),e.playbackController&&(p=e.playbackController))},reset:function(){T.off(i.default.PLAYBACK_RATE_CHANGED,D,this),T.off(i.default.MANIFEST_LOADED,M,this),T.off(i.default.BUFFER_LEVEL_STATE_CHANGED,L,t),T.off(i.default.PLAYBACK_SEEKED,N,t),b()},initialize:function(){T.on(i.default.PLAYBACK_RATE_CHANGED,D,t),T.on(i.default.MANIFEST_LOADED,M,t),T.on(i.default.BUFFER_LEVEL_STATE_CHANGED,L,t),T.on(i.default.PLAYBACK_SEEKED,N,t),T.on(i.default.PERIOD_SWITCH_COMPLETED,A,t)}},(0,s.default)(E).getInstance().getLogger(t),e=(0,d.default)(E).getInstance(),b(),t}p.__dashjs_factory_name="CmcdModel",t.default=o.default.getSingletonFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};r.DEFAULT_DVB_PRIORITY=1,r.DEFAULT_DVB_WEIGHT=1,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(172));function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{areEqual:function(e,t){return(0,i.default)(e,t)}}}o.__dashjs_factory_name="ObjectUtils",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(3)),i=c(n(4)),a=c(n(0)),o=c(n(2)),s=c(n(10)),u=c(n(8)),l=c(n(12));function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e,t=this.context,n=(0,r.default)(t).getInstance(),a=(0,l.default)(t).getInstance(),c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0;function _(){d=NaN,g=!1,h=!0,p=!1,b()}function b(){null!==f&&(clearTimeout(f),f=null)}function A(e){b(),p||(isNaN(e)&&!isNaN(d)&&(e=1e3*d),isNaN(e)||(c.debug("Refresh manifest in "+e+" milliseconds."),f=setTimeout(I,e)))}function S(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g=!0;var t=v.getValue(),n=t.url,r=y.getPatchLocation(t),i=y.getLocation(t);r&&!e?n=r:i&&(n=i),a.isRelative(n)&&(n=a.resolve(n,t.url)),m.load(n)}function w(e){if(e){if(y.getIsPatch(e)){var t=e;e=v.getValue();var r=y.isPatchValid(e,t),a=r;if(r){var o=y.getPublishTime(e);a=y.applyPatchToManifest(e,t);var s=y.getPublishTime(e);a=o.getTime()!=s.getTime()}if(!a)return c.debug("Patch provided is invalid, performing full manifest refresh"),void S(!0);e.loadedTime=new Date}}else(e=v.getValue()).loadedTime=new Date;if(v.getValue()&&v.getValue().type===u.default.DYNAMIC&&e.type===u.default.STATIC)return n.trigger(i.default.DYNAMIC_TO_STATIC),g=!1,void(p=!0);v.setValue(e);var l=new Date,f=(l.getTime()-e.loadedTime.getTime())/1e3;1e3*(d=y.getManifestUpdatePeriod(e,f))>2147483647&&(d=2147483.647),n.trigger(i.default.MANIFEST_UPDATED,{manifest:e}),c.info("Manifest has been refreshed at "+l+"["+l.getTime()/1e3+"] "),h||A()}function I(){h||(g?A(T.get().streaming.manifestUpdateRetryInterval):S())}function R(e){e.error?e.error.code===s.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&E.error(e.error):w(e.manifest)}function C(){h=!1,A()}function D(){(h=!T.get().streaming.scheduleWhilePaused)&&b()}function M(){g=!1}return e={initialize:function(){_(),n.on(i.default.STREAMS_COMPOSED,M,this),n.on(i.default.PLAYBACK_STARTED,C,this),n.on(i.default.PLAYBACK_PAUSED,D,this),n.on(i.default.INTERNAL_MANIFEST_LOADED,R,this)},setManifest:function(e){w(e)},refreshManifest:S,setConfig:function(e){e&&(e.manifestModel&&(v=e.manifestModel),e.adapter&&(y=e.adapter),e.manifestLoader&&(m=e.manifestLoader),e.errHandler&&(E=e.errHandler),e.settings&&(T=e.settings))},reset:function(){n.off(i.default.PLAYBACK_STARTED,C,this),n.off(i.default.PLAYBACK_PAUSED,D,this),n.off(i.default.STREAMS_COMPOSED,M,this),n.off(i.default.INTERNAL_MANIFEST_LOADED,R,this),_()}},c=(0,o.default)(t).getInstance().getLogger(e),e}d.__dashjs_factory_name="ManifestUpdater",t.default=a.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.url=e||null,i.type=n||null,i.mediaType=r.default.STREAM,i.responseType="",i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i(n(15)).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function n(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function r(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function i(t,n,i){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&r(e.arrayAccessFormPaths,t,n,i)&&(t[n]=[t[n]])}function a(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function o(t,n,i,a){return!(1==n&&e.xmlElementsFilter.length>0)||r(e.xmlElementsFilter,t,i,a)}function s(n,u){if(9==n.nodeType){for(var l=new Object,c=n.childNodes,d=0;d<c.length;d++)1==(h=c[d]).nodeType&&(e.ignoreRoot?l=s(h):(l={})[p=t(h)]=s(h));return l}if(1==n.nodeType){(l=new Object).__cnt=0;var f=[];for(c=n.childNodes,d=0;d<c.length;d++){var h,p=t(h=c[d]);if(8!=h.nodeType){var g=u+"."+p;if(o(l,h.nodeType,p,g))if(l.__cnt++,null==l[p]){var m=s(h,g);("#text"!=p||/[^\s]/.test(m))&&((v={})[p]=m,f.push(v)),l[p]=m,i(l,p,g)}else{var v;null!=l[p]&&(l[p]instanceof Array||(l[p]=[l[p]],i(l,p,g))),m=s(h,g),("#text"!=p||/[^\s]/.test(m))&&((v={})[p]=m,f.push(v)),l[p][l[p].length]=m}}}l.__children=f;for(var y=t(n),E=0;E<n.attributes.length;E++){var T=n.attributes[E];l.__cnt++;for(var _=T.value,b=0,A=e.matchers.length;b<A;b++){var S=e.matchers[b];S.test(T,y)&&(_=S.converter(T.value))}l[e.attributePrefix+T.name]=_}var w=function(e){return e.prefix}(n);return null!=w&&""!=w&&(l.__cnt++,l.__prefix=w),null!=l["#text"]&&(l.__text=l["#text"],l.__text instanceof Array&&(l.__text=l.__text.join("\n")),e.stripWhitespaces&&(l.__text=l.__text.trim()),delete l["#text"],"property"==e.arrayAccessForm&&delete l["#text_asArray"],l.__text=function(t,n,i){if(e.datetimeAccessFormPaths.length>0){var o=i.split(".#")[0];return r(e.datetimeAccessFormPaths,t,n,o)?a(t):t}return t}(l.__text,p,u+"."+p)),null!=l["#cdata-section"]&&(l.__cdata=l["#cdata-section"],delete l["#cdata-section"],"property"==e.arrayAccessForm&&delete l["#cdata-section_asArray"]),0==l.__cnt&&"text"==e.emptyNodeForm?l="":1==l.__cnt&&null!=l.__text?l=l.__text:1!=l.__cnt||null==l.__cdata||e.keepCData?l.__cnt>1&&null!=l.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==l.__text||""==l.__text.trim())&&delete l.__text:l=l.__cdata,delete l.__cnt,!e.enableToStringFunc||null==l.__text&&null==l.__cdata||(l.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),l}if(3==n.nodeType||4==n.nodeType)return n.nodeValue}function u(t,r,i,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+r;if(null!=i)for(var s=0;s<i.length;s++){var u=i[s],l=t[u];e.escapeMode&&(l=n(l)),o+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+l+'"':o+="'"+l+"'"}return o+(a?"/>":">")}function l(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(t,n){return"property"==e.arrayAccessForm&&(i="_asArray",-1!==(r=n.toString()).indexOf(i,r.length-i.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r,i}function d(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function f(t,n,i){return 0==e.jsonPropertiesFilter.length||""==i||r(e.jsonPropertiesFilter,t,n,i)}function h(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function p(t){var r="";return t instanceof Object?r+=function(t){var r="";return null!=t.__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?r+=n(t.__text):r+=t.__text),r}(t):null!=t&&(e.escapeMode?r+=n(t):r+=t),r}function g(e,t){return""===e?t:e+"."+t}function m(e,t,n,r){var i="";if(0==e.length)i+=u(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=u(e[a],t,h(e[a]),!1),i+=v(e[a],g(r,t)),i+=l(e[a],t);return i}function v(e,t){var n="";if(d(e)>0)for(var r in e)if(!c(e,r)&&(""==t||f(e,r,g(t,r)))){var i=e[r],a=h(i);null==i||null==i?n+=u(i,r,a,!0):i instanceof Object?i instanceof Array?n+=m(i,r,a,t):i instanceof Date?(n+=u(i,r,a,!1),n+=i.toISOString(),n+=l(i,r)):d(i)>0||null!=i.__text||null!=i.__cdata?(n+=u(i,r,a,!1),n+=v(i,g(t,r)),n+=l(i,r)):n+=u(i,r,a,!0):(n+=u(i,r,a,!1),n+=p(i),n+=l(i,r))}return n+p(e)}void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1),this.parseXmlString=function(e){var t;if(window.ActiveXObject||window,void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?a(e):e},this.xml2json=function(e){return s(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return v(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(r=n(198))&&r.__esModule?r:{default:r},o=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach((function(e){i._properties.push(new a.default(e))}))}return i(e,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportsMediaSource=s;var r,i=(r=n(0))&&r.__esModule?r:{default:r},a=n(57),o=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function s(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function u(){var e,t=void 0;return e={supportsMediaSource:s,supportsEncryptedMedia:function(){return t},supportsCodec:function(e){return!(!("MediaSource"in window)||!MediaSource.isTypeSupported(e))||!(!("WebKitMediaSource"in window)||!WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){t=e},supportsEssentialProperty:function(e){try{return-1!==a.THUMBNAILS_SCHEME_ID_URIS.indexOf(e.schemeIdUri)}catch(e){return!0}},codecRootCompatibleWithCodec:function(e,t){for(var n=e.split(".")[0],r=0===t.indexOf(n),i=void 0,a=0;a<o.length;a++)if(o[a].codec===n){i=o[a];break}return i?r||i.compatibleCodecs.some((function(e){return 0===t.indexOf(e)})):r}},t=!1,e}u.__dashjs_factory_name="Capabilities",t.default=i.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=function(){return"3.2.2"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(241))&&r.__esModule?r:{default:r};function a(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":i.default},n=this.context,r=void 0,a=e.debug?e.debug.getLogger(r):{},o=e.metricsConstants;return{create:function(e,r){var i=void 0;try{(i=t[e.schemeIdUri](n).create({metricsConstants:o})).initialize(e,r)}catch(t){i=null,a.error("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return i},register:function(e,n){t[e]=n},unregister:function(e){delete t[e]}}}a.__dashjs_factory_name="ReportingFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(245)),i=s(n(246)),a=s(n(247)),o=s(n(248));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){var t=void 0,n=(e=e||{}).debug?e.debug.getLogger(t):{},s=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,u=this.context,l={BufferLevel:r.default,DVBErrors:i.default,HttpList:a.default,PlayList:o.default,RepSwitchList:o.default,TcpList:o.default};return{create:function(t,r){var i,a=t.match(s);if(a){try{(i=l[a[1]](u).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(a[1],r,a[3],a[5])}catch(e){i=null,n.error("MetricsHandlerFactory: Could not create handler for type "+a[1]+" with args "+a[3]+", "+a[5]+" ("+e.message+")")}return i}},register:function(e,t){l[e]=t},unregister:function(e){delete l[e]}}}u.__dashjs_factory_name="MetricsHandlerFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(u)},function(e,t,n){"use strict";function r(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="HandlerHelpers",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){(function(e){
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
!function(){var n="undefined"!=typeof window?window:e,r={};for(var i in function(e,t,n){var r;function i(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},o=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var r=0;r<n.length;++r){var i=n[r];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{for(var n=o,r=e.split("."),i=0;i<r.length-1;i++){var s=r[i];if(!(s in n))break e;n=n[s]}(s=t(i=n[r=r[r.length-1]]))!=i&&null!=s&&a(n,r,{configurable:!0,writable:!0,value:s})}}function u(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function l(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:i(e)}}function c(e){if(!(e instanceof Array)){e=l(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}s("Symbol",(function(e){function t(e,t){this.a=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.a};var n=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t("jscomp_symbol_"+(r||"")+"_"+n++,r)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var r=o[t[n]];"function"==typeof r&&"function"!=typeof r.prototype[e]&&a(r.prototype,e,{configurable:!0,writable:!0,value:function(){return u(i(this))}})}return e}));var d,f="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)d=Object.setPrototypeOf;else{var h;e:{var p={};try{p.__proto__={te:!0},h=p.te;break e}catch(e){}h=!1}d=h?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var g=d;function m(e,t){if(e.prototype=f(t.prototype),e.prototype.constructor=e,g)g(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.sg=t.prototype}function v(){this.j=!1,this.g=null,this.b=void 0,this.a=1,this.f=this.h=0,this.v=this.c=null}function y(e){if(e.j)throw new TypeError("Generator is already running");e.j=!0}function E(e,t){e.c={Rd:t,Wd:!0},e.a=e.h||e.f}function T(e,t,n){return e.a=n,{value:t}}function _(e){e.a=0}function b(e,t,n){e.h=t,null!=n&&(e.f=n)}function A(e){e.h=0,e.f=2}function S(e,t){e.a=t,e.h=0}function w(e){e.h=0;var t=e.c.Rd;return e.c=null,t}function I(e){e.v=[e.c],e.h=0,e.f=0}function R(e,t){var n=e.v.splice(0)[0];(n=e.c=e.c||n)?n.Wd?e.a=e.h||e.f:null!=n.m&&e.f<n.m?(e.a=n.m,e.c=null):e.a=e.f:e.a=t}function C(e){this.a=new v,this.b=e}function D(e,t,n,r){try{var i=t.call(e.a.g,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.a.j=!1,i;var a=i.value}catch(t){return e.a.g=null,E(e.a,t),M(e)}return e.a.g=null,r.call(e.a,a),M(e)}function M(e){for(;e.a.a;)try{var t=e.b(e.a);if(t)return e.a.j=!1,{value:t.value,done:!1}}catch(t){e.a.b=void 0,E(e.a,t)}if(e.a.j=!1,e.a.c){if(t=e.a.c,e.a.c=null,t.Wd)throw t.Rd;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function L(e){this.next=function(t){return y(e.a),e.a.g?t=D(e,e.a.g.next,t,e.a.l):(e.a.l(t),t=M(e)),t},this.throw=function(t){return y(e.a),e.a.g?t=D(e,e.a.g.throw,t,e.a.l):(E(e.a,t),t=M(e)),t},this.return=function(t){return function(e,t){y(e.a);var n=e.a.g;return n?D(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),M(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function N(e,t){var n=new L(new C(t));return g&&e.prototype&&g(n,e.prototype),n}function x(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(r,i){!function e(a){a.done?r(a.value):Promise.resolve(a.value).then(t,n).then(e,i)}(e.next())}))}(new L(new C(e)))}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function P(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}function k(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var a=e[i];if(t.call(n,a,i,e))return{ba:i,qe:a}}return{ba:-1,qe:void 0}}function F(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}v.prototype.l=function(e){this.b=e},v.prototype.return=function(e){this.c={return:e},this.a=this.f},v.prototype.m=function(e){this.a=e},s("Promise",(function(e){function t(e){this.b=0,this.c=void 0,this.a=[],this.j=!1;var t=this.f();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.a=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c((function(){t.g()}))}this.a.push(e)};var i=o.setTimeout;n.prototype.c=function(e){i(e,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.f(e)}}}this.a=null},n.prototype.f=function(e){this.c((function(){throw e}))},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.D),reject:e(this.g)}},t.prototype.D=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.J(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.C(e):this.h(e)}},t.prototype.C=function(e){var t=void 0;try{t=e.then}catch(e){return void this.g(e)}"function"==typeof t?this.M(t,e):this.h(e)},t.prototype.g=function(e){this.l(2,e)},t.prototype.h=function(e){this.l(1,e)},t.prototype.l=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,2===this.b&&this.H(),this.v()},t.prototype.H=function(){var e=this;i((function(){if(e.A()){var t=o.console;void 0!==t&&t.error(e.c)}}),1)},t.prototype.A=function(){if(this.j)return!1;var e=o.CustomEvent,t=o.Event,n=o.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.c,n(e))},t.prototype.v=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)a.b(this.a[e]);this.a=null}};var a=new n;return t.prototype.J=function(e){var t=this.f();e.nc(t.resolve,t.reject)},t.prototype.M=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){a(e)}}:t}var i,a,o=new t((function(e,t){i=e,a=t}));return this.nc(r(e,i),r(n,a)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.nc=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n),this.j=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=l(e),a=i.next();!a.done;a=i.next())r(a.value).nc(t,n)}))},t.all=function(e){var n=l(e),i=n.next();return i.done?r([]):new t((function(e,t){function a(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,r(i.value).nc(a(o.length-1),t),i=n.next()}while(!i.done)}))},t})),s("WeakMap",(function(e){function t(e){if(this.a=(u+=Math.random()+1).toString(),e){e=l(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function i(e){if(!O(e,s)){var t=new n;a(e,s,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&i(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(i(e),!O(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.a]=t,this},t.prototype.get=function(e){return r(e)&&O(e,s)?e[s][this.a]:void 0},t.prototype.has=function(e){return r(e)&&O(e,s)&&O(e[s],this.a)},t.prototype.delete=function(e){return!!(r(e)&&O(e,s)&&O(e[s],this.a))&&delete e[s][this.a]},t})),s("Map",(function(e){function t(){var e={};return e.Oa=e.next=e.head=e}function n(e,t){var n=e.a;return u((function(){if(n){for(;n.head!=e.a;)n=n.Oa;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?a.has(t)?n=a.get(t):(n=""+ ++o,a.set(t,n)):n="p_"+t;var r=e.b[n];if(r&&O(e.b,n))for(var i=0;i<r.length;i++){var s=r[i];if(t!=t&&s.key!=s.key||t===s.key)return{id:n,list:r,index:i,aa:s}}return{id:n,list:r,index:-1,aa:void 0}}function i(e){if(this.b={},this.a=t(),this.size=0,e){e=l(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(l([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=r.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!r.next().done)}catch(e){return!1}}())return e;var a=new WeakMap;i.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.b[n.id]=[]),n.aa?n.aa.value=t:(n.aa={next:this.a,Oa:this.a.Oa,head:this.a,key:e,value:t},n.list.push(n.aa),this.a.Oa.next=n.aa,this.a.Oa=n.aa,this.size++),this},i.prototype.delete=function(e){return!(!(e=r(this,e)).aa||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.aa.Oa.next=e.aa.next,e.aa.next.Oa=e.aa.Oa,e.aa.head=null,this.size--,0))},i.prototype.clear=function(){this.b={},this.a=this.a.Oa=t(),this.size=0},i.prototype.has=function(e){return!!r(this,e).aa},i.prototype.get=function(e){return(e=r(this,e).aa)&&e.value},i.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},i.prototype.keys=function(){return n(this,(function(e){return e.key}))},i.prototype.values=function(){return n(this,(function(e){return e.value}))},i.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var o=0;return i})),s("Set",(function(e){function t(e){if(this.a=new Map,e){e=l(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(l([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&!(i=r.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&r.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.a.set(e,e),this.size=this.a.size,this},t.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},t.prototype.clear=function(){this.a.clear(),this.size=0},t.prototype.has=function(e){return this.a.has(e)},t.prototype.entries=function(){return this.a.entries()},t.prototype.values=function(){return this.a.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.a.forEach((function(r){return e.call(t,r,r,n)}))},t)})),s("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),s("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length,i=t||0;for(0>i&&(i=Math.max(i+r,0));i<r;i++){var a=n[i];if(a===e||Object.is(a,e))return!0}return!1}})),s("String.prototype.includes",(function(e){return e||function(e,t){return-1!==P(this,e,"includes").indexOf(e,t||0)}})),s("Array.prototype.findIndex",(function(e){return e||function(e,t){return k(this,e,t).ba}})),s("Array.prototype.values",(function(e){return e||function(){return F(this,(function(e,t){return t}))}})),s("Array.prototype.keys",(function(e){return e||function(){return F(this,(function(e){return e}))}}));var U="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)O(r,i)&&(e[i]=r[i])}return e};s("Object.assign",(function(e){return e||U})),s("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var a=0;!(i=e.next()).done;)r.push(t.call(n,i.value,a++))}else for(i=e.length,a=0;a<i;a++)r.push(t.call(n,e[a],a));return r}})),s("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}})),s("Array.prototype.entries",(function(e){return e||function(){return F(this,(function(e,t){return[e,t]}))}})),s("Array.prototype.find",(function(e){return e||function(e,t){return k(this,e,t).qe}})),s("String.prototype.repeat",(function(e){return e||function(e){var t=P(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}})),s("String.prototype.startsWith",(function(e){return e||function(e,t){for(var n=P(this,e,"startsWith"),r=n.length,i=e.length,a=Math.max(0,Math.min(0|t,n.length)),o=0;o<i&&a<r;)if(n[a++]!=e[o++])return!1;return o>=i}})),s("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)O(e,t)&&n.push(e[t]);return n}})),s("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}})),s("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)O(e,t)&&n.push([t,e[t]]);return n}}));var B=this||self;function G(e,t){var n,r=e.split("."),i=B;r[0]in i||void 0===i.execScript||i.execScript("var "+r[0]);for(;r.length&&(n=r.shift());)r.length||void 0===t?i=i[n]&&i[n]!==Object.prototype[n]?i[n]:i[n]={}:i[n]=t}
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function j(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function H(e,t,n){var r=Math.pow(e.c,t);n=n*(1-r)+r*e.a,isNaN(n)||(e.a=n,e.b+=t)}function K(e){return e.a/(1-Math.pow(e.c,e.b))}function Y(){this.b=new j(2),this.c=new j(5),this.a=0}function V(){}function q(){}function W(){}function z(e,t){for(var n=[],r=1;r<arguments.length;++r)n[r-1]=arguments[r];Q.has(e)||(Q.add(e),W.apply(V,c(n)))}function X(){}Y.prototype.getBandwidthEstimate=function(e){return 128e3>this.a?e:Math.min(K(this.b),K(this.c))};var Q=new Set;if(e.console&&e.console.log.bind){var J={},Z=(J[1]=console.error.bind(console),J[2]=console.warn.bind(console),J[3]=console.info.bind(console),J[4]=console.log.bind(console),J[5]=console.debug.bind(console),J[6]=console.debug.bind(console),J);W=Z[2],q=Z[1]}function $(e,t){for(var n=[],r=l(e),i=r.next();!i.done;i=r.next())n.push(t(i.value));return n}var ee=function e(t){var n;return N(e,(function(e){return 1==e.a&&(n=0),3!=e.a?n<t?T(e,n,3):e.m(0):(n++,e.m(2))}))},te=function e(t){var n,r,i,a,o,s;return N(e,(function(e){return 1==e.a&&(n=-1,i=r=void 0,a=l(t),o=a.next()),5!=e.a?o.done?-1==n?e.m(0):T(e,{ba:n,nf:r,item:i,next:void 0},0):(s=o.value,0<=n?T(e,{ba:n,item:i,nf:r,next:s},5):e.m(5)):(n++,r=i,i=s,o=a.next(),e.m(2))}))};function ne(){}function re(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(ie(e)==ie(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;for(var n=oe(e),r=oe(t),i=l(ee(e.byteLength)),a=i.next();!a.done;a=i.next())if(n[a=a.value]!=r[a])return!1;return!0}function ie(e){return e instanceof ArrayBuffer?e:e.buffer}function ae(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function oe(e,t,n){return ue(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint8Array)}function se(e,t,n){return ue(e,void 0===t?0:t,n=void 0===n?1/0:n,DataView)}function ue(e,t,n,r){var i=(e.byteOffset||0)+e.byteLength;return t=Math.max(0,Math.min((e.byteOffset||0)+t,i)),new r(ie(e),t,Math.min(t+Math.max(n,0),i)-t)}function le(e,t,n,r){for(var i=[],a=3;a<arguments.length;++a)i[a-3]=arguments[a];this.severity=e,this.category=t,this.code=n,this.data=i,this.handled=!1}function ce(e){this.b=e,this.a=void 0}function de(){}function fe(e){return e?(239==(e=oe(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),(e=(new TextDecoder).decode(e)).includes("�")&&q('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e):""}function he(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new le(2,2,2004);var r=Math.floor(e.byteLength/2);n=new Uint16Array(r),e=se(e);for(var i=(r=l(ee(r))).next();!i.done;i=r.next())n[i=i.value]=e.getUint16(2*i,t);return ve.value()(n)}function pe(e){function t(e){return n.byteLength<=e||32<=n[e]&&126>=n[e]}if(!e)return"";var n=oe(e);if(239==n[0]&&187==n[1]&&191==n[2])return fe(n);if(254==n[0]&&255==n[1])return he(n.subarray(2),!1);if(255==n[0]&&254==n[1])return he(n.subarray(2),!0);if(0==n[0]&&0==n[2])return he(e,!1);if(0==n[1]&&0==n[3])return he(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return fe(e);throw new le(2,2,2003)}function ge(e){return ae((new TextEncoder).encode(e))}function me(e,t){for(var n=new ArrayBuffer(2*e.length),r=new DataView(n),i=l(te(e)),a=i.next();!a.done;a=i.next())a=a.value,r.setUint16(2*a.ba,a.item.charCodeAt(0),t);return n}G("shaka.util.BufferUtils",ne),ne.toDataView=se,ne.toUint8=oe,ne.toArrayBuffer=ae,ne.equal=re,le.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},G("shaka.util.Error",le),le.Severity={RECOVERABLE:1,CRITICAL:2},le.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},le.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004},ce.prototype.value=function(){return null==this.a&&(this.a=this.b()),this.a},G("shaka.util.StringUtils",de),de.resetFromCharCode=function(){ve.a=void 0},de.toUTF16=me,de.toUTF8=ge,de.fromBytesAutoDetect=pe,de.fromUTF16=he,de.fromUTF8=fe;var ve=new ce((function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}}for(var t={Qa:65536};0<t.Qa;(t={Qa:t.Qa}).Qa/=2)if(e(t.Qa))return function(e){return function(t){for(var n="",r=0;r<t.length;r+=e.Qa)n+=String.fromCharCode.apply(null,t.subarray(r,r+e.Qa));return n}}(t);return null}));function ye(e,t){this.P=se(e),this.b=t==Te,this.a=0}function Ee(){return new le(2,3,3e3)}(r=ye.prototype).ha=function(){return this.a<this.P.byteLength},r.Z=function(){return this.a},r.Me=function(){return this.P.byteLength},r.V=function(){try{var e=this.P.getUint8(this.a);return this.a+=1,e}catch(e){throw Ee()}},r.Bb=function(){try{var e=this.P.getUint16(this.a,this.b);return this.a+=2,e}catch(e){throw Ee()}},r.I=function(){try{var e=this.P.getUint32(this.a,this.b);return this.a+=4,e}catch(e){throw Ee()}},r.de=function(){try{var e=this.P.getInt32(this.a,this.b);return this.a+=4,e}catch(e){throw Ee()}},r.gb=function(){try{if(this.b)var e=this.P.getUint32(this.a,!0),t=this.P.getUint32(this.a+4,!0);else t=this.P.getUint32(this.a,!1),e=this.P.getUint32(this.a+4,!1)}catch(e){throw Ee()}if(2097151<t)throw new le(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},r.Va=function(e){if(this.a+e>this.P.byteLength)throw Ee();var t=oe(this.P,this.a,e);return this.a+=e,t},r.skip=function(e){if(this.a+e>this.P.byteLength)throw Ee();this.a+=e},r.fe=function(e){if(this.a<e)throw Ee();this.a-=e},r.seek=function(e){if(0>e||e>this.P.byteLength)throw Ee();this.a=e},r.Ub=function(){for(var e=this.a;this.ha()&&0!=this.P.getUint8(this.a);)this.a+=1;return e=oe(this.P,e,this.a-e),this.a+=1,fe(e)},G("shaka.util.DataViewReader",ye),ye.prototype.readTerminatedString=ye.prototype.Ub,ye.prototype.seek=ye.prototype.seek,ye.prototype.rewind=ye.prototype.fe,ye.prototype.skip=ye.prototype.skip,ye.prototype.readBytes=ye.prototype.Va,ye.prototype.readUint64=ye.prototype.gb,ye.prototype.readInt32=ye.prototype.de,ye.prototype.readUint32=ye.prototype.I,ye.prototype.readUint16=ye.prototype.Bb,ye.prototype.readUint8=ye.prototype.V,ye.prototype.getLength=ye.prototype.Me,ye.prototype.getPosition=ye.prototype.Z,ye.prototype.hasMoreData=ye.prototype.ha;var Te=1;function _e(e,t){this.a=e,this.b=t}function be(e,t){var n=new _e(4,0),r=we,i=r.a,a=n.b-i.b;(0<(n.a-i.a||a)?r.c:r.b)(r.a,n,e,t)}function Ae(e,t,n,r){W([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",r].join(" "))}function Se(e,t,n,r){q([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",r].join(""))}ye.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:Te},_e.prototype.toString=function(){return"v"+this.a+"."+this.b};var we=null;function Ie(e,t){return e.concat(t)}function Re(){}function Ce(e){return null!=e}function De(e){var t=Object.create(e.prototype||Object.prototype);try{var n=e.call(t);n||(be("Factories requiring new","Factories should be plain functions"),n=t)}catch(t){be("Factories requiring new","Factories should be plain functions"),n=new e}return n}function Me(){this.c=[],this.b=[],this.a=!1}function Le(e){for(var t=ke(e);e.reader.ha()&&!e.parser.a;)e.parser.Bc(e.start+t,e.reader,e.partialOkay)}function Ne(e){for(var t=ke(e),n=e.reader.I(),r=(n=l(ee(n))).next();!r.done&&(e.parser.Bc(e.start+t,e.reader,e.partialOkay),!e.parser.a);r=n.next());}function xe(e){return function(t){e(t.reader.Va(t.reader.P.byteLength-t.reader.Z()))}}function Oe(e){for(var t=0,n=(e=l(e)).next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function Pe(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function ke(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}(r=Me.prototype).box=function(e,t){var n=Oe(e);return this.c[n]=Fe,this.b[n]=t,this},r.S=function(e,t){var n=Oe(e);return this.c[n]=Ue,this.b[n]=t,this},r.stop=function(){this.a=!0},r.parse=function(e,t,n){for(e=new ye(e,0),this.a=!1;e.ha()&&!this.a;)this.Bc(0,e,t,n)},r.Bc=function(e,t,n,r){var i=t.Z(),a=t.I(),o=t.I(),s=!1;switch(a){case 0:a=t.P.byteLength-i;break;case 1:a=t.gb(),s=!0}var u=this.b[o];if(u){var l=null,c=null;this.c[o]==Ue&&(l=(c=t.I())>>>24,c&=16777215),o=i+a,n&&o>t.P.byteLength&&(o=t.P.byteLength),r&&o>t.P.byteLength?this.a=!0:(r=o-t.Z(),u({parser:this,partialOkay:n||!1,version:l,flags:c,reader:t=new ye(t=0<r?t.Va(r):new Uint8Array(0),0),size:a,start:i+e,has64BitSize:s}))}else t.skip(Math.min(i+a-t.Z(),t.P.byteLength-t.Z()))},G("shaka.util.Mp4Parser",Me),Me.headerSize=ke,Me.typeToString=Pe,Me.allData=xe,Me.sampleDescription=Ne,Me.children=Le,Me.prototype.parseNext=Me.prototype.Bc,Me.prototype.parse=Me.prototype.parse,Me.prototype.stop=Me.prototype.stop,Me.prototype.fullBox=Me.prototype.S,Me.prototype.box=Me.prototype.box;var Fe=0,Ue=1;function Be(e){this.b=e,this.a=null}function Ge(e){this.b=e,this.a=null}function je(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function He(e){return""!=ze().canPlayType(e)}function Ke(){return We("Tizen")}function Ye(){return We("CrKey")}function Ve(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Ke()}function qe(){if(!Ve())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function We(e){return(navigator.userAgent||"").includes(e)}function ze(){return Qe||(Xe||(Xe=new Ge((function(){Qe=null}))),(Qe=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Qe=document.createElement("video")),Xe.N(1),Qe)}Be.prototype.N=function(t){var n=this;this.stop();var r=!0,i=null;return this.a=function(){e.clearTimeout(i),r=!1},i=e.setTimeout((function(){r&&n.b()}),1e3*t),this},Be.prototype.stop=function(){this.a&&(this.a(),this.a=null)},Ge.prototype.Yb=function(){return this.stop(),this.b(),this},Ge.prototype.N=function(e){var t=this;return this.stop(),this.a=new Be((function(){t.b()})).N(e),this},Ge.prototype.xa=function(e){var t=this;return this.stop(),this.a=new Be((function(){t.a.N(e),t.b()})).N(e),this},Ge.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},G("shaka.util.Timer",Ge),Ge.prototype.stop=Ge.prototype.stop,Ge.prototype.tickEvery=Ge.prototype.xa,Ge.prototype.tickAfter=Ge.prototype.N,Ge.prototype.tickNow=Ge.prototype.Yb;var Xe=null,Qe=null;function Je(){}function Ze(e){return e=oe(e),e=ve.value()(e),btoa(e)}function $e(e,t){t=null==t||t;var n=Ze(e).replace(/\+/g,"-").replace(/\//g,"_");return t?n:n.replace(/[=]*$/,"")}function et(t){var n=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));t=new Uint8Array(n.length);for(var r=(n=l(te(n))).next();!r.done;r=n.next())t[(r=r.value).ba]=r.item.charCodeAt(0);return t}function tt(t){for(var n=t.length/2,r=new Uint8Array(n),i=(n=l(ee(n))).next();!i.done;i=n.next())r[i=i.value]=e.parseInt(t.substr(2*i,2),16);return r}function nt(e){var t=oe(e);e="";for(var n=(t=l(t)).next();!n.done;n=t.next())1==(n=(n=n.value).toString(16)).length&&(n="0"+n),e+=n;return e}function rt(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];var r=0,i=l(t);for(n=i.next();!n.done;n=i.next())r+=n.value.byteLength;for(r=new Uint8Array(r),i=0,n=(t=l(t)).next();!n.done;n=t.next())n=n.value,r.set(oe(n),i),i+=n.byteLength;return r}function it(e,t,n,r,i){var a=ot.value(),o=e.subarray(n.start,n.start+n.size),s=se(o),u=new Uint8Array(n.size+a.byteLength);for(u.set(o,0),(o=se(u)).setUint32(4,i),u.set(a,n.size),i=s.getUint32(4),o.setUint32(n.size+16,i),at(u,0,u.byteLength),i=new Uint8Array(e.byteLength+u.byteLength),n=We("Xbox One")?n.start:n.start+n.size,a=e.subarray(n),i.set(e.subarray(0,n)),i.set(u,n),i.set(a,n+u.byteLength),r=(e=l(r)).next();!r.done;r=e.next())at(i,(r=r.value).start,r.size+u.byteLength);return u=se(i,t.start),t=ke(t),e=u.getUint32(t),u.setUint32(t,e+1),i}function at(e,t,n){0!=(t=(e=se(e,t)).getUint32(0))&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}G("shaka.util.Uint8ArrayUtils",Je),Je.concat=rt,Je.toHex=nt,Je.fromHex=tt,Je.fromBase64=et,Je.toBase64=$e,Je.toStandardBase64=Ze,Je.equal=function(e,t){return be("shaka.util.Uint8ArrayUtils.equal","Please use shaka.util.BufferUtils.equal instead."),re(e,t)};var ot=new ce((function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])}));function st(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function ut(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function lt(e,t,n){if(n||(n=st),e.length!=t.length)return!1;t=t.slice();for(var r={},i=(e=l(e)).next();!i.done;r={Mc:r.Mc},i=e.next()){if(r.Mc=i.value,-1==(i=t.findIndex(function(e){return function(t){return n(e.Mc,t)}}(r))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function ct(e,t,n){if(n||(n=st),e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function dt(e,t,n){this.startTime=e,this.direction=yt,this.endTime=t,this.payload=n,this.region=new Ct,this.position=null,this.positionAlign=ht,this.size=0,this.textAlign=pt,this.writingMode=Et,this.lineInterpretation=Tt,this.line=null,this.lineHeight="",this.lineAlign=_t,this.displayAlign=mt,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=wt,this.fontStyle=It,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=this.lineBreak=!1,this.cellResolution={columns:32,rows:15}}function ft(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!ct(e.nestedCues,t.nestedCues,ft))return!1}else if("region"==n||"cellResolution"==n){for(var r in e[n])if(e[n][r]!=t[n][r])return!1}else if(Array.isArray(e[n])){if(!ct(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}dt.prototype.clone=function(){var e,t=new dt(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},G("shaka.text.Cue",dt);var ht="auto";dt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:ht};var pt="center",gt={LEFT:"left",RIGHT:"right",CENTER:pt,START:"start",END:"end"};dt.textAlign=gt;var mt="after",vt={BEFORE:"before",CENTER:"center",AFTER:mt};dt.displayAlign=vt;var yt="ltr";dt.direction={HORIZONTAL_LEFT_TO_RIGHT:yt,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var Et="horizontal-tb";dt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Et,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Tt=0;dt.lineInterpretation={LINE_NUMBER:Tt,PERCENTAGE:1};var _t="start",bt={CENTER:"center",START:_t,END:"end"};dt.lineAlign=bt;var At={white:"#FFF",lime:"#0F0",cyan:"#0FF",red:"#F00",yellow:"#FF0",magenta:"#F0F",blue:"#00F",black:"#000"};dt.defaultTextColor=At;var St={bg_white:"#FFF",bg_lime:"#0F0",bg_cyan:"#0FF",bg_red:"#F00",bg_yellow:"#FF0",bg_magenta:"#F0F",bg_blue:"#00F",bg_black:"#000"};dt.defaultTextBackgroundColor=St;var wt=400;dt.fontWeight={NORMAL:wt,BOLD:700};var It="normal",Rt={NORMAL:It,ITALIC:"italic",OBLIQUE:"oblique"};function Ct(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Dt,this.scroll=Mt}dt.fontStyle=Rt,dt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},G("shaka.text.CueRegion",Ct);var Dt=1;Ct.units={PX:0,PERCENTAGE:Dt,LINES:2};var Mt="";function Lt(e,t,n,r,i){if(r>=i)return null;for(var a=-1,o=-1,s=0;s<n.length;s++)if(n[s].some((function(e){return null!=e&&""!=e.a.trim()}))){a=s;break}for(s=n.length-1;0<=s;s--)if(n[s].some((function(e){return null!=e&&""!=e.a.trim()}))){o=s;break}if(-1===a||-1===o)return null;for(var u=s=!1,l="white",c="black",d=Nt(r,i,s,u,l,c);a<=o;a++){for(var f=n[a],h=-1,p=-1,g=0;g<f.length;g++)if(null!=f[g]&&""!==f[g].a.trim()){h=g;break}for(g=f.length-1;0<=g;g--)if(null!=f[g]&&""!==f[g].a.trim()){p=g;break}if(-1===h||-1===p)f=xt(r,i),e.nestedCues.push(f);else{for(;h<=p;h++)if(g=f[h]){var m=g.g,v=g.c,y=g.f,E=g.b;m==s&&v==u&&y==l&&E==c||(d.payload&&e.nestedCues.push(d),d=Nt(r,i,m,v,y,E),s=m,u=v,l=y,c=E),d.payload+=g.a}else d.payload+=" ";d.payload&&e.nestedCues.push(d),a!==o&&(d=xt(r,i),e.nestedCues.push(d)),d=Nt(r,i,s,u,l,c)}}return e.nestedCues.length?{cue:e,stream:t}:null}function Nt(e,t,n,r,i,a){return e=new dt(e,t,""),n&&e.textDecoration.push("underline"),r&&(e.fontStyle="italic"),e.color=i,e.backgroundColor=a,e}function xt(e,t){var n=new dt(e,t,"");return n.lineBreak=!0,n}function Ot(e,t,n,r,i){this.a=e,this.g=t,this.c=n,this.b=r,this.f=i}function Pt(){this.g=!1,this.h=this.l=0,this.j=Kt,this.c=[],this.a=this.b=this.f=0,this.D=this.A=!1,this.C="white",this.v="black",kt(this)}function kt(e){e.c=[];for(var t=0;15>t;t++)e.c.push(Ft())}function Ft(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function Ut(e,t){Bt(e)&&(e.c[e.b][e.a]=new Ot(t,e.D,e.A,e.v,e.C),e.a++)}function Bt(e){var t=e.a<e.h&&0<=e.a;return e.b<e.l&&0<=e.b&&t}function Gt(e,t,n){var r=new dt(e.f,t,"");return r.textAlign=e.j===jt?"left":e.j===Ht?"right":pt,(n=Lt(r,"svc"+n,e.c,e.f,t))&&(e.f=t),n}Ct.scrollMode={NONE:Mt,UP:"up"},Pt.prototype.isVisible=function(){return this.g};var jt=0,Ht=1,Kt=2;function Yt(){this.c=[],this.b=null,this.a=0}function Vt(e,t){3===t.type?(e.a=2*(63&t.value)-1,e.b=[]):e.b&&(0<e.a&&(e.b.push(t),e.a--),0===e.a&&(e.c.push(new qt(e.b)),e.b=null,e.a=0))}function qt(e){this.a=0,this.b=e}function Wt(e){if(!e.ha())throw new le(2,2,3e3);return e.b[e.a++]}function zt(e){this.c=e,this.b=[null,null,null,null,null,null,null,null],this.a=null}function Xt(e,t,n,r){if(128<=n&&135>=n)r=7&n,e.b[r]&&(e.a=e.b[r]);else{if(136===n){n=Wt(t).value,t=null;for(var i=(n=l(Qt(e,n))).next();!i.done;i=n.next())(i=e.b[i.value]).isVisible()&&(t=Gt(i,r,e.c)),kt(i);return t}if(137===n)for(t=Wt(t).value,n=(t=l(Qt(e,t))).next();!n.done;n=t.next())(n=e.b[n.value]).isVisible()||(n.f=r),n.g=!0;else{if(138===n){for(n=Wt(t).value,t=null,i=(n=l(Qt(e,n))).next();!i.done;i=n.next())(i=e.b[i.value]).isVisible()&&(t=Gt(i,r,e.c)),i.g=!1;return t}if(139===n){for(n=Wt(t).value,t=null,i=(n=l(Qt(e,n))).next();!i.done;i=n.next())(i=e.b[i.value]).isVisible()?t=Gt(i,r,e.c):i.f=r,i.g=!i.g;return t}if(140===n)return Jt(e,t=Wt(t).value,r);if(143===n)return r=Jt(e,255,r),Zt(e),r;if(144===n)t.skip(1),r=Wt(t).value,e.a&&(e.a.A=0<(128&r),e.a.D=0<(64&r));else if(145===n)r=Wt(t).value,n=Wt(t).value,t.skip(1),e.a&&(t=$t((48&n)>>4,(12&n)>>2,3&n),e.a.C=$t((48&r)>>4,(12&r)>>2,3&r),e.a.v=t);else if(146===n)r=Wt(t).value,t=Wt(t).value,e.a&&((e=e.a).b=15&r,e.a=63&t);else if(151===n)t.skip(1),t.skip(1),r=Wt(t).value,t.skip(1),e.a&&(e.a.j=3&r);else if(152<=n&&159>=n){if(n=(15&n)-8,!(i=null!==e.b[n])){var a=new Pt;a.f=r,e.b[n]=a}r=Wt(t).value,Wt(t),Wt(t),a=Wt(t).value;var o=Wt(t).value;t=Wt(t).value,i&&0==(7&t)||((t=e.b[n]).b=0,t.a=0,t.D=!1,t.A=!1,t.C="white",t.v="black"),(t=e.b[n]).g=0<(32&r),t.l=1+(15&a),t.h=1+(63&o),e.a=e.b[n]}}}return null}qt.prototype.ha=function(){return this.a<this.b.length},qt.prototype.Z=function(){return this.a},qt.prototype.skip=function(e){if(this.a+e>this.b.length)throw new le(2,2,3e3);this.a+=e};var Qt=function e(t,n){var r;return N(e,(function(e){return 1==e.a&&(r=0),5!=e.a?8>r?1==(1&n)&&t.b[r]?T(e,r,5):e.m(5):e.m(0):(n>>=1,r++,e.m(2))}))};function Jt(e,t,n){for(var r=null,i=(t=l(Qt(e,t))).next();!i.done;i=t.next()){i=i.value;var a=e.b[i];a.isVisible()&&(r=Gt(a,n,e.c)),e.b[i]=null}return r}function Zt(e){e.a=null,e.b=[null,null,null,null,null,null,null,null]}function $t(e,t,n){var r={0:0,1:0,2:1,3:1};return tn[(e=r[e])<<2|(t=r[t])<<1|(n=r[n])]}var en=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),tn="black blue green cyan red magenta yellow white".split(" ");function nn(e,t){this.c=[],this.a=1,this.b=0,this.v=e,this.l=t,this.f=this.h=!1,this.g="white",this.j="black",an(this)}function rn(e,t,n){return Lt(new dt(t,n,""),"CC"+(e.v<<1|e.l+1),e.c,t,n)}function an(e){un(e,0,15),e.a=1}function on(e,t,n){if(!(32>n||127<n)){var r="";switch(t){case ln:r=hn.has(n)?hn.get(n):String.fromCharCode(n);break;case cn:r=pn.get(n);break;case dn:e.c[e.a].pop(),r=gn.get(n);break;case fn:e.c[e.a].pop(),r=mn.get(n)}r&&e.c[e.a].push(new Ot(r,e.h,e.f,e.j,e.g))}}function sn(e,t,n,r){if(t>=n)for(--r;0<=r;r--)e.c[t+r]=e.c[n+r].map((function(e){return e}));else for(var i=0;i<r;i++)e.c[t+i]=e.c[n+i].map((function(e){return e}))}function un(e,t,n){for(var r=0;r<=n;r++)e.c[t+r]=[]}var ln=0,cn=1,dn=2,fn=3,hn=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),pn=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57,"⠀"],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),gn=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),mn=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]);function vn(e,t){this.b=_n,this.j=new nn(e,t),this.c=new nn(e,t),this.g=new nn(e,t),this.a=this.c,this.f=0,this.h=null}function yn(e,t,n){e.a=e.c;var r=e.a,i=null;return e.b!==An&&e.b!==Sn&&(i=rn(r,e.f,n),(n=e.c).a=0<n.b?n.b:0,un(n,0,15),(n=e.g).a=0<n.b?n.b:0,un(n,0,15),r.a=15),e.b=An,r.b=t,i}function En(e){e.b=bn,e.a=e.g,e.a.b=0}function Tn(e){z("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.a=e.j,e.b=Sn}var _n=0,bn=1,An=3,Sn=4,wn="black green blue cyan red yellow magenta black".split(" "),In="white green blue cyan red yellow magenta white_italics".split(" ");function Rn(){this.b=[],this.a=[],this.c=new Yt,this.g=0,this.l=new Map([["CC1",new vn(0,0)],["CC2",new vn(0,1)],["CC3",new vn(1,0)],["CC4",new vn(1,1)]]),this.j=this.h=0,this.f=new Map,Cn(this)}function Cn(e){e.h=0,e.j=0;for(var t=(e=l(e.l.values())).next();!t.done;t=e.next())(t=t.value).b=2,t.a=t.c,t.h=null,an(t.c),an(t.g),an(t.j)}function Dn(e,t){var n=t.type;if(16==(112&t.va)){var r=t.va>>3&1;0===n?e.h=r:e.j=r}if(n=e.l.get("CC"+(n<<1|(n?e.j:e.h)+1)),255===t.va&&255===t.La||!t.va&&!t.La||!Ln(t.va)||!Ln(t.La))return 45<=++e.g&&Cn(e),null;if(e.g=0,t.va&=127,t.La&=127,!t.va&&!t.La)return null;if(r=null,16==(112&t.va))e:{var i=t.va;if(r=t.La,n.h===(i<<8|r))n.h=null;else if(n.h=i<<8|r,16==(240&i)&&64==(192&r)){i=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&i)<<1|r>>5&1];var a=(30&r)>>1,o="white",s=!1;if(7>a?o=In[a]:7===a&&(s=!0),r=1==(1&r),n.b!==Sn){if(a=n.a,n.b===An&&i!==a.a){var u=1+i-a.b;sn(a,u,1+a.a-a.b,a.b),un(a,0,u-1),un(a,i+1,15-i)}a.a=i,n.a.h=r,n.a.f=s,n.a.g=o,n.a.j="black"}}else if(17==(247&i)&&32==(240&r))n.a.h=!1,n.a.f=!1,n.a.g="white",on(n.a,ln,32),o=!1,"white_italics"===(i=In[(14&r)>>1])&&(i="white",o=!0),n.a.h=1==(1&r),n.a.f=o,n.a.g=i;else if(16==(247&i)&&32==(240&r)||23==(247&i)&&45==(255&r))o="black",0==(7&i)&&(o=wn[(14&r)>>1]),n.a.j=o;else if(17==(247&i)&&48==(240&r))on(n.a,cn,r);else if(18==(246&i)&&32==(224&r))on(n.a,1&i?fn:dn,r);else if(20==(246&i)&&32==(240&r)){switch(r=t.pts,i=null,t.La){case 32:En(n);break;case 33:(n=n.a).c[n.a].pop();break;case 37:i=yn(n,2,r);break;case 38:i=yn(n,3,r);break;case 39:i=yn(n,4,r);break;case 40:on(n.a,ln,32);break;case 41:n.b=2,n.a=n.c,n.a.b=0,n.f=r;break;case 42:an(n.j),Tn(n);break;case 43:Tn(n);break;case 44:i=n.c,o=null,n.b!==Sn&&(o=rn(i,n.f,r)),un(i,0,15),i=o;break;case 45:i=n.a,n.b!==An?i=null:(o=rn(i,n.f,r),sn(i,(s=i.a-i.b+1)-1,s,i.b),un(i,0,s-1),un(i,i.a,15-i.a),n.f=r,i=o);break;case 46:un(n.g,0,15);break;case 47:i=null,n.b!==Sn&&(i=rn(n.c,n.f,r)),o=n.g,n.g=n.c,n.c=o,En(n),n.f=r}r=i;break e}r=null}else i=t.La,on(n.a,ln,t.va),on(n.a,ln,i);return r}function Mn(e,t){var n=[];try{for(;t.ha();){var r=Wt(t).value,i=(224&r)>>5,a=31&r;if(7===i&&0!=a&&(i=63&Wt(t).value),0!=i){e.f.has(i)||e.f.set(i,new zt(i));for(var o=e.f.get(i),s=t.Z();t.Z()-s<a;){var u=Wt(i=t),l=u.value,c=u.pts;if(16===l&&(l=l<<16|Wt(i).value),0<=l&&31>=l){var d=c;if(o.a){var f=o.a;switch(i=null,l){case 8:!Bt(f)||0>=f.a&&0>=f.b||(0>=f.a?(f.a=f.h-1,f.b--):f.a--,f.c[f.b][f.a]=null);break;case 13:if(f.isVisible()&&(i=Gt(f,d,o.c)),f.b+1>=f.l){d=f;for(var h=0,p=1;15>p;p++,h++)d.c[h]=d.c[p];for(p=0;1>p;p++,h++)d.c[h]=Ft()}else f.b++;f.a=0;break;case 14:f.isVisible()&&(i=Gt(f,d,o.c)),f.c[f.b]=Ft(),f.a=0;break;case 12:f.isVisible()&&(i=Gt(f,d,o.c)),kt(f),(d=f).b=0,d.a=0}var g=i}else g=null}else if(128<=l&&159>=l)g=Xt(o,i,l,c);else{if(4096<=l&&4127>=l)8<=(d=255&l)&&15>=d?i.skip(1):16<=d&&23>=d?i.skip(2):24<=d&&31>=d&&i.skip(3);else if(4224<=l&&4255>=l)128<=(d=255&l)&&135>=d?i.skip(4):136<=d&&143>=d&&i.skip(5);else if(32<=l&&127>=l)i=l,o.a&&Ut(o.a,127===i?"♪":String.fromCharCode(i));else if(160<=l&&255>=l)o.a&&Ut(o.a,String.fromCharCode(l));else if(4128<=l&&4223>=l){if(i=255&l,o.a)if(en.has(i)){var m=en.get(i);Ut(o.a,m)}else Ut(o.a,"_")}else 4256<=l&&4351>=l&&o.a&&Ut(o.a,160!=(255&l)?"_":"[CC]");g=null}(i=g)&&n.push(i)}}}}catch(e){if(!(e instanceof le&&3e3===e.code))throw e;z("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function Ln(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function Nn(){}var xn=function e(t,n){var r,i,a,o;return N(e,(function(e){if(1==e.a){for(var t=0,s=0,u=0;s<n.length;)2==t&&3==n[s]?t=0:(0==n[s]?t++:t=0,n[u]=n[s],u++),s++;r=s-u,i=0}if(4!=e.a){if(!(i+r<n.length))return e.m(0);for(a=0;255==n[i];)a+=255,i++;for(a+=n[i++],o=0;255==n[i];)o+=255,i++;return o+=n[i++],4!=a?e.m(4):T(e,n.subarray(i,i+o),4)}return i+=o,e.m(2)}))};function On(e,t){var n=null,r=null,i=e.I();return 1&t&&e.skip(8),2&t&&e.skip(4),8&t&&(n=e.I()),16&t&&(r=e.I()),{trackId:i,Pd:n,Ee:r}}function Pn(e,t){return{cd:1==t?e.gb():e.I()}}function kn(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),{timescale:e.I()}}function Fn(e,t,n){var r=e.I(),i=[];1&n&&e.skip(4),4&n&&e.skip(4);for(var a=l(ee(r)),o=a.next();!o.done;o=a.next())o={yd:null,sampleSize:null,Dc:null},256&n&&(o.yd=e.I()),512&n&&(o.sampleSize=e.I()),1024&n&&e.skip(4),2048&n&&(o.Dc=0==t?e.I():e.de()),i.push(o);return{rg:r,ge:i}}function Un(){this.f=new Nn,this.c=new Map,this.b=this.a=0}function Bn(){this.b=new Un,this.a=new Rn}function Gn(e,t){for(var n=e.b.parse(t),r=(n=l(n)).next();!r.done;r=n.next()){var i=r.value,a=oe(i.lf);if(r=e.a,i=i.pts,181===(a=new ye(a,0)).V()&&49===a.Bb()&&1195456820===a.I()&&3===a.V()){var o=a.V();if(0!=(64&o)){o&=31,a.skip(1);for(var s=0;s<o;s++){var u=a.V(),d=(4&u)>>2,f=a.V(),h=a.V();d&&(0==(u&=3)||1===u?r.b.push({pts:i,type:u,va:f,La:h,order:r.b.length}):(r.a.push({pts:i,type:u,value:f,order:r.a.length}),r.a.push({pts:i,type:2,value:h,order:r.a.length})))}}}}return function(e){function t(e,t){return e.pts-t.pts||e.order-t.order}var n=[];e.b.sort(t),e.a.sort(t);for(var r=l(e.b),i=r.next();!i.done;i=r.next())(i=Dn(e,i.value))&&n.push(i);for(i=(r=l(e.a)).next();!i.done;i=r.next())Vt(e.c,i.value);for(i=(r=l(e.c.c)).next();!i.done;i=r.next())i=Mn(e,i.value),n.push.apply(n,c(i));return e.c.c=[],e.b=[],e.a=[],n}(e.a)}function jn(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Hn(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+n>=e.start(0)}function Kn(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,r=l(Yn(e)),i=r.next();!i.done;i=r.next()){var a=i.value;i=a.start,(a=a.end)>t&&(n+=a-Math.max(i,t))}return n}function Yn(e){if(!e)return[];for(var t=[],n=l(ee(e.length)),r=n.next();!r.done;r=n.next())r=r.value,t.push({start:e.start(r),end:e.end(r)});return t}Un.prototype.init=function(e){var t=this,n=[],r=[];if((new Me).box("moov",Le).box("mvex",Le).S("trex",(function(e){var n=e.reader;n.skip(4),n.skip(4),e=n.I(),n=n.I(),t.a=e,t.b=n})).box("trak",Le).S("tkhd",(function(e){var t=e.reader;1==e.version?(t.skip(8),t.skip(8),e=t.gb()):(t.skip(4),t.skip(4),e=t.I()),n.push(e)})).box("mdia",Le).S("mdhd",(function(e){e=kn(e.reader,e.version),r.push(e.timescale)})).parse(e,!0),!n.length||!r.length||n.length!=r.length)throw new le(2,2,2010);n.forEach((function(e,n){t.c.set(e,r[n])}))},Un.prototype.parse=function(e){var t=this,n=[],r=this.a,i=this.b,a=[],o=null,s=9e4;return(new Me).box("moof",Le).box("traf",Le).S("trun",(function(e){a=Fn(e.reader,e.version,e.flags).ge})).S("tfhd",(function(e){e=On(e.reader,e.flags),r=e.Pd||t.a,i=e.Ee||t.b,e=e.trackId,t.c.has(e)&&(s=t.c.get(e))})).S("tfdt",(function(e){o=Pn(e.reader,e.version).cd})).box("mdat",(function(e){if(null===o)throw new le(2,2,2010);e=e.reader;var u=o,c=s,d=r,f=i,h=a,p=0,g=f;for(h.length&&(g=h[0].sampleSize||f);e.ha();){var m=e.I();if(6==(31&e.V())){var v=0;h.length>p&&(v=h[p].Dc||0),v=(u+v)/c;for(var y=l(xn(t.f,e.Va(m-1))),E=y.next();!E.done;E=y.next())n.push({lf:E.value,pts:v})}else e.skip(m-1);0==(g-=m+4)&&(u=h.length>p?u+(h[p].yd||d):u+d,p++,g=h.length>p&&h[p].sampleSize||f)}})).parse(e,!1),n},Bn.prototype.init=function(e){this.b.init(e)};
/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var Vn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function qn(e){var t;e instanceof qn?(Wn(this,e.Ca),this.jb=e.jb,this.Ba=e.Ba,zn(this,e.Ab),this.sa=e.sa,Xn(this,e.a.clone()),this.ab=e.ab):e&&(t=String(e).match(Vn))?(Wn(this,t[1]||"",!0),this.jb=Qn(t[2]||""),this.Ba=Qn(t[3]||"",!0),zn(this,t[4]),this.sa=Qn(t[5]||"",!0),Xn(this,t[6]||"",!0),this.ab=Qn(t[7]||"")):this.a=new ir(null)}function Wn(e,t,n){e.Ca=n?Qn(t,!0):t,e.Ca&&(e.Ca=e.Ca.replace(/:$/,""))}function zn(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Ab=t}else e.Ab=null}function Xn(e,t,n){t instanceof ir?e.a=t:(n||(t=Jn(t,nr)),e.a=new ir(t))}function Qn(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function Jn(e,t,n){return null!=e?(e=encodeURI(e).replace(t,Zn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Zn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(r=qn.prototype).Ca="",r.jb="",r.Ba="",r.Ab=null,r.sa="",r.ab="",r.toString=function(){var e=[],t=this.Ca;if(t&&e.push(Jn(t,$n,!0),":"),t=this.Ba){e.push("//");var n=this.jb;n&&e.push(Jn(n,$n,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Ab)&&e.push(":",String(t))}return(t=this.sa)&&(this.Ba&&"/"!=t.charAt(0)&&e.push("/"),e.push(Jn(t,"/"==t.charAt(0)?tr:er,!0))),(t=this.a.toString())&&e.push("?",t),(t=this.ab)&&e.push("#",Jn(t,rr)),e.join("")},r.resolve=function(e){var t=this.clone();"data"===t.Ca&&(t=new qn);var n=!!e.Ca;n?Wn(t,e.Ca):n=!!e.jb,n?t.jb=e.jb:n=!!e.Ba,n?t.Ba=e.Ba:n=null!=e.Ab;var r=e.sa;if(n)zn(t,e.Ab);else if(n=!!e.sa){if("/"!=r.charAt(0))if(this.Ba&&!this.sa)r="/"+r;else{var i=t.sa.lastIndexOf("/");-1!=i&&(r=t.sa.substr(0,i+1)+r)}if(".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var a=[],o=0;o<r.length;){var s=r[o++];"."==s?i&&o==r.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),i&&o==r.length&&a.push("")):(a.push(s),i=!0)}r=a.join("/")}}return n?t.sa=r:n=""!==e.a.toString(),n?Xn(t,e.a.clone()):n=!!e.ab,n&&(t.ab=e.ab),t},r.clone=function(){return new qn(this)};var $n=/[#\/\?@]/g,er=/[#\?:]/g,tr=/[#\?]/g,nr=/[#\?@]/g,rr=/#/g;function ir(e){this.a=e||null}function ar(e,t){if(0==t.length)return e;var n=t.map((function(e){return new qn(e)}));return e.map((function(e){return new qn(e)})).map((function(e){return n.map((function(t){return e.resolve(t)}))})).reduce(Ie,[]).map((function(e){return e.toString()}))}function or(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,sessionType:"",initData:t||[],keyIds:new Set}}function sr(e,t){if(1==t.length)return t[0];var n=ur(e,t);if(null!=n)return n;throw new le(2,4,4025,t)}function ur(e,t){for(var n=l(dr[e]),r=n.next();!r.done;r=n.next()){r=r.value;for(var i=l(t),a=i.next();!a.done;a=i.next())if(a=a.value,r.test(a.trim()))return a.trim()}return e==lr?"":null}(r=ir.prototype).pa=null,r.pc=null,r.add=function(e,t){if(!this.pa&&(this.pa={},this.pc=0,this.a))for(var n=this.a.split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("="),a=null;if(0<=i){var o=n[r].substring(0,i);a=n[r].substring(i+1)}else o=n[r];o=decodeURIComponent(o.replace(/\+/g," ")),a=a||"",this.add(o,decodeURIComponent(a.replace(/\+/g," ")))}return this.a=null,(n=this.pa.hasOwnProperty(e)&&this.pa[e])||(this.pa[e]=n=[]),n.push(t),this.pc++,this},r.toString=function(){if(this.a)return this.a;if(!this.pa)return"";var e,t=[];for(e in this.pa)for(var n=encodeURIComponent(e),r=this.pa[e],i=0;i<r.length;i++){var a=n;""!==r[i]&&(a+="="+encodeURIComponent(r[i])),t.push(a)}return this.a=t.join("&")},r.clone=function(){var e=new ir;if(e.a=this.a,this.pa){var t,n={};for(t in this.pa)n[t]=this.pa[t].concat();e.pa=n,e.pc=this.pc}return e};var lr="text",cr={Ja:"video",Xa:"audio",$:lr,Tf:"image",Lf:"application"},dr={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function fr(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function hr(){}fr.prototype.resolve=function(){},fr.prototype.reject=function(){},G("shaka.dependencies",hr),hr.has=function(e){return pr.has(e)},hr.add=function(e,t){if(!gr[e])throw Error(e+" is not supported");pr.set(e,t)};var pr=new Map,gr={muxjs:"muxjs"};function mr(){var e=this;this.j=pr.get("muxjs"),this.a=new this.j.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.h=[],this.c=[],this.g=[],this.f=!1,this.a.on("data",(function(t){e.c=t.captions,e.g=t.metadata,e.h.push(rt(t.initSegment,t.data))})),this.a.on("done",(function(){var t={data:rt.apply(Je,c(e.h)),captions:e.c,metadata:e.g};e.b.resolve(t),e.f=!1}))}function vr(e,t){if(!pr.get("muxjs")||!yr(e))return!1;if(t)return MediaSource.isTypeSupported(Er(t,e));var n=Er("audio",e),r=Er("video",e);return MediaSource.isTypeSupported(n)||MediaSource.isTypeSupported(r)}function yr(e){return"mp2t"==e.toLowerCase().split(";")[0].split("/")[1]}function Er(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var r=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(r){var i="avc1.",a=r[1],o=Number(r[2]);i=("66"==a?i+"4200":"77"==a?i+"4d00":i+"6400")+(o>>4).toString(16),i+=(15&o).toString(16),n=n.replace(r[0],i)}return n}function Tr(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function _r(e,t,n){return e=Tr(e,t),pr.get("muxjs")&&yr(e)?Er(n,e):e}function br(e){var t=(e=e.split("."))[0];return e.pop(),t}hr.Allowed=gr,pr.set("muxjs",e.muxjs),mr.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()};var Ar=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Sr(e){this.j=null,this.c=e,this.f=this.v=0,this.g=1/0,this.b=this.a=null,this.l="",this.h=new Map}function wr(e){return!(!Cr[e]&&"application/cea-608"!=e&&"application/cea-708"!=e)}function Ir(e,t,n){if(e.l=t,t=e.h.get(t))for(var r=l(t.keys()),i=r.next();!i.done;i=r.next())(i=t.get(i.value).filter((function(e){return e.endTime<=n})))&&e.c.append(i)}function Rr(e,t,n,r,i){for(var a=n+" "+r,o=new Map,s=(t=l(t)).next();!s.done;s=t.next()){var u=s.value;s=u.stream,u=u.cue,o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),u.startTime+=i,u.endTime+=i,u.startTime>=e.f&&u.startTime<e.g&&(o.get(s).get(a).push(u),s==e.l&&e.c.append([u]))}for(a=(i=l(o.keys())).next();!a.done;a=i.next())for(a=a.value,e.h.has(a)||e.h.set(a,new Map),s=(t=l(o.get(a).keys())).next();!s.done;s=t.next())s=s.value,u=o.get(a).get(s),e.h.get(a).set(s,u);e.a=null==e.a?Math.max(n,e.f):Math.min(e.a,Math.max(n,e.f)),e.b=Math.max(e.b,Math.min(r,e.g))}Sr.prototype.destroy=function(){return this.c=this.j=null,this.h.clear(),Promise.resolve()},Sr.prototype.remove=function(e,t){var n=this;return x((function(r){if(1==r.a)return T(r,Promise.resolve(),2);!n.c||!n.c.remove(e,t)||null==n.a||t<=n.a||e>=n.b||(e<=n.a&&t>=n.b?n.a=n.b=null:e<=n.a&&t<n.b?n.a=t:e>n.a&&t>=n.b&&(n.b=e)),_(r)}))},G("shaka.text.TextEngine",Sr),Sr.prototype.destroy=Sr.prototype.destroy,Sr.findParser=function(e){return Cr[e]},Sr.unregisterParser=function(e){delete Cr[e]},Sr.registerParser=function(e,t){Cr[e]=t};var Cr={};function Dr(e){this.a=!1,this.b=new fr,this.c=e}function Mr(e,t){if(e.a){if(t instanceof le&&7003==t.code)throw t;throw new le(2,7,7003,t)}}function Lr(){this.a={}}function Nr(e,t){for(var n in e.a)t(n,e.a[n])}function xr(){this.a=new Lr}function Or(e,t,n,r){this.target=e,this.type=t,this.listener=n,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=Pr;if(null==t){t=!1;try{var n={},r={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",r),Object.defineProperty(n,"capture",r),r=function(){},e.addEventListener("test",r,n),e.removeEventListener("test",r,n)}catch(e){t=!1}Pr=t}return t||!1}(e)?t:t.capture||!1}(e,r),this.target.addEventListener(t,n,this.a)}Dr.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then((function(){e.b.resolve()}),(function(){e.b.resolve()})))},Lr.prototype.push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},Lr.prototype.get=function(e){return(e=this.a[e])?e.slice():null},Lr.prototype.remove=function(e,t){e in this.a&&(this.a[e]=this.a[e].filter((function(e){return e!=t})),0==this.a[e].length&&delete this.a[e])},Lr.prototype.size=function(){return Object.keys(this.a).length},(r=xr.prototype).release=function(){this.hb(),this.a=null},r.s=function(e,t,n,r){this.a&&(e=new Or(e,t,n,r),this.a.push(t,e))},r.qa=function(e,t,n,r){var i=this;this.s(e,t,(function r(a){i.ya(e,t,r),n(a)}),r)},r.ya=function(e,t,n){if(this.a)for(var r=this.a.get(t)||[],i=(r=l(r)).next();!i.done;i=r.next())(i=i.value).target!=e||n!=i.listener&&n||(i.ya(),this.a.remove(t,i))},r.hb=function(){if(this.a){var e,t=this.a,n=[];for(e in t.a)n.push.apply(n,c(t.a[e]));for(n=(t=l(n)).next();!n.done;n=t.next())n.value.ya();this.a.a={}}},G("shaka.util.EventManager",xr),xr.prototype.removeAll=xr.prototype.hb,xr.prototype.unlisten=xr.prototype.ya,xr.prototype.listenOnce=xr.prototype.qa,xr.prototype.listen=xr.prototype.s,xr.prototype.release=xr.prototype.release,Or.prototype.ya=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1};var Pr=void 0;function kr(e,t,n,r){var i=this;this.a=e,this.h=n,this.f={},this.D={},this.c=null,this.H=r||function(){},this.g={},this.b=new xr,this.l={},this.v=t,this.A=new fr,this.j=function(e,t){var n=new MediaSource;return e.b.qa(n,"sourceopen",(function(){URL.revokeObjectURL(e.C),t.resolve()})),e.C=Jr(n),e.a.src=e.C,n}(this,this.A),this.F=new Dr((function(){return function(e){var t,n,r,i,a,o,s;return x((function(u){if(1==u.a){for(n in t=[],e.g)for(r=e.g[n],i=r[0],e.g[n]=r.slice(0,1),i&&t.push(i.p.catch(Re)),a=l(r.slice(1)),o=a.next();!o.done;o=a.next())o.value.p.reject(new le(2,7,7003,void 0));for(s in e.c&&t.push(e.c.destroy()),e.h&&t.push(e.h.destroy()),e.l)t.push(e.l[s].destroy());return T(u,Promise.all(t),2)}e.b&&(e.b.release(),e.b=null),e.a&&(e.a.removeAttribute("src"),e.a.load(),e.a=null),e.j=null,e.c=null,e.h=null,e.f={},e.l={},e.v=null,e.g={},_(u)}))}(i)})),this.C=""}function Fr(e){var t=Tr(e.mimeType,e.codecs),n=function(e){var t=[e.mimeType];return Ar.forEach((function(n,r){var i=e[r];i&&t.push(n+'="'+i+'"')})),"PQ"==e.hdr&&t.push('eotf="smpte2084"'),t.join(";")}(e);return wr(t)||MediaSource.isTypeSupported(n)||vr(t,e.type)}function Ur(e,t){e.c||(e.c=new Sr(e.h)),"application/cea-608"!=t&&"application/cea-708"!=t&&(e.c.j=De(Cr[t]))}function Br(e){return!e.j||"ended"==e.j.readyState}function Gr(e,t){if(t==lr)var n=e.c.a;else n=!(n=Hr(e,t))||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function jr(e,t){return t==lr?e.c.b:jn(Hr(e,t))}function Hr(e,t){try{return e.f[t].buffered}catch(e){return null}}function Kr(e,t,n,r,i,a){var o,s,u,c,d,f,h,p;return x((function(g){return 1==g.a?t==(o=cr).$?T(g,function(e,t,n,r){var i,a,o;return x((function(s){return 1==s.a?T(s,Promise.resolve(),2):e.j&&e.c?null==n||null==r?(e.j.parseInit(oe(t)),s.return()):(i={periodStart:e.v,segmentStart:n,segmentEnd:r},a=e.j.parseMedia(oe(t),i),o=a.filter((function(t){return t.startTime>=e.f&&t.startTime<e.g})),e.c.append(o),null==e.a&&(e.a=Math.max(n,e.f)),e.b=Math.min(r,e.g),void _(s)):s.return()}))}(e.c,n,r,i),0):e.l[t]?T(g,function(e,t){e.f=!0,e.b=new fr,e.h=[],e.c=[],e.g=[];var n=oe(t);return e.a.push(n),e.a.flush(),e.f&&e.b.reject(new le(2,3,3018)),e.b}(e.l[t],n),10):a?(e.c||Ur(e,"text/vtt"),null==r&&null==i?e.v.init(n):(s=Gn(e.v,n)).length&&(u=e.f[o.Ja].timestampOffset,Rr(e.c,s,r,i,u)),n=Qr(e,n,r,t),T(g,qr(e,t,(function(){e.f[t].appendBuffer(n)})),0)):(n=Qr(e,n,r,t),T(g,qr(e,t,(function(){e.f[t].appendBuffer(n)})),0)):(c=g.b,e.c||Ur(e,"text/vtt"),c.metadata&&(d=e.f[t].timestampOffset,e.H(c.metadata,d,i)),c.captions&&c.captions.length&&(f=e.f[o.Ja].timestampOffset,h=function(e){for(var t=[],n=(e=l(e)).next();!n.done;n=e.next())n=n.value,t.push({stream:n.stream,cue:new dt(n.startTime,n.endTime,n.text)});return t}(c.captions),Rr(e.c,h,r,i,f)),p=c.data,p=Qr(e,p,r,t),T(g,qr(e,t,(function(){e.f[t].appendBuffer(p)})),0))}))}function Yr(e,t){return x((function(n){return t==cr.$?e.c?T(n,e.c.remove(0,1/0),0):n.return():T(n,qr(e,t,(function(){var n=e.j.duration;0>=n?Vr(e,t):e.f[t].remove(0,n)})),0)}))}function Vr(e,t){var n=e.g[t][0];n&&(n.p.resolve(),zr(e,t))}function qr(e,t,n){return Mr(e.F),n={start:n,p:new fr},e.g[t].push(n),1==e.g[t].length&&Xr(e,t),n.p}function Wr(e,t){var n,r,i,a,o;return x((function(s){switch(s.a){case 1:for(i in Mr(e.F),n=[],r={},e.f)r.Fb=new fr,a={start:function(e){return function(){return e.Fb.resolve()}}(r),p:r.Fb},e.g[i].push(a),n.push(r.Fb),1==e.g[i].length&&a.start(),r={Fb:r.Fb};return b(s,2),T(s,Promise.all(n),4);case 4:S(s,3);break;case 2:throw w(s);case 3:try{t()}catch(e){throw new le(2,3,3015,e)}finally{for(o in e.f)zr(e,o)}_(s)}}))}function zr(e,t){e.g[t].shift(),Xr(e,t)}function Xr(e,t){var n=e.g[t][0];if(n)try{n.start()}catch(r){"QuotaExceededError"==r.name?n.p.reject(new le(2,3,3017,t)):n.p.reject(new le(2,3,3015,r)),zr(e,t)}}function Qr(e,t,n,r){var i=e.a.mediaKeys;return null==n&&i&&(Ke()||We("Xbox One"))&&"mp4"==e.D[r].split(";")[0].split("/")[1]&&(t=function(e){function t(){i=!0}function n(e){a.push(e),Le(e)}e=oe(e);var r,i=!1,a=[],o=[];if((new Me).box("moov",n).box("trak",n).box("mdia",n).box("minf",n).box("stbl",n).S("stsd",(function(e){r=e,a.push(e),Ne(e)})).S("encv",t).S("enca",t).S("avc1",(function(e){o.push({box:e,$d:1701733238})})).S("mp4a",(function(e){o.push({box:e,$d:1701733217})})).parse(e),i)return e;if(0==o.length||!r)throw nt(e),new le(2,3,3019);o.reverse();for(var s=l(o),u=s.next();!u.done;u=s.next())u=u.value,e=it(e,r,u.box,a,u.$d);return e}(t)),t}(r=kr.prototype).destroy=function(){return this.F.destroy()},r.init=function(e,t){var n,r,i,a,o,s,u,c=this;return x((function(d){if(1==d.a)return n=cr,T(d,c.A,2);for(r={},i=l(e.keys()),a=i.next();!a.done;r={ma:r.ma},a=i.next())r.ma=a.value,o=e.get(r.ma),s=Tr(o.mimeType,o.codecs),r.ma==n.$?Ur(c,s):(!t&&MediaSource.isTypeSupported(s)||!vr(s,r.ma)||(c.l[r.ma]=new mr,s=Er(r.ma,s)),u=c.j.addSourceBuffer(s),c.b.s(u,"error",function(e){return function(){c.g[e.ma][0].p.reject(new le(2,3,3014,c.a.error?c.a.error.code:0))}}(r)),c.b.s(u,"updateend",function(e){return function(){return Vr(c,e.ma)}}(r)),c.f[r.ma]=u,c.D[r.ma]=s,c.g[r.ma]=[]);_(d)}))},r.rc=function(){var e={total:Yn(this.a.buffered),audio:Yn(Hr(this,"audio")),video:Yn(Hr(this,"video")),text:[]};if(this.c){var t=this.c.a,n=this.c.b;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},r.remove=function(e,t,n){var r=this;return x((function(i){return T(i,e==cr.$?r.c.remove(t,n):qr(r,e,(function(){n<=t?Vr(r,e):r.f[e].remove(t,n)})),0)}))},r.flush=function(e){var t=this;return x((function(n){return e==cr.$?n.return():T(n,qr(t,e,(function(){t.a.currentTime-=.001,Vr(t,e)})),0)}))},r.endOfStream=function(e){var t=this;return x((function(n){return T(n,Wr(t,(function(){Br(t)||(e?t.j.endOfStream(e):t.j.endOfStream())})),0)}))},r.Fa=function(e){var t=this;return x((function(n){return T(n,Wr(t,(function(){t.j.duration=e})),0)}))},r.getDuration=function(){return this.j.duration};var Jr=e.URL.createObjectURL;function Zr(e,t){return e=ti(e),t=ti(t),e.split("-")[0]==t.split("-")[0]}function $r(e,t){e=ti(e),t=ti(t);var n=e.split("-"),r=t.split("-");return n[0]==r[0]&&1==n.length&&2==r.length}function ei(e,t){e=ti(e),t=ti(t);var n=e.split("-"),r=t.split("-");return 2==n.length&&2==r.length&&n[0]==r[0]}function ti(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=ai.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function ni(e,t){return e=ti(e),(t=ti(t))==e?4:$r(t,e)?3:ei(t,e)?2:$r(e,t)?1:0}function ri(e){return e.language?ti(e.language):e.audio&&e.audio.language?ti(e.audio.language):e.video&&e.video.language?ti(e.video.language):"und"}function ii(e,t){for(var n=ti(e),r=new Set,i=l(t),a=i.next();!a.done;a=i.next())r.add(ti(a.value));for(a=(i=l(r)).next();!a.done;a=i.next())if((a=a.value)==n)return a;for(a=(i=l(r)).next();!a.done;a=i.next())if($r(a=a.value,n))return a;for(a=(i=l(r)).next();!a.done;a=i.next())if(ei(a=a.value,n))return a;for(a=(r=l(r)).next();!a.done;a=r.next())if($r(n,a=a.value))return a;return null}var ai=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function oi(e,t){var n=Ai(e.variants,t),r=function(e){var t="",n=1/0;return Nr(e,(function(e,r){for(var i=0,a=0,o=l(r),s=o.next();!s.done;s=o.next())i+=s.value.bandwidth||0,++a;(i/=a)<n&&(t=e,n=i)})),t}(n=function(e){var t=0,n=new Map,r=e.size();return Nr(e,(function(e,i){for(var a=l(i),o=a.next();!o.done;o=a.next()){var s=(o=o.value).video;if(s&&s.width&&s.height){s=s.width*s.height*(s.frameRate||1),n.has(s)||n.set(s,new Lr);var u=n.get(s);u.push(e,o),u.size()===r&&(t=Math.max(t,s))}}})),t?n.get(t):e}(n=function(e){for(var t=new Lr,n=(e=l(e)).next();!n.done;n=e.next()){var r=si(n=n.value);t.push(r,n)}return t}(n)));e.variants=e.variants.filter((function(e){return si(e)==r}))}function si(e){var t="";e.video&&(t=br(e.video.codecs));var n="";return e.audio&&(n=br(e.audio.codecs)),t+"-"+n}function ui(e,t,n){function r(e,t,n){return e>=t&&e<=n}var i=e.video;return!(i&&i.width&&i.height&&(!r(i.width,t.minWidth,Math.min(t.maxWidth,n.width))||!r(i.height,t.minHeight,Math.min(t.maxHeight,n.height))||!r(i.width*i.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!r(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!r(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function li(e,t){e.variants=e.variants.filter((function(e){return!(t&&t.M&&!function(e,t){var n=t.audio,r=t.video;if(n&&n.encrypted&&!Aa(e,n=wa(n))||r&&r.encrypted&&!Aa(e,r=wa(r)))return!1;var i=_a(e.c);return 0==(r=xa(t)).length||r.some((function(e){return e.keySystem==i}))}(t,e))}))}function ci(e,t){return x((function(n){if(1==n.a)return T(n,fi(e.variants,t),2);e.variants=e.variants.filter((function(e){var t=e.decodingInfos.some((function(e){return e.supported}));return t||function(e){var t=[];e.audio&&t.push(Ii(e.audio)),e.video&&t.push(Ii(e.video)),t.join(", ")}(e),t})),_(n)}))}function di(e){e.variants=e.variants.filter((function(e){var t=e.audio;return e=e.video,!(t&&!Fr(t)||e&&!Fr(e))}))}function fi(e,t){var n,r,i,a,o,s,u,c,d,f;return x((function(h){if(e.some((function(e){return e.decodingInfos.length})))return h.return();for(n=navigator.mediaCapabilities,r=[],i=function(e,t){var r;return x((function(i){return 1==i.a?(b(i,2),T(i,n.decodingInfo(t),4)):2!=i.a?(r=i.b,e.decodingInfos.push(r),S(i,0)):(w(i),JSON.stringify(t),void _(i))}))},a=l(e),o=a.next();!o.done;o=a.next())for(s=o.value,u=hi(s,t),c=l(u),d=c.next();!d.done;d=c.next())f=d.value,r.push(i(s,f));return T(h,Promise.all(r),0)}))}function hi(e,t){var n=e.audio,r=e.video,i={type:"media-source"};if(r){var a=r.codecs;if(r.codecs.includes(",")){var o=r.codecs.split(",");a="vp9"==(a=sr("video",o))?"vp09.00.10.08":a,o=sr("audio",o),o=_r(r.mimeType,o,"audio"),i.audio={contentType:o,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1}}a=_r(r.mimeType,"vp9"==a?"vp09.00.10.08":a,"video"),i.video={contentType:a,width:r.width||1,height:r.height||1,bitrate:r.bandwidth||e.bandwidth||1,framerate:r.frameRate||1}}n&&(a="ac-3"==n.codecs.toLowerCase()&&Ke()?"ec-3":n.codecs,a=_r(n.mimeType,a,"audio"),i.audio={contentType:a,channels:n.channelsCount||2,bitrate:n.bandwidth||e.bandwidth||1,samplerate:n.audioSamplingRate||1,spatialRendering:n.spatialAudio});var s=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]);if(!s.length)return[i];a=[],o=new Map;for(var u=(s=l(s)).next();!u.done;u=s.next()){var c=u.value;o.get(c.keySystem)||o.set(c.keySystem,[]),o.get(c.keySystem).push(c)}s=t?"required":"optional",c=t?["persistent-license"]:["temporary"];for(var d=l(o.keys()),f=d.next();!f.done;f=d.next()){var h=f.value;f=Object.assign({},i);var p=o.get(h);for(h={keySystem:h,initDataType:"cenc",persistentState:s,distinctiveIdentifier:"optional",sessionTypes:c},u=(p=l(p)).next();!u.done;u=p.next()){if((u=u.value).initData&&u.initData.length){for(var g=new Set,m=l(u.initData),v=m.next();!v.done;v=m.next())g.add(v.value.initDataType);h.initDataType=u.initData[0].initDataType}u.distinctiveIdentifierRequired&&(h.distinctiveIdentifier="required"),u.persistentStateRequired&&(h.persistentState="required"),u.sessionType&&(h.sessionTypes=[u.sessionType]),n&&(h.audio?h.audio.robustness=h.audio.robustness||u.audioRobustness:h.audio={robustness:u.audioRobustness}),r&&(h.video?h.video.robustness=h.video.robustness||u.videoRobustness:h.video={robustness:u.videoRobustness})}f.keySystemConfiguration=h,a.push(f)}return a}function pi(e,t){t.variants=t.variants.filter((function(t){var n=t.audio;return t=t.video,!(n&&e&&e.audio&&!gi(n,e.audio)||t&&e&&e.video&&!gi(t,e.video))}))}function gi(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}function mi(e){var t=e.audio,n=e.video,r=t?t.codecs:null,i=n?n.codecs:null,a=[];i&&a.push(i),r&&a.push(r);var o=[];n&&o.push(n.mimeType),t&&o.push(t.mimeType),o=o[0]||null;var s=[];t&&s.push(t.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;if(t)for(var c=l(t.roles),d=c.next();!d.done;d=c.next())u.add(d.value);if(n)for(d=(c=l(n.roles)).next();!d.done;d=c.next())u.add(d.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:o,codecs:a.join(", "),audioCodec:r,videoCodec:i,primary:e.primary,roles:Array.from(u),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e}function vi(e){return{id:e.id,active:!1,type:lr,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null}}function yi(e){return{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:e.width||null,height:e.height||null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:e.tilesLayout||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId}}function Ei(e){return e.__shaka_id||(e.__shaka_id=Ri++),e.__shaka_id}function Ti(e){var t=_i(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function _i(e){return{id:Ei(e),active:!1,type:"",bandwidth:0,language:ti(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null}}function bi(e){return e.allowedByApplication&&e.allowedByKeySystem}function Ai(e,t){for(var n=e.filter((function(e){return e.audio&&e.audio.channelsCount})),r=new Map,i=(n=l(n)).next();!i.done;i=n.next()){var a=(i=i.value).audio.channelsCount;r.has(a)||r.set(a,[]),r.get(a).push(i)}return 0==(n=Array.from(r.keys())).length?e:(i=n.filter((function(e){return e<=t}))).length?r.get(Math.max.apply(Math,c(i))):r.get(Math.min.apply(Math,c(n)))}function Si(e,t,n,r){var i=e,a=e.filter((function(e){return e.primary}));a.length&&(i=a);var o=i.length?i[0].language:"";if(i=i.filter((function(e){return e.language==o})),t){var s=ii(ti(t),e.map((function(e){return e.language})));s&&(i=e.filter((function(e){return ti(e.language)==s})))}if(i=i.filter((function(e){return e.forced==r})),n){if((e=wi(i,n)).length)return e}else if((e=i.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=i.map((function(e){return e.roles})).reduce(Ie,[])).length?wi(i,e[0]):i}function wi(e,t){return e.filter((function(e){return e.roles.includes(t)}))}function Ii(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}var Ri=0;function Ci(){var e=this;this.h=null,this.c=!1,this.a=new Y,navigator.connection&&navigator.connection.addEventListener("change",(function(){if(e.i.useNetworkInformation){e.a=new Y;var t=e.chooseVariant();t&&e.h(t)}})),this.b=[],this.g=1,this.j=!1,this.i=this.f=null}function Di(e){var t=e.i.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&e.i.useNetworkInformation&&(t=1e6*navigator.connection.downlink),t}function Mi(e,t){return e&&(t=t.filter((function(t){return ui(t,e,{width:1/0,height:1/0})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))}function Li(e,t){this.a=e,this.b=new Set([e]);for(var n=l(t=t||[]),r=n.next();!r.done;r=n.next())this.add(r.value)}function Ni(e,t){var n;if(!(n=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(n=e.audio&&t.audio)){n=e.audio;var r=t.audio;n=!((!(!n.channelsCount||!r.channelsCount||2<n.channelsCount||2<r.channelsCount)||n.channelsCount==r.channelsCount)&&xi(n,r)&&Oi(n.roles,r.roles))}return!n&&(n=e.video&&t.video)&&(n=!(xi(n=e.video,r=t.video)&&Oi(n.roles,r.roles))),!n}function xi(e,t){if(e.mimeType!=t.mimeType)return!1;var n=e.codecs.split(",").map((function(e){return br(e)})),r=t.codecs.split(",").map((function(e){return br(e)}));if(n.length!=r.length)return!1;n.sort(),r.sort();for(var i=l(ee(n.length)),a=i.next();!a.done;a=i.next())if(n[a=a.value]!=r[a])return!1;return!0}function Oi(e,t){var n=new Set(e),r=new Set(t);if(n.delete("main"),r.delete("main"),n.size!=r.size)return!1;for(var i=(n=l(n)).next();!i.done;i=n.next())if(!r.has(i.value))return!1;return!0}function Pi(e){this.a=e,this.b=new ki(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function ki(e,t,n,r){this.c=e,this.f=t,this.a=n,this.b=void 0===r?"":r}function Fi(){this.a=Gi,this.b=(new Map).set(Gi,2).set(Bi,1)}function Ui(e,t,n){e.b.set(Gi,n).set(Bi,t)}(r=Ci.prototype).stop=function(){this.h=null,this.c=!1,this.b=[],this.g=1,this.f=null},r.init=function(e){this.h=e},r.chooseVariant=function(){var e=Mi(this.i.restrictions,this.b),t=this.a.getBandwidthEstimate(Di(this));this.b.length&&!e.length&&(e=[(e=Mi(null,this.b))[0]]);for(var n=e[0]||null,r=(e=l(te(e))).next();!r.done;r=e.next()){var i=r.value;r=i.item;var a=isNaN(this.g)?1:Math.abs(this.g);i=a*(i.next||{bandwidth:1/0}).bandwidth/this.i.bandwidthUpgradeTarget,t>=a*r.bandwidth/this.i.bandwidthDowngradeTarget&&t<=i&&(n=r)}return this.f=Date.now(),n},r.enable=function(){this.c=!0},r.disable=function(){this.c=!1},r.segmentDownloaded=function(e,t){var n=this.a;if(!(16e3>t)){var r=8e3*t/e,i=e/1e3;n.a+=t,H(n.b,i,r),H(n.c,i,r)}if(null!=this.f&&this.c)e:{if(this.j){if(Date.now()-this.f<1e3*this.i.switchInterval)break e}else{if(!(128e3<=this.a.a))break e;this.j=!0}n=this.chooseVariant(),this.a.getBandwidthEstimate(Di(this)),n&&this.h(n)}},r.getBandwidthEstimate=function(){return this.a.getBandwidthEstimate(this.i.defaultBandwidthEstimate)},r.setVariants=function(e){this.b=e},r.playbackRateChanged=function(e){this.g=e},r.configure=function(e){this.i=e},G("shaka.abr.SimpleAbrManager",Ci),Ci.prototype.configure=Ci.prototype.configure,Ci.prototype.playbackRateChanged=Ci.prototype.playbackRateChanged,Ci.prototype.setVariants=Ci.prototype.setVariants,Ci.prototype.getBandwidthEstimate=Ci.prototype.getBandwidthEstimate,Ci.prototype.segmentDownloaded=Ci.prototype.segmentDownloaded,Ci.prototype.disable=Ci.prototype.disable,Ci.prototype.enable=Ci.prototype.enable,Ci.prototype.chooseVariant=Ci.prototype.chooseVariant,Ci.prototype.init=Ci.prototype.init,Ci.prototype.stop=Ci.prototype.stop,Li.prototype.add=function(e){return!!Ni(this.a,e)&&(this.b.add(e),!0)},Li.prototype.values=function(){return this.b.values()},Pi.prototype.create=function(e){var t=this,n=e.filter((function(e){return Ni(t.a,e)}));return n.length?new Li(n[0],n):this.b.create(e)},ki.prototype.create=function(e){var t=[];t=function(e,t){var n=ii(ti(t),e.map((function(e){return ri(e)})));return n?e.filter((function(e){return n==ri(e)})):[]}(e,this.c);var n=e.filter((function(e){return e.primary}));for((e=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}(t=t.length?t:n.length?n:e,this.f)).length&&(t=e),this.a&&(e=Ai(t,this.a)).length&&(t=e),this.b&&(e=function(e,t){return e.filter((function(e){return!!e.audio&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(t,this.b)).length&&(t=e),e=new Li(t[0]),n=(t=l(t)).next();!n.done;n=t.next())n=n.value,Ni(e.a,n)&&e.add(n);return e};var Bi=0,Gi=1;function ji(e,t){var n=2,r=1e3,i=2,a=.5;this.j=null==e.maxAttempts?n:e.maxAttempts,this.f=null==e.baseDelay?r:e.baseDelay,this.h=null==e.fuzzFactor?a:e.fuzzFactor,this.g=null==e.backoffFactor?i:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function Hi(e){var t,n;return x((function(r){if(1==r.a){if(e.a>=e.j){if(!e.c)throw new le(2,7,1010);e.a=1,e.b=e.f}return t=e.a,e.a++,0==t?r.return():(n=e.b*(1+(2*Math.random()-1)*e.h),T(r,new Promise((function(e){new Ge(e).N(n/1e3)})),2))}e.b*=e.g,_(r)}))}function Ki(e,t){this.promise=e,this.c=t,this.a=!1}function Yi(e){return new Ki(Promise.reject(e),(function(){return Promise.resolve()}))}function Vi(){var e=Promise.reject(new le(2,7,7001));return e.catch((function(){})),new Ki(e,(function(){return Promise.resolve()}))}function qi(e){return new Ki(Promise.resolve(e),(function(){return Promise.resolve()}))}function Wi(e){return new Ki(e,(function(){return e.catch((function(){}))}))}function zi(e){return new Ki(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Xi(t,n){for(var r in n=void 0===n?{}:n)Object.defineProperty(this,r,{value:n[r],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function Qi(){this.ic=new Lr,this.hc=this}function Ji(e){var t=new Set;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(t.has(n))return null;var r=n.constructor==Array;if(n.constructor!=Object&&!r)return null;t.add(n);var i,a=r?[]:{};for(i in n)a[i]=e(n[i]);return r&&(a.length=n.length),a}}(e)}function Zi(e){var t,n={};for(t in e)n[t]=e[t];return n}function $i(){this.a=[]}function ea(e,t){e.a.push(t.finally((function(){ut(e.a,t)})))}function ta(e){Qi.call(this),this.f=!1,this.h=new $i,this.a=new Set,this.b=new Set,this.c=e||null,this.g=!1}function na(e,t,n,r){n=n||sa;var i=ua[e];(!i||n>=i.priority)&&(ua[e]={priority:n,mf:t,pf:void 0!==r&&r})}function ra(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,streamDataCallback:void 0===n?null:n}}function ia(){this.a=0}function aa(e,t,n){Ki.call(this,e,t),this.b=n}Ki.prototype.abort=function(){return this.a=!0,this.c()},Ki.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},Ki.prototype.W=function(e,t){function n(n){return function(s){if(i.a&&n)a.reject(o);else{var u=n?e:t;u?r=function(e,t,n){try{var r=e(t);return r&&r.promise&&r.abort?(n.resolve(r.promise),function(){return r.abort()}):(n.resolve(r),function(){return Promise.resolve(r).then((function(){}),(function(){}))})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(u,s,a):(n?a.resolve:a.reject)(s)}}}function r(){return a.reject(o),i.abort()}var i=this,a=new fr,o=new le(2,7,7001);return this.promise.then(n(!0),n(!1)),new Ki(a,(function(){return r()}))},G("shaka.util.AbortableOperation",Ki),Ki.prototype.chain=Ki.prototype.W,Ki.prototype.finally=Ki.prototype.finally,Ki.all=zi,Ki.prototype.abort=Ki.prototype.abort,Ki.notAbortable=Wi,Ki.completed=qi,Ki.aborted=Vi,Ki.failed=Yi,Xi.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Xi.prototype.stopImmediatePropagation=function(){this.a=!0},Xi.prototype.stopPropagation=function(){},G("shaka.util.FakeEvent",Xi),Qi.prototype.addEventListener=function(e,t){this.ic.push(e,t)},Qi.prototype.removeEventListener=function(e,t){this.ic.remove(e,t)},Qi.prototype.dispatchEvent=function(e){var t=this.ic.get(e.type)||[],n=this.ic.get("All");for(n&&(t=t.concat(n)),n=(t=l(t)).next();!n.done;n=t.next()){n=n.value,e.target=this.hc,e.currentTarget=this.hc;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.a)break}return e.defaultPrevented},$i.prototype.destroy=function(){for(var e=[],t=l(this.a),n=t.next();!n.done;n=t.next())(n=n.value).promise.catch((function(){})),e.push(n.abort());return this.a=[],Promise.all(e)},m(ta,Qi),(r=ta.prototype).Ed=function(e){this.g=e},r.qf=function(e){this.a.add(e)},r.Hf=function(e){this.a.delete(e)},r.Be=function(){this.a.clear()},r.rf=function(e){this.b.add(e)},r.If=function(e){this.b.delete(e)},r.Ce=function(){this.b.clear()},r.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.h.destroy()},r.request=function(e,t){var n=this,r=new ia;if(this.f){var i=Promise.reject(new le(2,7,7001));return i.catch((function(){})),new aa(i,(function(){return Promise.resolve()}),r)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Ji(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},t.uris=Ji(t.uris);var a=(i=function(e,t,n){for(var r=qi(void 0),i={},a=(e=l(e.a)).next();!a.done;i={Rc:i.Rc},a=e.next())i.Rc=a.value,r=r.W(function(e){return function(){return n.body&&(n.body=ae(n.body)),e.Rc(t,n)}}(i));return r.W(void 0,(function(e){if(e instanceof le&&7001==e.code)throw e;throw new le(2,1,1006,e)}))}(this,e,t)).W((function(){return function e(t,n,r,i,a,o,s){t.g&&(r.uris[a]=r.uris[a].replace("http://","https://"));var u=new qn(r.uris[a]),l=u.Ca,c=!1;l||(Wn(u,l=(l=location.protocol).slice(0,-1)),r.uris[a]=u.toString()),l=l.toLowerCase();var d=(l=ua[l])?l.mf:null;if(!d)return Yi(new le(2,1,1e3,u));var f,h=l.pf,p=null,g=null,m=!1;return Wi(Hi(i)).W((function(){if(t.f)return Vi();f=Date.now();var e=d(r.uris[a],r,n,(function(e,r,i){p&&p.stop(),g&&g.N(o/1e3),t.c&&n==oa&&(t.c(e,r),c=!0,s.a=i)}));if(!h)return e;var i=r.retryParameters.connectionTimeout;i&&(p=new Ge((function(){m=!0,e.abort()}))).N(i/1e3);var o=r.retryParameters.stallTimeout;return o&&(g=new Ge((function(){m=!0,e.abort()}))),e})).W((function(e){return p&&p.stop(),g&&g.stop(),null==e.timeMs&&(e.timeMs=Date.now()-f),{response:e,cf:c}}),(function(u){if(p&&p.stop(),g&&g.stop(),t.f)return Vi();if(m&&(u=new le(1,1,1003,r.uris[a],n)),u instanceof le){if(7001==u.code)throw u;if(1010==u.code)throw o;if(1==u.severity){var l=new Xi("retry",{error:u});return t.dispatchEvent(l),a=(a+1)%r.uris.length,e(t,n,r,i,a,u,s)}}throw u}))}(n,e,t,new ji(t.retryParameters,!1),0,null,r)})),o=a.W((function(t){return function(e,t,n){for(var r=qi(void 0),i={},a=(e=l(e.b)).next();!a.done;i={Sc:i.Sc},a=e.next())i.Sc=a.value,r=r.W(function(e){return function(){var r=n.response;return r.data&&(r.data=ae(r.data)),e.Sc(t,r)}}(i));return r.W((function(){return n}),(function(e){var t=2;if(e instanceof le){if(7001==e.code)throw e;t=e.severity}throw new le(t,1,1007,e)}))}(n,e,t)})),s=Date.now(),u=0;i.promise.then((function(){u=Date.now()-s}),(function(){}));var c=0;a.promise.then((function(){c=Date.now()}),(function(){}));var d=o.W((function(t){var r=Date.now()-c,i=t.response;return i.timeMs+=u,i.timeMs+=r,t.cf||!n.c||i.fromCache||e!=oa||n.c(i.timeMs,i.data.byteLength),i}),(function(e){throw e&&(e.severity=2),e}));return i=new aa(d.promise,(function(){return d.abort()}),r),ea(this.h,i),i},G("shaka.net.NetworkingEngine",ta),ta.prototype.request=ta.prototype.request,ta.prototype.destroy=ta.prototype.destroy,ta.makeRequest=ra,ta.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},ta.prototype.clearAllResponseFilters=ta.prototype.Ce,ta.prototype.unregisterResponseFilter=ta.prototype.If,ta.prototype.registerResponseFilter=ta.prototype.rf,ta.prototype.clearAllRequestFilters=ta.prototype.Be,ta.prototype.unregisterRequestFilter=ta.prototype.Hf,ta.prototype.registerRequestFilter=ta.prototype.qf,ta.unregisterScheme=function(e){delete ua[e]},ta.registerScheme=na,ta.prototype.setForceHTTPS=ta.prototype.Ed,ta.NumBytesRemainingClass=ia,m(aa,Ki),ta.PendingRequest=aa;var oa=1;ta.RequestType={MANIFEST:0,SEGMENT:oa,LICENSE:2,APP:3,TIMING:4};var sa=3;ta.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:sa};var ua={};function la(){}function ca(e){return new qn(e=pe(e)).Ba}function da(e,t,n){function r(e){se(a).setUint32(o,e.byteLength,!0),o+=4,a.set(oe(e),o),o+=e.byteLength}if(!n||!n.byteLength)throw new le(2,6,6015);var i;i="string"==typeof t?me(t,!0):t,e=me(e=pe(e),!0);var a=new Uint8Array(12+e.byteLength+i.byteLength+n.byteLength),o=0;return r(e),r(i),r(n),a}function fa(e){for(var t=new Map,n=l(Object.keys(e)),r=n.next();!r.done;r=n.next())r=r.value,t.set(r,e[r]);return t}function ha(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function pa(e,t){if(!e&&!t)return!0;if(e&&!t||t&&!e)return!1;if(e.size!=t.size)return!1;for(var n=l(e),r=n.next();!r.done;r=n.next()){var i=l(r.value);if(r=i.next().value,i=i.next().value,!t.has(r))return!1;if((r=t.get(r))!=i||null==r)return!1}return!0}function ga(e,t){var n=this;t=void 0===t?1:t,this.u=e,this.l=new Set,this.a=this.h=null,this.ja=this.M=!1,this.D=0,this.c=null,this.b=new xr,this.f=new Map,this.v=[],this.j=new fr,this.i=null,this.g=function(t){n.j.reject(t),e.onError(t)},this.ka=new Map,this.T=new Map,this.J=new Ge((function(){return function(e){var t=e.ka,n=e.T;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),(t=Array.from(n.values())).length&&t.every((function(e){return"expired"==e}))&&e.g(new le(2,6,6014)),e.u.zc(ha(n))}(n)})),this.A=!1,this.C=[],this.H=!1,this.X=new Ge((function(){!function(e){e.f.forEach((function(t,n){var r=t.sd,i=n.expiration;isNaN(i)&&(i=1/0),i!=r&&(e.u.onExpirationUpdated(n.sessionId,i),t.sd=i)}))}(n)})).xa(t),this.j.catch((function(){})),this.F=new Dr((function(){return function(e){return x((function(t){switch(t.a){case 1:return e.b.release(),e.b=null,e.j.reject(),e.X.stop(),e.X=null,e.J.stop(),e.J=null,T(t,La(e),2);case 2:if(!e.a){t.m(3);break}return b(t,4),T(t,e.a.setMediaKeys(null),6);case 6:S(t,5);break;case 4:w(t);case 5:e.a=null;case 3:e.c=null,e.l.clear(),e.h=null,e.v=[],e.i=null,e.g=function(){},e.u=null,_(t)}}))}(n)}))}function ma(e,t,n,r){return e.v=n,e.A=0<n.length,va(e,t,!!r)}function va(t,n,r){var i,a,o,s,u,d,f,h,p,g,m,v,y;return x((function(E){if(1==E.a){if(i=function(t){if(0==(t=fa(t.i.clearKeys)).size)return null;var n=[],r=[];t.forEach((function(e,t){var i=tt(t),a=tt(e);i={kty:"oct",kid:$e(i,!1),k:$e(a,!1)},n.push(i),r.push(i.kid)})),t=JSON.stringify({keys:n});var i=JSON.stringify({kids:r});return i=[{initData:oe(ge(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,sessionType:"",initData:i,keyIds:new Set(r)}}(t))for(a=l(n),o=a.next();!o.done;o=a.next())(s=o.value).video&&(s.video.drmInfos=[i]),s.audio&&(s.audio.drmInfos=[i]);for((u=n.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})))||(d=fa(t.i.servers),function(e,t){var n=[];t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:new Set})}));for(var r=l(e),i=r.next();!i.done;i=r.next())(i=i.value).video&&(i.video.drmInfos=n),i.audio&&(i.audio.drmInfos=n)}(n,d)),f=l(n),o=f.next();!o.done;o=f.next())for(h=o.value,p=xa(h),g=l(p),m=g.next();!m.done;m=g.next())ka(m.value,fa(t.i.servers),fa(t.i.advanced||{}));return r?T(E,fi(n,t.A),2):(v=function(e,t){for(var n=new Set,r=l(t),i=r.next();!i.done;i=r.next()){var a=l(xa(i.value));for(i=a.next();!i.done;i=a.next())n.add(i.value)}for(i=(r=l(n)).next();!i.done;i=r.next())ka(i.value,fa(e.i.servers),fa(e.i.advanced||{}));a=e.A?"required":"optional";var o=e.A?["persistent-license"]:["temporary"];for(r=new Map,i=(n=l(n)).next();!i.done;i=n.next())i=i.value,r.set(i.keySystem,{initDataTypes:["cenc"],audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:o,label:i.keySystem,drmInfos:[]});for(i=(n=l(t)).next();!i.done;i=n.next())for(i=(a=l([(i=i.value).audio,i.video])).next();!i.done;i=a.next())if(o=i.value){var s=wa(o),u=null;"ac-3"==o.codecs.toLowerCase()&&Ke()&&(u=wa(o,"ec-3"));var d=l(o.drmInfos);for(i=d.next();!i.done;i=d.next()){var f=i.value;(i=r.get(f.keySystem)).drmInfos.push(f),f.initData&&f.initData.length&&(i.initDataTypes=c(new Set(f.initData.map((function(e){return e.initDataType})))).concat()),f.distinctiveIdentifierRequired&&(i.distinctiveIdentifier="required"),f.persistentStateRequired&&(i.persistentState="required"),f.sessionType&&(i.sessionTypes=[f.sessionType]);var h={robustness:(f="audio"==o.type?f.audioRobustness:f.videoRobustness)||"",contentType:s};"audio"==o.type?i.audioCapabilities.push(h):i.videoCapabilities.push(h),u&&(f={robustness:f||"",contentType:u},"audio"==o.type?i.audioCapabilities.push(f):i.videoCapabilities.push(f))}}return r}(t,n),E.m(2))}return u||Object.keys(t.i.servers).length?(y=Ia(t,v,n,r),E.return(u?y:y.catch((function(){})))):(t.M=!0,E.return(Promise.resolve()))}))}function ya(e){return x((function(t){if(1==t.a)return e.h&&e.c&&e.c.serverCertificate&&e.c.serverCertificate.length?(b(t,3),T(t,e.h.setServerCertificate(e.c.serverCertificate),5)):t.m(0);if(3!=t.a)return S(t,0);throw new le(2,6,6004,w(t).message)}))}function Ea(e){for(var t=(e.c?e.c.initData:[])||[],n=l(t),r=n.next();!r.done;r=n.next())Ta(e,(r=r.value).initDataType,r.initData);for(r=(n=l(e.v)).next();!r.done;r=n.next())Ra(e,r.value);return t.length||e.v.length||e.j.resolve(),e.j}function Ta(e,t,n){for(var r=e.f.values(),i=(r=l(r)).next();!i.done;i=r.next())if(re(n,i.value.initData)&&!We("Tizen 2"))return;!function(e,t,n){var r=e.c.sessionType;try{var i=e.h.createSession(r)}catch(t){return void e.g(new le(2,6,6005,t.message))}e.b.s(i,"message",(function(t){e.a&&e.i.delayLicenseRequestUntilPlayed&&e.a.paused&&!e.H?e.C.push(t):Da(e,t)})),e.b.s(i,"keystatuseschange",(function(t){return Ma(e,t)})),e.f.set(i,{initData:n,loaded:!1,sd:1/0,Ga:null,type:r});try{n=e.i.initDataTransform(n,t,e.c)}catch(n){return t=n,n instanceof le||(t=new le(2,6,6016,n)),void e.g(t)}e.i.logLicenseExchange&&$e(n),i.generateRequest(t,n).catch((function(t){if(!e.F.a){e.f.delete(i);var n=t.errorCode;if(n&&n.systemCode){var r=n.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}e.g(new le(2,6,6006,t.message,t,r))}}))}(e,t,n)}function _a(e){return e?e.keySystem:""}function ba(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function Aa(e,t){if(navigator.userAgent.match(/Edge\//))return!0;if(t=t.toLowerCase(),Ke()&&t.includes('codecs="ac-3"')){var n=t.replace("ac-3","ec-3");return e.l.has(t)||e.l.has(n)}return e.l.has(t)}function Sa(e){return e=$(e=e.f.keys(),(function(e){return e.sessionId})),Array.from(e)}function wa(e,t){var n=Tr(e.mimeType,t||e.codecs);return vr(n)?Er(e.type,n):n}function Ia(e,t,n,r){var i,a,o,s,u,c,d,f,h,p,g,m,v;return x((function(y){switch(y.a){case 1:if(i=new Map,r){e:{for(var E=l(n),_=E.next();!_.done;_=E.next()){var A=l(xa(_.value));for(_=A.next();!_.done;_=A.next()){var I=_.value;i.has(I.keySystem)||i.set(I.keySystem,[]),i.get(I.keySystem).push(I)}}if(1==i.size&&i.has(""))throw new le(2,6,6e3);for(A=(E=l([!0,!1])).next();!A.done;A=E.next())for(A=A.value,_=(I=l(n)).next();!_.done;_=I.next()){var R=l(_.value.decodingInfos);for(_=R.next();!_.done;_=R.next()){var C=_.value;if(C.supported&&C.keySystemAccess){var D=l(_=i.get(C.keySystemAccess.keySystem));for(_=D.next();!_.done;_=D.next())if(!!_.value.licenseServerUri==A){a=C.keySystemAccess;break e}}}}a=null}y.m(2);break}return T(y,function(e,t){var n,r,i,a,o,s,u,c,d,f,h;return x((function(p){switch(p.a){case 1:if(1==t.size&&t.has(""))throw new le(2,6,6e3);for(r=l(t.values()),i=r.next();!i.done;i=r.next())0==(a=i.value).audioCapabilities.length&&delete a.audioCapabilities,0==a.videoCapabilities.length&&delete a.videoCapabilities;o=l([!0,!1]),s=o.next();case 2:if(s.done){p.m(4);break}u=s.value,c=l(t.keys()),d=c.next();case 5:if(d.done){s=o.next(),p.m(2);break}if(f=d.value,(h=t.get(f)).drmInfos.some((function(e){return!!e.licenseServerUri}))!=u){p.m(6);break}return b(p,8),T(p,navigator.requestMediaKeySystemAccess(f,[h]),10);case 10:return n=p.b,p.return(n);case 8:w(p);case 9:Mr(e.F);case 6:d=c.next(),p.m(5);break;case 4:return p.return(n)}}))}(e,t),3);case 3:a=y.b;case 2:if(!(o=a))throw new le(2,6,6001);for(Mr(e.F),b(y,4),e.l.clear(),s=o.getConfiguration(),u=s.audioCapabilities||[],c=s.videoCapabilities||[],d=l(u),f=d.next();!f.done;f=d.next())h=f.value,e.l.add(h.contentType.toLowerCase());for(p=l(c),f=p.next();!f.done;f=p.next())g=f.value,e.l.add(g.contentType.toLowerCase());if(r){for(A=o.keySystem,Pa(E=i.get(o.keySystem),I=[],_=[],R=[],C=new Set),D=e.A?"persistent-license":"temporary",A={keySystem:A,licenseServerUri:I[0],distinctiveIdentifierRequired:E[0].distinctiveIdentifierRequired,persistentStateRequired:E[0].persistentStateRequired,sessionType:E[0].sessionType||D,audioRobustness:E[0].audioRobustness||"",videoRobustness:E[0].videoRobustness||"",serverCertificate:_[0],initData:R,keyIds:C},I=(E=l(E)).next();!I.done;I=E.next())(I=I.value).distinctiveIdentifierRequired&&(A.distinctiveIdentifierRequired=I.distinctiveIdentifierRequired),I.persistentStateRequired&&(A.persistentStateRequired=I.persistentStateRequired);E=A}else E=o.keySystem,A=t.get(o.keySystem),I=[],_=[],R=[],C=new Set,Pa(A.drmInfos,I,_,R,C),E={keySystem:E,licenseServerUri:I[0],distinctiveIdentifierRequired:"required"==A.distinctiveIdentifier,persistentStateRequired:"required"==A.persistentState,sessionType:A.sessionTypes[0]||"temporary",audioRobustness:(A.audioCapabilities?A.audioCapabilities[0].robustness:"")||"",videoRobustness:(A.videoCapabilities?A.videoCapabilities[0].robustness:"")||"",serverCertificate:_[0],initData:R,keyIds:C};if(e.c=E,!e.c.licenseServerUri)throw new le(2,6,6012,e.c.keySystem);return T(y,o.createMediaKeys(),6);case 6:return m=y.b,Mr(e.F),e.h=m,e.M=!0,T(y,ya(e),7);case 7:Mr(e.F),S(y,0);break;case 4:if(v=w(y),Mr(e.F,v),e.c=null,e.l.clear(),v instanceof le)throw v;throw new le(2,6,6002,v.message)}}))}function Ra(e,t){var n,r,i,a,o;return x((function(s){switch(s.a){case 1:try{n=e.h.createSession("persistent-license")}catch(t){return r=new le(2,6,6005,t.message),e.g(r),s.return(Promise.reject(r))}return e.b.s(n,"message",(function(t){e.a&&e.i.delayLicenseRequestUntilPlayed&&e.a.paused&&!e.H?e.C.push(t):Da(e,t)})),e.b.s(n,"keystatuseschange",(function(t){return Ma(e,t)})),i={initData:null,loaded:!1,sd:1/0,Ga:null,type:"persistent-license"},e.f.set(n,i),b(s,2),T(s,n.load(t),4);case 4:return a=s.b,Mr(e.F),a?(i.loaded=!0,Oa(e)&&e.j.resolve(),s.return(n)):(e.f.delete(n),e.g(new le(2,6,6013)),s.return(Promise.resolve()));case 2:o=w(s),Mr(e.F,o),e.f.delete(n),e.g(new le(2,6,6005,o.message));case 3:return s.return(Promise.resolve())}}))}function Ca(e,t,n){return"skd"==t&&(t=n.serverCertificate,e=da(e,n=ca(e),t)),e}function Da(e,t){var n,r,i,a,o,s,u,c,d,f,h,p;x((function(g){switch(g.a){case 1:return n=t.target,e.i.logLicenseExchange&&$e(t.message),r=e.f.get(n),i=e.c.licenseServerUri,a=e.i.advanced[e.c.keySystem],"individualization-request"==t.messageType&&a&&a.individualizationServer&&(i=a.individualizationServer),(o=ra([i],e.i.retryParameters)).body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,ba(e.c.keySystem)&&function(e){var t=he(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){for(var n=l((t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader")),r=n.next();!r.done;r=n.next())r=r.value,e.headers[r.getElementsByTagName("name")[0].textContent]=r.getElementsByTagName("value")[0].textContent;e.body=et(t.getElementsByTagName("Challenge")[0].textContent)}else e.headers["Content-Type"]="text/xml; charset=utf-8"}(o),s=Date.now(),b(g,2),T(g,e.u.xb.request(2,o).promise,4);case 4:u=g.b,S(g,3);break;case 2:return c=w(g),d=new le(2,6,6007,c),e.g(d),r&&r.Ga&&r.Ga.reject(d),g.return();case 3:return e.F.a?g.return():(e.D+=(Date.now()-s)/1e3,e.i.logLicenseExchange&&$e(u.data),b(g,5),T(g,n.update(u.data),7));case 7:S(g,6);break;case 5:return f=w(g),h=new le(2,6,6008,f.message),e.g(h),r&&r.Ga&&r.Ga.reject(h),g.return();case 6:p=new Xi("drmsessionupdate"),e.u.onEvent(p),r&&(r.Ga&&r.Ga.resolve(),new Ge((function(){r.loaded=!0,Oa(e)&&e.j.resolve()})).N(Ua)),_(g)}}))}function Ma(e,t){var n=t.target,r=e.f.get(n),i=!1;n.keyStatuses.forEach((function(t,n){if("string"==typeof n){var a=n;n=t,t=a}if(ba(e.c.keySystem)&&16==n.byteLength&&navigator.userAgent.match(/Edge?\//)){var o=(a=se(n)).getUint32(0,!0),s=a.getUint16(4,!0),u=a.getUint16(6,!0);a.setUint32(0,o,!1),a.setUint16(4,s,!1),a.setUint16(6,u,!1)}"status-pending"!=t&&(r.loaded=!0),"expired"==t&&(i=!0),a=nt(n),e.ka.set(a,t)}));var a=n.expiration-Date.now();(0>a||i&&1e3>a)&&r&&!r.Ga&&(e.f.delete(n),n.close().catch((function(){}))),Oa(e)&&(e.j.resolve(),e.J.N(Ba))}function La(e){var t;return x((function(n){return t=Array.from(e.f.entries()),e.f.clear(),T(n,Promise.all(t.map((function(t){var n=(t=l(t)).next().value,r=t.next().value;return x((function(t){return 1==t.a?(b(t,2),e.ja||e.v.includes(n.sessionId)||"persistent-license"!==r.type?T(t,function(e){var t;return x((function(n){return 1==n.a?(t=new Promise((function(e,t){new Ge(t).N(Fa)})),b(n,2),T(n,Promise.race([Promise.all([e.close(),e.closed]),t]),4)):2!=n.a?S(n,0):(w(n),void _(n))}))}(n),5):T(t,n.remove(),5)):2!=t.a?S(t,0):(w(t),void _(t))}))}))),0)}))}function Na(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],r=l(e),i=r.next();!i.done;i=r.next()){i=i.value;for(var a=l(t),o=a.next();!o.done;o=a.next())if(o=o.value,i.keySystem==o.keySystem){a=(a=(a=[]).concat(i.initData||[])).concat(o.initData||[]);var s=i.keyIds&&o.keyIds?new Set(c(i.keyIds).concat(c(o.keyIds))):i.keyIds||o.keyIds;n.push({keySystem:i.keySystem,licenseServerUri:i.licenseServerUri||o.licenseServerUri,distinctiveIdentifierRequired:i.distinctiveIdentifierRequired||o.distinctiveIdentifierRequired,persistentStateRequired:i.persistentStateRequired||o.persistentStateRequired,videoRobustness:i.videoRobustness||o.videoRobustness,audioRobustness:i.audioRobustness||o.audioRobustness,serverCertificate:i.serverCertificate||o.serverCertificate,initData:a,keyIds:s});break}}return n}function xa(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Oa(e){return function(e,t){for(var n=l(e),r=n.next();!r.done;r=n.next())if(!t(r.value))return!1;return!0}(e=e.f.values(),(function(e){return e.loaded}))}function Pa(e,t,n,r,i){for(var a={},o=(e=l(e)).next();!o.done;a={ta:a.ta},o=e.next()){if(a.ta=o.value,t.includes(a.ta.licenseServerUri)||t.push(a.ta.licenseServerUri),a.ta.serverCertificate&&(n.some(function(e){return function(t){return re(t,e.ta.serverCertificate)}}(a))||n.push(a.ta.serverCertificate)),a.ta.initData){o={};for(var s=l(a.ta.initData),u=s.next();!u.done;o={ac:o.ac},u=s.next())o.ac=u.value,r.some(function(e){return function(t){var n=e.ac;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&re(t.initData,n.initData)}}(o))||r.push(o.ac)}if(a.ta.keyIds)for(s=(o=l(a.ta.keyIds)).next();!s.done;s=o.next())i.add(s.value)}}function ka(t,n,r){!t.keySystem||"org.w3.clearkey"==t.keySystem&&t.licenseServerUri||(n.size&&(n=n.get(t.keySystem)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(r=r.get(t.keySystem))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=r.persistentStateRequired),t.videoRobustness||(t.videoRobustness=r.videoRobustness),t.audioRobustness||(t.audioRobustness=r.audioRobustness),t.serverCertificate||(t.serverCertificate=r.serverCertificate),r.sessionType&&(t.sessionType=r.sessionType)),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==t.keySystem&&(t.keySystem="com.chromecast.playready"))}G("shaka.util.FairPlayUtils",la),la.initDataTransform=da,la.defaultGetContentId=ca,(r=ga.prototype).destroy=function(){return this.F.destroy()},r.configure=function(e){this.i=e},r.Hb=function(e){var t,n=this;return x((function(r){if(1==r.a)return n.h?(n.a=e,n.b.qa(n.a,"play",(function(){for(var e=l(n.C),t=e.next();!t.done;t=e.next())Da(n,t.value);n.H=!0,n.C=[]})),"webkitCurrentPlaybackTargetIsWireless"in n.a&&n.b.s(n.a,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return La(n)})),T(r,n.a.setMediaKeys(n.h).catch((function(e){return Promise.reject(new le(2,6,6003,e.message))})),2)):(n.b.qa(e,"encrypted",(function(){n.g(new le(2,6,6010))})),r.return());Mr(n.F),Ea(n),n.c.initData.length||n.v.length||(t=function(e){return Ta(n,e.initDataType,oe(e.initData))},n.b.s(n.a,"encrypted",t)),_(r)}))},r.Mb=function(){for(var e=1/0,t=this.f.keys(),n=(t=l(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},r.tc=function(){return ha(this.T)};var Fa=1,Ua=5,Ba=.5,Ga=new ce((function(){return ae(new Uint8Array([0]))}));function ja(){}function Ha(e,t,n,r){var i,a,o,s;return x((function(u){if(1==u.a)return r&&(i=Va[r.toLowerCase()])?u.return(i):(a=Ya(e))&&(o=qa[a])?u.return(o):r?u.m(2):T(u,Ka(e,t,n),3);if(2!=u.a&&(r=u.b)&&(s=Va[r]))return u.return(s);throw new le(2,4,4e3,e)}))}function Ka(e,t,n){var r,i,a;return x((function(o){return 1==o.a?((r=ra([e],n)).method="HEAD",T(o,t.request(0,r).promise,2)):(i=o.b,a=i.headers["content-type"],o.return(a?a.toLowerCase().split(";").shift():""))}))}function Ya(e){return 1==(e=new qn(e).sa.split("/").pop().split(".")).length?"":e.pop().toLowerCase()}G("shaka.media.ManifestParser",ja),ja.unregisterParserByMime=function(e){delete Va[e]},ja.registerParserByMime=function(e,t){Va[e]=t},ja.registerParserByExtension=function(e,t){qa[e]=t};var Va={},qa={};function Wa(e,t,n){this.ga=e,this.da=t,this.Y=n}function za(e,t,n,r,i,a,o,s,u,l){l=void 0===l?[]:l,this.startTime=e,this.endTime=t,this.c=n,this.da=r,this.Y=i,this.b=a,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=u,this.a=l}function Xa(e,t,n){this.f=e,this.Cc=t,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.j=0,this.l=!0,this.v=0,this.A=void 0===n||n,this.C=0}function Qa(e,t){this.g=e,this.h=Za(e),this.a=e.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.j=t,this.c=function(){}}function Ja(e){this.a=e}function Za(e){if(e.a.paused||0==e.a.playbackRate||0==e.a.buffered.length)var t=!1;else e:{t=e.a.currentTime;for(var n=(e=l(Yn(e.a.buffered))).next();!n.done;n=e.next())if(!(t<(n=n.value).start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function $a(e,t,n,r,i){var a=this;this.a=e,this.A=t,this.i=n,this.v=i,this.b=new xr,this.j=!1,this.l=e.readyState,this.f=!1,this.c=r,this.h=!1,this.b.s(e,"waiting",(function(){return eo(a)})),this.g=new Ge((function(){eo(a)})).xa(.25)}function eo(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.j)return}else e.j=!1;if(!e.a.paused||0==e.a.currentTime){var t;if(e.a.readyState!=e.l&&(e.f=!1,e.l=e.a.readyState),!(t=!e.c)){var n=(t=e.c).g,r=Za(n),i=n.a.currentTime,a=Date.now()/1e3;t.a==i&&t.h==r||(t.f=a,t.a=i,t.h=r,t.b=!1),(r=(i=a-t.f)>=t.j&&r&&!t.b)&&(t.c(t.a,i),t.b=!0,t.a=n.a.currentTime),t=!r}if(t){var o=e.i.smallGapLimit;if(i=e.a.currentTime,!(null==(n=function(e,t,n){return!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)?null:0<=(e=Yn(e).findIndex((function(e,r,i){return e.start>t&&(0==r||i[r-1].end-t<=n)})))?e:null}(t=e.a.buffered,i,e.i.gapDetectionThreshold))||0==n&&!e.h||(r=t.start(n),r>=e.A.Ma()))){o=(a=r-i)<=o;var s=!1;.001>a||(o||e.f||(e.f=!0,(i=new Xi("largegap",{currentTime:i,gapSize:a})).cancelable=!0,e.v(i),e.i.jumpLargeGaps&&!i.defaultPrevented&&(s=!0)),!o&&!s)||(0!=n&&t.end(n-1),e.a.currentTime=r)}}}}}function to(e,t,n,r){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?r():(t=no.value().get(t),n.qa(e,t,r))}Wa.prototype.Pb=function(){return this.da},Wa.prototype.Lb=function(){return this.Y},G("shaka.media.InitSegmentReference",Wa),Wa.prototype.getEndByte=Wa.prototype.Lb,Wa.prototype.getStartByte=Wa.prototype.Pb,(r=za.prototype).ga=function(){return this.c()},r.Xe=function(){return this.startTime},r.Ke=function(){return this.endTime},r.Pb=function(){return this.da},r.Lb=function(){return this.Y},G("shaka.media.SegmentReference",za),za.prototype.getEndByte=za.prototype.Lb,za.prototype.getStartByte=za.prototype.Pb,za.prototype.getEndTime=za.prototype.Ke,za.prototype.getStartTime=za.prototype.Xe,za.prototype.getUris=za.prototype.ga,(r=Xa.prototype).getDuration=function(){return this.g},r.Qe=function(){return this.a},r.Fa=function(e){this.g=e},r.We=function(){return this.f},r.le=function(e){this.j=e},r.Xb=function(e){this.l=e},r.Hd=function(e){this.h=e},r.Cf=function(e){this.Cc=e},r.Je=function(){return this.Cc},r.yb=function(e){if(0!=e.length){var t=e[e.length-1].endTime;this.qd(e[0].startTime),this.a=e.reduce((function(e,t){return Math.max(e,t.endTime-t.startTime)}),this.a),this.b=Math.max(this.b,t),null!=this.f&&this.A&&(this.f=(Date.now()+this.j)/1e3-this.b-this.a)}},r.qd=function(e){this.c=null==this.c?e:Math.min(this.c,e)},r.pd=function(e){this.a=Math.max(this.a,e)},r.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},r.U=function(){return 1/0==this.g&&!this.l},r.eb=function(){return 1/0!=this.g&&!this.l},r.Ua=function(){return Math.max(this.v,this.Ta()-this.h)},r.me=function(e){this.v=e},r.Ta=function(){return this.U()||this.eb()?Math.min(Math.max(0,(Date.now()+this.j)/1e3-this.a-this.f)+this.C,this.g):this.g},r.Ob=function(e){var t=Math.max(this.c,this.v);return 1/0==this.h?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.Ta()-this.h+e,this.Ma()))},r.tb=function(){return this.Ob(0)},r.Ma=function(){return Math.max(0,this.Ta()-(this.U()||this.eb()?this.Cc:0))},r.pe=function(){return!(null==this.f||null!=this.b&&this.A)},r.ke=function(e){this.C=e},G("shaka.media.PresentationTimeline",Xa),Xa.prototype.setAvailabilityTimeOffset=Xa.prototype.ke,Xa.prototype.usingPresentationStartTime=Xa.prototype.pe,Xa.prototype.getSeekRangeEnd=Xa.prototype.Ma,Xa.prototype.getSeekRangeStart=Xa.prototype.tb,Xa.prototype.getSafeSeekRangeStart=Xa.prototype.Ob,Xa.prototype.getSegmentAvailabilityEnd=Xa.prototype.Ta,Xa.prototype.setUserSeekStart=Xa.prototype.me,Xa.prototype.getSegmentAvailabilityStart=Xa.prototype.Ua,Xa.prototype.isInProgress=Xa.prototype.eb,Xa.prototype.isLive=Xa.prototype.U,Xa.prototype.offset=Xa.prototype.offset,Xa.prototype.notifyMaxSegmentDuration=Xa.prototype.pd,Xa.prototype.notifyMinSegmentStartTime=Xa.prototype.qd,Xa.prototype.notifySegments=Xa.prototype.yb,Xa.prototype.getDelay=Xa.prototype.Je,Xa.prototype.setDelay=Xa.prototype.Cf,Xa.prototype.setSegmentAvailabilityDuration=Xa.prototype.Hd,Xa.prototype.setStatic=Xa.prototype.Xb,Xa.prototype.setClockOffset=Xa.prototype.le,Xa.prototype.getPresentationStartTime=Xa.prototype.We,Xa.prototype.setDuration=Xa.prototype.Fa,Xa.prototype.getMaxSegmentDuration=Xa.prototype.Qe,Xa.prototype.getDuration=Xa.prototype.getDuration,Qa.prototype.release=function(){this.g=null,this.c=function(){}},$a.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.g&&(this.g.stop(),this.g=null),this.c&&(this.c.release(),this.c=null),this.a=this.A=this.v=null},$a.prototype.td=function(){this.h=!0,eo(this)};var no=new ce((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])}));function ro(e,t,n){var r=this;this.a=e,this.g=t,this.f=n,this.h=!1,this.b=new xr,this.c=new uo(e),to(this.a,HTMLMediaElement.HAVE_METADATA,this.b,(function(){oo(r,r.f)}))}function io(e){return e.h?e.a.currentTime:e.f}function ao(e,t){0<e.a.readyState?lo(e.c,t):to(e.a,HTMLMediaElement.HAVE_METADATA,e.b,(function(){oo(e,e.f)}))}function oo(e,t){.001>Math.abs(e.a.currentTime-t)?so(e):(e.b.qa(e.a,"seeking",(function(){so(e)})),lo(e.c,0==e.a.currentTime?t:e.a.currentTime))}function so(e){e.h=!0,e.b.s(e.a,"seeking",(function(){return e.g()}))}function uo(e){var t=this;this.b=e,this.h=10,this.g=this.f=this.c=0,this.a=new Ge((function(){0>=t.c||t.b.currentTime!=t.f?t.a.stop():(t.b.currentTime=t.g,t.c--)}))}function lo(e,t){e.f=e.b.currentTime,e.g=t,e.c=e.h,e.b.currentTime=t,e.a.xa(.1)}function co(e){var t=this;this.a=e,this.f=!1,this.c=null,this.b=new xr,to(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,(function(){null==t.c?t.f=!0:(t.b.qa(t.a,"seeking",(function(){t.f=!0})),t.a.currentTime=Math.max(0,t.a.currentTime+t.c))}))}function fo(e,t,n,r,i,a){var o=this;this.c=e,this.a=t.presentationTimeline,this.C=t.minBufferTime||0,this.i=n,this.A=i,this.j=null,this.f=new $a(e,t.presentationTimeline,n,function(e,t){if(!t.stallEnabled)return null;var n=t.stallSkip,r=new Qa(new Ja(e),t.stallThreshold);return function(e,t){e.c=t}(r,(function(){n?e.currentTime+=n:(e.pause(),e.play())})),r}(e,n),a),this.b=new ro(e,(function(){var e=o.f;e.j=!0,e.h=!1,e.f=!1;var t=io(o.b);return e=po(o,t),.001<Math.abs(e-t)&&(t=Date.now()/1e3,!o.j||o.j<t-1)?(o.j=t,ao(o.b,e),e=void 0):(o.A(),e=void 0),e}),function(e,t){return null==t?t=1/0>e.a.getDuration()?e.a.tb():e.a.Ma():0>t&&(t=e.a.Ma()+t),ho(e,go(e,t))}(this,r)),this.h=new Ge((function(){if(0!=o.c.readyState&&!o.c.paused){var e=io(o.b),t=o.a.tb(),n=o.a.Ma();3>n-t&&(t=n-3),e<t&&(e=po(o,e),o.c.currentTime=e)}})).xa(.25)}function ho(e,t){var n=e.a.getDuration();return t>=n?n-e.i.durationBackoff:t}function po(e,t){var n=Math.max(e.C,e.i.rebufferingGoal),r=e.i.safeSeekOffset,i=e.a.tb(),a=e.a.Ma(),o=e.a.getDuration();3>a-i&&(i=a-3);var s=e.a.Ob(n),u=e.a.Ob(r);return n=e.a.Ob(n+r),t>=o?ho(e,t):t>a?a:t<i?Hn(e.c.buffered,u)?u:n:t>=s||Hn(e.c.buffered,t)?t:n}function go(e,t){var n=e.a.tb();return t<n||t>(n=e.a.Ma())?n:t}function mo(e){this.a=e,this.b=null,this.c=0,this.f=!1}function vo(e,t,n){return new mo([new za(e,e+t,(function(){return n}),0,null,null,e,e,e+t)])}function yo(e,t,n){this.c=e,this.b=t,this.a=n}function Eo(){mo.call(this,[]),this.g=[]}function To(e){var t=this;this.a=e,this.f=!1,this.b=this.a.vc(),this.c=new Ge((function(){t.a.Zd(.25*t.b)}))}function _o(e){e.c.stop();var t=e.f?0:e.b;if(0<=t)try{return void(e.a.vc()!=t&&e.a.Gd(t))}catch(e){}e.c.xa(.25),0!=e.a.vc()&&e.a.Gd(0)}function bo(e){var t=this;this.c=e,this.a=new Set,this.b=new Ge((function(){Ao(t,!1)})).xa(.25)}function Ao(e,t){for(var n=l(e.a),r=n.next();!r.done;r=n.next()){r=r.value;for(var i=e.c.currentTime,a=t,o=l(r.g.a),s=o.next();!s.done;s=o.next()){s=s.value;var u=r.f.get(s),c=i<s.startTime?Io:i>s.endTime?Co:Ro;r.f.set(s,c);for(var d=l(r.h),f=d.next();!f.done;f=d.next())(f=f.value).mb==u&&f.lb==c&&f.cb(s,a)}}}function So(e){var t=this;this.b=function(){},this.a=new Set,this.f=e,this.c=new Ge((function(){for(var e=t.f(),n=l(t.a),r=n.next();!r.done;r=n.next())(r=r.value).endTime<e.start&&t.a.delete(r)})).xa(2)}function wo(e){var t=this;this.g=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.h=[{mb:null,lb:Ro,cb:function(e,n){return t.a(e,n)}},{mb:Io,lb:Ro,cb:function(e,n){return t.a(e,n)}},{mb:Co,lb:Ro,cb:function(e,n){return t.a(e,n)}},{mb:Ro,lb:Io,cb:function(e,n){return t.b(e,n)}},{mb:Ro,lb:Co,cb:function(e,n){return t.b(e,n)}},{mb:Io,lb:Co,cb:function(e,n){return t.c(e,n)}},{mb:Co,lb:Io,cb:function(e,n){return t.c(e,n)}}]}ro.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.g=function(){},this.a=null},uo.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},co.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},co.prototype.l=function(e){this.c=this.f?this.c:e},co.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0},co.prototype.v=function(){},fo.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.f&&(this.f.release(),this.f=null),this.h&&(this.h.stop(),this.h=null),this.c=this.b=this.a=this.i=null,this.A=function(){}},fo.prototype.l=function(e){ao(this.b,e)},fo.prototype.g=function(){var e=io(this.b);return 0<this.c.readyState&&!this.c.paused?go(this,e):e},fo.prototype.v=function(){this.f.td()},(r=mo.prototype).destroy=function(){return be("shaka.media.SegmentIndex","Please use release() instead of destroy()."),this.release(),Promise.resolve()},r.release=function(){this.f||(this.a=[],this.b&&this.b.stop(),this.b=null)},r.ff=function(){this.f=!0},r.find=function(e){for(var t=this.a.length-1,n=t;0<=n;--n){var r=this.a[n],i=n<t?this.a[n+1].startTime:r.endTime;if(e>=r.startTime&&e<i)return n+this.c}return this.a.length&&e<this.a[0].startTime?this.c:null},r.get=function(e){return 0==this.a.length||0>(e-=this.c)||e>=this.a.length?null:this.a[e]},r.offset=function(e){if(!this.f)for(var t=l(this.a),n=t.next();!n.done;n=t.next())(n=n.value).startTime+=e,n.endTime+=e,n.timestampOffset+=e},r.xc=function(e){!this.f&&e.length&&(this.a=this.a.filter((function(t){return t.startTime<e[0].startTime})),this.a.push.apply(this.a,c(e)))},r.wb=function(e,t){e=e.filter((function(e){return e.endTime>t})),this.xc(e),this.$a(t)},r.$a=function(e){if(!this.f){var t=this.a.length;this.a=this.a.filter((function(t){return t.endTime>e})),this.c+=t-this.a.length}},r.Sa=function(e,t,n){if(n=void 0!==n&&n,!this.f){for(;this.a.length&&this.a[this.a.length-1].startTime>=t;)this.a.pop();for(;this.a.length&&this.a[0].endTime<=e;)this.a.shift(),n||this.c++;0!=this.a.length&&(e=this.a[this.a.length-1],this.a[this.a.length-1]=new za(e.startTime,t,e.c,e.da,e.Y,e.b,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd))}},r.Fc=function(e,t){var n=this;this.f||(this.b&&this.b.stop(),this.b=new Ge((function(){var e=t();e?n.a.push.apply(n.a,c(e)):(n.b.stop(),n.b=null)})),this.b.xa(e))},mo.prototype[Symbol.iterator]=function(){return this.sb(0)},mo.prototype.sb=function(e){var t=this.find(e);null==t?t=-1:t--;var n=this.get(t+1),r=-1;if(n&&0<n.a.length)for(var i=n.a.length-1;0<=i;--i){var a=n.a[i];if(e>=a.startTime&&e<a.endTime){t++,r=i-1;break}}return new yo(this,t,r)},G("shaka.media.SegmentIndex",mo),mo.forSingleSegment=vo,mo.prototype.getIteratorForTime=mo.prototype.sb,mo.prototype.updateEvery=mo.prototype.Fc,mo.prototype.fit=mo.prototype.Sa,mo.prototype.evict=mo.prototype.$a,mo.prototype.mergeAndEvict=mo.prototype.wb,mo.prototype.merge=mo.prototype.xc,mo.prototype.offset=mo.prototype.offset,mo.prototype.get=mo.prototype.get,mo.prototype.find=mo.prototype.find,mo.prototype.markImmutable=mo.prototype.ff,mo.prototype.release=mo.prototype.release,mo.prototype.destroy=mo.prototype.destroy,yo.prototype.seek=function(e){return be("shaka.media.SegmentIterator","Please use SegmentIndex.getIteratorForTime instead of seek()."),e=this.c.sb(e),this.b=e.b,this.a=e.a,this.next().value},yo.prototype.current=function(){var e=this.c.get(this.b);return e&&0<e.a.length&&e.ga().length&&this.a>=e.a.length&&(this.b++,this.a=0,e=this.c.get(this.b)),e&&0<e.a.length?e.a[this.a]:e},yo.prototype.next=function(){var e=this.c.get(this.b);return e&&0<e.a.length?(this.a++,e.ga().length&&this.a==e.a.length&&(this.b++,this.a=0)):(this.b++,this.a=0),{value:e=this.current(),done:!e}},G("shaka.media.SegmentIterator",yo),yo.prototype.next=yo.prototype.next,yo.prototype.current=yo.prototype.current,yo.prototype.seek=yo.prototype.seek,m(Eo,mo),(r=Eo.prototype).clone=function(){var e=new Eo;return e.g=this.g.slice(),e},r.release=function(){for(var e=l(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g=[]},r.find=function(e){for(var t=0,n=l(this.g),r=n.next();!r.done;r=n.next()){var i=(r=r.value).find(e);if(null!=i)return i+t;t+=r.c+r.a.length}return null},r.get=function(e){for(var t=0,n=l(this.g),r=n.next();!r.done;r=n.next()){var i=(r=r.value).get(e-t);if(i)return i;t+=r.c+r.a.length}return null},r.offset=function(){},r.xc=function(){},r.$a=function(){},r.wb=function(){},r.Sa=function(){},r.Fc=function(){},G("shaka.media.MetaSegmentIndex",Eo),Eo.prototype.updateEvery=Eo.prototype.Fc,Eo.prototype.fit=Eo.prototype.Sa,Eo.prototype.mergeAndEvict=Eo.prototype.wb,Eo.prototype.evict=Eo.prototype.$a,Eo.prototype.merge=Eo.prototype.xc,Eo.prototype.offset=Eo.prototype.offset,Eo.prototype.get=Eo.prototype.get,Eo.prototype.find=Eo.prototype.find,Eo.prototype.release=Eo.prototype.release,To.prototype.release=function(){this.c&&(this.c.stop(),this.c=null),this.a=null},To.prototype.set=function(e){this.b=e,_o(this)},To.prototype.sc=function(){return this.a.sc()},bo.prototype.release=function(){this.b.stop();for(var e=l(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},So.prototype.release=function(){this.b=function(){},this.a.clear(),this.c.stop()},wo.prototype.release=function(){this.g=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}};var Io=1,Ro=2,Co=3;function Do(e,t,n,r,i){return e=ra(e,r,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Mo(e,t){var n=this;this.u=t,this.o=e,this.i=null,this.f=1,this.c=this.b=null,this.a=new Map,this.h=!1,this.j=null,this.g=!1,this.F=new Dr((function(){return function(e){var t,n,r,i;return x((function(a){if(1==a.a){for(t=[],n=l(e.a.values()),r=n.next();!r.done;r=n.next())Ho(i=r.value),t.push(Ko(i));return T(a,Promise.all(t),2)}e.a.clear(),e.u=null,e.o=null,e.i=null,_(a)}))}(n)}))}function Lo(e,t){var n=e.a.get("video");if(n){var r=n.stream;if(r)if(t){var i=r.trickModeVideo;i&&!n.ib&&(Oo(e,i,!1,0,!1),n.ib=r)}else(r=n.ib)&&(n.ib=null,Oo(e,r,!0,0,!1))}}function No(e,t,n,r){n=void 0!==n&&n,r=void 0===r?0:r,e.b=t,e.h&&(t.video&&Oo(e,t.video,n,r,!1),t.audio&&Oo(e,t.audio,n,r,!1))}function xo(e,t){e.c=t,e.h&&Oo(e,t,!0,0,!1)}function Oo(e,t,n,r,i){var a=e.a.get(t.type);a||t.type!=lr?a&&(a.ib&&(t.trickModeVideo?(a.ib=t,t=t.trickModeVideo):a.ib=null),a.stream!=t||i)&&(t.type==lr&&Ur(e.u.L,Tr(t.mimeType,t.codecs)),a.stream=t,a.ia=null,n&&(a.Ib?a.Ic=!0:a.Na?(a.kb=!0,a.oc=r,a.Ic=!0):(Ho(a),Go(e,a,!0,r).catch((function(t){e.u&&e.u.onError(t)})))),function(e,t){var n,r;return x((function(i){if(1==i.a)return t.ra?(n=t.stream,r=t.ra,n.segmentIndex?i.m(2):T(i,n.createSegmentIndex(),2)):i.return();if(t.ra!=r||t.stream!=n)return i.return();var a=e.u.uc(),o=jr(e.u.L,t.type),s=t.stream.segmentIndex.find(t.wa?t.wa.endTime:a),u=null==s?null:t.stream.segmentIndex.get(s);s=u&&u.Y?u.Y-u.da:null,u&&!s&&(s=(u.endTime-u.startTime)*(t.stream.bandwidth||0)/8),s?((u=u.b)&&(s+=(u.Y?u.Y-u.da:null)||0),a=8*s/(u=e.u.getBandwidthEstimate())<(o||0)-a-Math.max(e.o.minBufferTime||0,e.i.rebufferingGoal)||t.ra.b.a>s):a=!1,a&&t.ra.abort(),_(i)}))}(e,a).catch((function(t){e.u&&e.u.onError(t)}))):function(e,t){var n,r,i,a;x((function(o){switch(o.a){case 1:return n=cr,b(o,2),T(o,Yr(e.u.L,n.$),4);case 4:S(o,3);break;case 2:r=w(o),e.u&&e.u.onError(r);case 3:i=Tr(t.mimeType,t.codecs),Ur(e.u.L,i),(e.u.L.h.isTextVisible()||e.i.alwaysStreamText)&&(a=ko(t),e.a.set(n.$,a),jo(e,a,0)),_(o)}}))}(e,t)}function Po(e,t){t.Ib||t.kb||(t.Na?(t.kb=!0,t.oc=0):null==Gr(e.u.L,t.type)?null==t.Ha&&jo(e,t,0):(Ho(t),Go(e,t,!1,0).catch((function(t){e.u&&e.u.onError(t)}))))}function ko(e){return{stream:e,type:e.type,ia:null,wa:null,wc:null,md:null,ld:null,kd:null,ib:null,endOfStream:!1,Na:!1,Ha:null,kb:!1,oc:0,Ic:!1,Ib:!1,wd:!1,Qb:!1,ra:null}}function Fo(e,t,n,r,i,a){var o;return x((function(s){return 1==s.a?(o=r.closedCaptions&&0<r.closedCaptions.size,null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length&&(new Me).S("emsg",(function(t){var n=r.emsgSchemeIdUris;if(0===t.version)var a=t.reader.Ub(),o=t.reader.Ub(),s=t.reader.I(),u=t.reader.I(),l=t.reader.I(),c=t.reader.I(),d=i.startTime+u/s;else s=t.reader.I(),u=(d=t.reader.gb()/s+i.timestampOffset)-i.startTime,l=t.reader.I(),c=t.reader.I(),a=t.reader.Ub(),o=t.reader.Ub();t=t.reader.Va(t.reader.P.byteLength-t.reader.Z()),n.includes(a)&&("urn:mpeg:dash:event:2012"==a?e.u.kf():(n=new Xi(iu,{detail:{startTime:d,endTime:d+l/s,schemeIdUri:a,value:o,timescale:s,presentationTimeDelta:u,eventDuration:l,id:c,messageData:t}}),e.u.onEvent(n)))})).parse(a),T(s,function(e,t,n){var r,i,a;return x((function(o){if(1==o.a)return r=Math.max(e.i.bufferBehind,e.o.presentationTimeline.a),null==(i=Gr(e.u.L,t.type))||.01>=(a=n-i-r)?o.return():T(o,e.u.L.remove(t.type,i,i+a),2);Mr(e.F),_(o)}))}(e,t,n),2)):3!=s.a?(Mr(e.F),T(s,Kr(e.u.L,t.type,a,i.startTime,i.endTime,o),3)):(Mr(e.F),void _(s))}))}function Uo(e){return e&&e.type==lr&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function Bo(e,t,n,r){var i,a,o,s;return x((function(u){return 1==u.a?(i=oa,a=Do(n.ga(),n.da,n.Y,e.i.retryParameters,r),o=e.u.xb.request(i,a),t.ra=o,T(u,o.promise,2)):(s=u.b,t.ra=null,u.return(s.data))}))}function Go(e,t,n,r){var i,a;return x((function(o){return 1==o.a?(t.kb=!1,t.Ic=!1,t.oc=0,t.Ib=!0,t.wa=null,t.wc=null,t.ia=null,r?(i=e.u.uc(),a=e.u.L.getDuration(),T(o,e.u.L.remove(t.type,i+r,a),3)):T(o,Yr(e.u.L,t.type),4)):3!=o.a?(Mr(e.F),n?T(o,e.u.L.flush(t.type),3):o.m(3)):(Mr(e.F),t.Ib=!1,t.endOfStream=!1,jo(e,t,0),void _(o))}))}function jo(e,t,n){var r=t.type;(r!=lr||e.a.has(r))&&(t.Ha=new Be((function(){var n;return x((function(r){return 1==r.a?(b(r,2),T(r,e.Sb(t),4)):2!=r.a?S(r,0):(n=w(r),e.u&&e.u.onError(n),void _(r))}))})).N(n))}function Ho(e){null!=e.Ha&&(e.Ha.stop(),e.Ha=null)}function Ko(e){return x((function(t){return e.ra?T(t,e.ra.abort(),0):t.m(0)}))}function Yo(e,t){return x((function(n){if(1==n.a)return T(n,Hi(e.j),2);Mr(e.F),e.u.onError(t),t.handled||e.i.failureCallback(t),_(n)}))}function Vo(e,t){var n={B:null,mimeType:null,startTime:null,Id:NaN,uri:null},r=this;this.h=t,this.c=e,this.f=n,this.j=null,this.g=[],this.b=this.a=null,this.l=Promise.resolve().then((function(){return function(e){return x((function(t){if(e.F.a)t=t.m(0);else{if(0==e.g.length||e.a&&!e.a.bb)var n=!1;else{e.a&&(e.a.Da.fb(),e.a=null);var r=(n=e.g.shift()).create(e.f);r?(n.Da.zb(),e.a={node:r.node,payload:r.payload,bb:r.bb,Da:n.Da}):n.Da.Ac(),n=!0}n?n=Promise.resolve():e.a?n=function(e){var t,n;return x((function(r){switch(r.a){case 1:return e.c=e.h.Se(e.c,e.f,e.a.node,e.a.payload),b(r,2),e.b=e.h.Ge(e.c,e.f,e.a.payload),T(r,e.b.promise,4);case 4:e.b=null,e.c==e.a.node&&(e.a.Da.yc(),e.a=null),S(r,0);break;case 2:return 7001==(t=w(r)).code?e.a.Da.fb():e.a.Da.onError(t),e.a=null,e.b=null,n=e,T(r,e.h.handleError(e.f,t),5);case 5:n.c=r.b,_(r)}}))}(e):(e.h.jf(e.c),e.j=new fr,n=e.j),t=T(t,n,1)}return t}))}(r)})),this.F=new Dr((function(){return function(e){var t,n;return x((function(r){if(1==r.a)return e.b&&e.b.abort(),Wo(e),T(r,e.l,2);for(e.a&&e.a.Da.fb(),t=l(e.g),n=t.next();!n.done;n=t.next())n.value.Da.fb();e.a=null,e.g=[],e.h=null,_(r)}))}(r)}))}function qo(e,t){var n={zb:function(){},yc:function(){},fb:function(){},onError:function(){},Ac:function(){},qg:function(){}};return e.g.push({create:t,Da:n}),e.b&&e.b.abort(),Wo(e),n}function Wo(e){e.j&&(e.j.resolve(),e.j=null)}function zo(e){this.a=null;for(var t=l(Array.from(e.textTracks)),n=t.next();!n.done;n=t.next())(n=n.value).mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n);this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function Xo(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function Qo(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var r=l(Array.from(e.cues)),i=r.next();!i.done;i=r.next())(i=i.value)&&t(i)&&e.removeCue(i);e.mode=n}function Jo(){}function Zo(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function $o(e,t){var n=this;this.h=!1,this.c=[],this.a=e,this.g=t,this.b=document.createElement("div"),this.b.classList.add("shaka-text-container"),this.b.style.textAlign="center",this.b.style.display="flex",this.b.style.flexDirection="column",this.b.style.alignItems="center",this.b.style.justifyContent="flex-end",this.g.appendChild(this.b),this.j=new Ge((function(){es(n)})).xa(.25),this.f=new Map}function es(e){function t(t){return e.c.includes(t)&&e.h&&t.startTime<=n&&t.endTime>n}for(var n=e.a.currentTime,r=l(e.f.keys()),i=r.next();!i.done;i=r.next())if(!t(i=i.value)){var a=e.f.get(i);e.b.removeChild(a),e.f.delete(i)}for(r=new Set(e.f.values()),a=(i=l(Array.from(e.b.childNodes))).next();!a.done;a=i.next())a=a.value,r.has(a)||e.b.removeChild(a);for(i=(r=l(r=e.c.filter((function(n){return t(n)&&!e.f.has(n)})).sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})))).next();!i.done;i=r.next())i=i.value,a=ts(e,e.b,i,!1),e.f.set(i,a)}function ts(e,t,n,r){var i=r?"span":"div";(n.lineBreak||n.spacer)&&(n.spacer&&be("shaka.extern.Cue","Please use lineBreak instead of spacer."),i="br");var a=document.createElement(i);if("br"!=i)for(function(e,t,n,r){var i=t.style,a=0==n.nestedCues.length;i.whiteSpace="pre-wrap";var o=n.payload.replace(/\s+$/g,(function(e){return" ".repeat(e.length)}));r?t.textContent=o:o.length&&((i=document.createElement("span")).textContent=o,t.appendChild(i),i=i.style),i.backgroundColor=n.backgroundColor,i.border=n.border,i.color=n.color,i.direction=n.direction,i.opacity=n.opacity,i.paddingLeft=ns(n.linePadding,n,e.g),i.paddingRight=ns(n.linePadding,n,e.g),n.backgroundImage&&(i.backgroundImage="url('"+n.backgroundImage+"')",i.backgroundRepeat="no-repeat",i.backgroundSize="contain",i.backgroundPosition="center",""==n.backgroundColor&&(i.backgroundColor="transparent")),i.verticalAlign="before"==n.displayAlign?"top":"center"==n.displayAlign?"middle":"bottom",a||(i.margin="0"),i.fontFamily=n.fontFamily,i.fontWeight=n.fontWeight.toString(),i.fontStyle=n.fontStyle,i.letterSpacing=n.letterSpacing,i.fontSize=ns(n.fontSize,n,e.g),n.line?1==n.lineInterpretation&&(i.position="absolute",n.writingMode==Et?n.lineAlign==_t?i.top=n.line+"%":"end"==n.lineAlign&&(i.bottom=n.line+"%"):"vertical-lr"==n.writingMode?n.lineAlign==_t?i.left=n.line+"%":"end"==n.lineAlign&&(i.right=n.line+"%"):n.lineAlign==_t?i.right=n.line+"%":"end"==n.lineAlign&&(i.left=n.line+"%")):n.region&&n.region.id&&(!r&&!a||n.backgroundImage)&&(e=n.region.widthUnits==Dt?"%":"px",t=n.region.viewportAnchorUnits==Dt?"%":"px",i.height=n.region.height+(n.region.heightUnits==Dt?"%":"px"),i.width=n.region.width+e,i.position="absolute",i.top=n.region.viewportAnchorY+t,i.left=n.region.viewportAnchorX+t),i.lineHeight=n.lineHeight,n.position&&(n.writingMode==Et?i.paddingLeft=n.position:i.paddingTop=n.position),"line-left"==n.positionAlign?i.cssFloat="left":"line-right"==n.positionAlign&&(i.cssFloat="right"),i.textAlign=n.textAlign,i.textDecoration=n.textDecoration.join(" "),i.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&i.writingMode==n.writingMode||(i.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==Et?i.width=n.size+"%":i.height=n.size+"%")}(e,a,n,r),r=(n=l(n.nestedCues)).next();!r.done;r=n.next())ts(e,a,r.value,!0);return t.appendChild(a),a}function ns(e,t,n){var r=(r=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(r[1]),Gf:r[2]}:null;if(!r)return e;var i=r.value;switch(r.Gf){case"%":return i/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*i/t.cellResolution.rows+"px";default:return e}}function rs(){}function is(e,t,n,r,i){var a,o=i in r,s=!0;for(a in t){var u=i+"."+a,l=o?r[i]:n[a];o||a in n?void 0===t[a]?void 0===l||o?delete e[a]:e[a]=Ji(l):l.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Ji(l)),u=is(e[a],t[a],l,r,u),s=s&&u):typeof t[a]!=typeof l||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=l.constructor?(q("Invalid config, wrong type for "+u),s=!1):("function"==typeof n[a]&&n[a].length!=t[a].length&&W("Unexpected number of arguments for "+u),e[a]=t[a]):(q("Invalid config, unrecognized key "+u),s=!1)}return s}function as(e,t){for(var n={},r=n,i=0,a=0;!(0>(i=e.indexOf(".",i)));)0!=i&&"\\"==e[i-1]||(r[a=e.substring(a,i).replace(/\\\./g,".")]={},r=r[a],a=i+1),i+=1;return r[e.substring(a).replace(/\\\./g,".")]=t,n}function os(){}function ss(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Ca,logLicenseExchange:!1,updateExpirationTime:1},n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"}},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function(e){return[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1};(navigator.userAgent.match(/Edge\//)||Ke()||Ye())&&(r.gapDetectionThreshold=.5),(We("Web0S")||Ke()||Ye())&&(r.stallSkip=0);var i={trackSelectionCallback:function(e){return x((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return x((function(n){return 1==n.a?navigator.storage&&navigator.storage.estimate?T(n,navigator.storage.estimate(),3):n.return(!0):(t=n.b,n.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},a={drm:t,manifest:n,streaming:r,offline:i,abrFactory:function(){return new Ci},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferForcedSubs:!1,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,useMediaCapabilities:!1,textDisplayFactory:function(){return null}};return i.trackSelectionCallback=function(e){return x((function(t){return t.return(function(e,t){var n=e.filter((function(e){return"variant"==e.type})),r=[],i=ii(t,n.map((function(e){return e.language})));i&&(r=n.filter((function(e){return ti(e.language)==i}))),0==r.length&&(r=n.filter((function(e){return e.primary}))),0==r.length&&(n.map((function(e){return e.language})),r=n);var a=r.filter((function(e){return e.height&&480>=e.height}));if(a.length&&(a.sort((function(e,t){return t.height-e.height})),r=a.filter((function(e){return e.height==a[0].height}))),n=[],r.length){var o=Math.floor(r.length/2);r.sort((function(e,t){return e.bandwidth-t.bandwidth})),n.push(r[o])}for(o=(r=l(e)).next();!o.done;o=r.next())(o=o.value).type!=lr&&"image"!=o.type||n.push(o);return n}(e,a.preferredAudioLanguage))}))},a}function us(e,t,n){var r={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return is(e,t,n||ss(),r,"")}function ls(){this.a=null,this.b=[]}function cs(e,t){if(null==e.a)e.a={timestamp:Date.now()/1e3,state:t,duration:0};else{var n=Date.now()/1e3;e.a.duration=n-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:n,state:t,duration:0})}}function ds(e,t){var n=0;e.a&&e.a.state==t&&(n+=e.a.duration);for(var r=l(e.b),i=r.next();!i.done;i=r.next())n+=(i=i.value).state==t?i.duration:0;return n}function fs(){this.b=this.c=null,this.a=[]}function hs(e,t,n){e.c!=t&&(e.c=t,e.a.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth}))}function ps(e,t,n){e.b!=t&&(e.b=t,e.a.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function gs(){this.h=this.j=this.C=this.v=this.D=this.f=this.A=this.g=this.c=this.H=this.J=this.M=this.l=this.T=NaN,this.b=new ls,this.a=new fs}function ms(t,n){Qi.call(this);var r=this;this.g=wu,this.lc=this.a=null,this.T=!1,this.b=new xr,this.Wc=this.l=this.Ra=this.o=this.jc=this.j=this.c=this.kc=this.C=this.Ya=this.A=this.Aa=this.v=this.D=this.h=this.K=null,this.bd=1e9,this.i=ws(this),this.$c={width:1/0,height:1/0},this.f=null,this.ja=new ki(this.i.preferredAudioLanguage,this.i.preferredVariantRole,this.i.preferredAudioChannelCount),this.ka=this.i.preferredTextLanguage,this.fc=this.i.preferredTextRole,this.ec=this.i.preferForcedSubs,this.Xc=[],n&&n(this),this.K=function(e){return new ta((function(t,n){e.l&&e.l.segmentDownloaded(t,n)}))}(this),this.K.Ed(this.i.streaming.forceHTTPS),this.H=null,Lu&&(this.H=De(Lu)),this.b.s(e,"online",(function(){r.xd()})),this.na={name:"detach"},this.Ka={name:"attach"},this.M={name:"unload"},this.dd={name:"manifest-parser"},this.Jc={name:"manifest"},this.za={name:"media-source"},this.Yc={name:"drm-engine"},this.J={name:"load"},this.ed={name:"src-equals-drm-engine"},this.Ia={name:"src-equals"};var i=new Map;i.set(this.Ka,(function(e,t){return Wi(function(e,t,n){return null==t.B&&(t.B=n.B,e.b.s(t.B,"error",(function(){var t=Hs(e);t&&Gs(e,t)}))),e.a=t.B,Promise.resolve()}(r,e,t))})),i.set(this.na,(function(e){return e.B&&(r.b.ya(e.B,"error"),e.B=null),r.a=null,Wi(e=Promise.resolve())})),i.set(this.M,(function(e){return Wi(ys(r,e))})),i.set(this.za,(function(e){return Wi(e=function(e,t){var n,r,i,a;return x((function(o){if(1==o.a)return n=new Bn,r=e.i.textDisplayFactory,i=De(r),e.Zc=r,T(o,(a=function(e,t,n,r){return new kr(e,t,n,r)}(t.B,n,i,(function(t,n,r){for(var i=(t=l(t)).next();!i.done;i=t.next())if((i=i.value).data&&i.cueTime&&i.frames){for(var a=i.cueTime+n,o=r,s=l(i.frames),u=s.next();!u.done;u=s.next())Es(e,a,o,"ID3",u.value);e.H&&e.H.onHlsTimedMetadata(i,a)}}))).A,2);e.D=a,_(o)}))}(r,e))})),i.set(this.dd,(function(e,t){return Wi(function(e,t,n){var r,i,a,o;return x((function(s){if(1==s.a)return t.mimeType=n.mimeType,t.uri=n.uri,r=t.uri,i=e.K,e.Ra=r,a=e,T(s,Ha(r,i,e.i.manifest.retryParameters,t.mimeType),2);a.jc=s.b,e.j=De(e.jc),o=Ji(e.i.manifest),n.B&&"AUDIO"===n.B.nodeName&&(o.disableVideo=!0),e.j.configure(o),_(s)}))}(r,e,t))})),i.set(this.Jc,(function(e){return function(e,t){var n=t.uri,r=e.K;e.kc=new So((function(){return e.zd()})),function(e,t){e.b=t}(e.kc,(function(t){js(e,vu,t),e.H&&e.H.onDashTimedMetadata(t)}));var i={networkingEngine:r,filter:function(t){return x((function(n){return n.return(e.qc(t))}))},makeTextStreamsForClosedCaptions:function(t){return function(e,t){for(var n=new Set,r=l(t.textStreams),i=r.next();!i.done;i=r.next())"application/cea-608"!=(i=i.value).mimeType&&"application/cea-708"!=i.mimeType||n.add(i.originalId);for(i=(r=l(t.variants)).next();!i.done;i=r.next())if((i=i.value.video)&&i.closedCaptions)for(var a=l(i.closedCaptions.keys()),o=a.next();!o.done;o=a.next())if(o=o.value,!n.has(o)){var s=o.startsWith("CC")?"application/cea-608":"application/cea-708",u=new Eo;s={id:e.bd++,originalId:o,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:u,mimeType:s,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:i.closedCaptions.get(o),label:null,type:lr,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:i.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},t.textStreams.push(s),n.add(o)}}(e,t)},onTimelineRegionAdded:function(t){var n=e.kc;e:{for(var r=l(n.a),i=r.next();!i.done;i=r.next())if((i=i.value).schemeIdUri==t.schemeIdUri&&i.id==t.id&&i.startTime==t.startTime&&i.endTime==t.endTime){r=i;break e}r=null}null==r&&(n.a.add(t),n.b(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return Gs(e,t)},isLowLatencyMode:function(){return e.i.streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return e.i.streaming.autoLowLatencyMode},enableLowLatencyMode:function(){e.configure("streaming.lowLatencyMode",!0)}},a=Date.now()/1e3;return new Ki(function(){var t,r,o,s;return x((function(u){if(1==u.a)return t=e,T(u,e.j.start(n,i),2);if(t.o=u.b,r=vs(lu),e.dispatchEvent(r),0==e.o.variants.length)throw new le(2,4,4036);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}(e.o),o=Date.now()/1e3,s=o-a,e.f.A=s,_(u)}))}(),(function(){return e.j.stop()}))}(r,e)})),i.set(this.Yc,(function(e){return Wi(e=function(e,t){var n,r;return x((function(i){return 1==i.a?(n=Date.now()/1e3,r=!0,e.h=Ts(e,{xb:e.K,onError:function(t){Gs(e,t)},zc:function(t){Ks(e,t)},onExpirationUpdated:function(t,n){Ys(e,t,n)},onEvent:function(t){e.dispatchEvent(t),t.type==ru&&r&&(r=!1,e.f.f=Date.now()/1e3-n)}}),e.i.useMediaCapabilities||di(e.o),e.h.configure(e.i.drm),T(i,ma(e.h,e.o.variants,e.o.offlineSessionIds,e.i.useMediaCapabilities),2)):3!=i.a?T(i,e.h.Hb(t.B),3):T(i,e.qc(e.o),0)}))}(r,e))})),i.set(this.J,(function(e,t){return Wi(function(e,t,n){var r,i,a,o,s,u,c,d,f,h;return x((function(p){switch(p.a){case 1:if(t.startTime=n.startTime,r=t.B,i=t.uri,e.Ra=i,e.A=new To({vc:function(){return t.B.playbackRate},sc:function(){return t.B.defaultPlaybackRate},Gd:function(e){t.B.playbackRate=e},Zd:function(e){t.B.currentTime+=e}}),a=function(){return Ds(e)},o=function(){return Cs(e)},e.b.s(r,"playing",a),e.b.s(r,"pause",a),e.b.s(r,"ended",a),e.b.s(r,"ratechange",o),s=e.i.abrFactory,e.l&&e.Wc==s||(e.Wc=s,e.l=De(s),"function"!=typeof e.l.playbackRateChanged&&(be("AbrManager","Please use an AbrManager with playbackRateChanged function."),e.l.playbackRateChanged=function(){}),e.l.configure(e.i.abr)),e.ja=new ki(e.i.preferredAudioLanguage,e.i.preferredVariantRole,e.i.preferredAudioChannelCount),e.ka=e.i.preferredTextLanguage,Vs(e.o.presentationTimeline,e.i.playRangeStart,e.i.playRangeEnd),e.l.init((function(t,n,r){n=void 0!==n&&n,r=void 0===r?0:r,e.c&&t!=e.c.b&&(hs(e.f.a,t,!0),No(e.c,t,n,r),Os(e))})),e.v=function(e,t){return new fo(e.a,e.o,e.i.streaming,t,(function(){if(e.Aa&&Ao(e.Aa,!0),e.c)for(var t=e.c,n=t.u.uc(),r=t.i.smallGapLimit,i=l(t.a.keys()),a=i.next();!a.done;a=i.next()){a=a.value;var o=t.a.get(a);o.ia=null;var s=t.u.L;if(!(s=a==lr?null!=(s=s.c).a&&null!=s.b&&n>=s.a&&n<s.b:Hn(s=Hr(s,a),n,r))&&(null!=jr(t.u.L,a)&&Po(t,o),o.ra&&(o.ra.abort(),o.ra=null),a===lr))for((a=t.u.L.v.a).g=0,a.b=[],a.a=[],(o=a.c).c=[],o.b=[],o.a=0,Cn(a),o=(a=l(a.f.values())).next();!o.done;o=a.next())Zt(o.value)}e.C&&bs(e)}),(function(t){return e.dispatchEvent(t)}))}(e,t.startTime),e.Aa=function(e){var t=new wo(e.kc);!function(e,t,n,r){e.a=t,e.b=n,e.c=r}(t,(function(t){js(e,yu,t)}),(function(t){js(e,Eu,t)}),(function(t,n){n||(js(e,yu,t),js(e,Eu,t))}));var n=new bo(e.a);return n.a.add(t),n}(e),u=Math.max(e.o.minBufferTime,e.i.streaming.rebufferingGoal),_s(e,u),oi(e.o,e.i.preferredAudioChannelCount),e.c=function(e){return new Mo(e.o,{uc:function(){return e.v.g()},getBandwidthEstimate:function(){return e.l.getBandwidthEstimate()},L:e.D,xb:e.K,onError:function(t){return Gs(e,t)},onEvent:function(t){return e.dispatchEvent(t)},kf:function(){e.j&&e.j.update&&e.j.update()},td:function(){e.v&&e.v.v(),bs(e)}})}(e),e.c.configure(e.i.streaming),e.g=Iu,e.dispatchEvent(vs(pu)),c=Ms(e)?e.l.chooseVariant():null,hs(e.f.a,c,!0),No(e.c,c,!1,0),(d=Si(e.o.textStreams,e.ka,e.fc,e.ec)[0]||null)&&ps(e.f.a,d,!0),d?(c.audio&&function(e,t,n){return e=ti(e.i.preferredTextLanguage),t=ti(t.language),Zr(n=ti(n.language),e)&&!Zr(t,n)}(e,c.audio,d)&&(e.T=!0),e.T&&e.D.h.setTextVisibility(!0),Us(e)):e.T=!1,d&&(e.i.streaming.alwaysStreamText||e.jd())&&xo(e.c,d),!e.i.streaming.startAtSegmentBoundary){p.m(2);break}return f=e.v.g(),T(p,function(e,t){var n,r,i,a,o;return x((function(s){return 1==s.a?(n=e.audio,r=e.video,i=function(e,t){var n,r;return x((function(i){return 1==i.a?e?T(i,e.createSegmentIndex(),2):i.return(null):(n=e.segmentIndex[Symbol.iterator]().seek(t))?(r=n.startTime,i.return(r)):i.return(null)}))},T(s,i(n,t),2)):3!=s.a?(a=s.b,T(s,i(r,t),3)):null!=(o=s.b)&&null!=a?s.return(Math.max(o,a)):null!=o?s.return(o):null!=a?s.return(a):s.return(t)}))}(c,f),3);case 3:h=p.b,e.v.l(h);case 2:return T(p,e.c.start(),4);case 4:e.i.abr.enabled&&(e.l.enable(),Bs(e)),pi(e.c?e.c.b:null,e.o),Ws(e.o),Ps(e),Os(e),Ms(e),e.o.variants.some((function(e){return e.primary})),e.b.qa(r,"loadedmetadata",(function(){e.f.g=Date.now()/1e3-n.Id})),_(p)}}))}(r,e,t))})),i.set(this.ed,(function(e){return Wi(e=function(e,t){var n,r,i,a;return x((function(o){return 1==o.a?(n=cr,r=Date.now()/1e3,i=!0,e.h=Ts(e,{xb:e.K,onError:function(t){Gs(e,t)},zc:function(t){Ks(e,t)},onExpirationUpdated:function(t,n){Ys(e,t,n)},onEvent:function(t){e.dispatchEvent(t),t.type==ru&&i&&(i=!1,e.f.f=Date.now()/1e3-r)}}),e.h.configure(e.i.drm),a={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"video/mp4",codecs:"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",label:null,type:n.Ja,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},T(o,ma(e.h,[a],[]),2)):T(o,e.h.Hb(t.B),0)}))}(r,e))})),i.set(this.Ia,(function(e,t){return function(e,t,n){function r(){return Ds(e)}t.uri=n.uri,t.startTime=n.startTime,e.Ra=t.uri,e.v=new co(t.B),null!=t.startTime&&e.v.l(t.startTime),e.A=new To({vc:function(){return t.B.playbackRate},sc:function(){return t.B.defaultPlaybackRate},Gd:function(e){t.B.playbackRate=e},Zd:function(e){t.B.currentTime+=e}}),_s(e,e.i.streaming.rebufferingGoal),e.b.s(t.B,"playing",r),e.b.s(t.B,"pause",r),e.b.s(t.B,"ended",r),e.b.s(t.B,"ratechange",(function(){return Cs(e)})),"none"!=e.a.preload&&e.b.qa(e.a,"loadedmetadata",(function(){e.f.g=Date.now()/1e3-n.Id})),e.a.audioTracks&&(e.b.s(e.a.audioTracks,"addtrack",(function(){return Ps(e)})),e.b.s(e.a.audioTracks,"removetrack",(function(){return Ps(e)})),e.b.s(e.a.audioTracks,"change",(function(){return Ps(e)}))),e.a.textTracks&&(e.b.s(e.a.textTracks,"addtrack",(function(t){Ps(e),function(e,t){var n=t.track;"metadata"==n.kind&&(n.mode="hidden",e.b.s(n,"cuechange",(function(){if(n.activeCues)for(var t=l(n.activeCues),r=t.next();!r.done;r=t.next())r=r.value,Es(e,r.startTime,r.endTime,r.type,r.value),e.H&&e.H.onCueMetadataChange(r.value)})),new Ge((function(){for(var t=function(e){return Array.from(e.a.textTracks).filter((function(e){return"metadata"==e.kind}))}(e),n=(t=l(t)).next();!n.done;n=t.next())n.value.mode="hidden"})).Yb().N(.5))}(e,t)})),e.b.s(e.a.textTracks,"removetrack",(function(){return Ps(e)})),e.b.s(e.a.textTracks,"change",(function(){return Ps(e)}))),t.B.src=t.uri,(Ke()||We("Web0S"))&&t.B.load(),e.g=Ru,e.dispatchEvent(vs(pu));var i=new fr;to(e.a,HTMLMediaElement.HAVE_METADATA,e.b,(function(){i.resolve()}));var a=!1;return e.Xc.push((function(){a=!0})),to(e.a,HTMLMediaElement.HAVE_CURRENT_DATA,e.b,(function(){return x((function(t){return 1==t.a?a?t.return():(function(e){var t=e.i.preferredAudioLanguage;if(""!=t){e.Bd(t);var n=e.i.preferredVariantRole;""!=n&&e.Bd(t,n)}}(e),Ss(e).find((function(e){return"disabled"!=e.mode}))?t.m(2):T(t,new Promise((function(t){e.b.qa(e.a.textTracks,"change",t),new Ge(t).N(1)})),2)):a?t.return():(function(e){var t=e.i.preferredTextLanguage,n=e.i.preferForcedSubs;if(""!=t){e.Cd(t,"",n);var r=e.i.preferredTextRole;""!=r&&e.Cd(t,r,n)}}(e),void _(t))}))})),e.a.error?i.reject(Hs(e)):"none"==e.a.preload&&(W('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),i.resolve()),e.b.qa(e.a,"error",(function(){i.reject(Hs(e))})),new Ki(i,(function(){return i.reject(new le(2,7,7001)),Promise.resolve()}))}(r,e,t)})),this.X=new Vo(this.na,{Se:function(e,t,n,i){var a=null;return e==r.na&&(a=n==r.na?r.na:r.Ka),e==r.Ka&&(a=n==r.na||t.B!=i.B?r.na:n==r.Ka?r.Ka:n==r.za||n==r.J?r.za:n==r.Ia?r.ed:null),e==r.za&&(a=n==r.J&&t.B==i.B?r.dd:r.M),e==r.dd&&(a=Zs(r.J,r.Jc,r.M,n,t,i)),e==r.Jc&&(a=Zs(r.J,r.Yc,r.M,n,t,i)),e==r.Yc&&(a=Zs(r.J,r.J,r.M,n,t,i)),e==r.ed&&(a=n==r.Ia&&t.B==i.B?r.Ia:r.M),e!=r.J&&e!=r.Ia||(a=r.M),e==r.M&&(a=i.B&&t.B==i.B?r.Ka:r.na),a},Ge:function(e,t,n){return r.dispatchEvent(vs(du,{state:e.name})),i.get(e)(t,n)},handleError:function(e){return x((function(t){return 1==t.a?T(t,ys(r,e),2):t.return(e.B?r.Ka:r.na)}))},jf:function(e){r.dispatchEvent(vs(fu,{state:e.name}))}}),t&&this.Hb(t,!0)}function vs(e,t){return new Xi(e,t)}function ys(e,t){var n,r,i,a,o,s,u,c,d;return x((function(f){switch(f.a){case 1:return e.g!=Su&&(e.g=wu),n=e.Xc.map((function(e){return e()})),e.Xc=[],T(f,Promise.all(n),2);case 2:if(e.dispatchEvent(vs(_u)),t.mimeType=null,t.startTime=null,t.uri=null,t.B&&(e.b.ya(t.B,"loadedmetadata"),e.b.ya(t.B,"playing"),e.b.ya(t.B,"pause"),e.b.ya(t.B,"ended"),e.b.ya(t.B,"ratechange")),e.Aa&&(e.Aa.release(),e.Aa=null),e.Ya&&(e.Ya.stop(),e.Ya=null),!e.j){f.m(3);break}return T(f,e.j.stop(),4);case 4:e.j=null,e.jc=null;case 3:if(!e.l){f.m(5);break}return T(f,e.l.stop(),5);case 5:if(!e.c){f.m(7);break}return T(f,e.c.destroy(),8);case 8:e.c=null;case 7:if(e.A&&(e.A.release(),e.A=null),e.v&&(e.v.release(),e.v=null),!e.D){f.m(9);break}return T(f,e.D.destroy(),10);case 10:e.D=null;case 9:if(e.H&&e.H.onAssetUnload(),!t.B||!t.B.src){f.m(11);break}return T(f,new Promise((function(e){return new Ge(e).N(.1)})),12);case 12:for(t.B.removeAttribute("src"),t.B.load();t.B.lastChild;)t.B.removeChild(t.B.firstChild);case 11:if(!e.h){f.m(13);break}return T(f,e.h.destroy(),14);case 14:e.h=null;case 13:if(e.Ra=null,e.C=null,e.o){for(r=l(e.o.variants),i=r.next();!i.done;i=r.next())for(a=i.value,o=l([a.audio,a.video]),s=o.next();!s.done;s=o.next())(u=s.value)&&u.segmentIndex&&u.segmentIndex.release();for(c=l(e.o.textStreams),s=c.next();!s.done;s=c.next())(d=s.value).segmentIndex&&d.segmentIndex.release()}e.o=null,e.f=new gs,e.Zc=null,Rs(e),_(f)}}))}function Es(e,t,n,r,i){e.dispatchEvent(vs(cu,{startTime:t,endTime:n,mg:r,payload:i}))}function Ts(e,t){return new ga(t,e.i.drm.updateExpirationTime)}function _s(e,t){e.C=new Fi,e.C.a=Bi,Ui(e.C,t,Math.min(.5,t/2)),Rs(e),e.Ya=new Ge((function(){bs(e)})).xa(.25)}function bs(e){switch(e.g){case Ru:if(e.a.ended)var t=!0;else{var n=jn(e.a.buffered);t=null!=n&&n>=e.a.duration-1}break;case Iu:e:if(e.a.ended||Br(e.D))t=!0;else{if(e.o.presentationTimeline.U()){n=e.o.presentationTimeline.Ta();var r=jn(e.a.buffered);if(null!=r&&r>=n){t=!0;break e}}t=!1}break;default:t=!1}r=Kn(e.a.buffered,e.a.currentTime);var i=t,a=(n=e.C).b.get(n.a);t=n.a,r=i||r>=a?Gi:Bi,n.a=r,t!=r&&Rs(e)}function As(e){if(e.j){var t=Ji(e.i.manifest);e.a&&"AUDIO"===e.a.nodeName&&(t.disableVideo=!0),e.j.configure(t)}if(e.h&&e.h.configure(e.i.drm),e.c){e.c.configure(e.i.streaming);try{Is(e,e.o)}catch(t){Gs(e,t)}e.l&&Ms(e),!(t=e.c.b)||t.allowedByApplication&&t.allowedByKeySystem||Ls(e)}if(e.K&&e.K.Ed(e.i.streaming.forceHTTPS),e.D&&(t=e.i.textDisplayFactory,e.Zc!=t)){var n=De(t),r=e.D,i=r.h;r.h=n,i&&(n.setTextVisibility(i.isTextVisible()),i.destroy()),r.c&&(r.c.c=n),e.Zc=t,e.c&&(n=(t=e.c).a.get(lr))&&Oo(t,n.stream,!0,0,!0)}e.l&&(e.l.configure(e.i.abr),e.i.abr.enabled?e.l.enable():e.l.disable(),Bs(e)),e.C&&(t=e.i.streaming.rebufferingGoal,e.o&&(t=Math.max(t,e.o.minBufferTime)),Ui(e.C,t,Math.min(.5,t/2))),e.o&&Vs(e.o.presentationTimeline,e.i.playRangeStart,e.i.playRangeEnd)}function Ss(e){return Array.from(e.a.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function ws(e){var t=ss();return t.streaming.failureCallback=function(t){e.U()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,e.xd())},t.textDisplayFactory=function(){return e.lc?new $o(e.a,e.lc):new zo(e.a)},t}function Is(e,t){if(e.g!=Su){for(var n=e.i.restrictions,r=e.$c,i=!1,a=l(t.variants),o=a.next();!o.done;o=a.next()){var s=(o=o.value).allowedByApplication;o.allowedByApplication=ui(o,n,r),s!=o.allowedByApplication&&(i=!0)}if(i&&e.c&&Ps(e),(n=e.h?e.h.c:null)&&e.h.h)for(i=(r=l(t.variants)).next();!i.done;i=r.next())for(a=(i=l(((i=i.value).video?i.video.drmInfos:[]).concat(i.audio?i.audio.drmInfos:[]))).next();!a.done;a=i.next())if((a=a.value).keySystem==n.keySystem)for(o=(a=l(a.initData||[])).next();!o.done;o=a.next())o=o.value,Ta(e.h,o.initDataType,o.initData);qs(e,t)}}function Rs(e){var t=e.hd();if(e.f&&e.C&&e.v){var n=e.A;n.f=t,_o(n),Ds(e)}e.dispatchEvent(vs(nu,{buffering:t}))}function Cs(e){var t=e.a.playbackRate;0!=t&&(e.A&&e.A.set(t),t=vs(hu),e.dispatchEvent(t))}function Ds(e){if(e.f&&e.C){var t=e.f.b;e.C.a==Bi?cs(t,"buffering"):e.a.paused?cs(t,"paused"):e.a.ended?cs(t,"ended"):cs(t,"playing")}}function Ms(e){try{qs(e,e.o)}catch(t){return Gs(e,t),!1}var t=e.o.variants.filter((function(e){return bi(e)}));return t=e.ja.create(t),e.l.setVariants(Array.from(t.values())),!0}function Ls(e){var t;(t=Ms(e)?e.l.chooseVariant():null)&&(Ns(e,t,!0,!0,0),Os(e))}function Ns(e,t,n,r,i){var a=e.c.b;t!=a&&(hs(e.f.a,t,n),No(e.c,t,r,i),n=null,a&&(n=mi(a)),ks(e,n,t=mi(t)))}function xs(e,t){var n=Array.from(e.a.audioTracks).find((function(e){return e.enabled}));t.enabled=!0,ks(e,n=Ti(n),Ti(t))}function Os(e){zs(e,vs(tu))}function Ps(e){zs(e,vs(Tu))}function ks(e,t,n){zs(e,t=vs(bu,{pg:t,og:n}))}function Fs(e){zs(e,vs(gu))}function Us(e){zs(e,vs(mu))}function Bs(e){zs(e,vs(eu,{ng:e.i.abr.enabled}))}function Gs(e,t){if(e.g!=Su){var n=vs(au,{detail:t});e.dispatchEvent(n),n.defaultPrevented&&(t.handled=!0)}}function js(e,t,n){e.dispatchEvent(vs(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function Hs(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var n=e.a.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new le(2,3,3016,t,n,e.a.error.message)}function Ks(e,t){if(e.c){var n=Object.keys(t),r=1==n.length&&"00"==n[0],i=!1;if(n.length)for(var a=(n=l(e.o.variants)).next();!a.done;a=n.next()){var o=[];(a=a.value).audio&&o.push(a.audio),a.video&&o.push(a.video);for(var s=(o=l(o)).next();!s.done;s=o.next()){var u=s.value;if(s=a.allowedByKeySystem,u.keyIds.size){a.allowedByKeySystem=!0;for(var c=(u=l(u.keyIds)).next();!c.done;c=u.next())c=c.value,c=t[r?"00":c],a.allowedByKeySystem=a.allowedByKeySystem&&!!c&&!Du.includes(c)}s!=a.allowedByKeySystem&&(i=!0)}}i&&Ms(e),(r=e.c.b)&&!r.allowedByKeySystem&&Ls(e),i&&Ps(e)}}function Ys(e,t,n){e.j&&e.j.onExpirationUpdated&&e.j.onExpirationUpdated(t,n),t=vs(ou),e.dispatchEvent(t)}function Vs(e,t,n){0<t&&(e.U()||e.me(t)),n<(t=e.getDuration())&&(e.U()||e.Fa(n))}function qs(e,t){var n=e.h?e.h.tc():{},r=Object.keys(n);r=r.length&&"00"==r[0];for(var i=!1,a=!1,o=new Set,s=new Set,u=l(t.variants),c=u.next();!c.done;c=u.next()){var d=[];(c=c.value).audio&&d.push(c.audio),c.video&&d.push(c.video);for(var f=(d=l(d)).next();!f.done;f=d.next())if((f=f.value).keyIds.size)for(var h=(f=l(f.keyIds)).next();!h.done;h=f.next()){h=h.value;var p=n[r?"00":h];p?Du.includes(p)&&s.add(p):o.add(h)}c.allowedByApplication?c.allowedByKeySystem&&(i=!0):a=!0}if(!i)throw new le(2,4,4012,n={hasAppRestrictions:a,missingKeys:Array.from(o),restrictedKeyStatuses:Array.from(s)})}function Ws(e){if(!e.variants.some(bi))throw new le(2,4,4032)}function zs(e,t){x((function(n){if(1==n.a)return T(n,Promise.resolve(),2);e.g!=Su&&e.dispatchEvent(t),_(n)}))}function Xs(e){for(var t=new Set,n=(e=l(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(ti(n.language)):t.add("und");return t}function Qs(e){for(var t=new Map,n=new Map,r=(e=l(e)).next();!r.done;r=e.next()){var i="und",a=[];(r=r.value).language&&(i=ti(r.language)),(a="variant"==r.type?r.audioRoles:r.roles)&&a.length||(a=[""]),t.has(i)||t.set(i,new Set);for(var o=(a=l(a)).next();!o.done;o=a.next())o=o.value,t.get(i).add(o),r.label&&(n.has(i)||n.set(i,new Map),n.get(i).set(o,r.label))}var s=[];return t.forEach((function(e,t){for(var r=l(e),i=r.next();!i.done;i=r.next()){i=i.value;var a=null;n.has(t)&&n.get(t).has(i)&&(a=n.get(t).get(i)),s.push({language:t,role:i,label:a})}})),s}function Js(){return new le(2,7,7e3)}function Zs(e,t,n,r,i,a){return r==e&&i.B==a.B&&i.uri==a.uri&&i.mimeType==a.mimeType?t:n}function $s(e){return new Promise((function(t,n){e.fb=function(){return n(Js())},e.yc=function(){return t()},e.onError=function(e){return n(e)},e.Ac=function(){return n(Js())}}))}Mo.prototype.destroy=function(){return this.F.destroy()},Mo.prototype.configure=function(e){this.i=e,this.j=new ji({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0)},Mo.prototype.start=function(){var e=this;return x((function(t){if(1==t.a)return T(t,function(e){var t,n,r,i,a,o,s,u,c,d;return x((function(f){if(1==f.a){if(t=cr,!e.b)throw new le(2,5,5006);return n=new Map,r=new Set,e.b.audio&&(n.set(t.Xa,e.b.audio),r.add(e.b.audio)),e.b.video&&(n.set(t.Ja,e.b.video),r.add(e.b.video)),e.c&&(n.set(t.$,e.c),r.add(e.c)),i=e.u.L,a=e.i.forceTransmuxTS,T(f,i.init(n,a),2)}Mr(e.F);var h=e.o.presentationTimeline.getDuration();for(1/0>h?e.u.L.Fa(h):e.u.L.Fa(Math.pow(2,32)),o=l(n.keys()),s=o.next();!s.done;s=o.next())u=s.value,c=n.get(u),e.a.has(u)||(d=ko(c),e.a.set(u,d),jo(e,d,0));_(f)}))}(e),2);Mr(e.F),e.h=!0,_(t)}))},Mo.prototype.Sb=function(t){var n,r,i,a,o,s=this;return x((function(u){switch(u.a){case 1:if(Mr(s.F),t.Na||null==t.Ha||t.Ib)return u.return();if(t.Ha=null,!t.kb){u.m(2);break}return T(u,Go(s,t,t.Ic,t.oc),3);case 3:return u.return();case 2:if(t.stream.segmentIndex){u.m(4);break}return n=t.stream,T(u,t.stream.createSegmentIndex(),5);case 5:if(n!=t.stream)return null==t.Ha&&jo(s,t,0),u.return();case 4:b(u,6),null!=(r=function(t,n){if(Uo(n))return function(e,t){var n=jr(e,"video")||0;Ir(e.c,t,n)}(t.u.L,n.stream.originalId||""),null;n.type==lr&&function(e){e.c&&Ir(e.c,"",0)}(t.u.L);var r=t.u.uc(),i=n.wa?n.wa.endTime:r,a=function(e,t,n){return t==lr?null==(e=e.c).b||e.b<n?0:e.b-Math.max(n,e.a):Kn(e=Hr(e,t),n)}(t.u.L,n.type,r),o=Math.max(t.o.minBufferTime||0,t.i.rebufferingGoal,t.i.bufferingGoal)*t.f;if(i>=t.o.presentationTimeline.getDuration())return n.endOfStream=!0,"video"==n.type&&(r=t.a.get(lr))&&Uo(r)&&(r.endOfStream=!0),null;if(n.endOfStream=!1,a>=o)return.5;if(!(a=function(e,t,n,r){if(t.ia)return t.ia.current();if(t.wa||r)return t.ia=t.stream.segmentIndex.sb(t.wa?t.wa.endTime:r),t.ia.next().value;e=e.i.inaccurateManifestTolerance,r=Math.max(n-e,0);var i=null;return e&&(t.ia=t.stream.segmentIndex.sb(r),i=t.ia.next().value),i||(t.ia=t.stream.segmentIndex.sb(n),i=t.ia.next().value),i}(t,n,r,a=jr(t.u.L,n.type))))return 1;o=1/0;for(var s=Array.from(t.a.values()),u=(s=l(s)).next();!u.done;u=s.next())Uo(u=u.value)||u.ia&&!u.ia.current()||(o=Math.min(o,u.wa?u.wa.endTime:r));return i>=o+t.o.presentationTimeline.a?1:(function(t,n,r,i){var a,o,s,u,l,c,d,f,h,p,g,m,v;return x((function(y){switch(y.a){case 1:return a=cr,o=n.stream,s=n.ia,n.Na=!0,u=function(e,t,n){var r,i,a,o,s,u,l;return x((function(c){return r=[],i=Math.max(0,n.appendWindowStart-.1),a=n.appendWindowEnd+.01,(o=n.timestampOffset)==t.md&&i==t.ld&&a==t.kd||(s=function(){var n;return x((function(r){if(1==r.a)return b(r,2),t.ld=i,t.kd=a,t.md=o,T(r,function(e,t,n,r,i){return x((function(a){return t==cr.$?(e.c.v=n,function(e,t,n){e.f=t,e.g=n}(e.c,r,i),a.return()):T(a,Promise.all([qr(e,t,(function(){var n=e.f[t].appendWindowStart,r=e.f[t].appendWindowEnd;e.f[t].abort(),e.f[t].appendWindowStart=n,e.f[t].appendWindowEnd=r,Vr(e,t)})),qr(e,t,(function(){var r=n;0>r&&(r+=.001),e.f[t].timestampOffset=r,Vr(e,t)})),qr(e,t,(function(){e.f[t].appendWindowStart=0,e.f[t].appendWindowEnd=i,e.f[t].appendWindowStart=r,Vr(e,t)}))]),0)}))}(e.u.L,t.type,o,i,a),4);if(2!=r.a)return S(r,0);throw n=w(r),t.ld=null,t.kd=null,t.md=null,n}))},r.push(s())),!function(e,t){return e&&t?e.Pb()==t.Pb()&&e.Lb()==t.Lb()&&ct(e.ga(),t.ga()):e==t}(n.b,t.wc)&&(t.wc=n.b)&&(u=Bo(e,t,n.b),l=function(){var n,r,i;return x((function(a){switch(a.a){case 1:return b(a,2),T(a,u,4);case 4:return n=a.b,Mr(e.F),r=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,T(a,Kr(e.u.L,t.type,n,null,null,r),5);case 5:S(a,0);break;case 2:throw i=w(a),t.wc=null,i}}))},r.push(l())),T(c,Promise.all(r),0)}))}(t,n,i),b(y,2),l="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,c=e.ReadableStream,t.i.lowLatencyMode&&c&&l?(h=new Uint8Array(0),p=function(e){var a,s,l;return x((function(c){return 1==c.a?T(c,u,2):(Mr(t.F),t.g?c.return():(h=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(h,e),a=!1,s=0,(new Me).box("mdat",(function(e){s=e.size+e.start,a=!0})).parse(h,!1,!0),a?(l=h.subarray(0,s),h=h.subarray(s),T(c,Fo(t,n,r,o,i,l),0)):c.m(0)))}))},T(y,Bo(t,n,i,p),5)):(d=Bo(t,n,i),T(y,Promise.all([u,d]),6));case 6:return f=y.b,Mr(t.F),t.g?y.return():n.kb?(n.Na=!1,jo(t,n,0),y.return()):T(y,Fo(t,n,r,o,i,f[1]),5);case 5:if(Mr(t.F),t.g)return y.return();n.wa=i,s.next(),n.Na=!1,n.wd=!1,g=t.u.L.rc(),m=g[n.type],JSON.stringify(m),n.kb||t.u.td(),jo(t,n,0),S(y,0);break;case 2:if(v=w(y),Mr(t.F,v),t.g)return y.return();if(n.Na=!1,n.type==a.$&&t.i.ignoreTextStreamFailures)t.a.delete(a.$),y.m(0);else if(7001==v.code)n.Na=!1,n.Ha=null,jo(t,n,0),y.m(0);else if(3017==v.code)(function(e,t,n){if(!Array.from(e.a.values()).some((function(e){return e!=t&&e.wd}))){var r=Math.round(100*e.f);if(20<r)e.f-=.2;else{if(!(4<r))return t.Qb=!0,e.g=!0,void e.u.onError(n);e.f-=.04}t.wd=!0}jo(e,t,4)})(t,n,v),y.m(0);else{if(1001!=v.code||!v.data||404!=v.data[1])return n.Qb=!0,v.severity=2,T(y,Yo(t,v),0);n.Na=!1,n.Ha=null,jo(t,n,1),y.m(0)}}}))}(t,n,r,a).catch((function(){})),null)}(s,t))&&(jo(s,t,r),t.Qb=!1),S(u,7);break;case 6:return i=w(u),T(u,Yo(s,i),8);case 8:return u.return();case 7:if(a=Array.from(s.a.values()),!s.h||!a.every((function(e){return e.endOfStream}))){u.m(0);break}return T(u,s.u.L.endOfStream(),10);case 10:Mr(s.F),0!=(o=s.u.L.getDuration())&&o<s.o.presentationTimeline.getDuration()&&s.o.presentationTimeline.Fa(o),_(u)}}))},Vo.prototype.destroy=function(){return this.F.destroy()},(r=zo.prototype).remove=function(e,t){return!!this.a&&(Qo(this.a,(function(n){return n.startTime<t&&n.endTime>e})),!0)},r.append=function(e){function t(e){var n=[],r=700<=e.fontWeight,i="italic"==e.fontStyle,a=e.textDecoration.includes("underline");return r&&n.push("b"),i&&n.push("i"),a&&n.push("u"),r=n.reduce((function(e,t){return e+"<"+t+">"}),""),n=n.reduceRight((function(e,t){return e+"</"+t+">"}),""),e.lineBreak||e.spacer?(e.spacer&&be("shaka.extern.Cue","Please use lineBreak instead of spacer."),"\n"):e.nestedCues.length?e.nestedCues.map(t).join(""):r+e.payload+n}var n=e.map((function(e){if(e.nestedCues.length){var n=e.clone();return n.nestedCues=[],n.payload=t(e),n}return e})),r=[];e=this.a.cues?Array.from(this.a.cues):[];for(var i={},a=(n=l(n)).next();!a.done;i={nb:i.nb},a=n.next())i.nb=a.value,e.some(function(e){return function(t){return t.startTime==e.nb.startTime&&t.endTime==e.nb.endTime&&t.text==e.nb.payload}}(i))||(a=Xo(i.nb))&&r.push(a);for(i=(e=l(e=r.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?r.indexOf(t)-r.indexOf(e):r.indexOf(e)-r.indexOf(t)})))).next();!i.done;i=e.next())this.a.addCue(i.value)},r.destroy=function(){return this.a&&(Qo(this.a,(function(){return!0})),this.a.mode="disabled"),this.a=null,Promise.resolve()},r.isTextVisible=function(){return"showing"==this.a.mode},r.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},G("shaka.text.SimpleTextDisplayer",zo),zo.prototype.setTextVisibility=zo.prototype.setTextVisibility,zo.prototype.isTextVisible=zo.prototype.isTextVisible,zo.prototype.destroy=zo.prototype.destroy,zo.prototype.append=zo.prototype.append,zo.prototype.remove=zo.prototype.remove,G("shaka.util.Dom",Jo),Jo.removeAllChildren=Zo,(r=$o.prototype).append=function(e){for(var t=c(this.c).concat(),n={},r=(e=l(e)).next();!r.done;n={Zb:n.Zb},r=e.next())n.Zb=r.value,t.some(function(e){return function(t){return ft(t,e.Zb)}}(n))||this.c.push(n.Zb);es(this)},r.destroy=function(){this.g.removeChild(this.b),this.b=null,this.h=!1,this.c=[],this.j&&this.j.stop(),this.f.clear()},r.remove=function(e,t){return!!this.b&&(this.c=this.c.filter((function(n){return n.startTime<e||n.endTime>=t})),es(this),!0)},r.isTextVisible=function(){return this.h},r.setTextVisibility=function(e){this.h=e},G("shaka.text.UITextDisplayer",$o),$o.prototype.setTextVisibility=$o.prototype.setTextVisibility,$o.prototype.isTextVisible=$o.prototype.isTextVisible,$o.prototype.remove=$o.prototype.remove,$o.prototype.destroy=$o.prototype.destroy,$o.prototype.append=$o.prototype.append,G("shaka.text.WebVttGenerator",(function(){})),G("shaka.util.ConfigUtils",rs),rs.convertToConfigObject=as,rs.mergeConfigObjects=is,G("shaka.util.PlayerConfiguration",os),os.mergeConfigObjects=us,m(ms,Qi),(r=ms.prototype).destroy=function(){var e,t=this;return x((function(n){switch(n.a){case 1:return t.g==Su?n.return():(t.g=Su,e=qo(t.X,(function(){return{node:t.na,payload:{B:null,mimeType:null,startTime:null,Id:NaN,uri:null},bb:!1}})),T(n,new Promise((function(t){e.zb=function(){},e.yc=function(){t()},e.fb=function(){t()},e.onError=function(){t()},e.Ac=function(){t()}})),2));case 2:return T(n,t.X.destroy(),3);case 3:if(t.b&&(t.b.release(),t.b=null),t.Wc=null,t.l=null,t.i=null,t.f=null,t.lc=null,!t.K){n.m(0);break}return T(n,t.K.destroy(),5);case 5:t.K=null,_(n)}}))},r.Hb=function(e,t){if(t=void 0===t||t,this.g==Su)return Promise.reject(Js());var n={B:null,mimeType:null,startTime:null,Id:NaN,uri:null};n.B=e,je()||(t=!1);var r=t?this.za:this.Ka,i=qo(this.X,(function(){return{node:r,payload:n,bb:!1}}));return i.zb=function(){},$s(i)},r.detach=function(){var e=this;if(this.g==Su)return Promise.reject(Js());var t=qo(this.X,(function(){return{node:e.na,payload:{B:null,mimeType:null,startTime:null,Id:NaN,uri:null},bb:!1}}));return t.zb=function(){},$s(t)},r.Kd=function(e){var t=this;if(e=void 0===e||e,this.g==Su)return Promise.reject(Js());je()||(e=!1);var n={B:null,mimeType:null,startTime:null,Id:NaN,uri:null},r=qo(this.X,(function(r){var i=r.B&&e?t.za:r.B?t.Ka:t.na;return n.B=r.B,{node:i,payload:n,bb:!1}}));return r.zb=function(){},$s(r)},r.load=function(e,t,n){var r=this;if(this.g==Su)return Promise.reject(Js());this.dispatchEvent(vs(uu));var i={B:null,mimeType:null,startTime:null,Id:NaN,uri:null};i.uri=e,i.Id=Date.now()/1e3,n&&(i.mimeType=n),void 0!==t&&(i.startTime=t);var a=function(e,t){if(!je())return!0;var n=t.mimeType,r=t.uri||"";if(n||(n={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[Ya(r)]),n){if(""==(t.B||ze()).canPlayType(n))return!1;if(!je()||!(n in Va)&&!(Ya(r)in qa)||e.i.streaming.preferNativeHls)return!0;if(Ve())return e.i.streaming.useNativeHlsOnSafari}return!1}(this,i)?this.Ia:this.J,o=qo(this.X,(function(e){return null==e.B?null:(i.B=e.B,{node:a,payload:i,bb:!0})}));return this.f=new gs,o.zb=function(){},new Promise((function(e,t){o.Ac=function(){return t(new le(2,7,7002))},o.yc=function(){e(),r.dispatchEvent(vs(su))},o.fb=function(){return t(Js())},o.onError=function(e){return t(e)}}))},r.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=as(e,t)),e.manifest&&e.manifest.dash&&"defaultPresentationDelay"in e.manifest.dash&&(be("manifest.dash.defaultPresentationDelay configuration","Please Use manifest.defaultPresentationDelay instead."),e.manifest.defaultPresentationDelay=e.manifest.dash.defaultPresentationDelay,delete e.manifest.dash.defaultPresentationDelay),e.streaming&&e.streaming.lowLatencyMode&&(null==e.streaming.inaccurateManifestTolerance&&(e.streaming.inaccurateManifestTolerance=0),null==e.streaming.rebufferingGoal&&(e.streaming.rebufferingGoal=.01));var n=us(this.i,e,ws(this));return As(this),n},r.getConfiguration=function(){var e=ws(this);return us(e,this.i,ws(this)),e},r.wf=function(){for(var e in this.i)delete this.i[e];us(this.i,ws(this),ws(this)),As(this)},r.Ne=function(){return this.g},r.Re=function(){return this.a},r.Nb=function(){return this.K},r.fd=function(){return this.Ra},r.Td=function(){return this.H?this.H:null},r.U=function(){return this.o?this.o.presentationTimeline.U():!(!this.a||!this.a.src)&&1/0==this.a.duration},r.eb=function(){return!!this.o&&this.o.presentationTimeline.eb()},r.df=function(){if(this.o){var e=this.o.variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},r.zd=function(){if(this.o){var e=this.o.presentationTimeline;return{start:e.tb(),end:e.Ma()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},r.keySystem=function(){return _a(this.drmInfo())},r.drmInfo=function(){return this.h?this.h.c:null},r.Mb=function(){return this.h?this.h.Mb():1/0},r.tc=function(){return this.h?this.h.tc():{}},r.hd=function(){return!!this.C&&this.C.a==Bi},r.Te=function(){return this.a?this.A?this.A.b:1:0},r.Ff=function(e){0==e?W("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.A.set(e),this.g==Iu&&(this.l.playbackRateChanged(e),Lo(this.c,1<Math.abs(e))))},r.ze=function(){var e=this.A.sc();this.g==Ru&&this.A.set(e),this.g==Iu&&(this.A.set(e),this.l.playbackRateChanged(e),Lo(this.c,!1))},r.gd=function(){if(this.o){for(var e=this.c?this.c.b:null,t=[],n=l(this.o.variants),r=n.next();!r.done;r=n.next())if(bi(r=r.value)){var i=mi(r);i.active=r==e,t.push(i)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map((function(e){return Ti(e)})):[]},r.ub=function(){if(this.o){for(var e=this.c?this.c.c:null,t=[],n=l(this.o.textStreams),r=n.next();!r.done;r=n.next()){var i=vi(r=r.value);i.active=r==e,t.push(i)}return t}return this.a&&this.a.src&&this.a.textTracks?Ss(this).map((function(e){var t=_i(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t})):[]},r.Le=function(){return this.o?this.o.imageStreams.map((function(e){return yi(e)})):[]},r.af=function(e,t){var n,r,i,a,o,s,u,l,c,d,f,h,p,g,m,v,y=this;return x((function(E){return 1==E.a?y.o?(n=y.o.imageStreams.find((function(t){return t.id==e})))?n.segmentIndex?E.m(3):T(E,n.createSegmentIndex(),3):E.return(null):E.m(2):2!=E.a?null==(r=n.segmentIndex.find(t))?E.return(null):(i=n.segmentIndex.get(r),(a=/(\d+)x(\d+)/.exec(n.tilesLayout))?(o=n.width||0,s=n.height||0,u=parseInt(a[1],10),l=parseInt(a[2],10),c=o/u,d=s/l,h=f=0,1<(p=u*l)&&(g=t-i.startTime,m=i.endTime-i.startTime,v=Math.floor(g*p/m),f=v%u/u*o,h=v%l/l*s),E.return({height:d,positionX:f,positionY:h,uris:i.ga(),width:c})):E.return(null)):E.return(null)}))},r.ie=function(e){if(this.o&&this.c){var t=this.o.textStreams.find((function(t){return t.id==e.id}));t&&t!=this.c.c&&(ps(this.f.a,t,!1),xo(this.c,t),Fs(this),this.ka=t.language)}else if(this.a&&this.a.src&&this.a.textTracks){for(var n=(t=l(t=Ss(this))).next();!n.done;n=t.next())Ei(n=n.value)==e.id?n.mode=this.T?"showing":"hidden":n.mode="disabled";Fs(this)}},r.je=function(e,t,n){if(t=void 0!==t&&t,n=void 0===n?0:n,this.o&&this.c){this.i.abr.enabled&&W("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var r=this.o.variants.find((function(t){return t.id==e.id}));r&&bi(r)&&(Ns(this,r,!1,t,n),this.ja=new Pi(r),Ms(this))}else if(this.a&&this.a.audioTracks)for(n=(t=l(t=Array.from(this.a.audioTracks))).next();!n.done;n=t.next())if(Ei(n=n.value)==e.id){xs(this,n);break}},r.Ie=function(){return Qs(this.gd())},r.$e=function(){return Qs(this.ub())},r.He=function(){return Array.from(Xs(this.gd()))},r.Ze=function(){return Array.from(Xs(this.ub()))},r.Bd=function(e,t){if(this.o&&this.v){if(this.ja=new ki(e,t||"",0,""),!this.i.abr.enabled){for(var n=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},r=this.c.b,i=this.ja.create(this.o.variants),a=null,o=(i=l(i.values())).next();!o.done;o=i.next())o=o.value,(!a||n(a,r)>n(o,r))&&(a=o);if(a)return n=mi(a),void this.je(n,!0)}Ls(this)}else if(this.a&&this.a.audioTracks){for(i=Array.from(this.a.audioTracks),n=ti(e),a=r=null,o=(i=l(i)).next();!o.done;o=i.next()){var s=Ti(o=o.value);ti(s.language)==n&&(r=o,t?s.roles.includes(t)&&(a=o):0==s.roles.length&&(a=o))}a?xs(this,a):r&&xs(this,r)}},r.Cd=function(e,t,n){if(n=void 0!==n&&n,this.o&&this.v)this.ka=e,this.fc=t||"",this.ec=n,(e=Si(this.o.textStreams,this.ka,this.fc,this.ec)[0]||null)&&e!=this.c.c&&(ps(this.f.a,e,!1),this.i.streaming.alwaysStreamText||this.jd())&&(xo(this.c,e),Fs(this));else{var r=ti(e);(e=this.ub().find((function(e){return ti(e.language)==r&&(!t||e.roles.includes(t))&&e.forced==n})))&&this.ie(e)}},r.xf=function(e){if(this.o&&this.v){for(var t=null,n=l(this.o.variants),r=n.next();!r.done;r=n.next())if((r=r.value).audio.label==e){t=r;break}null!=t&&(this.ja=new ki(t.language,"",0,e),Ls(this))}},r.jd=function(){var e=this.T;return this.D?this.D.h.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Ss(this).some((function(e){return"showing"==e.mode})):e},r.Df=function(e){if(e=!!e,this.T!=e){if(this.T=e,this.g==Iu)this.D.h.setTextVisibility(e),this.i.streaming.alwaysStreamText||(e?this.c.c||0<(e=Si(this.o.textStreams,this.ka,this.fc,this.ec)).length&&(xo(this.c,e[0]),Fs(this)):function(e){var t=e.a.get(lr);t&&(Ho(t),Ko(t).catch((function(){})),e.a.delete(lr)),e.c=null}(this.c));else if(this.a&&this.a.src&&this.a.textTracks)for(var t=Ss(this),n=(t=l(t)).next();!n.done;n=t.next())"disabled"!=(n=n.value).mode&&(n.mode=e?"showing":"hidden");Us(this)}},r.Ve=function(){if(!this.U())return null;var e=this.X.f,t=0;if(this.v)t=this.v.g();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.o?new Date(1e3*(this.o.presentationTimeline.f+t)):this.a&&this.a.getStartDate?(e=this.a.getStartDate(),isNaN(e.getTime())?null:new Date(e.getTime()+1e3*t)):null},r.Ud=function(){if(!this.U())return null;if(this.o)return new Date(1e3*this.o.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?null:e}return null},r.rc=function(){if(this.g==Iu)return this.D.rc();var e={total:[],audio:[],video:[],text:[]};return this.g==Ru&&(e.total=Yn(this.a.buffered)),e},r.getStats=function(){if(this.g!=Iu&&this.g!=Ru)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};Ds(this);var e=this.a,t=e.currentTime/e.duration;if(!isNaN(t)){var n=this.f;t=Math.round(100*t),n.c=isNaN(n.c)?t:Math.max(n.c,t)}e.getVideoPlaybackQuality&&(e=e.getVideoPlaybackQuality(),n=this.f,t=Number(e.totalVideoFrames),n.M=Number(e.droppedVideoFrames),n.J=t,this.f.H=Number(e.corruptedVideoFrames)),e=this.h&&(e=this.h).D?e.D:NaN,this.f.D=e,this.g==Iu&&((e=this.c.b)&&(this.f.j=(this.A?this.A.b:1)*e.bandwidth),e&&e.video&&(n=this.f,t=e.video.height||NaN,n.T=e.video.width||NaN,n.l=t),this.U()&&(e=this.Ud().valueOf()+1e3*this.zd().end,this.f.v=(Date.now()-e)/1e3),this.o&&this.o.presentationTimeline&&(this.f.C=this.o.presentationTimeline.a),e=this.l.getBandwidthEstimate(),this.f.h=e);var r=this.f;e=r.T,n=r.l,t=r.j;for(var i=r.J,a=r.M,o=r.H,s=r.h,u=r.c,c=r.g,d=r.A,f=r.f,h=ds(r.b,"playing"),p=ds(r.b,"paused"),g=ds(r.b,"buffering"),m=r.D,v=r.v,y=r.C,E=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],r=l(e.b),i=r.next();!i.done;i=r.next())n.push(t(i.value));return e.a&&n.push(t(e.a)),n}(r.b),T=[],_=(r=l(r.a.a)).next();!_.done;_=r.next())_=_.value,T.push({timestamp:_.timestamp,id:_.id,type:_.type,fromAdaptation:_.fromAdaptation,bandwidth:_.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:i,droppedFrames:a,corruptedFrames:o,estimatedBandwidth:s,completionPercent:u,loadLatency:c,manifestTimeSeconds:d,drmTimeSeconds:f,playTime:h,pauseTime:p,bufferingTime:g,licenseTime:m,liveLatency:v,maxSegmentDuration:y,stateHistory:E,switchHistory:T}},r.addTextTrack=function(e,t,n,r,i,a,o){if(o=void 0!==o&&o,be("addTextTrack","Please use an addTextTrackAsync."),this.g!=Iu&&this.g!=Ru)throw new le(1,7,7004);if(!r){var s=Ya(e);if(!(r={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"}[s]))throw new le(1,2,2011,s)}if(this.g==Ru){if("text/vtt"!=r)throw new le(1,2,2013,r);if(o&&(n="forced"),(r=document.createElement("track")).src=e,r.label=a||"",r.kind=n,r.srclang=t,this.a.getAttribute("crossorigin")||this.a.setAttribute("crossorigin","anonymous"),this.a.appendChild(r),e=this.ub().find((function(e){return e.language==t&&e.label==(a||"")&&e.kind==n})))return Ps(this),e;throw new le(1,2,2012)}if(1/0==(s=this.o.presentationTimeline.getDuration()))throw new le(1,4,4033);if(!wr(Tr((e={id:this.bd++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:vo(0,s,[e]),mimeType:r||"",codecs:i||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,label:a||null,type:lr,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}).mimeType,e.codecs)))throw new le(2,2,2014,r);return this.o.textStreams.push(e),Ps(this),vi(e)},r.ve=function(e,t,n,r,i,a,o){o=void 0!==o&&o;var s,u,c,d,f,h,p,g,m,v,y=this;return x((function(E){switch(E.a){case 1:if(y.g!=Iu&&y.g!=Ru)throw new le(1,7,7004);if(r){E.m(2);break}if(s=Ya(e),r={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"}[s]){E.m(3);break}return b(E,4),T(E,Ka(e,y.K,y.i.streaming.retryParameters),6);case 6:r=E.b,S(E,3);break;case 4:w(E);case 3:if(!r)throw new le(1,2,2011,s);case 2:if(y.g!=Ru){E.m(7);break}if("text/vtt"==r){E.m(8);break}return T(E,function(e,t,n){var r,i,a;return x((function(o){return 1==o.a?(r=oa,(i=ra([e],n)).method="GET",T(o,t.request(r,i).promise,2)):(a=o.b,o.return(a.data))}))}(e,y.K,y.i.streaming.retryParameters),9);case 9:u=E.b,c=function(e,t,n){var r=Cr[n];if(r)return n=r(),e={periodStart:0,segmentStart:0,segmentEnd:e.a.duration},t=oe(t),function(e){function t(e){var n=[],r=700<=e.fontWeight,i="italic"==e.fontStyle,a=e.textDecoration.includes("underline");return r&&n.push("b"),i&&n.push("i"),a&&n.push("u"),r=n.reduce((function(e,t){return e+"<"+t+">"}),""),n=n.reduceRight((function(e,t){return e+"</"+t+">"}),""),e.lineBreak||e.spacer?(e.spacer&&be("shaka.text.Cue","Please use lineBreak instead of spacer."),"\n"):e.nestedCues.length?e.nestedCues.map(t).join(""):r+e.payload+n}var n=e.map((function(e){if(e.nestedCues.length){var n=e.clone();return n.nestedCues=[],n.payload=t(e),n}return e}));e="WEBVTT\n\n";for(var r=(n=l(n)).next();!r.done;r=n.next()){var i=function(e){var t=Math.floor(e/3600),n=Math.floor(e/60%60),r=Math.floor(e%60);return(10>t?"0":"")+t+":"+(10>n?"0":"")+n+":"+(10>r?"0":"")+r+"."+(100>(e=Math.floor(1e3*e%1e3))?10>e?"00":"0":"")+e};e+=i((r=r.value).startTime)+" --\x3e "+i(r.endTime)+"\n",e+=r.payload+"\n\n"}return e}(t=n.parseMedia(t,e));throw new le(2,2,2014,n)}(y,u,r),d=new Blob([c],{type:"text/vtt"}),e=Jr(d),r="text/vtt";case 8:if(o&&(n="forced"),(f=document.createElement("track")).src=e,f.label=a||"",f.kind=n,f.srclang=t,y.a.getAttribute("crossorigin")||y.a.setAttribute("crossorigin","anonymous"),y.a.appendChild(f),h=y.ub(),p=h.find((function(e){return e.language==t&&e.label==(a||"")&&e.kind==n})))return Ps(y),E.return(p);throw new le(1,2,2012);case 7:if(g=cr,1/0==(m=y.o.presentationTimeline.getDuration()))throw new le(1,4,4033);if(!wr(Tr((v={id:y.bd++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:vo(0,m,[e]),mimeType:r||"",codecs:i||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,label:a||null,type:g.$,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}).mimeType,v.codecs)))throw new le(2,2,2014,r);return y.o.textStreams.push(v),Ps(y),E.return(vi(v))}}))},r.Fd=function(e,t){this.$c.width=e,this.$c.height=t},r.xd=function(){if(this.g==Iu){var e=this.c;if(e.F.a)e=!1;else if(e.g)e=!1;else{for(var t=l(e.a.values()),n=t.next();!n.done;n=t.next())(n=n.value).Qb&&(n.Qb=!1,jo(e,n,.1));e=!0}}else e=!1;return e},r.Oe=function(){return W("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.o},r.Pe=function(){return this.jc},r.ne=function(e){this.lc=e},r.qc=function(e){var t=this;return x((function(n){if(1==n.a)return T(n,function(e,t){var n;return x((function(r){if(1==r.a)return n=e.c?e.c.b:null,T(r,function(e,t,n,r){return x((function(i){if(1==i.a)return r?T(i,ci(n,0<n.offlineSessionIds.length),2):(li(n,e),di(n),i.m(2));pi(t,n),function(e){e.textStreams=e.textStreams.filter((function(e){return wr(Tr(e.mimeType,e.codecs))}))}(n),function(e){e.imageStreams=e.imageStreams.filter((function(e){var t=["image/svg+xml","image/png","image/jpeg"];return(We("Web0S")||Ke()||Ye())&&t.push("image/webp"),t.includes(e.mimeType)}))}(n),_(i)}))}(e.h,n,t,e.i.useMediaCapabilities),2);Ws(t),_(r)}))}(t,e),2);Is(t,e),_(n)}))},G("shaka.Player",ms),ms.prototype.setVideoContainer=ms.prototype.ne,ms.prototype.getManifestParserFactory=ms.prototype.Pe,ms.prototype.getManifest=ms.prototype.Oe,ms.prototype.retryStreaming=ms.prototype.xd,ms.prototype.setMaxHardwareResolution=ms.prototype.Fd,ms.prototype.addTextTrackAsync=ms.prototype.ve,ms.prototype.addTextTrack=ms.prototype.addTextTrack,ms.prototype.getStats=ms.prototype.getStats,ms.prototype.getBufferedInfo=ms.prototype.rc,ms.prototype.getPresentationStartTimeAsDate=ms.prototype.Ud,ms.prototype.getPlayheadTimeAsDate=ms.prototype.Ve,ms.prototype.setTextTrackVisibility=ms.prototype.Df,ms.prototype.isTextTrackVisible=ms.prototype.jd,ms.prototype.selectVariantsByLabel=ms.prototype.xf,ms.prototype.selectTextLanguage=ms.prototype.Cd,ms.prototype.selectAudioLanguage=ms.prototype.Bd,ms.prototype.getTextLanguages=ms.prototype.Ze,ms.prototype.getAudioLanguages=ms.prototype.He,ms.prototype.getTextLanguagesAndRoles=ms.prototype.$e,ms.prototype.getAudioLanguagesAndRoles=ms.prototype.Ie,ms.prototype.selectVariantTrack=ms.prototype.je,ms.prototype.selectTextTrack=ms.prototype.ie,ms.prototype.getThumbnails=ms.prototype.af,ms.prototype.getImageTracks=ms.prototype.Le,ms.prototype.getTextTracks=ms.prototype.ub,ms.prototype.getVariantTracks=ms.prototype.gd,ms.prototype.cancelTrickPlay=ms.prototype.ze,ms.prototype.trickPlay=ms.prototype.Ff,ms.prototype.getPlaybackRate=ms.prototype.Te,ms.prototype.isBuffering=ms.prototype.hd,ms.prototype.getKeyStatuses=ms.prototype.tc,ms.prototype.getExpiration=ms.prototype.Mb,ms.prototype.drmInfo=ms.prototype.drmInfo,ms.prototype.keySystem=ms.prototype.keySystem,ms.prototype.seekRange=ms.prototype.zd,ms.prototype.isAudioOnly=ms.prototype.df,ms.prototype.isInProgress=ms.prototype.eb,ms.prototype.isLive=ms.prototype.U,ms.prototype.getAdManager=ms.prototype.Td,ms.prototype.getAssetUri=ms.prototype.fd,ms.prototype.getNetworkingEngine=ms.prototype.Nb,ms.prototype.getMediaElement=ms.prototype.Re,ms.prototype.getLoadMode=ms.prototype.Ne,ms.prototype.resetConfiguration=ms.prototype.wf,ms.prototype.getConfiguration=ms.prototype.getConfiguration,ms.prototype.configure=ms.prototype.configure,ms.prototype.load=ms.prototype.load,ms.prototype.unload=ms.prototype.Kd,ms.prototype.detach=ms.prototype.detach,ms.prototype.attach=ms.prototype.Hb,ms.probeSupport=function(e){var t,n,r,i,a;return e=void 0===e||e,x((function(o){if(1==o.a)return t={},e?T(o,function(){var e,t,n,r,i,a;return x((function(o){return 1==o.a?(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),n=[{videoCapabilities:t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{initDataTypes:["cenc"],videoCapabilities:t}],r=new Map,i=function(e){var t,i,a;return x((function(o){switch(o.a){case 1:return b(o,2),T(o,navigator.requestMediaKeySystemAccess(e,n),4);case 4:return t=o.b,a=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),We("Tizen 3")&&(a=!1),r.set(e,{persistentState:a}),T(o,t.createMediaKeys(),5);case 5:S(o,0);break;case 2:w(o),r.set(e,null),_(o)}}))},a=e.map((function(e){return i(e)})),T(o,Promise.all(a),2)):o.return(ha(r))}))}(),3):o.m(2);2!=o.a&&(t=o.b);var s={};if(je()){for(var u in Va)s[u]=!0;for(var c in qa)s[c]=!0}u={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var d=(c=l(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!d.done;d=c.next())s[d=d.value]=je()?!!Va[d]:He(d);for(var f in u)s[f]=je()?!!qa[f]:He(u[f]);for(n=s,s={},u=(f=l('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(","))).next();!u.done;u=f.next())s[u=u.value]=je()?!!wr(u)||MediaSource.isTypeSupported(u)||vr(u):He(u),s[c=u.split(";")[0]]=s[c]||s[u];for(a in r={manifest:n,media:s,drm:t},i=Mu)r[a]=i[a]();return o.return(r)}))},ms.isBrowserSupported=function(){if(e.Promise||W("A Promise implementation or polyfill is required"),e.TextDecoder&&e.TextEncoder||W("A TextDecoder/TextEncoder implementation or polyfill is required"),!(e.Promise&&e.Uint8Array&&e.TextDecoder&&e.TextEncoder&&Array.prototype.forEach)||We("Trident/"))return!1;var t=qe();return!(t&&12>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!je()||He("application/x-mpegurl"))},ms.setAdManagerFactory=function(e){Lu=e},ms.registerSupportPlugin=function(e,t){Mu[e]=t},ms.prototype.destroy=ms.prototype.destroy;var eu="abrstatuschanged",tu="adaptation",nu="buffering",ru="drmsessionupdate",iu="emsg",au="error",ou="expirationupdated",su="loaded",uu="loading",lu="manifestparsed",cu="metadata",du="onstatechange",fu="onstateidle",hu="ratechange",pu="streaming",gu="textchanged",mu="texttrackvisibility",vu="timelineregionadded",yu="timelineregionenter",Eu="timelineregionexit",Tu="trackschanged",_u="unloading",bu="variantchanged",Au={Mf:eu,Nf:tu,Of:nu,Pf:ru,Rf:iu,Error:au,Sf:ou,Uf:"largegap",Vf:su,Wf:uu,Xf:lu,Metadata:cu,Yf:du,Zf:fu,$f:hu,ag:"sessiondata",bg:pu,cg:gu,dg:mu,eg:vu,fg:yu,gg:Eu,hg:Tu,ig:_u,jg:bu},Su=0,wu=1,Iu=2,Ru=3;ms.LoadMode={DESTROYED:Su,NOT_LOADED:wu,MEDIA_SOURCE:Iu,SRC_EQUALS:Ru},ms.version="v3.1.0";var Cu=["3","1"];we=new function(e){this.a=e,this.c=Ae,this.b=Se}(new _e(Number(Cu[0]),Number(Cu[1])));var Du=["output-restricted","internal-error"],Mu={},Lu=null;function Nu(){this.a=[],this.f=this.b=this.c=0}function xu(e,t){var n=this;this.c=e,this.a=t,this.f=!1,this.g=this.a.getVolume(),this.b=new xr,this.b.s(this.a,google.ima.AdEvent.Type.PAUSED,(function(){n.f=!0})),this.b.s(this.a,google.ima.AdEvent.Type.RESUMED,(function(){n.f=!1}))}function Ou(e,t,n,r){var i=this;this.h=e,this.a=t,this.l=NaN,this.f=r,this.j=null,this.b=new xr,google.ima.settings.setLocale(n),(e=new google.ima.AdDisplayContainer(this.h,this.a)).initialize(),this.g=new google.ima.AdsLoader(e),this.g.getSettings().setPlayerType("shaka-player"),this.g.getSettings().setPlayerVersion("v3.1.0"),this.c=null,this.b.qa(this.g,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(e){!function(e,t){e.f(new Xi("ads-loaded",{loadTime:Date.now()/1e3-e.l})),e.c=t.getAdsManager(e.a),e.f(new Xi("ima-ad-manager-loaded",{imaAdManager:e.c}));var n=e.c.getCuePoints();if(n.length){for(var r=[],i=(n=l(n)).next();!i.done;i=n.next())r.push(new ju(i.value));e.f(new Xi("ad-cue-points-changed",{cuepoints:r}))}!function(e){e.b.s(e.c,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){Pu(e,t)})),e.b.s(e.c,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){ku(e,t)})),e.b.s(e.c,google.ima.AdEvent.Type.STARTED,(function(t){ku(e,t)})),e.b.s(e.c,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(t){e.f(new Xi("ad-first-quartile",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.MIDPOINT,(function(t){e.f(new Xi("ad-midpoint",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(t){e.f(new Xi("ad-third-quartile",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.COMPLETE,(function(t){e.f(new Xi("ad-complete",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){Fu(e,t)})),e.b.s(e.c,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){Fu(e,t)})),e.b.s(e.c,google.ima.AdEvent.Type.SKIPPED,(function(t){e.f(new Xi("ad-skipped",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(t){e.f(new Xi("ad-volume-changed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.VOLUME_MUTED,(function(t){e.f(new Xi("ad-muted",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.PAUSED,(function(t){e.j.f=!0,e.f(new Xi("ad-paused",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.RESUMED,(function(t){e.j.f=!1,e.f(new Xi("ad-resumed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(t){e.f(new Xi("ad-skip-state-changed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.CLICK,(function(t){e.f(new Xi("ad-clicked",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.AD_PROGRESS,(function(t){e.f(new Xi("ad-progress",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.AD_BUFFERING,(function(t){e.f(new Xi("ad-buffering",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.IMPRESSION,(function(t){e.f(new Xi("ad-impression",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.DURATION_CHANGE,(function(t){e.f(new Xi("ad-duration-changed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.USER_CLOSE,(function(t){e.f(new Xi("ad-closed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.LOADED,(function(t){e.f(new Xi("ad-loaded",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){e.f(new Xi("all-ads-completed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(t){e.f(new Xi("ad-linear-changed",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.AD_METADATA,(function(t){e.f(new Xi("ad-metadata",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.LOG,(function(t){e.f(new Xi("ad-recoverable-error",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.AD_BREAK_READY,(function(t){e.f(new Xi("ad-break-ready",{originalEvent:t}))})),e.b.s(e.c,google.ima.AdEvent.Type.INTERACTION,(function(t){e.f(new Xi("ad-interaction",{originalEvent:t}))}))}(e);try{e.c.init(e.a.offsetWidth,e.a.offsetHeight,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),e.b.s(e.a,"loadeddata",(function(){e.c.resize(e.a.offsetWidth,e.a.offsetHeight,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),e.c.start()}catch(t){Fu(e,null)}}(i,e)})),this.b.s(this.g,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){Pu(i,e)})),this.a.onended=function(){i.g.contentComplete()}}function Pu(e,t){t.getError(),Fu(e,null),e.f(new Xi("ad-cue-points-changed",{cuepoints:[]}))}function ku(e,t){var n=t.getAd();e.j=new xu(n,e.c),e.f(new Xi("ad-started",{ad:e.j,sdkAdObject:n,originalEvent:t})),e.h.setAttribute("ad-active","true"),e.a.pause()}function Fu(e,t){e.f(new Xi("ad-stopped",{originalEvent:t})),e.h.removeAttribute("ad-active"),e.a.play()}function Uu(e,t){this.c=e,this.b=null,this.a=t}function Bu(e,t,n,r){var i=this;this.v=e,this.a=t,this.g=null,this.D=NaN,this.f=r,this.C=!1,this.A=this.h=this.j=null,this.l="",this.b=new xr,(e=new google.ima.dai.api.UiSettings).setLocale(n),this.c=new google.ima.dai.api.StreamManager(this.a,this.v,e),this.f(new Xi("ima-stream-manager-loaded",{imaStreamManager:this.c})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){!function(e,t){e.f(new Xi("ads-loaded",{loadTime:Date.now()/1e3-e.D}));var n=t.getStreamData().url;e.g.resolve(n),e.g=null,e.C||e.b.s(e.a,"seeked",(function(){var t=e.a.currentTime;if(0!=t){e.c.streamTimeForContentTime(t);var n=e.c.previousCuePointForStreamTime(t);n&&!n.played&&(e.j=t,e.a.currentTime=n.start)}}))}(i,e)})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){i.l.length?i.g.resolve(i.l):i.g.reject("IMA Stream request returned an error and there was no backup asset uri provided."),i.g=null})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){e=e.getAd(),i.h=new Uu(e,i.a),i.A&&(i.h.b=i.A),i.f(new Xi("ad-started",{ad:i.h})),i.v.setAttribute("ad-active","true")})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){i.v.removeAttribute("ad-active");var e=i.a.currentTime;i.j&&i.j>e&&(i.a.currentTime=i.j,i.j=null)})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){i.A=e.getStreamData().adProgressData,i.h&&(i.h.b=i.A)})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){i.f(new Xi("ad-first-quartile"))})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){i.f(new Xi("ad-midpoint"))})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){i.f(new Xi("ad-third-quartile"))})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){i.f(new Xi("ad-complete")),i.f(new Xi("ad-stopped")),i.v.removeAttribute("ad-active"),i.h=null})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){i.f(new Xi("ad-skipped")),i.f(new Xi("ad-stopped"))})),this.b.s(this.c,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){var t=e.getStreamData();e=[];for(var n=(t=l(t.cuepoints)).next();!n.done;n=t.next())n=n.value,e.push(new ju(n.start,n.end));i.f(new Xi("ad-cue-points-changed",{cuepoints:e}))}))}function Gu(){Qi.call(this),this.a=this.b=null,this.f=new Nu,this.c=navigator.language}function ju(e,t){this.start=e,this.end=void 0===t?null:t}function Hu(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Xi){var n={};for(i in t){var r=t[i];r&&"object"==typeof r?"detail"==i&&(n[i]=r):i in Event||(n[i]=r)}return n}if(t instanceof Error){var i=new Set(["name","message","stack"]);for(n in t)i.add(n);for(n=(r=l(Object.getOwnPropertyNames(t))).next();!n.done;n=r.next())i.add(n.value);for(r={},n=(i=l(i)).next();!n.done;n=i.next())r[n=n.value]=t[n];i={__type__:"Error",contents:r}}else if(t instanceof TimeRanges)for(i={__type__:"TimeRanges",length:t.length,start:[],end:[]},r=(n=l(Yn(t))).next();!r.done;r=n.next()){var a=(r=r.value).end;i.start.push(r.start),i.end.push(a)}else i=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return i}}))}function Ku(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){n=t.contents;var r,i=Error(n.message);for(r in n)i[r]=n[r];n=i}else n=t;return n}))}(r=xu.prototype).getDuration=function(){return this.c.getDuration()},r.getMinSuggestedDuration=function(){return this.c.getMinSuggestedDuration()},r.getRemainingTime=function(){return this.a.getRemainingTime()},r.isPaused=function(){return this.f},r.isSkippable=function(){return 0<=this.c.getSkipTimeOffset()},r.getTimeUntilSkippable=function(){var e=this.c.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},r.canSkipNow=function(){return this.a.getAdSkippableState()},r.skip=function(){return this.a.skip()},r.pause=function(){return this.a.pause()},r.play=function(){return this.a.resume()},r.getVolume=function(){return this.a.getVolume()},r.setVolume=function(e){return this.a.setVolume(e)},r.isMuted=function(){return 0==this.a.getVolume()},r.resize=function(e,t){this.a.resize(e,t,document.fullscreenElement?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},r.setMuted=function(e){e?(this.g=this.getVolume(),this.setVolume(0)):this.setVolume(this.g)},r.getSequenceLength=function(){var e=this.c.getAdPodInfo();return null==e?1:e.getTotalAds()},r.getPositionInSequence=function(){var e=this.c.getAdPodInfo();return null==e?1:e.getAdPosition()},r.release=function(){this.a=this.c=null},G("shaka.ads.ClientSideAd",xu),xu.prototype.release=xu.prototype.release,xu.prototype.getPositionInSequence=xu.prototype.getPositionInSequence,xu.prototype.getSequenceLength=xu.prototype.getSequenceLength,xu.prototype.setMuted=xu.prototype.setMuted,xu.prototype.resize=xu.prototype.resize,xu.prototype.isMuted=xu.prototype.isMuted,xu.prototype.setVolume=xu.prototype.setVolume,xu.prototype.getVolume=xu.prototype.getVolume,xu.prototype.play=xu.prototype.play,xu.prototype.pause=xu.prototype.pause,xu.prototype.skip=xu.prototype.skip,xu.prototype.canSkipNow=xu.prototype.canSkipNow,xu.prototype.getTimeUntilSkippable=xu.prototype.getTimeUntilSkippable,xu.prototype.isSkippable=xu.prototype.isSkippable,xu.prototype.isPaused=xu.prototype.isPaused,xu.prototype.getRemainingTime=xu.prototype.getRemainingTime,xu.prototype.getMinSuggestedDuration=xu.prototype.getMinSuggestedDuration,xu.prototype.getDuration=xu.prototype.getDuration,Ou.prototype.stop=function(){this.c&&this.c.stop(),this.h&&Zo(this.h)},(r=Uu.prototype).getDuration=function(){return this.b?this.b.duration:-1},r.getMinSuggestedDuration=function(){return this.getDuration()},r.getRemainingTime=function(){return this.b?this.b.duration-this.b.currentTime:-1},r.isPaused=function(){return this.a.paused},r.isSkippable=function(){return this.c.isSkippable()},r.getTimeUntilSkippable=function(){var e=this.c.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},r.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},r.skip=function(){this.a.currentTime+=this.getRemainingTime()},r.pause=function(){return this.a.pause()},r.play=function(){return this.a.play()},r.getVolume=function(){return this.a.volume},r.setVolume=function(e){this.a.volume=e},r.isMuted=function(){return this.a.muted},r.resize=function(){},r.setMuted=function(e){this.a.muted=e},r.getSequenceLength=function(){var e=this.c.getAdPodInfo();return null==e?1:e.getTotalAds()},r.getPositionInSequence=function(){var e=this.c.getAdPodInfo();return null==e?1:e.getAdPosition()},r.release=function(){this.a=this.b=this.c=null},G("shaka.ads.ServerSideAd",Uu),Uu.prototype.release=Uu.prototype.release,Uu.prototype.getPositionInSequence=Uu.prototype.getPositionInSequence,Uu.prototype.getSequenceLength=Uu.prototype.getSequenceLength,Uu.prototype.setMuted=Uu.prototype.setMuted,Uu.prototype.resize=Uu.prototype.resize,Uu.prototype.isMuted=Uu.prototype.isMuted,Uu.prototype.setVolume=Uu.prototype.setVolume,Uu.prototype.getVolume=Uu.prototype.getVolume,Uu.prototype.play=Uu.prototype.play,Uu.prototype.pause=Uu.prototype.pause,Uu.prototype.skip=Uu.prototype.skip,Uu.prototype.canSkipNow=Uu.prototype.canSkipNow,Uu.prototype.getTimeUntilSkippable=Uu.prototype.getTimeUntilSkippable,Uu.prototype.isSkippable=Uu.prototype.isSkippable,Uu.prototype.isPaused=Uu.prototype.isPaused,Uu.prototype.getRemainingTime=Uu.prototype.getRemainingTime,Uu.prototype.getMinSuggestedDuration=Uu.prototype.getMinSuggestedDuration,Uu.prototype.getDuration=Uu.prototype.getDuration,Bu.prototype.stop=function(){this.c.reset(),this.l="",this.j=null},Bu.prototype.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.c.onTimedMetadata(t)}},m(Gu,Qi),(r=Gu.prototype).setLocale=function(e){this.c=e},r.initClientSide=function(t,n){var r=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new le(2,10,1e4);this.b=new Ou(t,n,this.c,(function(e){if(e&&e.type)switch(e.type){case"ads-loaded":r.f.a.push(e.loadTime);break;case"ad-started":r.f.c++;break;case"ad-complete":r.f.b++;break;case"ad-skipped":r.f.f++}r.dispatchEvent(e)}))},r.onAssetUnload=function(){this.b&&this.b.stop(),this.dispatchEvent(new Xi("ad-stopped")),this.f=new Nu},r.requestClientSideAds=function(e){if(!this.b)throw new le(1,10,10001);var t=this.b;t.l=Date.now()/1e3,t.g.requestAds(e)},r.initServerSide=function(t,n){var r=this;if(!e.google||!google.ima||!google.ima.dai)throw new le(2,10,10002);this.a=new Bu(t,n,this.c,(function(e){if(e&&e.type)switch(e.type){case"ads-loaded":r.f.a.push(e.loadTime);break;case"ad-started":r.f.c++;break;case"ad-complete":r.f.b++;break;case"ad-skipped":r.f.f++}r.dispatchEvent(e)}))},r.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.a)throw new le(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;(n.mpt||n.mpv)&&W('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v3.1.0";var r=t;return(n=this.a).g?n=Promise.reject(new le(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.C=!0),n.g=new fr,n.c.requestStream(e),n.l=r||"",n.D=Date.now()/1e3,n=n.g),n},r.replaceServerSideAdTagParameters=function(e){if(!this.a)throw new le(1,10,10003);(e.mpt||e.mpv)&&W('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v3.1.0",this.a.c.replaceAdTagParameters(e)},r.getStats=function(){var e=this.f;return{loadTimes:e.a,started:e.c,playedCompletely:e.b,skipped:e.f}},r.onDashTimedMetadata=function(e){if(this.a&&"urn:google:dai:2018"==e.schemeIdUri){var t=e.schemeIdUri,n=e.eventElement?e.eventElement.getAttribute("messageData"):null;this.a.c.processMetadata(t,n,e.startTime)}},r.onHlsTimedMetadata=function(e,t){this.a&&this.a.c.processMetadata("ID3",e.data,t)},r.onCueMetadataChange=function(e){this.a&&this.a.onCueMetadataChange(e)},G("shaka.ads.AdManager",Gu),Gu.prototype.onCueMetadataChange=Gu.prototype.onCueMetadataChange,Gu.prototype.onHlsTimedMetadata=Gu.prototype.onHlsTimedMetadata,Gu.prototype.onDashTimedMetadata=Gu.prototype.onDashTimedMetadata,Gu.prototype.getStats=Gu.prototype.getStats,Gu.prototype.replaceServerSideAdTagParameters=Gu.prototype.replaceServerSideAdTagParameters,Gu.prototype.requestServerSideStream=Gu.prototype.requestServerSideStream,Gu.prototype.initServerSide=Gu.prototype.initServerSide,Gu.prototype.requestClientSideAds=Gu.prototype.requestClientSideAds,Gu.prototype.onAssetUnload=Gu.prototype.onAssetUnload,Gu.prototype.initClientSide=Gu.prototype.initClientSide,Gu.prototype.setLocale=Gu.prototype.setLocale,Gu.ADS_LOADED="ads-loaded",Gu.AD_STARTED="ad-started",Gu.AD_FIRST_QUARTILE="ad-first-quartile",Gu.AD_MIDPOINT="ad-midpoint",Gu.AD_THIRD_QUARTILE="ad-third-quartile",Gu.AD_COMPLETE="ad-complete",Gu.AD_STOPPED="ad-stopped",Gu.AD_SKIPPED="ad-skipped",Gu.AD_VOLUME_CHANGED="ad-volume-changed",Gu.AD_MUTED="ad-muted",Gu.AD_PAUSED="ad-paused",Gu.AD_RESUMED="ad-resumed",Gu.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",Gu.CUEPOINTS_CHANGED="ad-cue-points-changed",Gu.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",Gu.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",Gu.AD_CLICKED="ad-clicked",Gu.AD_PROGRESS="ad-progress",Gu.AD_BUFFERING="ad-buffering",Gu.AD_IMPRESSION="ad-impression",Gu.AD_DURATION_CHANGED="ad-duration-changed",Gu.AD_CLOSED="ad-closed",Gu.AD_LOADED="ad-loaded",Gu.ALL_ADS_COMPLETED="all-ads-completed",Gu.AD_LINEAR_CHANGED="ad-linear-changed",Gu.AD_METADATA="ad-metadata",Gu.AD_RECOVERABLE_ERROR="ad-recoverable-error",Gu.AD_BREAK_READY="ad-break-ready",Gu.AD_INTERACTION="ad-interaction",Lu=function(){return new Gu};var Yu="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Vu="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),qu=["loop","playbackRate"],Wu=["pause","play"],zu={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getTextTracks:2,getStats:5,getVariantTracks:2,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10},Xu={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Qu=[["getConfiguration","configure"]],Ju=[["isTextTrackVisible","setTextTrackVisibility"]],Zu="addTextTrack addTextTrackAsync cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),$u=["attach","detach","load","unload"];function el(e,t,n,r,i,a){var o=this;this.T=e,this.f=new Ge(t),this.X=n,this.l=!1,this.C=r,this.M=i,this.H=a,this.b=this.h=!1,this.J="",this.j=null,this.v=function(){return al(o)},this.A=function(e,t){var n=Ku(t);switch(n.type){case"event":var r=n.targetName;n=new Xi((n=n.event).type,n),o.C(r,n);break;case"update":for(var i in r=n.update)for(var a in n=o.a[i]||{},r[i])n[a]=r[i][a];o.l&&(o.X(),o.l=!1);break;case"asyncComplete":if(i=n.id,n=n.error,a=o.c[i],delete o.c[i],a)if(n){for(r in i=new le(n.severity,n.category,n.code),n)i[r]=n[r];a.reject(i)}else a.resolve()}},this.a={video:{},player:{}},this.D=0,this.c={},this.g=null,dl.add(this)}function tl(e,t,n){cl=n,n.addUpdateListener(e.v),n.addMessageListener("urn:x-cast:com.google.shaka.v2",e.A),al(e),sl(e,{type:"init",initState:t,appData:e.j}),e.g.resolve()}function nl(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.g.reject(new le(2,8,n,t))}function rl(e,t){var n=e.H();e.g=new fr,e.l=!0,tl(e,n,t)}function il(e){var t=cl;t.removeUpdateListener(e.v),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.A)}function al(e){var t=!!cl&&"connected"==cl.status;if(e.b&&!t){for(var n in e.M(),e.a)e.a[n]={};ol(e)}e.b=t,e.J=t?cl.receiver.friendlyName:"",e.f.Yb()}function ol(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new le(1,7,7e3))}}function sl(e,t){var n=Hu(t),r=cl;try{r.sendMessage("urn:x-cast:com.google.shaka.v2",n,(function(){}),X)}catch(t){throw r=new Xi("error",{detail:n=new le(2,8,8005,t)}),e.C("player",r),e.qb(),n}}(r=el.prototype).destroy=function(){return dl.delete(this),ol(this),cl&&il(this),this.f&&(this.f.stop(),this.f=null),this.M=this.C=null,this.b=this.h=!1,this.A=this.v=this.g=this.c=this.a=this.j=null,Promise.resolve()},r.oa=function(){return this.b},r.vd=function(){return this.J},r.init=function(){if(this.T.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.h=!0,this.f.Yb();var t=new chrome.cast.SessionRequest(this.T);t=new chrome.cast.ApiConfig(t,(function(e){for(var t=l(dl),n=t.next();!n.done;n=t.next())rl(n.value,e)}),(function(e){for(var t=l(dl),n=t.next();!n.done;n=t.next())n=n.value,ll="available"==e,n.f.Yb()}),"origin_scoped"),chrome.cast.initialize(t,(function(){}),(function(){})),ll&&this.f.N(ul),(t=cl)&&t.status!=chrome.cast.SessionStatus.STOPPED?rl(this,t):cl=null}else e.__onGCastApiAvailable||(e.__onGCastApiAvailable=fl),e.__onGCastApiAvailable!=fl&&W("A global Cast SDK hook is already installed! Shaka Player will be unable to receive a notification when the Cast SDK is ready.")},r.Dd=function(e){this.j=e,this.b&&sl(this,{type:"appData",appData:this.j})},r.cast=function(e){var t=this;return x((function(n){if(!t.h)throw new le(1,8,8e3);if(!ll)throw new le(1,8,8001);if(t.b)throw new le(1,8,8002);return t.g=new fr,chrome.cast.requestSession((function(n){return tl(t,e,n)}),(function(e){return nl(t,e)})),T(n,t.g,0)}))},r.qb=function(){if(this.b){if(ol(this),cl){il(this);try{cl.stop((function(){}),(function(){}))}catch(e){}cl=null}al(this)}},r.get=function(e,t){var n=this;if("video"==e){if(Wu.includes(t))return function(r){for(var i=[],a=0;a<arguments.length;++a)i[a]=arguments[a];return n.ee.apply(n,[e,t].concat(c(i)))}}else if("player"==e){if(Xu[t]&&!this.get("player","isLive")())return function(){};if(Zu.includes(t))return function(r){for(var i=[],a=0;a<arguments.length;++a)i[a]=arguments[a];return n.ee.apply(n,[e,t].concat(c(i)))};if($u.includes(t))return function(r){for(var i=[],a=0;a<arguments.length;++a)i[a]=arguments[a];return n.tf.apply(n,[e,t].concat(c(i)))};if(zu[t])return function(){return n.a[e][t]}}return this.a[e][t]},r.set=function(e,t,n){this.a[e][t]=n,sl(this,{type:"set",targetName:e,property:t,value:n})},r.ee=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];sl(this,{type:"call",targetName:e,methodName:t,args:r})},r.tf=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];i=new fr;var a=this.D.toString();this.D++,this.c[a]=i;try{sl(this,{type:"asyncCall",targetName:e,methodName:t,args:r,id:a})}catch(e){i.reject(e)}return i};var ul=.02,ll=!1,cl=null,dl=new Set;function fl(e){if(e)for(var t=(e=l(dl)).next();!t.done;t=e.next())t.value.init()}function hl(e,t,n){Qi.call(this);var r=this;this.f=e,this.c=t,this.b=this.j=this.g=this.l=this.h=null,this.A=n,this.v=new Map,this.a=new el(n,(function(){return ml(r)}),(function(){return vl(r)}),(function(e,t){return Tl(r,e,t)}),(function(){return yl(r)}),(function(){return gl(r)})),function(e){e.a.init(),e.b=new xr;for(var t=l(Yu),n=t.next();!n.done;n=t.next())e.b.s(e.f,n.value,(function(t){e.a.oa()||(t=new Xi(t.type,t),e.g.dispatchEvent(t))}));for(var r in Au)e.b.s(e.c,Au[r],(function(t){e.a.oa()||e.j.dispatchEvent(t)}));for(var i in e.h={},t={},e.f)t.Db=i,Object.defineProperty(e.h,t.Db,{configurable:!1,enumerable:!0,get:function(t){return function(){return El(e,t.Db)}}(t),set:function(t){return function(n){var r=t.Db;e.a.oa()?e.a.set("video",r,n):e.f[r]=n}}(t)}),t={Db:t.Db};e.l={},pl(e,(function(t){Object.defineProperty(e.l,t,{configurable:!1,enumerable:!0,get:function(){return function(e,t){if(e.v.has(t)&&(t=e.v.get(t)),"addEventListener"==t)return function(t,n,r){return e.j.addEventListener(t,n,r)};if("removeEventListener"==t)return function(t,n,r){return e.j.removeEventListener(t,n,r)};if("getMediaElement"==t)return function(){return e.h};if("getSharedConfiguration"==t)return e.a.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.c.Nb()};if("getAdManager"==t)return function(){return e.c.Td()};if("setVideoContainer"==t)return function(t){return e.c.ne(t)};if(e.a.oa()){if("getManifest"==t||"drmInfo"==t)return function(){return W(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return W(t+"() does not work while casting!"),Promise.resolve()}}return e.a.oa()&&0==Object.keys(e.a.a.video).length&&zu[t]||!e.a.oa()?e.c[t].bind(e.c):e.a.get("player",t)}(e,t)}})})),function(e){var t=new Map;pl(e,(function(n,r){if(t.has(r)){var i=t.get(r);n.length<i.length?e.v.set(n,i):e.v.set(i,n)}else t.set(r,n)}))}(e),e.g=new Qi,e.g.hc=e.h,e.j=new Qi,e.j.hc=e.l}(this)}function pl(e,t){function n(e){return"constructor"!=e&&"function"==typeof r[e]&&!i.has(e)}var r=e.c,i=new Set;for(a in r)n(a)&&(i.add(a),t(a,r[a]));for(var a=Object.getPrototypeOf(r),o=Object.getPrototypeOf({});a&&a!=o;){for(var s=l(Object.getOwnPropertyNames(a)),u=s.next();!u.done;u=s.next())n(u=u.value)&&(i.add(u),t(u,r[u]));a=Object.getPrototypeOf(a)}}function gl(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.c.fd(),startTime:null};e.f.pause();for(var n=l(qu),r=n.next();!r.done;r=n.next())r=r.value,t.video[r]=e.f[r];for(e.f.ended||(t.startTime=e.f.currentTime),r=(n=l(Qu)).next();!r.done;r=n.next()){var i=r.value;r=i[1],i=e.c[i[0]](),t.player[r]=i}for(r=(n=l(Ju)).next();!r.done;r=n.next())r=(i=r.value)[1],i=e.c[i[0]](),t.playerAfterLoad[r]=i;return t}function ml(e){var t=new Xi("caststatuschanged");e.dispatchEvent(t)}function vl(e){var t=new Xi(e.h.paused?"pause":"play");e.g.dispatchEvent(t)}function yl(e){for(var t=l(Qu),n=t.next();!n.done;n=t.next()){var r=n.value;n=r[1],r=e.a.get("player",r[0])(),e.c[n](r)}var i=e.a.get("player","getAssetUri")();n=e.a.get("video","ended"),t=Promise.resolve();var a=e.f.autoplay;r=null,n||(r=e.a.get("video","currentTime")),i&&(e.f.autoplay=!1,t=e.c.load(i,r));var o={};for(r=(n=l(qu)).next();!r.done;r=n.next())r=r.value,o[r]=e.a.get("video",r);t.then((function(){if(e.f){for(var t=l(qu),n=t.next();!n.done;n=t.next())n=n.value,e.f[n]=o[n];for(n=(t=l(Ju)).next();!n.done;n=t.next()){var r=n.value;n=r[1],r=e.a.get("player",r[0])(),e.c[n](r)}e.f.autoplay=a,i&&e.f.play()}}),(function(t){t=new Xi(au,{detail:t}),e.c.dispatchEvent(t)}))}function El(e,t){if("addEventListener"==t)return function(t,n,r){return e.g.addEventListener(t,n,r)};if("removeEventListener"==t)return function(t,n,r){return e.g.removeEventListener(t,n,r)};if(e.a.oa()&&0==Object.keys(e.a.a.video).length){var n=e.f[t];if("function"!=typeof n)return n}return e.a.oa()?e.a.get("video",t):("function"==typeof(n=e.f[t])&&(n=n.bind(e.f)),n)}function Tl(e,t,n){e.a.oa()&&("video"==t?e.g.dispatchEvent(n):"player"==t&&e.j.dispatchEvent(n))}function _l(e,t,n,r){Qi.call(this);var i=this;this.a=e,this.c=t,this.b=new xr,this.J={video:e,player:t},this.C=n||function(){},this.M=r||function(e){return e},this.f=null,this.D=!1,this.j=!0,this.h=0,this.A=!1,this.v=!0,this.l=this.g=null,this.H=new Ge((function(){wl(i)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return bl(e)},t.onSenderDisconnected=function(){return bl(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&Dl(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.g),Dl(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.g)},e.l=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.l.onMessage=function(t){return function(e,t){var n=Ku(t.data);switch(n.type){case"PLAY":e.a.play(),Ml(e);break;case"PAUSE":e.a.pause(),Ml(e);break;case"SEEK":var r=n.currentTime,i=n.resumeState;null!=r&&(e.a.currentTime=Number(r)),i&&"PLAYBACK_START"==i?(e.a.play(),Ml(e)):i&&"PLAYBACK_PAUSE"==i&&(e.a.pause(),Ml(e));break;case"STOP":e.c.Kd().then((function(){e.c&&Ml(e)}));break;case"GET_STATUS":Rl(e,Number(n.requestId));break;case"VOLUME":r=(i=n.volume).level,i=i.muted;var a=e.a.volume,o=e.a.muted;null!=r&&(e.a.volume=Number(r)),null!=i&&(e.a.muted=i),a==e.a.volume&&o==e.a.muted||Ml(e);break;case"LOAD":e.h=0,e.A=!1,e.v=!1,r=n.media,i=n.currentTime,a=e.M(r.contentId),o=n.autoplay||!0,e.C(r.customData),o&&(e.a.autoplay=!0),e.c.load(a,i).then((function(){e.c&&Rl(e)})).catch((function(t){var r="LOAD_FAILED";7==t.category&&7e3==t.code&&(r="LOAD_CANCELLED"),Dl(e,{requestId:Number(n.requestId),type:r},e.l)}));break;default:Dl(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.l)}}(e,t)},e.g=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.g.onMessage=function(t){return function(e,t){var n=Ku(t.data);switch(n.type){case"init":e.h=0,e.A=!1,e.v=!0,function(e,t,n){var r,i,a,o,s,u,l,c,d;x((function(f){switch(f.a){case 1:for(r in t.player)i=t.player[r],e.c[r](i);return e.C(n),a=e.a.autoplay,t.manifest?(e.a.autoplay=!1,b(f,5),T(f,e.c.load(t.manifest,t.startTime),7)):T(f,Promise.resolve(),3);case 7:S(f,3);break;case 5:return o=w(f),s=new Xi(au,{detail:o}),e.c&&e.c.dispatchEvent(s),f.return();case 3:if(!e.c)return f.return();for(u in t.video)l=t.video[u],e.a[u]=l;for(c in t.playerAfterLoad)d=t.playerAfterLoad[c],e.c[c](d);e.a.autoplay=a,t.manifest&&(e.a.play(),Ml(e)),_(f)}}))}(e,n.initState,n.appData),wl(e);break;case"appData":e.C(n.appData);break;case"set":var r=n.targetName,i=n.property;if(n=n.value,"video"==r){var a=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){a.setSystemVolumeLevel(n);break}if("muted"==i){a.setSystemVolumeMuted(n);break}}e.J[r][i]=n;break;case"call":(r=e.J[n.targetName])[n.methodName].apply(r,n.args);break;case"asyncCall":r=n.targetName,i=n.methodName,"player"==r&&"load"==i&&(e.h=0,e.A=!1);var o=n.id,s=t.senderId;n=(a=e.J[r])[i].apply(a,n.args),"player"==r&&"load"==i&&(n=n.then((function(){e.v=!0}))),n.then((function(){return Cl(e,s,o,null)}),(function(t){return Cl(e,s,o,t)}))}}(e,t)},t.start();for(var n=(t=l(Yu)).next();!n.done;n=t.next())e.b.s(e.a,n.value,(function(t){return Sl(e,"video",t)}));for(var r in Au)e.b.s(e.c,Au[r],(function(t){return Sl(e,"player",t)}));cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.c.Fd(3840,2160):e.c.Fd(1920,1080),e.b.s(e.a,"loadeddata",(function(){e.A=!0})),e.b.s(e.c,"loading",(function(){e.j=!1,Al(e)})),e.b.s(e.a,"playing",(function(){e.j=!1,Al(e)})),e.b.s(e.a,"pause",(function(){Al(e)})),e.b.s(e.c,"unloading",(function(){e.j=!0,Al(e)})),e.b.s(e.a,"ended",(function(){new Ge((function(){e.a&&e.a.ended&&(e.j=!0,Al(e))})).N(Nl)}))}(this)}function bl(e){e.h=0,e.v=!0,e.D=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Al(e)}function Al(e){var t;x((function(n){return 1==n.a?T(n,Promise.resolve(),2):e.c?(t=new Xi("caststatuschanged"),e.dispatchEvent(t),Il(e)||Ml(e),void _(n)):n.return()}))}function Sl(e,t,n){e.c&&(wl(e),Dl(e,{type:"event",targetName:t,event:n},e.g))}function wl(e){e.H.N(Ll);for(var t={video:{},player:{}},n=l(Vu),r=n.next();!r.done;r=n.next())r=r.value,t.video[r]=e.a[r];if(e.c.U())for(var i in Xu)0==e.h%Xu[i]&&(t.player[i]=e.c[i]());for(var a in zu)0==e.h%zu[a]&&(t.player[a]=e.c[a]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),e.A&&(e.h+=1),Dl(e,{type:"update",update:t},e.g),Il(e)}function Il(e){return!(!e.v||!e.a.duration&&!e.c.U()||(Rl(e),e.v=!1,0))}function Rl(e,t){var n={contentId:e.c.fd(),streamType:e.c.U()?"LIVE":"BUFFERED",contentType:""};e.c.U()||(n.duration=e.a.duration),e.f&&(n.metadata=e.f),Ml(e,void 0===t?0:t,n)}function Cl(e,t,n,r){e.c&&Dl(e,{type:"asyncComplete",id:n,error:r},e.g,t)}function Dl(e,t,n,r){e.D&&(e=Hu(t),r?n.getCastChannel(r).send(e):n.broadcast(e))}function Ml(e,t,n){n=void 0===n?null:n;var r={mediaSessionId:0,playbackRate:e.a.playbackRate,playerState:e.j?xl:e.c.hd()?Pl:e.a.paused?kl:Ol,currentTime:e.a.currentTime,supportedMediaCommands:63,volume:{level:e.a.volume,muted:e.a.muted}};n&&(r.media=n),Dl(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[r]},e.l)}m(hl,Qi),(r=hl.prototype).destroy=function(e){return e&&this.a.qb(),this.b&&(this.b.release(),this.b=null),e=[],this.c&&(e.push(this.c.destroy()),this.c=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.f=null,Promise.all(e)},r.bf=function(){return this.h},r.Ue=function(){return this.l},r.xe=function(){return this.a.h&&ll},r.oa=function(){return this.a.oa()},r.vd=function(){return this.a.vd()},r.cast=function(){var e,t=this;return x((function(n){return 1==n.a?(e=gl(t),T(n,t.a.cast(e),2)):t.c?T(n,t.c.Kd(),0):n.return()}))},r.Dd=function(e){this.a.Dd(e)},r.Ef=function(){!function(e){if(e.b){var t=e.H();chrome.cast.requestSession((function(n){return tl(e,t,n)}),(function(t){return nl(e,t)}))}}(this.a)},r.qb=function(){this.a.qb()},r.Ae=function(e){var t=this;return x((function(n){if(1==n.a)return e==t.A?n.return():(t.A=e,t.a.qb(),T(n,t.a.destroy(),2));t.a=null,t.a=new el(e,(function(){return ml(t)}),(function(){return vl(t)}),(function(e,n){return Tl(t,e,n)}),(function(){return yl(t)}),(function(){return gl(t)})),t.a.init(),_(n)}))},G("shaka.cast.CastProxy",hl),hl.prototype.changeReceiverId=hl.prototype.Ae,hl.prototype.forceDisconnect=hl.prototype.qb,hl.prototype.suggestDisconnect=hl.prototype.Ef,hl.prototype.setAppData=hl.prototype.Dd,hl.prototype.cast=hl.prototype.cast,hl.prototype.receiverName=hl.prototype.vd,hl.prototype.isCasting=hl.prototype.oa,hl.prototype.canCast=hl.prototype.xe,hl.prototype.getPlayer=hl.prototype.Ue,hl.prototype.getVideo=hl.prototype.bf,hl.prototype.destroy=hl.prototype.destroy,m(_l,Qi),(r=_l.prototype).isConnected=function(){return this.D},r.ef=function(){return this.j},r.Af=function(e){this.f=e},r.De=function(){this.f=null},r.Bf=function(e){this.f||(this.f={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.f.title=e},r.zf=function(e){this.f||(this.f={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.f.images=[{url:e}]},r.yf=function(e){this.f||(this.f={}),this.f.artist=e,this.f.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},r.destroy=function(){var e,t=this;return x((function(n){if(1==n.a)return t.b&&(t.b.release(),t.b=null),e=[],t.c&&(e.push(t.c.destroy()),t.c=null),t.H&&(t.H.stop(),t.H=null),t.a=null,t.J=null,t.C=null,t.D=!1,t.j=!0,t.g=null,t.l=null,T(n,Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),_(n)}))},G("shaka.cast.CastReceiver",_l),_l.prototype.destroy=_l.prototype.destroy,_l.prototype.setContentArtist=_l.prototype.yf,_l.prototype.setContentImage=_l.prototype.zf,_l.prototype.setContentTitle=_l.prototype.Bf,_l.prototype.clearContentMetadata=_l.prototype.De,_l.prototype.setContentMetadata=_l.prototype.Af,_l.prototype.isIdle=_l.prototype.ef,_l.prototype.isConnected=_l.prototype.isConnected;var Ll=.5,Nl=5,xl="IDLE",Ol="PLAYING",Pl="BUFFERING",kl="PAUSED";function Fl(e){var t=this;this.a=[],this.b=[],this.data=[],(new Me).box("moov",Le).S("pssh",(function(e){if(!(1<e.version)){var n=oe(e.reader.P,-12,e.size);if(t.data.push(n),t.a.push(nt(e.reader.Va(16))),0<e.version){n=e.reader.I();for(var r=(n=l(ee(n))).next();!r.done;r=n.next())r=nt(e.reader.Va(16)),t.b.push(r)}}})).parse(e)}function Ul(e){var t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),n=e.length,r=t.length+16+n,i=new Uint8Array(r),a=se(i),o=0;return a.setUint32(o,r),o+=4,a.setUint32(o,1886614376),o+=4,a.setUint32(o,0),o+=4,i.set(t,o),o+=t.length,a.setUint32(o,n),i.set(e,o+4),i}function Bl(e,t){var n=jl(e,t);return 1!=n.length?null:n[0]}function Gl(e,t,n){return 1!=(e=Hl(e,t,n)).length?null:e[0]}function jl(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName==t}))}function Hl(e,t,n){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t}))}function Kl(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Yl(e){return Array.from(e.childNodes).every(Vl)?e.textContent.trim():null}function Vl(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}function ql(e,t,n,r){r=void 0===r?null:r;var i=null;return null!=(e=e.getAttribute(t))&&(i=n(e)),null==i?r:i}function Wl(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null}function zl(e){return e&&(e=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null}function Xl(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function Ql(e){return 0==(e=Number(e))%1?e:null}function Jl(e){return 0==(e=Number(e))%1&&0<e?e:null}function Zl(e){return 0==(e=Number(e))%1&&0<=e?e:null}function $l(e){return e=Number(e),isNaN(e)?null:e}function ec(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e}function tc(e,t){var n=new DOMParser,r=null,i=null;try{i=n.parseFromString(e,"text/xml")}catch(e){}return i&&i.documentElement.tagName==t&&(r=i.documentElement),r&&0<r.getElementsByTagName("parsererror").length?null:r}function nc(e,t){try{return tc(fe(e),t)}catch(e){return null}}function rc(e,t,n){var r=function(e){for(var t=[],n=(e=l(e)).next();!n.done;n=e.next())(n=ac(n.value))&&t.push(n);return t}(e),i=null;e=[];var a=[],o=new Set(r.map((function(e){return e.keyId})));if(o.delete(null),1<o.size)throw new le(2,4,4010);if(t||(a=r.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.he||(i=e.init||i,!1)}))).length&&0==(e=function(e,t,n){for(var r=[],i=(t=l(t)).next();!i.done;i=t.next()){var a,o=n[(i=i.value).he];o&&(a=(a=Gl(i.node,"urn:microsoft:playready","pro"))?[{initData:Ul(a=et(a.textContent)),initDataType:"cenc",keyId:i.keyId}]:null,a=or(o,i.init||e||a),(o=sc.get(o))&&(a.licenseServerUri=o(i)),r.push(a))}return r}(i,a,n)).length&&(e=[or("",i)]),r.length&&(t||!a.length))for(e=[],n=(t=l(Object.values(n))).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(or(n,i));if(o=Array.from(o)[0]||null)for(n=(t=l(e)).next();!n.done;n=t.next())for(r=(n=l(n.value.initData)).next();!r.done;r=n.next())r.value.keyId=o;return{Od:o,kg:i,drmInfos:e,Sd:!0}}function ic(e){return(e=Gl(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=se(e),r=n.getUint32(t,!0);if(r!=e.byteLength)return[];e:{for(e=t+4+2,t=[];e<n.byteLength-1;){r=n.getUint16(e,!0),e+=2;var i=n.getUint16(e,!0);if(e+=2,0!=(1&i)||i+e>n.byteLength){n=[];break e}var a=oe(n,e,i);t.push({type:r,value:a}),e+=i}n=t}return n}(e=et(e.textContent)).filter((function(e){return e.type===oc}))[0])&&(e=tc(e=he(e.value,!0),"WRMHEADER"))?function(e){for(var t=(e=l(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=l(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""}function ac(e){var t=e.getAttribute("schemeIdUri"),n=Kl(e,"urn:mpeg:cenc:2013","default_KID"),r=Hl(e,"urn:mpeg:cenc:2013","pssh").map(Yl);if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new le(2,4,4009);var i=[];try{i=r.map((function(e){return{initDataType:"cenc",initData:et(e),keyId:null}}))}catch(e){throw new le(2,4,4007)}return{node:e,he:t,keyId:n,init:0<i.length?i:null}}var oc=1,sc=(new Map).set("com.widevine.alpha",(function(e){return(e=Gl(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",ic).set("com.microsoft.playready.recommendation",ic).set("com.microsoft.playready.software",ic).set("com.microsoft.playready.hardware",ic);function uc(t,n,r,i,a){var o={RepresentationID:n,Number:r,Bandwidth:i,Time:a};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,n,r,i){if("$$"==t)return"$";var a=o[n];if(null==a)return t;switch("RepresentationID"==n&&r&&(r=void 0),"Time"==n&&(a=Math.round(a)),i){case void 0:case"d":case"i":case"u":t=a.toString();break;case"o":t=a.toString(8);break;case"x":t=a.toString(16);break;case"X":t=a.toString(16).toUpperCase();break;default:t=a.toString()}return r=e.parseInt(r,10)||1,Array(Math.max(0,r-t.length)+1).join("0")+t}))}function lc(e,t){var n=cc(e,t,"timescale"),r=1;n&&(r=Jl(n)||1);var i=cc(e,t,"duration");n=Jl(i||""),"image"==e.G.contentType&&(n=$l(i||"")),n&&(n/=r);var a=cc(e,t,"startNumber");i=Number(cc(e,t,"presentationTimeOffset"))||0;var o=Zl(a||"");null!=a&&null!=o||(o=1);var s=dc(e,t,"SegmentTimeline");if(a=null,s){a=r;var u=e.O.duration||1/0,c=jl(s,"S");s=[];for(var d=-i,f=(c=l(te(c))).next();!f.done;f=c.next()){var h=(f=f.value).item,p=f.next,g=ql(h,"t",Zl);f=ql(h,"d",Zl);var m=ql(h,"r",Ql);if(null!=g&&(g-=i),!f)break;if(h=null!=g?g:d,0>(g=m||0))if(p){if(null==(p=ql(p,"t",Zl)))break;if(h>=p)break;g=Math.ceil((p-h)/f)-1}else{if(1/0==u)break;if(h/a>=u)break;g=Math.ceil((u*a-h)/f)-1}for(0<s.length&&h!=d&&(s[s.length-1].end=h/a),g=(p=l(ee(g+1))).next();!g.done;g=p.next())d=h+f,s.push({start:h/a,end:d/a,Jf:h}),h=d}a=s}return{timescale:r,ca:n,Cb:o,Pa:i/r||0,Ld:i,timeline:a}}function cc(e,t,n){return[t(e.G),t(e.ea),t(e.la)].filter(Ce).map((function(e){return e.getAttribute(n)})).reduce((function(e,t){return e||t}))}function dc(e,t,n){return[t(e.G),t(e.ea),t(e.la)].filter(Ce).map((function(e){return Bl(e,n)})).reduce((function(e,t){return e||t}))}function fc(e,t,n,r,i,a,o){var s,u=(new Me).S("sidx",(function(e){s=function(e,t,n,r,i,a,o){var s=[];o.reader.skip(4);var u=o.reader.I();if(0==u)throw new le(2,3,3005);if(0==o.version)var c=o.reader.I(),d=o.reader.I();else c=o.reader.gb(),d=o.reader.gb();o.reader.skip(2);var f=o.reader.Bb();for(e=e+o.size+d,d=(f=l(ee(f))).next();!d.done;d=f.next()){var h=o.reader.I();d=(2147483648&h)>>>31,h&=2147483647;var p=o.reader.I();if(o.reader.skip(4),1==d)throw new le(2,3,3006);s.push(new za(c/u+n,(c+p)/u+n,(function(){return a}),e,e+h-1,t,n,r,i)),c+=p,e+=h}return o.parser.stop(),s}(t,r,i,a,o,n,e)}));if(e&&u.parse(e),s)return s;throw new le(2,3,3004)}function hc(e){this.b=se(e),this.a=new ye(this.b,0)}function pc(e){var t=gc(e);if(7<t.length)throw new le(2,3,3002);for(var n=0,r=(t=l(t)).next();!r.done;r=t.next())n=256*n+r.value;t=gc(e);e:{for(var i=(r=l(mc)).next();!i.done;i=r.next())if(re(t,new Uint8Array(i.value))){r=!0;break e}r=!1}if(r)t=e.b.byteLength-e.a.Z();else{if(8==t.length&&224&t[1])throw new le(2,3,3001);r=0;for(var a=(i=l(te(t))).next();!a.done;a=i.next()){var o=(a=a.value).item;r=0==a.ba?o&(1<<8-t.length)-1:256*r+o}t=r}return t=e.a.Z()+t<=e.b.byteLength?t:e.b.byteLength-e.a.Z(),r=se(e.b,e.a.Z(),t),e.a.skip(t),new vc(n,r)}function gc(e){var t=e.a.Z(),n=e.a.V();if(0==n)throw new le(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.a.skip(n-1),oe(e.b,t,n)}hc.prototype.ha=function(){return this.a.ha()};var mc=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function vc(e,t){this.id=e,this.a=t}function yc(e){if(8<e.a.byteLength)throw new le(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new le(2,3,3001);for(var t=0,n=l(ee(e.a.byteLength)),r=n.next();!r.done;r=n.next())t=256*t+(r=e.a.getUint8(r.value));return t}function Ec(e){var t=new hc(e.a);if(179!=(e=pc(t)).id)throw new le(2,3,3013);if(e=yc(e),183!=(t=pc(t)).id)throw new le(2,3,3012);t=new hc(t.a);for(var n=0;t.ha();){var r=pc(t);if(241==r.id){n=yc(r);break}}return{Kf:e,sf:n}}function Tc(e,t){var n=dc(e,t,"Initialization");if(!n)return null;var r=e.G.ua,i=n.getAttribute("sourceURL");i&&(r=ar(e.G.ua,[i])),i=0;var a=null;return(n=ql(n,"range",Xl))&&(i=n.start,a=n.end),new Wa((function(){return r}),i,a)}function _c(e,t,n,r,i,a,o){var s,u,l,c,d,f,h,p,g,m,v,y,E,_,b;return x((function(A){if(1==A.a)return s=e.presentationTimeline,u=!e.Za||!e.O.Xd,l=e.O.start,c=e.O.duration,d=e.G.mimeType.split("/")[1],h=null,p=[(f=t)(r,i,a),"webm"==d?f(n.ga(),n.da,n.Y):null],f=null,T(A,Promise.all(p),2);if(g=A.b,m=g[0],v=g[1]||null,E=l-o,_=l,b=c?l+c:1/0,"mp4"==d)var S=fc(m,i,r,n,E,_,b);else{if(440786851!=pc(S=new hc(v)).id)throw new le(2,3,3008);var w=pc(S);if(408125543!=w.id)throw new le(2,3,3009);S=w.a.byteOffset,w=new hc(w.a);for(var I=null;w.ha();){var R=pc(w);if(357149030==R.id){I=R;break}}if(!I)throw new le(2,3,3010);for(I=new hc(I.a),R=1e6,w=null;I.ha();){var C=pc(I);if(2807729==C.id)R=yc(C);else if(17545==C.id)if(4==C.a.byteLength)w=C.a.getFloat32(0);else{if(8!=C.a.byteLength)throw new le(2,3,3003);w=C.a.getFloat64(0)}}if(null==w)throw new le(2,3,3011);if(w*=I=R/1e9,475249515!=(R=pc(new hc(m))).id)throw new le(2,3,3007);S=function(e,t,n,r,i,a,o,s,u){function l(){return i}var c=[];e=new hc(e.a);for(var d=null,f=null;e.ha();){var h=pc(e);if(187==h.id){var p=Ec(h);p&&(h=n*p.Kf,p=t+p.sf,null!=d&&c.push(new za(d+o,h+o,l,f,p-1,a,o,s,u)),d=h,f=p)}}return null!=d&&c.push(new za(d+o,r+o,l,f,null,a,o,s,u)),c}(R,S,I,w,r,n,E,_,b)}return y=S,s.yb(y),h=new mo(y),u&&h.Sa(_,b,!0),A.return(h)}))}function bc(e){return e.Vb}function Ac(e){var t=dc(e,bc,"RepresentationIndex");return e=Xl((e=cc(e,bc,"indexRange"))||""),t&&(e=ql(t,"range",Xl,e)),e}function Sc(e,t){var n=e.G.mimeType.split("/")[1];if(e.G.contentType!=lr&&"mp4"!=n&&"webm"!=n)throw new le(2,4,4006);if("webm"==n&&!t)throw new le(2,4,4005)}function wc(e,t){var n=Tc(e,Ic),r=function(e){var t=function(e){return[e.G.Wa,e.ea.Wa,e.la.Wa].filter(Ce).map((function(e){return jl(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.Vd&&(e.Vd=!0),{hf:t.getAttribute("media"),start:(t=ql(t,"mediaRange",Xl,{start:0,end:null})).start,end:t.end}}))}(e),n=(e=lc(e,Ic)).Cb;0==n&&(n=1);var r=0;return e.ca?r=e.ca*(n-1):e.timeline&&0<e.timeline.length&&(r=e.timeline[0].start),{ca:e.ca,startTime:r,Cb:n,Pa:e.Pa,timeline:e.timeline,vb:t}}(e);if(!r.ca&&!r.timeline&&1<r.vb.length)throw new le(2,4,4002);if(!r.ca&&!e.O.duration&&!r.timeline&&1==r.vb.length)throw new le(2,4,4002);if(r.timeline&&0==r.timeline.length)throw new le(2,4,4002);var i=null,a=null;return e.la.id&&e.G.id&&(a=e.la.id+","+e.G.id,i=t[a]),n=function(e,t,n,r,i){var a=r.vb.length;r.timeline&&r.timeline.length!=r.vb.length&&(a=Math.min(r.timeline.length,r.vb.length));for(var o=e-r.Pa,s=t?e+t:1/0,u=[],c=r.startTime,d={},f=(a=l(ee(a))).next();!f.done;d={Oc:d.Oc},f=a.next()){f=f.value;var h,p=r.vb[f];d.Oc=ar(n,[p.hf]),h=null!=r.ca?c+r.ca:r.timeline?r.timeline[f].end:c+t,u.push(new za(e+c,e+h,function(e){return function(){return e.Oc}}(d),p.start,p.end,i,o,e,s)),c=h}return u}(e.O.start,e.O.duration,e.G.ua,r,n),r=!i,i?i.wb(n,e.presentationTimeline.Ua()):(e.presentationTimeline.yb(n),i=new mo(n),a&&e.Za&&(t[a]=i)),e.Za&&e.O.Xd||i.Sa(e.O.start,e.O.duration?e.O.start+e.O.duration:1/0,r),{rb:function(){return Promise.resolve(i)}}}function Ic(e){return e.Wa}function Rc(e,t,n,r,i){var a=function(e){var t=cc(e,Cc,"initialization");if(!t)return null;var n=e.G.id,r=e.bandwidth||null,i=e.G.ua;return new Wa((function(){var e=uc(t,n,null,r,null);return ar(i,[e])}),0,null)}(e),o=function(e){var t=lc(e,Cc),n=cc(e,Cc,"media");return e=cc(e,Cc,"index"),{ca:t.ca,timescale:t.timescale,Cb:t.Cb,Pa:t.Pa,Ld:t.Ld,timeline:t.timeline,od:n,Rb:e}}(e);!function(e){var t=e.Rb?1:0;if(t+=e.timeline?1:0,0==(t+=e.ca?1:0))throw new le(2,4,4002);if(1!=t&&(e.Rb&&(e.timeline=null),e.ca=null),!e.Rb&&!e.od)throw new le(2,4,4002)}(o);var s=Zi(e);if(o.Rb)return Sc(e,a),{rb:function(){var e=uc(o.Rb,s.G.id,null,s.bandwidth||null,null);return e=ar(s.G.ua,[e]),_c(s,t,a,e,0,null,o.Pa)}};if(o.ca)return r||(e.presentationTimeline.pd(o.ca),e.presentationTimeline.qd(e.O.start)),{rb:function(){return function(e,t,n,r){function i(e){var n=(e-f)*d,i=n+t.Pa;return new za(n+=s,Math.min(n+d,c),(function(){var t=uc(p,m,e,g,i*h);return ar(v,[t])}),0,null,r,y,s,c)}function a(){var e=[Math.max(o.Ua(),s),Math.min(o.Ta(),c)].map((function(e){return e-s}));return[Math.ceil(e[0]/d),Math.ceil(e[1]/d)-1].map((function(e){return e+f}))}var o=e.presentationTimeline,s=e.O.start,u=e.O.duration,c=u?s+u:1/0,d=t.ca,f=t.Cb,h=t.timescale,p=t.od,g=e.bandwidth||null,m=e.G.id,v=e.G.ua,y=s-t.Pa;u=a(),e=e.Za?Math.max(u[0],u[1]-n+1):u[0],n=u[1],u=[];for(var E=e;E<=n;++E){var T=i(E);u.push(T)}var _=new mo(u);if(o.Ta()<c){var b=Math.max(e,n+1);_.Fc(d,(function(){_.$a(o.Ua());var e=l(a());e.next(),e=e.next().value;for(var t=[];b<=e;){var n=i(b);t.push(n),b++}return o.Ta()>=c&&!t.length?null:t}))}return Promise.resolve(_)}(s,o,i,a)}};var u=null;r=null,e.la.id&&e.G.id&&(r=e.la.id+","+e.G.id,u=n[r]);var c=function(e,t,n){var r=e.O.start,i=e.O.duration,a=r-t.Pa;i=i?r+i:1/0;for(var o=[],s={},u=l(te(t.timeline)),c=u.next();!c.done;s={Nc:s.Nc,Qc:s.Qc,Tc:s.Tc,Kc:s.Kc,Vc:s.Vc,Lc:s.Lc},c=u.next()){var d=(c=c.value).item,f=d.start,h=d.Jf;d=d.end,s.Tc=c.ba+t.Cb,s.Vc=h+t.Ld,s.Qc=e.G.id,s.Kc=e.bandwidth||null,s.Nc=t.od,s.Lc=e.G.ua,o.push(new za(r+f,r+d,function(e){return function(){var t=uc(e.Nc,e.Qc,e.Tc,e.Kc||null,e.Vc);return ar(e.Lc,[t]).map((function(e){return e.toString()}))}}(s),0,null,n,a,r,i))}return o}(s,o,a),d=e.O.start,f=e.O.duration?e.O.start+e.O.duration:1/0,h=1/0!=f;return u?(h&&new mo(c).Sa(d,f,!0),u.wb(c,e.presentationTimeline.Ua())):(e.presentationTimeline.yb(c),u=new mo(c),r&&e.Za&&(n[r]=u)),h&&u.Sa(d,f),{rb:function(){return Promise.resolve(u)}}}function Cc(e){return e.Wb}function Dc(){this.g=[],this.a=[],this.b=[],this.f=[],this.c=[],this.h=new Set}function Mc(e){var t,n,r,i,a,o,s,u,c,d,f,h,p,g,m,v,y,E,_,b;return x((function(A){switch(A.a){case 1:if(t=cr,1==e.length)return A.return(e[0]);for(n=e.map((function(e){return e.filter((function(e){return e.type==t.Xa}))})),r=e.map((function(e){return e.filter((function(e){return e.type==t.Ja}))})),i=e.map((function(e){return e.filter((function(e){return e.type==t.$}))})),a=l(i),o=a.next();!o.done;o=a.next())o.value.push({id:0,originalId:"",primary:!1,type:lr,mimeType:"",codecs:"",language:"",label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null});return T(A,Lc([],n,0,Oc,kc),2);case 2:return s=A.b,T(A,Lc([],r,0,Oc,kc),3);case 3:return u=A.b,T(A,Lc([],i,0,Oc,kc),4);case 4:if(c=A.b,d=0,u.length&&s.length)for(g=l(s),m=g.next();!m.done;m=g.next())for(v=m.value,y=l(u),E=y.next();!E.done;E=y.next())_=E.value,b=d++,_.variantIds.push(b),v.variantIds.push(b);else for(f=u.concat(s),h=l(f),p=h.next();!p.done;p=h.next())p.value.variantIds=[d++];return A.return(u.concat(s,c))}}))}function Lc(e,t,n,r,i){var a,o,s,u,c,d,f,h,p,g,m,v,y,E,_,b,A,S,w;return x((function(I){switch(I.a){case 1:for(a=cr,o=[],s=l(te(t)),u=s.next();!u.done;u=s.next())c=u.value,d=c.ba,f=c.item,d>=n?o.push(new Set(f)):o.push(new Set);h=l(e),p=h.next();case 2:if(p.done){I.m(4);break}return T(I,function(e,t,n,r,i){var a;return x((function(o){return 1==o.a?(a=Fc(t,e))?T(o,Promise.all(a.map((function(e){return e.createSegmentIndex()}))),2):o.return(!1):(Nc(e,a,n,r,i),o.return(!0))}))}(p.value,t,n,i,o),5);case 5:if(!I.b)throw new le(2,4,4037);p=h.next(),I.m(2);break;case 4:g=l(o),m=g.next();case 6:if(m.done){I.m(8);break}v=m.value,y=l(v),E=y.next();case 9:if(E.done){m=g.next(),I.m(6);break}return T(I,function(e,t,n,r,i){var a,o;return x((function(s){return 1==s.a?(a=n(e),(o=Fc(t,a))?a.createSegmentIndex?T(s,Promise.all(o.map((function(e){return e.createSegmentIndex()}))),2):s.m(2):s.return(null)):(Nc(a,o,0,r,i),s.return(a))}))}(E.value,t,r,i,o),12);case 12:(_=I.b)&&e.push(_),E=y.next(),I.m(9);break;case 8:for(b=l(o),m=b.next();!m.done;m=b.next())for(A=m.value,S={},w=l(A),E=w.next();!E.done;S={ob:S.ob},E=w.next())if(S.ob=E.value,(S.ob.type!=a.$||S.ob.language)&&e.some(function(e){return function(t){return t.mimeType==e.ob.mimeType&&br(t.codecs)==br(e.ob.codecs)}}(S)))throw new le(2,4,4037);return I.return(e)}}))}function Nc(e,t,n,r,i){for(var a=(t=l(te(t))).next();!a.done;a=t.next()){var o=a.value;if(a=o.ba,o=o.item,a>=n){r(e,o);var s=!0;"audio"==e.type&&0==ni(e.language,o.language)&&(s=!1),s&&i[a].delete(o)}}}function xc(e){return(e=Object.assign({},e)).originalId=null,e.createSegmentIndex=function(){return Promise.resolve()},e.segmentIndex=new Eo,e.emsgSchemeIdUris=[],e.keyIds=new Set,e.closedCaptions=null,e.trickModeVideo=null,e}function Oc(e){return(e=Object.assign({},e)).keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function Pc(e,t){e.roles=Array.from(new Set(e.roles.concat(t.roles))),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=Array.from(new Set(e.emsgSchemeIdUris.concat(t.emsgSchemeIdUris))));var n=t.keyIds;if(n=new Set(c(e.keyIds).concat(c(n))),e.keyIds=n,null==e.originalId?e.originalId=t.originalId:e.originalId+=","+(t.originalId||""),n=Na(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!n.length)throw new le(2,4,4038);if(e.drmInfos=n,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions){e.closedCaptions||(e.closedCaptions=new Map);for(var r=(n=l(t.closedCaptions)).next();!r.done;r=n.next()){var i=l(r.value);r=i.next().value,i=i.next().value,e.closedCaptions.set(r,i)}}e.segmentIndex.g.push(t.segmentIndex),t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=xc(t.trickModeVideo),e.trickModeVideo.segmentIndex=e.segmentIndex.clone()),Pc(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&Pc(e.trickModeVideo,t)}function kc(e,t){e.roles=Array.from(new Set(e.roles.concat(t.roles)));var n=t.keyIds;if(n=new Set(c(e.keyIds).concat(c(n))),e.keyIds=n,e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,c(t.segments)),t.closedCaptions){e.closedCaptions||(e.closedCaptions=new Map);for(var r=(n=l(t.closedCaptions)).next();!r.done;r=n.next()){var i=l(r.value);r=i.next().value,i=i.next().value,e.closedCaptions.set(r,i)}}}function Fc(e,t){for(var n=[],r=l(e),i=r.next();!i.done;i=r.next()){for(var a=t,o={audio:Uc,video:Uc,text:Bc,image:Gc}[a.type],s={audio:jc,video:Hc,text:Kc,image:Yc}[a.type],u=null,c=(i=l(i.value)).next();!c.done;c=i.next())!o(a,c=c.value)||u&&!s(a,u,c)||(u=c);if(!(a=u))return null;n.push(a)}return n}function Uc(e,t){var n;if(!(n=t.mimeType!=e.mimeType||br(t.codecs)!=br(e.codecs))&&(n=e.drmInfos)){n=e.drmInfos;var r=t.drmInfos;n=!(!n.length||!r.length||0<Na(n,r).length)}return!n}function Bc(e,t){return!!e.language&&(!t.language||0!=ni(e.language,t.language)&&t.kind==e.kind)}function Gc(e){return!!e.tilesLayout}function jc(e,t,n){if(e.id==n.id)return!0;var r=ni(e.language,t.language),i=ni(e.language,n.language);return i>r||!(i<r)&&(!(t.primary||!n.primary)||!(t.primary&&!n.primary)&&(e.roles.length?(r=t.roles.filter((function(t){return e.roles.includes(t)})),(i=n.roles.filter((function(t){return e.roles.includes(t)}))).length>r.length||!(i.length<r.length)&&n.roles.length<t.roles.length):!(n.roles.length||!t.roles.length)||!(n.roles.length&&!t.roles.length)&&((r=Vc(e.channelsCount,t.channelsCount,n.channelsCount))==Wc||r!=Xc&&((r=Vc(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate))==Wc||r!=Xc&&!(!e.bandwidth||qc(e.bandwidth,t.bandwidth,n.bandwidth)!=Wc)))))}function Hc(e,t,n){if(e.id==n.id)return!0;var r=Vc(e.width*e.height,t.width*t.height,n.width*n.height);if(r==Wc)return!0;if(r==Xc)return!1;if(e.frameRate){if((r=Vc(e.frameRate,t.frameRate,n.frameRate))==Wc)return!0;if(r==Xc)return!1}return!(!e.bandwidth||qc(e.bandwidth,t.bandwidth,n.bandwidth)!=Wc)}function Kc(e,t,n){if(e.id==n.id)return!0;var r=ni(e.language,t.language),i=ni(e.language,n.language);if(i>r)return!0;if(i<r)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(e.roles.length){if(r=t.roles.filter((function(t){return e.roles.includes(t)})),(i=n.roles.filter((function(t){return e.roles.includes(t)}))).length>r.length)return!0;if(i.length<r.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function Yc(e,t,n){return e.id==n.id||n.mimeType==e.mimeType}function Vc(e,t,n){if(t==e&&e!=n)return Xc;if(n==e&&e!=t)return Wc;if(t>e){if(n<=e||n-e<t-e)return Wc;if(n-e>t-e)return Xc}else{if(n>e)return Xc;if(e-n<e-t)return Wc;if(e-n>e-t)return Xc}return zc}function qc(e,t,n){return t=Math.abs(e-t),(e=Math.abs(e-n))<t?Wc:t<e?Xc:zc}Dc.prototype.release=function(){for(var e=l(this.a.concat(this.b,this.f,this.c)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.a=[],this.b=[],this.f=[],this.c=[],this.g=[]};var Wc=1,zc=0,Xc=-1;function Qc(){var e=this;this.u=this.i=null,this.b=[],this.o=null,this.A=1,this.f={},this.a=new Dc,this.l=0,this.v=new j(5),this.j=new Ge((function(){e.Sb()})),this.g=new $i,this.c=1/0,this.h=!1}function Jc(e){var t,n,r,i,a,o,s;return x((function(u){return 1==u.a?(t=ra(e.b,e.i.retryParameters),n=e.u.networkingEngine,r=Date.now(),i=n.request(0,t),ea(e.g,i),T(u,i.promise,2)):3!=u.a?(a=u.b,e.u?(a.uri&&!e.b.includes(a.uri)&&e.b.unshift(a.uri),T(u,function(e,t,n){var r,i,a,o;return x((function(s){if(1==s.a){if(!(r=nc(t,"MPD")))throw new le(2,4,4001,n);return e.i.dash.disableXlinkProcessing?s.return(Zc(e,r,n)):(i=e.i.dash.xlinkFailGracefully,a=function e(t,n,r,i,a,o){if(o=void 0===o?0:o,Kl(t,"http://www.w3.org/1999/xlink","href")){var s=function(t,n,r,i,a,o){for(var s=Kl(t,"http://www.w3.org/1999/xlink","href"),u=Kl(t,"http://www.w3.org/1999/xlink","actuate")||"onRequest",c=l(Array.from(t.attributes)),d=c.next();!d.done;d=c.next())"http://www.w3.org/1999/xlink"==(d=d.value).namespaceURI&&t.removeAttributeNS(d.namespaceURI,d.localName);if(5<=o)return Yi(new le(2,4,4028));if("onLoad"!=u)return Yi(new le(2,4,4027));var f=ar([i],[s]);return a.request(0,ra(f,n)).W((function(i){if(!(i=nc(i.data,t.tagName)))return Yi(new le(2,4,4001,s));for(;t.childNodes.length;)t.removeChild(t.childNodes[0]);for(;i.childNodes.length;){var u=i.childNodes[0];i.removeChild(u),t.appendChild(u)}for(u=(i=l(Array.from(i.attributes))).next();!u.done;u=i.next())t.setAttributeNode(u.value.cloneNode(!1));return e(t,n,r,f[0],a,o+1)}))}(t,n,r,i,a,o);return r&&(s=s.W(void 0,(function(){return e(t,n,r,i,a,o)}))),s}s=[];for(var u=l(Array.from(t.childNodes)),c=u.next();!c.done;c=u.next())(c=c.value)instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Kl(c,"http://www.w3.org/1999/xlink","href")?t.removeChild(c):"SegmentTimeline"!=c.tagName&&s.push(e(c,n,r,i,a,o)));return zi(s).W((function(){return t}))}(r,e.i.retryParameters,i,n,e.u.networkingEngine),ea(e.g,a),T(s,a.promise,2))}return o=s.b,s.return(Zc(e,o,n))}))}(e,a.data,a.uri),3)):u.return(0)):(o=Date.now(),s=(o-r)/1e3,H(e.v,1,s),u.return(s))}))}function Zc(e,t,n){var r,i,a,o,s,u,c,d,f,h,p,g,m,v,y,E,A,I,R,C,D,M,L,N,O,P,k;return x((function(F){switch(F.a){case 1:if(r=[n],0<(i=jl(t,"Location").map(Yl).filter(Ce)).length&&(a=ar(r,i),r=e.b=a),o=jl(t,"BaseURL"),s=o.map(Yl),u=ar(r,s),c=0,o&&o.length&&(c=ql(o[0],"availabilityTimeOffset",$l)||0),d=e.i.dash.ignoreMinBufferTime,f=0,d||(f=ql(t,"minBufferTime",zl)||0),e.l=ql(t,"minimumUpdatePeriod",zl,-1),h=ql(t,"availabilityStartTime",Wl),p=ql(t,"timeShiftBufferDepth",zl),g=e.i.dash.ignoreSuggestedPresentationDelay,m=null,g||(m=ql(t,"suggestedPresentationDelay",zl)),v=e.i.dash.ignoreMaxSegmentDuration,y=null,v||(y=ql(t,"maxSegmentDuration",zl)),E=t.getAttribute("type")||"static",e.o)for(A=e.o.presentationTimeline,I=l(Object.values(e.f)),R=I.next();!R.done;R=I.next())R.value.$a(A.Ua());else C=e.i.defaultPresentationDelay||1.5*f,A=new Xa(h,null!=m?m:C,e.i.dash.autoCorrectDrift);D=t.getAttribute("profiles")||"",M={Za:"static"!=E,presentationTimeline:A,la:null,O:null,ea:null,G:null,bandwidth:0,Vd:!1,pb:c,profiles:D.split(",")};for(var U=ql(t,"mediaPresentationDuration",zl),B=[],G=0,j=jl(t,"Period"),H=(j=l(te(j))).next();!H.done;H=j.next()){var K=H.value;H=K.item,K=K.next,G=ql(H,"start",zl,G);var Y=ql(H,"duration",zl),V=null;if(K){var q=ql(K,"start",zl);null!=q&&(V=q-G)}else null!=U&&(V=U-G);if(null==V&&(V=Y),H=$c(e,M,u,{start:G,duration:V,node:H,Xd:null==V||!K}),B.push(H),null==V){G=null;break}G+=V}return N=(L=null!=U?{periods:B,duration:U,Qd:!1}:{periods:B,duration:G,Qd:!0}).duration,O=L.periods,A.Xb("static"==E),"static"!=E&&L.Qd||A.Fa(N||1/0),e.c&&!e.h&&e.u.isAutoLowLatencyMode()&&(e.u.enableLowLatencyMode(),e.h=e.u.isLowLatencyMode()),e.h?A.ke(e.c):e.c&&W("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),A.U()&&!isNaN(e.i.availabilityWindowOverride)&&(p=e.i.availabilityWindowOverride),null==p&&(p=1/0),A.Hd(p),A.pd(y||1),T(F,function(e,t,n){var r,i,a,o,s,u,c,d,f,h,p,g,m,v,y,E,b,A,S,w,I,R,C,D,M,L,N,O,P;return x((function(x){switch(x.a){case 1:if(r=cr,function(e){for(var t=(e=l(e)).next();!t.done;t=e.next()){for(var n=[],r=l((t=t.value).mc),i=r.next();!i.done;i=r.next()){i=i.value;for(var a=!1,o=l(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.channelsCount==s.channelsCount&&i.language==s.language&&i.bandwidth==s.bandwidth&&i.label==s.label&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&lt(i.roles,s.roles)&&i.audioSamplingRate==s.audioSamplingRate&&i.primary==s.primary&&(a=!0);a||n.push(i)}t.mc=n}}(t),function(e){for(var t=(e=l(e)).next();!t.done;t=e.next()){for(var n=[],r=l((t=t.value).Hc),i=r.next();!i.done;i=r.next()){i=i.value;for(var a=!1,o=l(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.width==s.width&&i.frameRate==s.frameRate&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&i.label==s.label&&lt(i.roles,s.roles)&&pa(i.closedCaptions,s.closedCaptions)&&i.bandwidth==s.bandwidth&&(a=!0);a||n.push(i)}t.Hc=n}}(t),function(e){for(var t=(e=l(e)).next();!t.done;t=e.next()){for(var n=[],r=l((t=t.value).textStreams),i=r.next();!i.done;i=r.next()){i=i.value;for(var a=!1,o=l(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.language==s.language&&i.label==s.label&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&lt(i.roles,s.roles)&&(a=!0);a||n.push(i)}t.textStreams=n}}(t),!n&&1==t.length){i=t[0],e.a=i.mc,e.b=i.Hc,e.f=i.textStreams,e.c=i.imageStreams,x.m(2);break}for(a=-1,o=l(te(t)),s=o.next();!s.done;s=o.next())u=s.value,c=u.ba,d=u.item,e.h.has(d.id)||(e.h.add(d.id),-1==a&&(a=c));if(-1==a)return x.return();for(f=t.map((function(e){return e.mc})),h=t.map((function(e){return e.Hc})),p=t.map((function(e){return e.textStreams})),g=t.map((function(e){return e.imageStreams})),m=l(p),v=m.next();!v.done;v=m.next())v.value.push({id:0,originalId:"",createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new mo([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",label:null,type:lr,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null});return T(x,Lc(e.a,f,a,xc,Pc),3);case 3:return T(x,Lc(e.b,h,a,xc,Pc),4);case 4:return T(x,Lc(e.f,p,a,xc,Pc),5);case 5:return T(x,Lc(e.c,g,a,xc,Pc),2);case 2:if(y=0,E=[],e.b.length&&e.a.length)for(R=l(e.a),C=R.next();!C.done;C=R.next())for(D=C.value,M=l(e.b),L=M.next();!L.done;L=M.next())N=L.value,O=Na(D.drmInfos,N.drmInfos),D.drmInfos.length&&N.drmInfos.length&&!O.length||(P=y++,E.push({id:P,language:D.language,primary:D.primary,audio:D,video:N,bandwidth:(D.bandwidth||0)+(N.bandwidth||0),drmInfos:O,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(b=e.b.concat(e.a),A=l(b),S=A.next();!S.done;S=A.next())w=S.value,I=y++,E.push({id:I,language:w.language,primary:w.primary,audio:w.type==r.Xa?w:null,video:w.type==r.Ja?w:null,bandwidth:w.bandwidth||0,drmInfos:w.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});e.g=E,_(x)}}))}(e.a,O,M.Za),2);case 2:if(e.o){e.o.variants=e.a.g,e.o.textStreams=e.a.f,e.o.imageStreams=e.a.c,e.u.filter(e.o),F.m(3);break}if(e.o={presentationTimeline:A,variants:e.a.g,textStreams:e.a.f,imageStreams:e.a.c,offlineSessionIds:[],minBufferTime:f||0},!A.pe()){F.m(3);break}return P=jl(t,"UTCTiming"),T(F,function(e,t,n){var r,i,a,o,s,u,c,d;return x((function(f){switch(f.a){case 1:r=n.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}})),i=e.i.dash.clockSyncUri,!r.length&&i&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),a=l(r),o=a.next();case 2:if(o.done){f.m(4);break}switch(s=o.value,b(f,5),u=s.scheme,c=s.value,u){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return f.m(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return f.m(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return d=Date.parse(c),f.return(isNaN(d)?0:d-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":W("NTP UTCTiming scheme is not supported");break;default:W("Unrecognized scheme in UTCTiming element",u)}f.m(9);break;case 7:return T(f,rd(e,t,c,"HEAD"),10);case 10:return f.return(f.b);case 8:return T(f,rd(e,t,c,"GET"),11);case 11:return f.return(f.b);case 9:S(f,3);break;case 5:w(f);case 3:o=a.next(),f.m(2);break;case 4:return W("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),f.return(0)}}))}(e,u,P),5);case 5:if(k=F.b,!e.u)return F.return();A.le(k);case 3:e.u.makeTextStreamsForClosedCaptions(e.o),_(F)}}))}function $c(e,t,n,r){t.la=nd(r.node,null,n),t.O=r,t.la.pb=t.pb,t.la.id||(t.la.id="__shaka_period_"+r.start);for(var i=(n=l(n=jl(r.node,"EventStream"))).next();!i.done;i=n.next())id(e,r.start,r.duration,i.value);if(n=jl(r.node,"AdaptationSet").map((function(n){return function(e,t,n){t.ea=nd(n,t.la,null);var r=!1,i=jl(n,"Role"),a=i.map((function(e){return e.getAttribute("value")})).filter(Ce),o=void 0,s=t.ea.contentType==lr;s&&(o="subtitle");for(var u=(i=l(i)).next();!u.done;u=i.next()){var d=(u=u.value).getAttribute("schemeIdUri");if(null==d||"urn:mpeg:dash:role:2011"==d)switch(u=u.getAttribute("value"),u){case"main":r=!0;break;case"caption":case"subtitle":o=u}}i=null,u=!1;for(var f=(d=l(d=jl(n,"EssentialProperty"))).next();!f.done;f=d.next())"http://dashif.org/guidelines/trickmode"==(f=f.value).getAttribute("schemeIdUri")?i=f.getAttribute("value"):u=!0;d=jl(n,"Accessibility");var h=new Map;for(f=(d=l(d)).next();!f.done;f=d.next()){var p=f.value;if(f=p.getAttribute("schemeIdUri"),p=p.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==f)if(f=1,null!=p)for(var g=l(p=p.split(";")),m=g.next();!m.done;m=g.next()){var v=m.value,y=m=void 0;v.includes("=")?(m=(v=v.split("="))[0].startsWith("CC")?v[0]:"CC"+v[0],y=v[1]):(m="CC"+f,2==p.length?f+=2:f++,y=v),h.set(m,ti(y))}else h.set("CC1","und");else if("urn:scte:dash:cc:cea-708:2015"==f)if(f=1,null!=p)for(m=(p=l(p.split(";"))).next();!m.done;m=p.next())v=g=void 0,(m=m.value).includes("=")?(g="svc"+(m=m.split("="))[0],v=m[1].split(",")[0].split(":").pop()):(g="svc"+f,f++,v=m),h.set(g,ti(v));else h.set("svc1","und");else"urn:mpeg:dash:role:2011"==f&&null!=p&&(a.push(p),"captions"==p&&(o="caption"))}if(u)return null;var E=rc(u=jl(n,"ContentProtection"),e.i.dash.ignoreDrmInfo,e.i.dash.keySystemsByURI),b=ti(n.getAttribute("lang")||"und"),A=n.getAttribute("label");if((u=jl(n,"Label"))&&u.length&&(u=u[0]).textContent&&(A=u.textContent),0==(n=(u=jl(n,"Representation")).map((function(n){return function(e,t,n,r,i,a,o,s,u,l){if(t.G=nd(l,t.ea,null),e.c=Math.min(e.c,t.G.pb),!function(e){var t=e.Vb?1:0;return t+=e.Wa?1:0,0==(t+=e.Wb?1:0)?e.contentType==lr||"application"==e.contentType:(1!=t&&(e.Vb&&(e.Wa=null),e.Wb=null),!0)}(t.G))return null;var c=t.O.start;t.bandwidth=ql(l,"bandwidth",Jl)||0;var d=t.G.contentType,f=d==lr||"application"==d;d="image"==d;try{var h=function(t,n,r){return function(e,t,n,r){var i,a,o,s,u;return x((function(l){return 1==l.a?(i=oa,a=Do(t,n,r,e.i.retryParameters),o=e.u.networkingEngine,s=o.request(i,a),ea(e.g,s),T(l,s.promise,2)):(u=l.b,l.return(u.data))}))}(e,t,n,r)};if(t.G.Vb)var p=function(e,t){var n=Number(cc(e,bc,"presentationTimeOffset"))||0,r=cc(e,bc,"timescale"),i=1;r&&(i=Jl(r)||1);var a=n/i||0,o=Tc(e,bc);!function(e,t){if(Sc(e,t),!Ac(e))throw new le(2,4,4002)}(e,o);var s=Zi(e);return{rb:function(){var e=dc(s,bc,"RepresentationIndex"),n=s.G.ua;return e&&(e=e.getAttribute("sourceURL"))&&(n=ar(s.G.ua,[e])),e=Ac(s),_c(s,t,o,n,e.start,e.end,a)}}}(t,h);else if(t.G.Wa)p=wc(t,e.f);else if(t.G.Wb)p=Rc(t,h,e.f,!!e.o,e.i.dash.initialSegmentLimit);else{var g=t.G.ua,m=t.O.duration||0;p={rb:function(){return Promise.resolve(vo(c,m,g))}}}}catch(e){if((f||d)&&4002==e.code)return null;throw e}h=function(e,t,n,r){var i=rc(e,n,r);if(t.Sd)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==i.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=i.drmInfos),t.Sd=!1;else if(0<i.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return i.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new le(2,4,4008);return i.Od||t.Od}(h=jl(l,"ContentProtection"),n,e.i.dash.ignoreDrmInfo,e.i.dash.keySystemsByURI),h=new Set(h?[h]:[]);var v=!1;jl(l,"SupplementalProperty").some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.getAttribute("schemeIdUri")&&"JOC"==e.getAttribute("value")}))&&(t.G.mimeType="audio/eac3-joc",v=!0);var y,E,b=!1;if(f&&(b=s.includes("forced_subtitle")),d&&((l=jl(l,"EssentialProperty").find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.getAttribute("schemeIdUri"))})))&&(y=l.getAttribute("value")),!y))return null;l=t.G.codecs,t.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(l.includes("hvc1.2.4.L153.B0")||l.includes("hev1.2.4.L153.B0"))&&(E="PQ");var A={id:e.A++,originalId:t.G.id,createSegmentIndex:function(){var e;return x((function(t){if(1==t.a)return A.segmentIndex?t.m(0):(e=A,T(t,p.rb(),3));e.segmentIndex=t.b,_(t)}))},segmentIndex:null,mimeType:t.G.mimeType,codecs:t.G.codecs,frameRate:t.G.frameRate,pixelAspectRatio:t.G.pixelAspectRatio,bandwidth:t.bandwidth,width:t.G.width,height:t.G.height,kind:r,encrypted:0<n.drmInfos.length,drmInfos:n.drmInfos,keyIds:h,language:i,label:a,type:t.ea.contentType,primary:o,trickModeVideo:null,emsgSchemeIdUris:t.G.emsgSchemeIdUris,roles:s,forced:b,channelsCount:t.G.rd,audioSamplingRate:t.G.audioSamplingRate,spatialAudio:v,closedCaptions:u,hdr:E,tilesLayout:y};return A}(e,t,E,o,b,A,r,a,h,n)})).filter((function(e){return!!e}))).length){if(i="image"==t.ea.contentType,e.i.dash.ignoreEmptyAdaptationSet||s||i)return null;throw new le(2,4,4003)}if(!t.ea.contentType||"application"==t.ea.contentType)for(t.ea.contentType=ad(n[0].mimeType,n[0].codecs),d=(s=l(n)).next();!d.done;d=s.next())d.value.type=t.ea.contentType;for(d=(s=l(n)).next();!d.done;d=s.next())for(d=d.value,p=(f=l(E.drmInfos)).next();!p.done;p=f.next())(p=p.value).keyIds=p.keyIds&&d.keyIds?new Set(c(p.keyIds).concat(c(d.keyIds))):p.keyIds||d.keyIds;return s=u.map((function(e){return e.getAttribute("id")})).filter(Ce),{id:t.ea.id||"__fake__"+e.A++,contentType:t.ea.contentType,language:b,lg:r,streams:n,drmInfos:E.drmInfos,Jd:i,vf:s}}(e,t,n)})).filter(Ce),t.Za){r=[];for(var a=(i=l(n)).next();!a.done;a=i.next())for(var o=(a=l(a.value.vf)).next();!o.done;o=a.next())r.push(o.value);if(r.length!=new Set(r).size)throw new le(2,4,4018)}for(r=n.filter((function(e){return!e.Jd})),i=(n=l(n=n.filter((function(e){return e.Jd})))).next();!i.done;i=n.next()){a=(i=i.value).Jd.split(" ");for(var s=(o=l(r)).next();!s.done;s=o.next()){var u=s.value;if(a.includes(u.id)){s={};for(var d=(u=l(u.streams)).next();!d.done;s={dc:s.dc},d=u.next())s.dc=d.value,s.dc.trickModeVideo=i.streams.find(function(e){return function(t){return br(e.dc.codecs)==br(t.codecs)}}(s))}}}if(i=e.i.disableAudio?[]:ed(r,"audio"),o=e.i.disableVideo?[]:ed(r,"video"),a=e.i.disableText?[]:ed(r,lr),n=e.i.disableThumbnails?[]:ed(r,"image"),!o.length&&!i.length)throw new le(2,4,4004);for(r=[],s=(i=l(i)).next();!s.done;s=i.next())r.push.apply(r,c(s.value.streams));for(i=[],s=(o=l(o)).next();!s.done;s=o.next())i.push.apply(i,c(s.value.streams));for(o=[],s=(a=l(a)).next();!s.done;s=a.next())o.push.apply(o,c(s.value.streams));for(a=[],s=(n=l(n)).next();!s.done;s=n.next())a.push.apply(a,c(s.value.streams));return{id:t.la.id,mc:r,Hc:i,textStreams:o,imageStreams:a}}function ed(e,t){return e.filter((function(e){return e.contentType==t}))}function td(e,t){0>e.l||e.j.N(Math.max(3,e.l-t,K(e.v)))}function nd(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,rd:null,audioSamplingRate:null,pb:0},n=n||t.ua;for(var r=jl(e,"BaseURL"),i=r.map(Yl),a=e.getAttribute("contentType")||t.contentType,o=e.getAttribute("mimeType")||t.mimeType,s=e.getAttribute("codecs")||t.codecs,u=ql(e,"frameRate",ec)||t.frameRate,c=e.getAttribute("sar")||t.pixelAspectRatio,d=jl(e,"InbandEventStream"),f=t.emsgSchemeIdUris.slice(),h=(d=l(d)).next();!h.done;h=d.next())h=h.value.getAttribute("schemeIdUri"),f.includes(h)||f.push(h);d=function(e){for(var t=(e=l(e)).next();!t.done;t=e.next()){var n=t.value;if((t=n.getAttribute("schemeIdUri"))&&(n=n.getAttribute("value")))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(t=parseInt(n,10)))continue;return t;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(t=parseInt(n,16)))continue;for(e=0;t;)1&t&&++e,t>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(t=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(n=parseInt(n,10))&&0<n&&n<t.length)return t[n]}}return null}(d=jl(e,"AudioChannelConfiguration"))||t.rd,h=ql(e,"audioSamplingRate",Zl)||t.audioSamplingRate,a||(a=ad(o,s));var p=Bl(e,"SegmentBase"),g=Bl(e,"SegmentTemplate"),m=p&&ql(p,"availabilityTimeOffset",$l)||0,v=g&&ql(g,"availabilityTimeOffset",$l)||0;return r=r&&r.length&&ql(r[0],"availabilityTimeOffset",$l)||0,r=t.pb+r+m+v,{ua:ar(n,i),Vb:p||t.Vb,Wa:Bl(e,"SegmentList")||t.Wa,Wb:g||t.Wb,width:ql(e,"width",Zl)||t.width,height:ql(e,"height",Zl)||t.height,contentType:a,mimeType:o,codecs:s,frameRate:u,pixelAspectRatio:c,emsgSchemeIdUris:f,id:e.getAttribute("id"),rd:d,audioSamplingRate:h,pb:r}}function rd(e,t,n,r){var i,a,o,s,u,l;return x((function(c){if(1==c.a)return i=ar(t,[n]),(a=ra(i,e.i.retryParameters)).method=r,o=e.u.networkingEngine.request(4,a),ea(e.g,o),T(c,o.promise,2);if(s=c.b,"HEAD"==r){if(!s.headers||!s.headers.date)return c.return(0);u=s.headers.date}else u=fe(s.data);return l=Date.parse(u),isNaN(l)?c.return(0):c.return(l-Date.now())}))}function id(e,t,n,r){for(var i=r.getAttribute("schemeIdUri")||"",a=r.getAttribute("value")||"",o=ql(r,"timescale",Zl)||1,s=(r=l(jl(r,"Event"))).next();!s.done;s=r.next()){var u=ql(s=s.value,"presentationTime",Zl)||0,c=ql(s,"duration",Zl)||0;c=(u=u/o+t)+c/o,null!=n&&(u=Math.min(u,t+n),c=Math.min(c,t+n)),s={schemeIdUri:i,value:a,startTime:u,endTime:c,id:s.getAttribute("id")||"",eventElement:s},e.u.onTimelineRegionAdded(s)}}function ad(e,t){return wr(Tr(e,t))?lr:e.split("/")[0]}function od(e,t,n,r){this.a=e,this.type=t,this.R=n,this.segments=r||null}function sd(e,t,n,r){this.id=e,this.name=t,this.a=n,this.value=void 0===r?null:r}function ud(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function ld(e,t){var n=e.getAttribute(t);if(!n)throw new le(2,4,4023,t);return n.value}function cd(e,t,n){n=void 0===n?[]:n,this.R=t,this.a=e,this.b=n}function dd(e,t){this.name=e,this.value=t}function fd(e,t){return e.filter((function(e){return e.name==t}))}function hd(e,t){return e.filter((function(e){return ld(e,"TYPE")==t}))}function pd(e,t){var n=fd(e,t);return n.length?n[0]:null}function gd(e,t,n){return n=void 0===n?0:n,(e=pd(e,t))?Number(e.value):n}function md(e){this.b=e,this.a=0}function vd(e){yd(e,/[ \t]+/gm)}function yd(e,t){t.lastIndex=e.a;var n=t.exec(e.b);return n=null==n?null:{position:n.index,length:n[0].length,results:n},e.a==e.b.length||null==n||n.position!=e.a?null:(e.a+=n.length,n.results)}function Ed(e){return e.a==e.b.length?null:(e=yd(e,/[^ \t\n]*/gm))?e[0]:null}function Td(){this.a=0}function _d(e,t,n){var r=(t=(t=fe(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(r[0]))throw new le(2,4,4015);t=0;for(var i=!0,a=l(r),o=a.next();!o.done;o=a.next())if(o=o.value,/^#(?!EXT)/m.test(o)||i)i=!1;else{if(o=bd(e.a++,o),--e.a,Ad.includes(o.name)){t=1;break}"EXT-X-STREAM-INF"==o.name&&(i=!0)}a=[],i=!0;for(var s=(o=l(te(r))).next();!s.done;s=o.next()){var u=s.value;s=u.ba;var c=u.item;if(u=u.next,/^#(?!EXT)/m.test(c)||i)i=!1;else{if(c=bd(e.a++,c),Sd.includes(c.name)){if(1!=t)throw new le(2,4,4017);u=r.splice(s,r.length-s),r=n,i=[],o=[],s=[],c=null;for(var d=(u=l(u)).next();!d.done;d=u.next())d=d.value,/^(#EXT)/.test(d)?(d=bd(e.a++,d),Ad.includes(d.name)?a.push(d):"EXT-X-MAP"==d.name?c=d:"EXT-X-PART"==d.name?s.push(d):"EXT-X-PRELOAD-HINT"==d.name?"PART"==ud(d,"TYPE")?s.push(d):"MAP"==ud(d,"TYPE")&&(d.name="EXT-X-MAP",c=d):o.push(d)):/^#(?!EXT)/m.test(d)||(d=ar([r],[d.trim()])[0],c&&o.push(c),i.push(new cd(d,o,s)),o=[],s=[]);return s.length&&(c&&o.push(c),i.push(new cd("",o,s))),new od(n,t,a,i)}a.push(c),"EXT-X-STREAM-INF"==c.name&&(c.a.push(new dd("URI",u)),i=!0)}}return new od(n,t,a)}function bd(e,t){var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new le(2,4,4016,t);var r,i=n[1],a=n[2];if(n=[],a){var o;(o=yd(a=new md(a),/^([^,=]+)(?:,|$)/g))&&(r=o[1]);for(var s=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;o=yd(a,s);)n.push(new dd(o[1],o[2]||o[3]))}return new sd(e,i,n,r)}(r=Qc.prototype).configure=function(e){this.i=e},r.start=function(e,t){var n,r=this;return x((function(i){if(1==i.a)return r.h=t.isLowLatencyMode(),r.b=[e],r.u=t,T(i,Jc(r),2);if(n=i.b,r.u&&td(r,n),!r.u)throw new le(2,7,7001);return i.return(r.o)}))},r.stop=function(){for(var e=l(Object.values(this.f)),t=e.next();!t.done;t=e.next())t.value.release();return this.a&&this.a.release(),this.i=this.u=null,this.b=[],this.o=null,this.f={},this.a=null,null!=this.j&&(this.j.stop(),this.j=null),this.g.destroy()},r.update=function(){var e,t=this;return x((function(n){return 1==n.a?(b(n,2),T(n,Jc(t),4)):2!=n.a?S(n,0):(e=w(n),t.u&&e?(t.u.onError(e),void _(n)):n.return())}))},r.onExpirationUpdated=function(){},r.Sb=function(){var e,t,n=this;return x((function(r){switch(r.a){case 1:return e=0,b(r,2),T(r,Jc(n),4);case 4:e=r.b,S(r,3);break;case 2:t=w(r),n.u&&(t.severity=1,n.u.onError(t));case 3:if(!n.u)return r.return();td(n,e),_(r)}}))},G("shaka.dash.DashParser",Qc),qa.mpd=function(){return new Qc},Va["application/dash+xml"]=function(){return new Qc},Va["video/vnd.mpeg.dash.mpd"]=function(){return new Qc},sd.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},sd.prototype.getAttribute=function(e){var t=this.a.filter((function(t){return t.name==e}));return t.length?t[0]:null};var Ad="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP".split(" "),Sd="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function wd(){}function Id(e){try{var t=Rd(e);return qi({uri:e,ce:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return Yi(e)}}function Rd(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new le(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw new le(2,1,1004,t);var r=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=r.split(";"),r=n[0];var i=!1;return 1<n.length&&"base64"==n[n.length-1]&&(i=!0,n.pop()),{data:i?et(t):ge(t),contentType:r}}function Cd(){var e=this;this.i=this.u=null,this.Ya=1,this.l=new Map,this.h=new Map,this.Aa=new Set,this.b=new Map,this.a=null,this.H="",this.T=new Td,this.za=0,this.j=new Ge((function(){e.Sb()})),this.f=zd,this.o=null,this.ja=0,this.v=1/0,this.M=this.Ra=0,this.A=new $i,this.ka=[],this.D=new Map,this.Ia=!1,this.g=new Map,this.J=null,this.X=new Map,this.C=new Map,this.c=!1}function Dd(e,t){var n,r,i,a,o,s,u,l,c,d,f,h;return x((function(p){if(1==p.a)return n=Jd,r=t.ue,i=new qn(r),e.c&&t.ye&&Xn(i,new ir("_HLS_skip=YES")),T(p,Yd(e,ra([i.toString()],e.i.retryParameters),0),2);if(3!=p.a){if(a=p.b,1!=(o=_d(e.T,a.data,a.uri)).type)throw new le(2,4,4017);return s=fd(o.R,"EXT-X-DEFINE"),u=Md(e,s),l=t.stream,T(p,Bd(e,t.Gc,o,l.mimeType,t.nd,u,t.Fe),3)}c=p.b,l.segmentIndex.wb(c,e.a.Ua()),c.length&&(d=gd(o.R,"EXT-X-MEDIA-SEQUENCE",0),f=t.nd.get(d),l.segmentIndex.$a(f)),h=c[c.length-1],pd(o.R,"EXT-X-ENDLIST")&&(Kd(e,n.se),e.a.Fa(h.endTime)),_(p)}))}function Md(e,t){for(var n=new Map,r=l(t),i=r.next();!i.done;i=r.next()){var a=i.value;i=ud(a,"NAME");var o=ud(a,"VALUE");a=ud(a,"IMPORT"),i&&o&&n.set(i,o),a&&(i=e.l.get(a))&&n.set(a,i)}return n}function Ld(e,t){var n=[];e.i.disableVideo||n.push("avc1.42E01E"),e.i.disableAudio||n.push("mp4a.40.2");var r=ud(t,"CODECS",n.join(",")).split(/\s*,\s*/);n=new Set;for(var i=[],a=(r=l(r)).next();!a.done;a=r.next()){var o=br(a=a.value);n.has(o)||(i.push(a),n.add(o))}return i}function Nd(e){return ti(e=ud(e,"LANGUAGE")||"und")}function xd(e,t){var n,r,i,a,o,s,u,l,c,d,f,h,p;return x((function(g){if(1==g.a){n=ld(t,"GROUP-ID"),r="";var m=ld(t,"TYPE").toLowerCase();return"subtitles"==m&&(m=lr),(i=m)!=lr&&n&&e.g.has(n)&&(r=e.g.get(n)),a=Hd(ld(t,"URI"),e.l),e.b.has(a)?g.return(e.b.get(a)):(o=Nd(t),s=ud(t,"NAME"),u=t.getAttribute("DEFAULT"),l="YES"==u,m="audio"==i&&(m=ud(t,"CHANNELS"))?parseInt(m.split("/")[0],10):null,c=m,m="audio"==i&&!!(m=ud(t,"CHANNELS"))&&m.includes("/JOC"),d=m,f=ud(t,"CHARACTERISTICS"),h=ud(t,"FORCED"),T(g,Od(e,a,r,i,o,l,s,c,null,f,"YES"==h,d),2))}return p=g.b,e.h.has(n)?e.h.get(n).push(p):e.h.set(n,[p]),null==p?g.return(null):e.b.has(a)?g.return(e.b.get(a)):(e.b.set(a,p),g.return(p))}))}function Od(e,t,n,r,i,a,o,s,u,d,f,h){var p,g,m,v,y,E,_,A,I,R,C,D,M,L,N,O,P,k,F,U,B,G,j,H,K,Y,V,q,z,X,Q,J,Z,$,ee,te,ne,re,ie;return x((function(ae){switch(ae.a){case 1:return p=ar([e.H],[t])[0],T(ae,Yd(e,ra([p],e.i.retryParameters),0),2);case 2:if(g=ae.b,p=g.uri,1!=(m=_d(e.T,g.data,p)).type)throw new le(2,4,4017);if(v=[],m.segments)for(y=l(m.segments),E=y.next();!E.done;E=y.next())_=E.value,A=fd(_.R,"EXT-X-KEY"),v.push.apply(v,c(A));for(I=!1,R=[],C=new Set,D=l(v),M=D.next();!M.done;M=D.next())if(L=M.value,"NONE"!=(N=ld(L,"METHOD"))){if(I=!0,"AES-128"==N)return e.Ia=!0,ae.return(null);if(O=ld(L,"KEYFORMAT"),k=(P=Wd[O])?P(L):null){if(k.keyIds)for(F=l(k.keyIds),U=F.next();!U.done;U=F.next())B=U.value,C.add(B);R.push(k)}}if(I&&!R.length)throw new le(2,4,4026);return G=fd(m.R,"EXT-X-DEFINE"),j=Md(e,G),function(e,t){var n=pd(t.R,"EXT-X-PLAYLIST-TYPE"),r=pd(t.R,"EXT-X-ENDLIST");if(r=n&&"VOD"==n.value||r,n=n&&"EVENT"==n.value&&!r,n=!r&&!n,r)Kd(e,zd);else{if(Kd(e,n?Qd:Xd),!(r=pd(t.R,"EXT-X-TARGETDURATION")))throw new le(2,4,4024,"EXT-X-TARGETDURATION");r=Number(r.value),n=pd(t.R,"EXT-X-PART-INF"),e.c&&n?(e.Ra=Number(ld(n,"PART-TARGET")),e.v=Math.min(e.Ra,e.v),n=pd(t.R,"EXT-X-SERVER-CONTROL"),e.M=n?Number(ld(n,"PART-HOLD-BACK")):0):e.v=Math.min(r,e.v),e.ja=Math.max(r,e.ja)}}(e,m),T(ae,function(e,t,n,r,i){var a,o,s,u,l,c,d,f,h,p,g;return x((function(m){return 1==m.a?(a=cr,o=oa,s=Hd(r.segments[0].a,i),u=new qn(s),l=u.sa.split(".").pop(),c=qd[t],(d=c[l])?m.return(d):t==a.$?n&&"vtt"!=n&&"wvtt"!=n?m.return("application/mp4"):m.return("text/vtt"):((f=ra([s],e.i.retryParameters)).method="HEAD",T(m,Yd(e,f,o),2))):(h=m.b,(p=h.headers["content-type"])?m.return(p.split(";")[0]):(g=c.mp4,m.return(g)))}))}(e,r,n,m,j),3);case 3:return H=ae.b,Vd.includes(H)&&(n=""),K=new Map,Y=new Map,b(ae,4),T(ae,Bd(e,t,m,H,K,j,Y),6);case 6:V=ae.b,S(ae,5);break;case 4:if(4035==(q=w(ae)).code)return W("Skipping unsupported HLS stream",H,t),ae.return(null);throw q;case 5:if(z=V[0].startTime,X=V[V.length-1].endTime,Q=new mo(V),J=r==lr?"subtitle":void 0,Z=[],d)for($=l(d.split(",")),ee=$.next();!ee.done;ee=$.next())te=ee.value,Z.push(te);return re=!!(ne=pd(m.R,"EXT-X-SERVER-CONTROL"))&&null!=ne.getAttribute("CAN-SKIP-UNTIL"),ie={id:e.Ya++,originalId:o,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Q,mimeType:H,codecs:n,kind:J,encrypted:I,drmInfos:R,keyIds:C,language:i,label:o,type:r,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:Z,forced:f,channelsCount:s,audioSamplingRate:null,spatialAudio:h,closedCaptions:u,hdr:void 0,tilesLayout:void 0},ae.return({stream:ie,Gc:t,ue:p,Yd:z,gf:X,nd:K,Fe:Y,ye:re})}}))}function Pd(e,t,n,r){return(n=pd(n,"EXT-X-MAP"))?(t=[r=Hd(ar([t],[ld(n,"URI")])[0],r),ud(n,"BYTERANGE","")].join("-"),e.X.has(t)||(n=function(e,t){var n=0,r=null,i=ud(t,"BYTERANGE");return i&&(n=i.split("@"),r=Number(n[0]),r=(n=Number(n[1]))+r-1),new Wa((function(){return[e]}),n,r)}(r,n),e.X.set(t,n)),e.X.get(t)):null}function kd(e,t,n,r,i,a,o,s){var u=r.R,c=Hd(r.a,o),d=pd(u,"EXTINF"),f=o=0,h=null,p=[];if(e.c&&r.b.length){e={};for(var g=(r=l(te(r.b))).next();!g.done;e={Pc:e.Pc},g=r.next()){var m=(g=g.value).ba;g=g.item;var v=0==m?n:p[p.length-1];m=0==m?i:v.endTime;var y=Number(ud(g,"DURATION"));y=m+y;var E=0,T=null;"EXT-X-PRELOAD-HINT"==g.name?E=(v=ud(g,"BYTERANGE-START"))?Number(v):0:(E=(v=l(Fd(v,E=ud(g,"BYTERANGE")))).next().value,T=v.next().value),g=ud(g,"URI"),e.Pc=ar([s],[g])[0],p.push(new za(m,y,function(e){return function(){return[e.Pc]}}(e),E,T,t,a,0,1/0))}}else if(!d)throw new le(2,4,4024,"EXTINF");return o=d?i+Number(d.value.split(",")[0]):p[p.length-1].endTime,(s=pd(u,"EXT-X-BYTERANGE"))?(f=(n=l(Fd(n,s.value))).next().value,h=n.next().value):p.length&&(f=p[0].da,h=p[p.length-1].Y),new za(i,o,(function(){return c.length?[c]:[]}),f,h,t,a,0,1/0,p)}function Fd(e,t){var n=0,r=null;return t&&(n=t.split("@"),r=Number(n[0]),r=(n=n[1]?Number(n[1]):e.Y+1)+r-1),[n,r]}function Ud(e){if(e.a){for(var t=l(e.ka),n=t.next();!n.done;n=t.next())e.a.yb(n.value);e.ka=[]}}function Bd(e,t,n,r,i,a,o){var s,u,c,d,f,h,p,g,m,v,y,E,_,b,A,S,w,I,R,C;return x((function(D){switch(D.a){case 1:if(s=n.segments,c=gd(n.R,"EXT-X-MEDIA-SEQUENCE",0),f=(d=pd(n.R,"EXT-X-SKIP"))?Number(ud(d,"SKIPPED-SEGMENTS")):0,h=c+f,e.f!=zd&&i.has(h)){p=i.get(h),D.m(2);break}if(null!=e.J){D.m(3);break}return u=Pd(e,n.a,s[0].R,a),g=e,T(D,jd(e,t,u,r,h,!1,s[0],a),4);case 4:g.J=D.b;case 3:p=e.J;case 2:if(s[0].a.split("/").pop(),m=gd(n.R,"EXT-X-DISCONTINUITY-SEQUENCE"),e.c&&(o.has(m)||o.set(m,h),f))for(;o.has(m+1)&&o.get(m+1)<h;)m++;v=e.C.get(m)||0,y=[],E=l(function(e){return te(e)}(s)),_=E.next();case 5:if(_.done){D.m(7);break}if(b=_.value,A=b.ba,S=b.item,w=y[y.length-1],I=0==A?p:w.endTime,h=c+f+A,i.set(h,I),u=Pd(e,n.a,S.R,a),!pd(S.R,"EXT-X-DISCONTINUITY")){D.m(8);break}return m++,o.set(m,h),T(D,function(e,t,n,r,i,a,o,s,u){var l,c;return x((function(d){return 1==d.a?(l=0,e.C.has(t)?(l=e.C.get(t),d.m(2)):T(d,jd(e,n,r,i,a,!0,o,s),3)):(2!=d.a&&(c=d.b,l=u-c,e.C.set(t,l)),d.return(l))}))}(e,m,t,u,r,h,S,a,I),9);case 9:v=D.b;case 8:!e.c&&e.u.isAutoLowLatencyMode()&&(e.u.enableLowLatencyMode(),e.c=e.u.isLowLatencyMode()),R=pd(S.R,"EXTINF"),e.c||R?(C=kd(e,u,w,S,I,v,a,n.a),y.push(C)):e.c||W("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),_=E.next(),D.m(5);break;case 7:return e.ka.push(y),Ud(e),D.return(y)}}))}function Gd(e,t){var n,r,i,a,o,s;return x((function(u){switch(u.a){case 1:return n=oa,r=Do(t.ga(),t.da,t.Y,e.i.retryParameters),e.i.hls.useFullSegmentsForStartTime?u.return(Yd(e,r,n)):(i=Do(t.ga(),t.da,t.da+2048-1,e.i.retryParameters),b(u,2),T(u,Yd(e,i,n),4));case 4:return a=u.b,u.return(a);case 2:if(7001==(o=w(u)).code)throw o;return W("Unable to fetch the starting part of HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",i.uris[0]),T(u,Yd(e,r,n),5);case 5:return s=u.b,u.return(s)}}))}function jd(e,t,n,r,i,a,o,s){var u,l,c,d,f,h,p,g;return x((function(m){switch(m.a){case 1:if(u=kd(e,n,null,o,0,0,s,""),e.o&&!a&&(l=e.b.get(t),null!=(c=l.nd.get(i))))return m.return(c);if(r=r.toLowerCase(),Vd.includes(r))throw W("Raw formats are not yet supported.  Skipping "+r),new le(1,4,4035);if("video/webm"==r)throw W("WebM in HLS is not yet supported.  Skipping."),new le(1,4,4035);if("video/mp4"!=r&&"audio/mp4"!=r){m.m(2);break}return d=[Gd(e,u)],n&&d.push(Gd(e,n)),T(m,Promise.all(d),3);case 3:return f=m.b,h=f[0],p=f[1]||f[0],m.return(function(e,t,n,r){var i=0;if((new Me).box("moov",Le).box("trak",Le).box("mdia",Le).S("mdhd",(function(e){i=kn(e.reader,e.version).timescale,e.parser.stop()})).parse(r,!0),!i)throw new le(2,4,4030,e,t);var a=0,o=!1;if((new Me).box("moof",Le).box("traf",Le).S("tfdt",(function(e){a=Pn(e.reader,e.version).cd/i,o=!0,e.parser.stop()})).parse(n,!0),!o)throw new le(2,4,4030,e,t);return a}(t,h.uri,h.data,p.data));case 2:if("video/mp2t"!=r){m.m(4);break}return T(m,Gd(e,u),5);case 5:return g=m.b,m.return(function(e,t,n){function r(){a.seek(o+188),71!=(s=a.V())&&(a.seek(o+192),s=a.V()),71!=s&&(a.seek(o+204),s=a.V()),71!=s&&i(),a.fe(1)}function i(){throw new le(2,4,4030,e,t)}for(var a=new ye(n,0),o=0,s=0;;)if(o=a.Z(),71!=(s=a.V())&&i(),8191==(8191&(n=a.Bb())))r();else if(16384&n){if(0!=(n=(48&a.V())>>4)&&2!=n||i(),3==n&&(n=a.V(),a.skip(n)),1==a.I()>>8)return a.skip(3),0!=(n=a.V()>>6)&&1!=n||i(),0==a.V()&&i(),(1073741824*((14&(n=a.V()))>>1)+((65534&a.Bb())<<14|(65534&a.Bb())>>1))/9e4;r()}else r()}(t,g.uri,g.data));case 4:throw new le(2,4,4030,t)}}))}function Hd(e,t){var n=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}"),r=n.match(/{\$\w*}/g);if(r)for(var i=(r=l(r)).next();!i.done;i=r.next()){var a=(i=i.value).slice(2,i.length-1),o=t.get(a);if(!o)throw new le(2,4,4039,a);n=n.replace(i,o)}return n}function Kd(e,t){e.f=t,e.a&&e.a.Xb(e.f==zd),e.f!=zd||e.j.stop()}function Yd(e,t,n){if(!e.A)throw new le(2,7,7001);return t=e.u.networkingEngine.request(n,t),ea(e.A,t),t.promise}G("shaka.net.DataUriPlugin",wd),wd.parse=Id,na("data",Id),(r=Cd.prototype).configure=function(e){this.i=e},r.start=function(e,t){var n,r,i=this;return x((function(a){return 1==a.a?(i.u=t,i.c=t.isLowLatencyMode(),T(a,Yd(i,ra([e],i.i.retryParameters),0),2)):3!=a.a?(n=a.b,i.H=n.uri,T(a,function(e,t){var n,r,i,a,o,s,u,c,d,f,h,p,g,m,v,y,E,A,S,I,R,C,D,M;return x((function(L){switch(L.a){case 1:if(0!=(n=_d(e.T,t,e.H)).type)throw new le(2,4,4022);for(var N=l(fd(n.R,"EXT-X-DEFINE")),O=N.next();!O.done;O=N.next()){var P=O.value;O=ud(P,"NAME"),P=ud(P,"VALUE"),O&&P&&(e.l.has(O)||e.l.set(O,P))}for(r=fd(n.R,"EXT-X-MEDIA"),O=(N=l(i=fd(n.R,"EXT-X-STREAM-INF"))).next();!O.done;O=N.next()){var k=O.value;P=ud(k,"AUDIO"),O=ud(k,"VIDEO");var F=ud(k,"SUBTITLES");if(k=Ld(e,k),F){var U=ur(lr,k);e.g.set(F,U),ut(k,U)}P&&(F=sr("audio",k),e.g.set(P,F)),O&&(P=sr("video",k),e.g.set(O,P))}for(a=fd(n.R,"EXT-X-SESSION-DATA"),o=l(a),s=o.next();!s.done;s=o.next())u=s.value,c=ud(u,"DATA-ID"),d=ud(u,"URI"),f=ud(u,"LANGUAGE"),h=ud(u,"VALUE"),p={id:c},d&&(p.uri=ar([e.H],[d])[0]),f&&(p.language=f),h&&(p.value=h),g=new Xi("sessiondata",p),e.u&&e.u.onEvent(g);return T(L,function(e,t){var n;return x((function(r){return 1==r.a?(t=t.filter((function(e){var t=ud(e,"URI")||"";return"SUBTITLES"!=ud(e,"TYPE")&&""!=t}))).length?T(r,xd(e,t[0]),2):r.m(2):(n=t.slice(1).map((function(t){return xd(e,t)})),T(r,Promise.all(n),0))}))}(e,r),2);case 2:for(O=(N=l(N=hd(r,"CLOSED-CAPTIONS"))).next();!O.done;O=N.next())O=Nd(F=O.value),P=ld(F,"GROUP-ID"),F=ld(F,"INSTREAM-ID"),e.D.get(P)||e.D.set(P,new Map),e.D.get(P).set(F,O);return T(L,function(e,t){var n,r,i;return x((function(a){return 1==a.a?(n=t.map((function(t){var n,r,i,a,o,s,u,c;return x((function(d){return 1==d.a?(n=ud(t,"FRAME-RATE"),r=Number(ld(t,"BANDWIDTH")),i=ud(t,"RESOLUTION"),a=l(i?i.split("x"):[null,null]),o=a.next().value,s=a.next().value,u=ud(t,"VIDEO-RANGE"),T(d,function(e,t){var n,r,i,a,o,s,u,c,d,f,h,p,g,m;return x((function(v){if(1==v.a)return n=cr,r=Ld(e,t),i=ud(t,"AUDIO"),a=ud(t,"VIDEO"),s=(o=i||a)&&e.h.has(o)?e.h.get(o):[],u={audio:i?s:[],video:a?s:[]},d=!1,f=ld(t,"URI"),h=u.audio.find((function(e){return e&&e.Gc==f})),p=ur(n.Ja,r),(g=ur(n.Xa,r))&&!p?c=n.Xa:!s.length&&g&&p?(c=n.Ja,r=[[p,g].join()]):u.audio.length&&h?(c=n.Xa,d=!0):c=u.video.length?n.Xa:n.Ja,d?v.m(2):T(v,function(e,t,n,r){var i,a,o,s;return x((function(u){if(1==u.a){if(i=Hd(ld(t,"URI"),e.l),e.b.has(i))return u.return(e.b.get(i));var l=ud(t,"CLOSED-CAPTIONS");return a="video"==r&&l&&"NONE"!=l?e.D.get(l):null,o=sr(r,n),T(u,Od(e,i,o,r,"und",!1,null,null,a,null,!1,!1),2)}return null==(s=u.b)?u.return(null):e.b.has(i)?u.return(e.b.get(i)):(e.b.set(i,s),u.return(s))}))}(e,t,r,c),3);if(2!=v.a&&(m=v.b),m)u[m.stream.type]=[m];else if(null===m)return v.return(null);return function(e){for(var t=(e=l(e.audio.concat(e.video))).next();!t.done;t=e.next())if(t=t.value){var n=t.stream.codecs.split(",");n=n.filter((function(e){return"mp4a.40.34"!=e})),t.stream.codecs=n.join(",")}}(u),v.return(u)}))}(e,t),2)):(c=d.b)?d.return(function(e,t,n,r,i,a,o,s){for(var u=l(n),c=u.next();!c.done;c=u.next()){var d=a,f=o,h=s;(c=c.value.stream)&&(c.width=Number(i)||void 0,c.height=Number(d)||void 0,c.frameRate=Number(f)||void 0,c.hdr=h||void 0)}for(i=e.i.disableAudio,(!t.length||i)&&(t=[null]),i=e.i.disableVideo,(!n.length||i)&&(n=[null]),i=[],a=(t=l(t)).next();!a.done;a=t.next())for(a=a.value,s=(o=l(n)).next();!s.done;s=o.next())f=s.value,s=a?a.stream:null,u=f?f.stream:null,c=a?a.stream.drmInfos:null,d=f?f.stream.drmInfos:null,f=(f?f.Gc:"")+" - "+(a?a.Gc:""),s&&u&&c.length&&d.length&&!(0<Na(c,d).length)||e.Aa.has(f)||(s={id:e.Ya++,language:s?s.language:"und",primary:!!s&&s.primary||!!u&&u.primary,audio:s,video:u,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},i.push(s),e.Aa.add(f));return i}(e,c.audio,c.video,r,o,s,n,u)):d.return([])}))})),T(a,Promise.all(n),2)):(r=a.b,i=(i=r.reduce(Ie,[])).filter((function(e){return null!=e})),a.return(i))}))}(e,i),3);case 3:return m=L.b,T(L,function(e,t){var n,r,i,a,o,s,u,c,d,f,h;return x((function(p){if(1==p.a)return n=hd(t,"SUBTITLES"),r=n.map((function(t){var n,r;return x((function(i){if(1==i.a)return e.i.disableText?i.return(null):(b(i,2),T(i,xd(e,t),4));if(2!=i.a)return n=i.b,i.return(n.stream);if(r=w(i),e.i.hls.ignoreTextStreamFailures)return i.return(null);throw r}))})),T(p,Promise.all(r),2);for(i=p.b,a=l(n),o=a.next();!o.done;o=a.next())if(s=o.value,u=ld(s,"GROUP-ID"),(c=e.g.get(u))&&(d=e.h.get(u)))for(f=l(d),h=f.next();!h.done;h=f.next())h.value.stream.codecs=c;return p.return(i.filter((function(e){return e})))}))}(e,r),4);case 4:if(v=L.b,!e.u)throw new le(2,7,7001);if(e.Ia&&0==m.length)throw new le(2,4,4034);for(E=y=1/0,A=l(e.b.values()),S=A.next();!S.done;S=A.next())I=S.value,y=Math.min(y,I.Yd),"text"!=I.stream.type&&(E=Math.min(E,I.gf-I.Yd));if(e.f!=zd?(e.a=new Xa(0,e.i.defaultPresentationDelay?e.i.defaultPresentationDelay:e.M?e.M:3*e.ja),e.a.Xb(!1)):(e.a=new Xa(null,0),e.a.Xb(!0)),Ud(e),e.f!=zd)e.za=e.v,R=Jd,e.f==R.re&&(C=e.a.Cc,isNaN(e.i.availabilityWindowOverride)||(C=e.i.availabilityWindowOverride),e.a.Hd(C));else for(e.a.Fa(E),e.a.offset(-y),D=l(e.b.values()),S=D.next();!S.done;S=D.next())(M=S.value).stream.segmentIndex.offset(-y),M.stream.segmentIndex.Sa(0,E);e.o={presentationTimeline:e.a,variants:m,textStreams:v,imageStreams:[],offlineSessionIds:[],minBufferTime:0},e.u.makeTextStreamsForClosedCaptions(e.o),_(L)}}))}(i,n.data),3)):(0<(r=i.za)&&i.j.N(r),a.return(i.o))}))},r.stop=function(){this.j&&(this.j.stop(),this.j=null);var e=[];return this.A&&(e.push(this.A.destroy()),this.A=null),this.i=this.u=null,this.Aa.clear(),this.o=null,this.b.clear(),this.h.clear(),this.g.clear(),this.l.clear(),Promise.all(e)},r.update=function(){var e,t,n,r=this;return x((function(i){if(1==i.a)return r.f==zd?i.return():(e=[],r.J=null,(t=Array.from(r.b.values())).length?T(i,Dd(r,t[0]),2):i.m(2));for(n=1;n<t.length;n++)e.push(Dd(r,t[n]));return T(i,Promise.all(e),0)}))},r.onExpirationUpdated=function(){},r.Sb=function(){var e,t,n=this;return x((function(r){return 1==r.a?n.u?(b(r,2),T(r,n.update(),4)):r.return():2!=r.a?(e=n.za,n.j.N(e),S(r,0)):(t=w(r),n.u?(t.severity=1,n.u.onError(t),n.j.N(.1),void _(r)):r.return())}))},G("shaka.hls.HlsParser",Cd);var Vd=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],qd={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}},Wd={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ld(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?(t=or("com.widevine.alpha",[{initDataType:"cenc",initData:t=oe((t=Rd(t=ld(e,"URI"))).data)}]),(e=ud(e,"KEYID"))&&(t.keyIds=new Set([e.toLowerCase().substr(2)])),t):null},"com.microsoft.playready":function(e){var t=ld(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?or("com.microsoft.playready",[{initDataType:"cenc",initData:e=Ul(e=oe((e=Rd(e=ld(e,"URI"))).data))}]):null}},zd="VOD",Xd="EVENT",Qd="LIVE",Jd={se:zd,Qf:Xd,re:Qd};function Zd(e,t,n,r,i,a){if(200<=n&&299>=n&&202!=n)return{uri:i||r,ce:r,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};i=null;try{i=pe(t)}catch(e){}throw new le(401==n||403==n?2:1,1,1001,r,n,i,e,a)}function $d(){}function ef(e,t,n,r){var i=new of;fa(t.headers).forEach((function(e,t){i.append(t,e)}));var a=new rf,o={Md:!1,oe:!1};if(e=new Ki(e=function(e,t,n,r,i,a){var o,s,u,l,c,d,f,h,p,g,m,v;return x((function(y){switch(y.a){case 1:return o=nf,s=af,d=c=0,f=Date.now(),b(y,2),T(y,o(e,n),4);case 4:return u=y.b,h=u.clone().body.getReader(),g=(p=u.headers.get("Content-Length"))?parseInt(p,10):0,new s({start:function(e){!function t(){var n,r;return x((function(o){switch(o.a){case 1:return b(o,2),T(o,h.read(),4);case 4:n=o.b,S(o,3);break;case 2:return w(o),o.return();case 3:n.done||(c+=n.value.byteLength,a&&a(n.value)),(100<(r=Date.now())-f||n.done)&&(i(r-f,c-d,g-c),d=c,f=r),n.done?e.close():(e.enqueue(n.value),t()),_(o)}}))}()}}),T(y,u.arrayBuffer(),5);case 5:l=y.b,S(y,3);break;case 2:if(m=w(y),r.Md)throw new le(1,1,7001,e,t);if(r.oe)throw new le(1,1,1003,e,t);throw new le(1,1,1002,e,m,t);case 3:return v={},u.headers.forEach((function(e,t){v[t.trim()]=e})),y.return(Zd(v,l,u.status,e,u.url,t))}}))}(e,n,{body:t.body||void 0,headers:i,method:t.method,signal:a.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},o,r,t.streamDataCallback),(function(){return o.Md=!0,a.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var s=new Ge((function(){o.oe=!0,a.abort()}));s.N(t/1e3),e.finally((function(){s.stop()}))}return e}function tf(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)}qa.m3u8=function(){return new Cd},Va["application/x-mpegurl"]=function(){return new Cd},Va["application/vnd.apple.mpegurl"]=function(){return new Cd},G("shaka.net.HttpFetchPlugin",$d),$d.isSupported=tf,$d.parse=ef;var nf=e.fetch,rf=e.AbortController,af=e.ReadableStream,of=e.Headers;function sf(){}function uf(e,t,n,r){var i=new lf,a=Date.now(),o=0;return new Ki(new Promise((function(s,u){for(var c in i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){u(new le(1,1,7001,e,n))},i.onload=function(t){for(var r=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),i={},a=(r=l(r)).next();!a.done;a=r.next())i[(a=a.value.split(": "))[0].toLowerCase()]=a.slice(1).join(": ");try{var o=Zd(i,t.response,t.status,e,t.responseURL,n);s(o)}catch(e){u(e)}},i.onerror=function(t){u(new le(1,1,1002,e,t,n))},i.ontimeout=function(){u(new le(1,1,1003,e,n))},i.onprogress=function(e){var t=Date.now();(100<t-a||e.lengthComputable&&e.loaded==e.total)&&(r(t-a,e.loaded-o,e.total-e.loaded),o=e.loaded,a=t)},t.headers)i.setRequestHeader(c.toLowerCase(),t.headers[c]);i.send(t.body)})),(function(){return i.abort(),Promise.resolve()}))}tf()&&(na("http",ef,2,!0),na("https",ef,2,!0)),G("shaka.net.HttpXHRPlugin",sf),sf.parse=uf;var lf=e.XMLHttpRequest;function cf(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function df(e){var t=this;this.K=e,this.a=new Map,this.F=new Dr((function(){var e=Array.from(t.a.values());return Promise.all(e.map((function(e){return e.catch((function(){}))})))})),this.b=[],this.be=function(){},this.ae=function(){},this.Kb=new cf}function ff(e){var t=e.b.map((function(e){return e()}));return e.b=[],Promise.all(t)}function hf(e,t,n,r,i,a){Mr(e.F);var o=function(e,t){e.b+=t;var n=e.g;return e.g++,e.c.set(n,t),n}(e.Kb,r);return r=(e.a.get(t)||Promise.resolve()).then((function(){var t,r,s,u,l,c,d;return x((function(f){if(1==f.a)return T(f,function(e,t){var n,r,i,a;return x((function(o){return 1==o.a?(n=oa,r=e.K.request(n,t),i=function(){return r.abort()},e.b.push(i),T(o,r.promise,2)):(a=o.b,ut(e.b,i),o.return(a.data))}))}(e,n),2);if(t=f.b,e.F.a)throw new le(2,9,7001);if(i)for(u in r=oe(t),(s=new Fl(r)).data)l=Number(u),c=s.data[l],d=s.a[l],e.ae(c,d);e.Kb.close(o,t.byteLength);var h=e.Kb;return e.be(0==h.b?0:h.f/h.b,e.Kb.a),f.return(a(t))}))})),e.a.set(t,r),r}function pf(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new fr,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function gf(e,t){return new Promise((function(n,r){var i=e.b.openCursor();i.onerror=r,i.onsuccess=function(){var e;return x((function(r){if(1==r.a)return null==i.result?(n(),r.return()):(e=i.result,T(r,t(e.key,e.value,e),2));e.continue(),_(r)}))}}))}function mf(e){this.b=e,this.a=[]}function vf(e,t){return yf(e,t,"readwrite")}function yf(e,t,n){var r=new pf(n=e.b.transaction([t],n),t);return e.a.push(r),r.promise().then((function(){ut(e.a,r)}),(function(){ut(e.a,r)})),r}function Ef(e,t,n){this.b=new mf(e),this.c=t,this.a=n}function Tf(e){return Promise.reject(new le(2,9,9011,"Cannot add new value to "+e))}function _f(e,t,n,r){t=(e=vf(e.b,t)).store();for(var i={},a=(n=l(n)).next();!a.done;i={bc:i.bc},a=n.next())i.bc=a.value,t.delete(i.bc).onsuccess=function(e){return function(){return r(e.bc)}}(i);return e.promise()}function bf(e,t,n){var r,i,a,o,s,u,c;return x((function(d){if(1==d.a){for(r=yf(e.b,t,"readonly"),i=r.store(),a={},o=[],s={},u=l(n),c=u.next();!c.done;s={Gb:s.Gb,Eb:s.Eb},c=u.next())s.Eb=c.value,s.Gb=i.get(s.Eb),s.Gb.onsuccess=function(e){return function(){null==e.Gb.result&&o.push(e.Eb),a[e.Eb]=e.Gb.result}}(s);return T(d,r.promise(),2)}if(o.length)throw new le(2,9,9012,"Could not find values for "+o);return d.return(n.map((function(e){return a[e]})))}))}function Af(e){this.a=new mf(e)}function Sf(){this.a=new Map}function wf(e,t,n){if(!(e=e.a.get(t)))throw new le(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new le(2,9,9013,"Could not find cell with name "+n);return t}function If(e,t){Rf.set(e,t)}na("http",uf,1,!0),na("https",uf,1,!0),cf.prototype.close=function(e,t){if(this.c.has(e)){var n=this.c.get(e);this.c.delete(e),this.f+=n,this.a+=t}},df.prototype.destroy=function(){return this.F.destroy()},pf.prototype.abort=function(){var e=this;return x((function(t){if(1==t.a){try{e.c.abort()}catch(e){}return b(t,2),T(t,e.a,4)}if(2!=t.a)return S(t,0);w(t),_(t)}))},pf.prototype.store=function(){return this.b},pf.prototype.promise=function(){return this.a},mf.prototype.destroy=function(){return Promise.all(this.a.map((function(e){return e.abort()})))},(r=Ef.prototype).destroy=function(){return this.b.destroy()},r.hasFixedKeySpace=function(){return!0},r.addSegments=function(){return Tf(this.c)},r.removeSegments=function(e,t){return _f(this,this.c,e,t)},r.getSegments=function(e){var t,n=this;return x((function(r){return 1==r.a?T(r,bf(n,n.c,e),2):(t=r.b,r.return(t.map((function(e){return n.Nd(e)}))))}))},r.addManifests=function(){return Tf(this.a)},r.updateManifestExpiration=function(e,t){var n=vf(this.b,this.a),r=n.store();return r.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,r.put(n,e))},n.promise()},r.removeManifests=function(e,t){return _f(this,this.a,e,t)},r.getManifests=function(e){var t,n=this;return x((function(r){return 1==r.a?T(r,bf(n,n.a,e),2):(t=r.b,r.return(Promise.all(t.map((function(e){return n.Jb(e)})))))}))},r.getAllManifests=function(){var e,t,n=this;return x((function(r){return 1==r.a?(e=yf(n.b,n.a,"readonly"),t=new Map,T(r,gf(e,(function(e,r){var i;return x((function(a){if(1==a.a)return T(a,n.Jb(r),2);i=a.b,t.set(e,i),_(a)}))})),2)):3!=r.a?T(r,e.promise(),3):r.return(t)}))},r.Nd=function(e){return e},r.Jb=function(e){return Promise.resolve(e)},r.add=function(e,t){var n,r,i,a,o,s,u,c=this;return x((function(d){if(1==d.a){for(n=vf(c.b,e),r=n.store(),i=[],a={},o=l(t),s=o.next();!s.done;a={cc:a.cc},s=o.next())u=s.value,a.cc=r.add(u),a.cc.onsuccess=function(e){return function(){i.push(e.cc.result)}}(a);return T(d,n.promise(),2)}return d.return(i)}))},Af.prototype.destroy=function(){return this.a.destroy()},Af.prototype.getAll=function(){var e,t,n=this;return x((function(r){return 1==r.a?(e=yf(n.a,"session-ids","readonly"),t=[],T(r,gf(e,(function(e,n){t.push(n)})),2)):3!=r.a?T(r,e.promise(),3):r.return(t)}))},Af.prototype.add=function(e){for(var t=vf(this.a,"session-ids"),n=t.store(),r=(e=l(e)).next();!r.done;r=e.next())n.add(r.value);return t.promise()},Af.prototype.remove=function(e){var t,n=this;return x((function(r){return 1==r.a?T(r,gf(t=vf(n.a,"session-ids"),(function(t,n,r){e.includes(n.sessionId)&&r.delete()})),2):T(r,t.promise(),0)}))},Sf.prototype.destroy=function(){for(var e=[],t=l(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.a.clear(),Promise.all(e)},Sf.prototype.init=function(){var e=this;Rf.forEach((function(t,n){var r=t();r&&e.a.set(n,r)}));for(var t=[],n=l(this.a.values()),r=n.next();!r.done;r=n.next())t.push(r.value.init());return Promise.all(t)},G("shaka.offline.StorageMuxer",Sf),Sf.unregister=function(e){Rf.delete(e)},Sf.register=If,Sf.prototype.destroy=Sf.prototype.destroy;var Rf=new Map;function Cf(){Ef.apply(this,arguments)}function Df(e,t){!function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType}));if(e=e.streams.filter((function(e){return"video"==e.contentType})),!t.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){for(var n=l(t),r=n.next();!r.done;r=n.next())r.value.variantIds=[];for(r=(n=l(e)).next();!r.done;r=n.next())r.value.variantIds=[];if(n=0,e.length&&!t.length){var i=n++,a=l(e);for(r=a.next();!r.done;r=a.next())r.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,r=(a=l(t)).next();!r.done;r=a.next())r.value.variantIds.push(i);if(e.length&&t.length)for(r=(t=l(t)).next();!r.done;r=t.next())for(r=r.value,a=(i=l(e)).next();!a.done;a=i.next()){a=a.value;var o=n++;r.variantIds.push(o),a.variantIds.push(o)}}}(e);for(var n=l(e.streams),r=n.next();!r.done;r=n.next());return e.streams.map((function(n){return function(e,t,n){var r=e.initSegmentUri?Mf(e.initSegmentUri):null,i=t+e.presentationTimeOffset,a=t+n;return{id:e.id,originalId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:r,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){var n=Mf(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:r,appendWindowStart:t,appendWindowEnd:a,timestampOffset:i}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}(n,e.startTime,t)}))}function Mf(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new le(2,9,9004,"Could not parse uri "+e)}function Lf(){Ef.apply(this,arguments)}function Nf(e,t,n){return{id:e.id,originalId:e.originalId,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(r){return{startTime:t+r.startTime,endTime:t+r.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:r.dataKey}})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}function xf(){Ef.apply(this,arguments)}function Of(){this.h=this.f=this.c=this.b=this.a=this.g=null}function Pf(e,t,n,r){this.a=e,this.g=t,this.f=n,this.c=r,this.b=["offline:",e,"/",t,"/",n,"/",r].join("")}function kf(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var r=e[3];return r&&null!=t?new Pf(t,n,r,Number(e[4])):null}function Ff(e,t){this.b=e,this.a=t}function Uf(e,t){var n=new Xa(null,0);n.Fa(t.duration);var r=t.streams.filter((function(e){return"audio"==e.type})),i=t.streams.filter((function(e){return"video"==e.type}));r=function(e,t,n,r){for(var i=new Set,a=l(t),o=a.next();!o.done;o=a.next()){var s=l(o.value.variantIds);for(o=s.next();!o.done;o=s.next())i.add(o.value)}for(o=(a=l(n)).next();!o.done;o=a.next())for(o=(s=l(o.value.variantIds)).next();!o.done;o=s.next())i.add(o.value);for(a=new Map,o=(i=l(i)).next();!o.done;o=i.next())o=o.value,a.set(o,{id:o,language:"",primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(i=(t=l(t)).next();!i.done;i=t.next())for(o=Bf(e,i=i.value,r),i=(s=l(i.variantIds)).next();!i.done;i=s.next())(i=a.get(i.value)).language=o.language,i.primary=i.primary||o.primary,i.audio=o;for(t=(n=l(n)).next();!t.done;t=n.next())for(t=Bf(e,i=t.value,r),i=(o=l(i.variantIds)).next();!i.done;i=o.next())(i=a.get(i.value)).primary=i.primary||t.primary,i.video=t;return a}(e,r,i,n),i=t.streams.filter((function(e){return e.type==lr})).map((function(t){return Bf(e,t,n)}));var a=t.streams.filter((function(e){return"image"==e.type})).map((function(t){return Bf(e,t,n)})),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var s=l(r.values()),u=s.next();!u.done;u=s.next())(u=u.value).audio&&u.audio.encrypted&&(u.audio.drmInfos=o),u.video&&u.video.encrypted&&(u.video.drmInfos=o);return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,variants:Array.from(r.values()),textStreams:i,imageStreams:a}}function Bf(e,t,n){var r=t.segments.map((function(t){return function(e,t){var n=new Pf("segment",e.b,e.a,t.dataKey);return new za(t.startTime,t.endTime,(function(){return[n.toString()]}),0,null,null!=t.initSegmentKey?function(e,t){var n=new Pf("segment",e.b,e.a,t);return new Wa((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd)}(e,t)}));return n.yb(r),{id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new mo(r),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout}}function Gf(){this.a=null}function jf(){}function Hf(e){var t=kf(e);return e=t&&"manifest"==t.a?qi(e={uri:e,ce:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}}):t&&"segment"==t.a?function(e,t){var n=new Sf;return qi(void 0).W((function(){return n.init()})).W((function(){return wf(n,t.Ea(),t.fa())})).W((function(e){return e.getSegments([t.key()])})).W((function(e){return{uri:t,data:e[0].data,headers:{}}})).finally((function(){return n.destroy()}))}(t.key(),t):Yi(new le(2,1,9004,e))}function Kf(e,t,n){var r,i,a,o,s,u;return x((function(c){switch(c.a){case 1:r=[];for(var d=[],f=l(n),h=f.next();!h.done;h=f.next()){h=h.value;for(var p=!1,g=l(d),m=g.next();!m.done;m=g.next())if(Yf((m=m.value).info,h)){m.sessionIds.push(h.sessionId),p=!0;break}p||d.push({info:h,sessionIds:[h.sessionId]})}i=l(d),a=i.next();case 2:if(a.done){c.m(4);break}return o=a.value,s=function(e,t,n){var r,i;return x((function(a){switch(a.a){case 1:return r=new ga({xb:t,onError:function(){},zc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),b(a,2),r.configure(e),T(a,function(e,t,n,r,i,a){var o=new Map;return(i={audioCapabilities:i,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t}).drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}],o.set(t,i),Ia(e,o,[],!1)}(r,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:S(a,3);break;case 2:return w(a),T(a,r.destroy(),5);case 5:return a.return([]);case 3:return b(a,6),T(a,ya(r),8);case 8:S(a,7);break;case 6:return w(a),T(a,r.destroy(),9);case 9:return a.return([]);case 7:return i=[],T(a,Promise.all(n.sessionIds.map((function(e){return x((function(t){return 1==t.a?(b(t,2),T(t,function(e,t){var n,r,i;return x((function(a){return 1==a.a?T(a,Ra(e,t),2):(n=a.b)?(r=[],(i=e.f.get(n))&&(i.Ga=new fr,r.push(i.Ga)),r.push(n.remove()),T(a,Promise.all(r),0)):a.return()}))}(r,e),4)):2!=t.a?(i.push(e),S(t,0)):(w(t),void _(t))}))}))),10);case 10:return T(a,r.destroy(),11);case 11:return a.return(i)}}))}(e,t,o),T(c,s,5);case 5:u=c.b,r=r.concat(u),a=i.next(),c.m(2);break;case 4:return c.return(r)}}))}function Yf(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&lt(e.audioCapabilities,t.audioCapabilities,n)&&lt(e.videoCapabilities,t.videoCapabilities,n)}function Vf(e,t){var n=Uf(new Ff(e.Ea(),e.fa()),t),r=t.appMetadata||{};return n=qf(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:r}}function qf(e){for(var t=[],n=function(e){return e.filter((function(e){return bi(e)}))}(e.variants),r=(n=l(n)).next();!r.done;r=n.next())t.push(mi(r.value));for(n=(e=l(e.textStreams)).next();!n.done;n=e.next())t.push(vi(n.value));return t}function Wf(){this.a={}}function zf(e,t){var n=e.a[t];return null==n&&(n=0),n}function Xf(e){var t=this;if(e&&e.constructor!=ms)throw new le(2,9,9008);this.K=this.i=null,e?(this.i=e.i,this.K=e.Nb()):(this.i=ss(),this.K=new ta),this.Ec=[],this.Tb=[],this.ud=[];var n=!e;this.F=new Dr((function(){var e,r,i,a,o;return x((function(s){switch(s.a){case 1:return T(s,Promise.all(t.ud.map((function(e){return ff(e)}))),2);case 2:for(e=function(){},r=[],i=l(t.Tb),a=i.next();!a.done;a=i.next())o=a.value,r.push(o.then(e,e));return T(s,Promise.all(r),3);case 3:if(!n){s.m(4);break}return T(s,t.K.destroy(),4);case 4:t.i=null,t.K=null,_(s)}}))}))}function Qf(){if(je())e:{for(var e=l(Rf.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Jf(e,t){for(var n=[],r=l(e.streams),i=r.next();!i.done;i=r.next())i=i.value,t&&"video"==i.type?n.push({contentType:Tr(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=i.type||n.push({contentType:Tr(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return n}function Zf(e,t,n){return x((function(r){return T(r,function(e,t,n,r){var i,a,o;return x((function(s){return 1==s.a?r.drmInfo?(i=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new le(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(n),a=r.sessionIds.map((function(e){return{sessionId:e,keySystem:r.drmInfo.keySystem,licenseUri:r.drmInfo.licenseServerUri,serverCertificate:r.drmInfo.serverCertificate,audioCapabilities:Jf(r,!1),videoCapabilities:Jf(r,!0)}})),T(s,Kf(t,e,a),2)):s.return():3!=s.a?(o=s.b,T(s,i.remove(o),3)):T(s,i.add(a.filter((function(e){return!o.includes(e.sessionId)}))),0)}))}(e.K,e.i.drm,n,t),0)}))}function $f(e,t,n){function r(){}var i=function(e){for(var t=[],n=(e=l(e.streams)).next();!n.done;n=e.next())for(var r=(n=l(n.value.segments)).next();!r.done;r=n.next())null!=(r=r.value).initSegmentKey&&t.push(r.initSegmentKey),t.push(r.dataKey);return t}(n);return Vf(t,n),Promise.all([e.removeSegments(i,r),e.removeManifests([t.key()],r)])}function eh(e,t,n,r,i,a,o,s,u){var l={id:a.id,originalId:a.originalId,primary:a.primary,type:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,pixelAspectRatio:a.pixelAspectRatio,hdr:a.hdr,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,encrypted:a.encrypted,keyIds:a.keyIds,segments:[],variantIds:[],roles:a.roles,forced:a.forced,channelsCount:a.channelsCount,audioSamplingRate:a.audioSamplingRate,spatialAudio:a.spatialAudio,closedCaptions:a.closedCaptions,tilesLayout:a.tilesLayout},c=a.id;return function(e,t,n){if(null!=(t=e.segmentIndex.find(t)))for(var r=e.segmentIndex.get(t);r;)n(r),r=e.segmentIndex.get(++t)}(a,i.presentationTimeline.Ua(),(function(i){var d=function(e,t,n,r,i,a,o,s,u){return u.has(o)?u.get(o):(t=hf(t,n,s=Do(o.ga(),o.da,o.Y,s.streaming.retryParameters),.5*zf(a,r),!0,(function(t){var n;return x((function(r){return 1==r.a?T(r,i.addSegments([{data:t}]),2):(n=r.b,e.Ec.push(n[0]),r.return(n[0]))}))})),u.set(o,t),t)}(e,t,c,a.id,n,r,i.b,o,s),f=function(e,t,n,r,i,a,o,s,u){var l=[o.ga()[0],o.da,o.Y].join("-");return u.has(l)?u.get(l):(t=hf(t,n,s=Do(o.ga(),o.da,o.Y,s.streaming.retryParameters),function(e,t,n){return n=n.endTime-n.startTime,zf(e,t)*n}(a,r,o),!1,(function(t){var n;return x((function(r){return 1==r.a?T(r,i.addSegments([{data:t}]),2):(n=r.b,e.Ec.push(n[0]),r.return(n[0]))}))})),u.set(l,t),t)}(e,t,c,a.id,n,r,i,o,u);!function(e,t,n){Mr(e.F);var r=(e.a.get(t)||Promise.resolve()).then((function(){return x((function(e){return T(e,function(){var e,t;return x((function(n){return 1==n.a?T(n,d,2):3!=n.a?(e=n.b,T(n,f,3)):(t=n.b,l.segments.push({initSegmentKey:e,startTime:i.startTime,endTime:i.endTime,appendWindowStart:i.appendWindowStart,appendWindowEnd:i.appendWindowEnd,timestampOffset:i.timestampOffset,dataKey:t}),void _(n))}))}(),0)}))}));e.a.set(t,r)}(t,c)})),l}function th(e){if(e.F.a)throw new le(2,9,7001)}function nh(){if(!Qf())throw new le(2,9,9e3)}function rh(e,t){return x((function(n){return 1==n.a?(e.Tb.push(t),A(n),T(n,t,4)):2!=n.a?n.return(n.b):(I(n),ut(e.Tb,t),R(n,0))}))}function ih(e){for(var t=new Set,n=l(e.textStreams),r=n.next();!r.done;r=n.next())t.add(r.value);for(r=(n=l(e.imageStreams)).next();!r.done;r=n.next())t.add(r.value);for(n=(e=l(e.variants)).next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}m(Cf,Ef),Cf.prototype.updateManifestExpiration=function(e,t){var n,r,i,a=this;return x((function(o){return n=vf(a.b,a.a),r=n.store(),i=new fr,r.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,r.put(n),i.resolve()):i.reject(new le(2,9,9012,"Could not find values for "+e))},T(o,Promise.all([n.promise(),i]),0)}))},Cf.prototype.Jb=function(e){var t,n,r,i,a,o;return x((function(s){if(1==s.a){for(t=[],n=0;n<e.periods.length;++n)r=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=r-e.periods[n].startTime,a=Df(e.periods[n],i),t.push(a);return T(s,Mc(t),2)}return o=s.b,s.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata})}))},Cf.prototype.Nd=function(e){return{data:e.data}},m(Lf,Ef),Lf.prototype.Jb=function(e){var t,n,r,i,a,o;return x((function(s){if(1==s.a){for(t=[],n=0;n<e.periods.length;++n){r=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=r-e.periods[n].startTime;for(var u=e.periods[n],c=[],d=l(u.streams),f=d.next();!f.done;f=d.next())0!=(f=f.value).variantIds.length&&c.push(Nf(f,u.startTime,u.startTime+i));a=c,t.push(a)}return T(s,Mc(t),2)}return o=s.b,s.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o})}))},m(xf,Ef),xf.prototype.hasFixedKeySpace=function(){return!1},xf.prototype.addSegments=function(e){return this.add(this.c,e)},xf.prototype.addManifests=function(e){return this.add(this.a,e)},xf.prototype.Jb=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},(r=Of.prototype).init=function(){var t=this,n=new fr,r=e.indexedDB.open("shaka_offline_db",5);return r.onsuccess=function(){var e=r.result;t.g=e;var i=e.objectStoreNames;i=i.contains("manifest")&&i.contains("segment")?new Cf(e,"segment","manifest"):null,t.a=i,i=(i=e.objectStoreNames).contains("manifest-v2")&&i.contains("segment-v2")?new Lf(e,"segment-v2","manifest-v2"):null,t.b=i,i=(i=e.objectStoreNames).contains("manifest-v3")&&i.contains("segment-v3")?new Lf(e,"segment-v3","manifest-v3"):null,t.c=i,i=(i=e.objectStoreNames).contains("manifest-v5")&&i.contains("segment-v5")?new xf(e,"segment-v5","manifest-v5"):null,t.f=i,e=e.objectStoreNames.contains("session-ids")?new Af(e):null,t.h=e,n.resolve()},r.onupgradeneeded=function(){for(var e=r.result,t=l(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},r.onerror=function(e){n.reject(new le(2,9,9001,r.error)),e.preventDefault()},n},r.destroy=function(){var e=this;return x((function(t){switch(t.a){case 1:if(!e.a){t.m(2);break}return T(t,e.a.destroy(),2);case 2:if(!e.b){t.m(4);break}return T(t,e.b.destroy(),4);case 4:if(!e.c){t.m(6);break}return T(t,e.c.destroy(),6);case 6:if(!e.f){t.m(8);break}return T(t,e.f.destroy(),8);case 8:if(!e.h){t.m(10);break}return T(t,e.h.destroy(),10);case 10:e.g&&e.g.close(),_(t)}}))},r.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),this.f&&e.set("v5",this.f),e},r.getEmeSessionCell=function(){return this.h},r.erase=function(){var t=this;return x((function(n){switch(n.a){case 1:if(!t.a){n.m(2);break}return T(n,t.a.destroy(),2);case 2:if(!t.b){n.m(4);break}return T(n,t.b.destroy(),4);case 4:if(!t.c){n.m(6);break}return T(n,t.c.destroy(),6);case 6:if(!t.f){n.m(8);break}return T(n,t.f.destroy(),8);case 8:return t.g&&t.g.close(),T(n,function(){var t=new fr,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new le(2,9,9001,n.error)),e.preventDefault()},t}(),10);case 10:return t.g=null,t.a=null,t.b=null,t.c=null,t.f=null,T(n,t.init(),0)}}))},If("idb",(function(){return Ye()||!e.indexedDB?null:new Of})),Pf.prototype.Ea=function(){return this.g},Pf.prototype.fa=function(){return this.f},Pf.prototype.key=function(){return this.c},Pf.prototype.toString=function(){return this.b},(r=Gf.prototype).configure=function(){},r.start=function(e,t){var n,r,i,a,o,s,u=this;return x((function(l){switch(l.a){case 1:if(n=kf(e),u.a=n,null==n||"manifest"!=n.a)throw new le(2,1,9004,e);return r=new Sf,A(l),T(l,r.init(),4);case 4:return T(l,wf(r,n.Ea(),n.fa()),5);case 5:return T(l,l.b.getManifests([n.key()]),6);case 6:return i=l.b,a=i[0],o=new Ff(n.Ea(),n.fa()),s=Uf(o,a),t.makeTextStreamsForClosedCaptions(s),l.return(s);case 2:return I(l),T(l,r.destroy(),7);case 7:R(l,0)}}))},r.stop=function(){return Promise.resolve()},r.update=function(){},r.onExpirationUpdated=function(e,t){var n,r,i,a,o,s,u,l=this;return x((function(c){switch(c.a){case 1:return n=l.a,r=new Sf,b(c,2,3),T(c,r.init(),5);case 5:return T(c,wf(r,n.Ea(),n.fa()),6);case 6:return T(c,(i=c.b).getManifests([n.key()]),7);case 7:if(a=c.b,o=a[0],s=o.sessionIds.includes(e),u=null==o.expiration||o.expiration>t,!s||!u){c.m(3);break}return T(c,i.updateManifestExpiration(n.key(),t),3);case 3:return I(c),T(c,r.destroy(),10);case 10:R(c,0);break;case 2:w(c),c.m(3)}}))},Va["application/x-offline-manifest"]=function(){return new Gf},G("shaka.offline.OfflineScheme",jf),jf.plugin=Hf,na("offline",Hf),(r=Xf.prototype).destroy=function(){return this.F.destroy()},r.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=as(e,t)),e.manifest&&e.manifest.dash&&"defaultPresentationDelay"in e.manifest.dash&&(be("manifest.dash.defaultPresentationDelay configuration","Please Use manifest.defaultPresentationDelay instead."),e.manifest.defaultPresentationDelay=e.manifest.dash.defaultPresentationDelay,delete e.manifest.dash.defaultPresentationDelay),us(this.i,e)},r.getConfiguration=function(){var e=ss();return us(e,this.i,ss()),e},r.Nb=function(){return this.K},r.store=function(e,t,n){var r=this,i=this.getConfiguration(),a=new df(this.K);this.ud.push(a);var o=new Ki(t=function(e,t,n,r,i,a){var o,s,u,c,d,f,h,p,g,m;return x((function(v){switch(v.a){case 1:return nh(),s=o=null,u=new Sf,d=c=null,b(v,2,3),T(v,r(),5);case 5:return o=v.b,T(v,function(e,t,n,r){var i,a,o,s,u;return x((function(l){if(1==l.a)return i=null,a=e.K,o={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){}},n.configure(r.manifest),th(e),T(l,n.start(t,o),2);if(3!=l.a)return s=l.b,th(e),u=ih(s),T(l,Promise.all($(u,(function(e){return e.createSegmentIndex()}))),3);if(th(e),i)throw i;return l.return(s)}))}(e,t,o,i),6);case 6:if(f=v.b,th(e),f.presentationTimeline.U()||f.presentationTimeline.eb())throw new le(2,9,9005,t);return T(v,function(e,t,n,r){var i;return x((function(a){switch(a.a){case 1:return(i=new ga({xb:e.K,onError:n,zc:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(r.drm),T(a,function(e,t,n,r){return e.ja=!0,e.v=[],e.A=n,va(e,t,!!r)}(i,t.variants,r.offline.usePersistentLicense,r.useMediaCapabilities),2);case 2:return T(a,ya(i),3);case 3:return T(a,Ea(i),4);case 4:return a.return(i)}}))}(e,f,(function(e){d=d||e}),i),7);case 7:if(s=v.b,th(e),d)throw d;return T(v,e.qc(f,s,i),8);case 8:return T(v,u.init(),9);case 9:return th(e),T(v,function(e){var t=null;if(e.a.forEach((function(e,n){e.getCells().forEach((function(e,r){e.hasFixedKeySpace()||t||(t={path:{Ea:n,fa:r},fa:e})}))})),t)return t;throw new le(2,9,9013,"Could not find a cell that supports add-operations")}(u),10);case 10:return c=v.b,th(e),T(v,function(e,t,n,r,i,a,o,s){var u,c,d,f,h,p,g,m,v,y;return x((function(E){switch(E.a){case 1:return u=function(e,t,n){return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:t=qf(t),appMetadata:n}}(i,r,a),c=o.offline.progressCallback,function(e,t,n){e.be=function(e,t){u.size=t,c(u,e)},e.ae=n}(s,0,(function(e,t){h&&o.offline.usePersistentLicense&&p==t&&Ta(n,"cenc",e)})),d=r.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t})),f=r.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))})),p=null,(h=d&&!f)&&(g=n.c,p=ah.get(g.keySystem)),A(E),v=m=function(e,t,n,r,i,a,o,s){for(var u=new Wf,c=l(i.variants),d=c.next();!d.done;d=c.next()){var f=u,h=(d=d.value).audio,p=d.video;if(h&&!p&&(f.a[h.id]=h.bandwidth||d.bandwidth),!h&&p&&(f.a[p.id]=p.bandwidth||d.bandwidth),h&&p){var g=h.bandwidth||393216,m=p.bandwidth||d.bandwidth-g;0>=m&&(m=d.bandwidth),f.a[h.id]=g,f.a[p.id]=m}}for(f=(c=l(i.textStreams)).next();!f.done;f=c.next())u.a[f.value.id]=52;for(f=(c=l(i.imageStreams)).next();!f.done;f=c.next())f=f.value,u.a[f.id]=f.bandwidth||2048;for((f=new Map).set(null,Promise.resolve(null)),d=new Map,h=ih(i),c=new Map,p=(h=l(h)).next();!p.done;p=h.next())g=eh(e,t,n,u,i,p=p.value,s,f,d),c.set(p.id,g);for(d=(e=l(i.variants)).next();!d.done;d=e.next())(t=d.value).audio&&c.get(t.audio.id).variantIds.push(t.id),t.video&&c.get(t.video.id).variantIds.push(t.id);return e=Array.from(c.values()),s=s.offline.usePersistentLicense,(t=r.c)&&s&&(t.initData=[]),{creationTime:Date.now(),originalManifestUri:a,duration:i.presentationTimeline.getDuration(),size:0,expiration:r.Mb(),streams:e,sessionIds:s?Sa(r):[],drmInfo:t,appMetadata:o}}(e,s,t,n,r,i,a,o),T(E,function(e){return x((function(t){return 1==t.a?T(t,Promise.all(e.a.values()),2):t.return(e.Kb.a)}))}(s),4);case 4:if(v.size=E.b,m.expiration=n.Mb(),y=Sa(n),m.sessionIds=o.offline.usePersistentLicense?y:[],d&&o.offline.usePersistentLicense&&!y.length)throw new le(2,9,9007);return E.return(m);case 2:return I(E),T(E,s.destroy(),5);case 5:R(E,0)}}))}(e,c.fa,s,f,t,n,i,a),11);case 11:if(h=v.b,th(e),d)throw d;return T(v,c.fa.addManifests([h]),12);case 12:return p=v.b,th(e),g=new Pf("manifest",c.path.Ea,c.path.fa,p[0]),v.return(Vf(g,h));case 3:return I(v),e.Ec=[],T(v,u.destroy(),13);case 13:if(!o){v.m(14);break}return T(v,o.stop(),14);case 14:if(!s){v.m(16);break}return T(v,s.destroy(),16);case 16:R(v,0);break;case 2:if(m=w(v),!c){v.m(18);break}return T(v,c.fa.removeSegments(e.Ec,(function(){})),18);case 18:throw d||m}}))}(this,e,t||{},(function(){var t;return x((function(a){return 1==a.a?T(a,Ha(e,r.K,i.manifest.retryParameters,n||null),2):(t=a.b,a.return(De(t)))}))}),i,a),(function(){return ff(a)}));return o.finally((function(){ut(r.ud,a)})),o.then=function(e){return be("shaka.offline.Storage.store.then","Storage operations now return a shaka.util.AbortableOperation, rather than a promise.  Please update to conform to this new API; you can use the |chain| method instead."),o.promise.then(e)},function(e,t){var n=t.promise;return e.Tb.push(n),t.finally((function(){ut(e.Tb,n)}))}(this,o)},r.Ye=function(){return be("shaka.offline.Storage.getStoreInProgress","Multiple concurrent downloads are now supported."),!1},r.qc=function(e,t,n){var r,i,a,o,s,u,c,d,f,h,p,g,m,v,y,E,A,I,R,C,D,M,L,N;return x((function(x){switch(x.a){case 1:for(r={width:1/0,height:1/0},function(e,t,n){e.variants=e.variants.filter((function(e){return ui(e,t,n)}))}(e,n.restrictions,r),n.useMediaCapabilities?ci(e,n.offline.usePersistentLicense):(di(e),li(e,t)),i=[],a=n.preferredAudioChannelCount,oi(e,a),o=l(e.variants),s=o.next();!s.done;s=o.next())u=s.value,i.push(mi(u));for(c=l(e.textStreams),d=c.next();!d.done;d=c.next())f=d.value,i.push(vi(f));for(h=l(e.imageStreams),p=h.next();!p.done;p=h.next())g=p.value,i.push(yi(g));return T(x,n.offline.trackSelectionCallback(i),2);case 2:for(m=x.b,v=e.presentationTimeline.getDuration(),y=0,E=l(m),A=E.next();!A.done;A=E.next())I=A.value,R=I.bandwidth*v/8,y+=R;return b(x,3),T(x,n.offline.downloadSizeCallback(y),5);case 5:if(!x.b)throw new le(2,9,9014);S(x,4);break;case 3:throw w(x),new le(2,9,9015);case 4:for(C=new Set,D=new Set,M=new Set,L=l(m),A=L.next();!A.done;A=L.next())"variant"==(N=A.value).type&&C.add(N.id),"text"==N.type&&D.add(N.id),"image"==N.type&&M.add(N.id);e.variants=e.variants.filter((function(e){return C.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return D.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return M.has(e.id)})),function(e){e.variants.map((function(e){return e.video}));var t=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams;for(var n=l(t),r=n.next();!r.done;r=n.next())for(var i=(r=l(t)).next();!i.done;i=r.next());for(n=(t=l(e)).next();!n.done;n=t.next())for(r=(n=l(e)).next();!r.done;r=n.next());}(e),_(x)}}))},r.remove=function(e){return rh(this,function(e,t){var n,r,i,a,o,s;return x((function(u){switch(u.a){case 1:if(nh(),null==(n=kf(t))||"manifest"!=n.a)throw new le(2,9,9004,t);return r=n,i=new Sf,A(u),T(u,i.init(),4);case 4:return T(u,wf(i,r.Ea(),r.fa()),5);case 5:return T(u,(a=u.b).getManifests([r.key()]),6);case 6:return o=u.b,s=o[0],T(u,Promise.all([Zf(e,s,i),$f(a,r,s)]),2);case 2:return I(u),T(u,i.destroy(),8);case 8:R(u,0)}}))}(this,e))},r.uf=function(){return rh(this,function(e){var t,n,r,i,a,o,s,u,c,d;return x((function(f){switch(f.a){case 1:return nh(),t=e.K,n=e.i.drm,r=new Sf,i=!1,A(f),T(f,r.init(),4);case 4:a=[],function(e,t){e.a.forEach((function(e){!function(e){a.push(e)}(e.getEmeSessionCell())}))}(r),o=l(a),s=o.next();case 5:if(s.done){f.m(2);break}return T(f,(u=s.value).getAll(),8);case 8:return c=f.b,T(f,Kf(n,t,c),9);case 9:return d=f.b,T(f,u.remove(d),10);case 10:d.length!=c.length&&(i=!0),s=o.next(),f.m(5);break;case 2:return I(f),T(f,r.destroy(),11);case 11:R(f,3);break;case 3:return f.return(!i)}}))}(this))},r.list=function(){return rh(this,function(){var e,t,n;return x((function(r){switch(r.a){case 1:return nh(),e=[],t=new Sf,A(r),T(r,t.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.a.forEach((function(e,n){e.getCells().forEach((function(e,r){t({Ea:n,fa:r},e)}))}))}(t,(function(t,r){n=n.then((function(){return x((function(n){if(1==n.a)return T(n,r.getAllManifests(),2);n.b.forEach((function(n,r){var i=Vf(new Pf("manifest",t.Ea,t.fa,r),n);e.push(i)})),_(n)}))}))})),T(r,n,2);case 2:return I(r),T(r,t.destroy(),6);case 6:R(r,3);break;case 3:return r.return(e)}}))}())},G("shaka.offline.Storage",Xf),Xf.deleteAll=function(){var e;return x((function(t){return 1==t.a?(e=new Sf,A(t),T(t,function(e){var t,n;return x((function(r){return 1==r.a?(t=Array.from(e.a.values()),(n=0<t.length)||Rf.forEach((function(e){(e=e())&&t.push(e)})),T(r,Promise.all(t.map((function(e){return e.erase()}))),2)):n?r.m(0):T(r,Promise.all(t.map((function(e){return e.destroy()}))),0)}))}(e),2)):5!=t.a?(I(t),T(t,e.destroy(),5)):R(t,0)}))},Xf.prototype.list=Xf.prototype.list,Xf.prototype.removeEmeSessions=Xf.prototype.uf,Xf.prototype.remove=Xf.prototype.remove,Xf.prototype.getStoreInProgress=Xf.prototype.Ye,Xf.prototype.store=Xf.prototype.store,Xf.prototype.getNetworkingEngine=Xf.prototype.Nb,Xf.prototype.getConfiguration=Xf.prototype.getConfiguration,Xf.prototype.configure=Xf.prototype.configure,Xf.prototype.destroy=Xf.prototype.destroy,Xf.support=Qf;var ah=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");function oh(){}function sh(e,t){for(var n={priority:t||0,we:e},r=l(te(uh)),i=r.next();!i.done;i=r.next()){var a=(i=i.value).ba;if(i.item.priority<n.priority)return void uh.splice(a,0,n)}uh.push(n)}Mu.offline=Qf,G("shaka.polyfill",oh),oh.register=sh,oh.installAll=function(){for(var e=l(uh),t=e.next();!t.done;t=e.next()){t=t.value;try{t.we()}catch(e){W("Error installing polyfill!",e)}}};var uh=[];function lh(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function ch(e){var t,n,r,i,a,o,s,u,l,c;return x((function(d){switch(d.a){case 1:return t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},!e||e.video&&(n=e.video.contentType,!MediaSource.isTypeSupported(n))||e.audio&&(r=e.audio.contentType,!MediaSource.isTypeSupported(r))?d.return(t):e.keySystemConfiguration?(i=e.keySystemConfiguration,a=[],o=[],i.audio&&(s={robustness:i.audio.robustness||"",contentType:e.audio.contentType},a.push(s)),i.video&&(u={robustness:i.video.robustness||"",contentType:e.video.contentType},o.push(u)),l={initDataTypes:[i.initDataType],distinctiveIdentifier:i.distinctiveIdentifier,persistentState:i.persistentState,sessionTypes:i.sessionTypes},a.length&&(l.audioCapabilities=a),o.length&&(l.videoCapabilities=o),b(d,3),T(d,navigator.requestMediaKeySystemAccess(i.keySystem,[l]),5)):(t.supported=!0,d.return(Promise.resolve(t)));case 5:c=d.b,S(d,4);break;case 3:w(d);case 4:c&&(t.supported=!0,t.keySystemAccess=c);case 2:return d.return(t)}}))}function dh(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var n=[],r=0;r<arguments.length;++r)n[r]=arguments[r];return(n=e.apply(this,n)).abort=function(){},n}}function fh(){Qi.call(this),this.type="",this.angle=0}function hh(e,t){try{var n=new mh(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function ph(e){var t=this.mediaKeys;return t&&t!=e&&yh(t,null),delete this.mediaKeys,(this.mediaKeys=e)?yh(e,this):Promise.resolve()}function gh(e){if(se(e=oe(e.initData)).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=ge(e=he(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=ae(e),this.dispatchEvent(t)}function mh(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(var n=l(t),r=n.next();!r.done;r=n.next()){var i=r.value;if("required"==i.persistentState)r=null;else{r={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:i.initDataTypes,sessionTypes:["temporary"],label:i.label};var a=!1,o=!1;if(i.audioCapabilities)for(var s=l(i.audioCapabilities),u=s.next();!u.done;u=s.next())(u=u.value).contentType&&(a=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,u.contentType.split(";")[0])&&(r.audioCapabilities.push(u),o=!0));if(i.videoCapabilities)for(u=(i=l(i.videoCapabilities)).next();!u.done;u=i.next())(s=u.value).contentType&&(a=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,s.contentType.split(";")[0])&&(r.videoCapabilities.push(s),o=!0));a||(o=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),r=o?r:null}if(r)return void(this.a=r)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function vh(e){this.a=new WebKitMediaKeys(e),this.b=new xr}function yh(e,t){if(e.b.hb(),!t)return Promise.resolve();e.b.s(t,"webkitneedkey",gh);try{return to(t,HTMLMediaElement.HAVE_METADATA,e.b,(function(){t.webkitSetMediaKeys(e.a)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function Eh(e){Qi.call(this),this.f=null,this.g=e,this.c=this.a=null,this.b=new xr,this.sessionId="",this.expiration=NaN,this.closed=new fr,this.keyStatuses=new _h}function Th(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,n=new Xi("keystatuseschange"),e.dispatchEvent(n)}function _h(){this.size=0,this.a=void 0}function bh(e,t){try{var n=new Sh(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Ah(e){if(e.initData){var t=new CustomEvent("encrypted");t.initDataType="cenc",t.initData=ae(function(e){if(!e)return e;var t=new Fl(e);if(1>=t.data.length)return e;e=[];for(var n={},r=(t=l(t.data)).next();!r.done;n={$b:n.$b},r=t.next())n.$b=r.value,e.some(function(e){return function(t){return re(t,e.$b)}}(n))||e.push(n.$b);return rt.apply(Je,c(e))}(e.initData)),this.dispatchEvent(t)}}function Sh(e,t){this.keySystem=e;for(var n=!1,r=l(t),i=r.next();!i.done;i=r.next()){var a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(i=i.value).initDataTypes,sessionTypes:["temporary"],label:i.label},o=!1;if(i.audioCapabilities)for(var s=l(i.audioCapabilities),u=s.next();!u.done;u=s.next())(u=u.value).contentType&&(o=!0,MSMediaKeys.isTypeSupported(this.keySystem,u.contentType.split(";")[0])&&(a.audioCapabilities.push(u),n=!0));if(i.videoCapabilities)for(u=(s=l(i.videoCapabilities)).next();!u.done;u=s.next())(u=u.value).contentType&&(o=!0,MSMediaKeys.isTypeSupported(this.keySystem,u.contentType.split(";")[0])&&(a.videoCapabilities.push(u),n=!0));if(o||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==i.persistentState&&(n=!1),n)return void(this.a=a)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function wh(e){var t=this.mediaKeys;return t&&t!=e&&Rh(t,null),delete this.mediaKeys,(this.mediaKeys=e)?Rh(e,this):Promise.resolve()}function Ih(e){this.a=new MSMediaKeys(e),this.b=new xr}function Rh(e,t){if(e.b.hb(),!t)return Promise.resolve();e.b.s(t,"msneedkey",Ah);try{return to(t,HTMLMediaElement.HAVE_METADATA,e.b,(function(){t.msSetMediaKeys(e.a)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function Ch(e){Qi.call(this),this.f=null,this.g=e,this.c=this.a=null,this.b=new xr,this.sessionId="",this.expiration=NaN,this.closed=new fr,this.keyStatuses=new Mh}function Dh(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,n=new Xi("keystatuseschange"),e.dispatchEvent(n)}function Mh(){this.size=0,this.a=void 0}function Lh(){return Promise.reject(Error("The key system specified is not supported."))}function Nh(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function xh(){throw new TypeError("Illegal constructor.")}function Oh(){throw this.keySystem="",new TypeError("Illegal constructor.")}function Ph(e){return qh?qh+e.charAt(0).toUpperCase()+e.slice(1):e}function kh(e,t){try{var n=new Uh(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Fh(e){var t=this.mediaKeys;return t&&t!=e&&Gh(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Gh(e,this),Promise.resolve()}function Uh(e,t){this.a=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.a="webkit-org.w3.clearkey",n=!1);var r=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var a=l(t),o=a.next();!o.done;o=a.next()){var s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(o=o.value).initDataTypes,sessionTypes:["temporary"],label:o.label},u=!1;if(o.audioCapabilities)for(var c=l(o.audioCapabilities),d=c.next();!d.done;d=c.next())(d=d.value).contentType&&(u=!0,i.canPlayType(d.contentType.split(";")[0],this.a)&&(s.audioCapabilities.push(d),r=!0));if(o.videoCapabilities)for(d=(c=l(o.videoCapabilities)).next();!d.done;d=c.next())(d=d.value).contentType&&(u=!0,i.canPlayType(d.contentType,this.a)&&(s.videoCapabilities.push(d),r=!0));if(u||(r=i.canPlayType("video/mp4",this.a)||i.canPlayType("video/webm",this.a)),"required"==o.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):r=!1),r)return void(this.b=s)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Bh(e){this.g=e,this.a=null,this.b=new xr,this.c=[],this.f=new Map}function Gh(e,t){e.a=t,e.b.hb();var n=qh;t&&(e.b.s(t,n+"needkey",(function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=ae(t.initData),e.a.dispatchEvent(n)})),e.b.s(t,n+"keymessage",(function(t){var n=jh(e,t.sessionId);n&&(t=new Xi("message",{messageType:null==n.keyStatuses.a?"licenserequest":"licenserenewal",message:t.message}),n.b&&(n.b.resolve(),n.b=null),n.dispatchEvent(t))})),e.b.s(t,n+"keyadded",(function(t){(t=jh(e,t.sessionId))&&(Yh(t,"usable"),t.a&&t.a.resolve(),t.a=null)})),e.b.s(t,n+"keyerror",(function(t){var n=jh(e,t.sessionId);n&&n.handleError(t)})))}function jh(e,t){var n=e.f.get(t);return n||((n=e.c.shift())?(n.sessionId=t,e.f.set(t,n),n):null)}function Hh(e,t,n){Qi.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new fr,this.keyStatuses=new Vh}function Kh(e,t,n){if(e.h)return Promise.reject(Error("The session is already initialized."));e.h=!0;try{if("persistent-license"==e.g)if(n)var r=oe(ge("LOAD_SESSION|"+n));else{var i=ge("PERSISTENT|");r=rt(i,t)}else r=oe(t)}catch(e){return Promise.reject(e)}e.b=new fr;var a=Ph("generateKeyRequest");try{e.f[a](e.c,r)}catch(t){if("InvalidStateError"!=t.name)return e.b=null,Promise.reject(t);new Ge((function(){try{e.f[a](e.c,r)}catch(t){e.b.reject(t),e.b=null}})).N(.01)}return e.b}function Yh(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,n=new Xi("keystatuseschange"),e.dispatchEvent(n)}function Vh(){this.size=0,this.a=void 0}sh((function(){pg()}),-2),sh((function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",lh),document.addEventListener("webkitfullscreenerror",lh),document.addEventListener("mozfullscreenchange",lh),document.addEventListener("mozfullscreenerror",lh),document.addEventListener("MSFullscreenChange",lh),document.addEventListener("MSFullscreenError",lh)}})),sh((function(){})),sh((function(){!Ye()&&navigator.mediaCapabilities||!e.MediaSource||(navigator.mediaCapabilities={},navigator.mediaCapabilities.decodingInfo=ch)}),-1),sh((function(){var t=qe();e.MediaSource&&(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */);return n.shift(),n.some((function(e){return e.startsWith("codecs=")}))?cast.__platform__.canDisplayType(t):e(t)}}():t?(function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),12>=t?(dh(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):dh()):(We("Tizen 2")||We("Tizen 3")||We("Tizen 4"))&&function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=br(t)&&e(t)}}()),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),r=n.findIndex((function(e){return e.startsWith("codecs=")}));if(0>r)return e(t);var i=n[r].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),a=i.findIndex((function(e){return e.startsWith("vp09")}));return 0<=a&&(i[a]="vp9",n[r]='codecs="'+i.join(",")+'"',t=n.join("; ")),e(t)}}()})),m(fh,Qi),fh.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},fh.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},sh((function(){screen.orientation||null!=e.orientation&&function(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new fh;screen.orientation=n,t(),e.addEventListener("orientationchange",(function(){t();var e=new Xi("change",{});n.dispatchEvent(e)}))}()})),mh.prototype.createMediaKeys=function(){var e=new vh(this.keySystem);return Promise.resolve(e)},mh.prototype.getConfiguration=function(){return this.a},vh.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Eh(this.a,e)},vh.prototype.setServerCertificate=function(){return Promise.resolve(!1)},m(Eh,Qi),(r=Eh.prototype).generateRequest=function(e,t){var n=this;this.a=new fr;try{var r=this.g.createSession("video/mp4",oe(t));this.f=r,this.sessionId=r.sessionId||"",this.b.s(this.f,"webkitkeymessage",(function(e){n.a&&(n.a.resolve(),n.a=null),e=new Xi("message",{messageType:null==n.keyStatuses.a?"license-request":"license-renewal",message:ae(e.message)}),n.dispatchEvent(e)})),this.b.s(r,"webkitkeyadded",(function(){n.c&&(Th(n,"usable"),n.c.resolve(),n.c=null)})),this.b.s(r,"webkitkeyerror",(function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.f.error,null!=n.a)n.a.reject(e),n.a=null;else if(null!=n.c)n.c.reject(e),n.c=null;else switch(n.f.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:Th(n,"output-not-allowed");break;default:Th(n,"internal-error")}})),Th(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},r.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},r.update=function(e){this.c=new fr;try{this.f.update(oe(e))}catch(e){this.c.reject(e)}return this.c},r.close=function(){try{this.f.close(),this.closed.resolve(),this.b.hb()}catch(e){this.closed.reject(e)}return this.closed},r.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(r=_h.prototype).forEach=function(e){this.a&&e(this.a,Ga.value())},r.get=function(e){if(this.has(e))return this.a},r.has=function(e){var t=Ga.value();return!(!this.a||!re(e,t))},r.entries=function(){},r.keys=function(){},r.values=function(){},sh((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ph,e.MediaKeys=vh,e.MediaKeySystemAccess=mh,navigator.requestMediaKeySystemAccess=hh)})),Sh.prototype.createMediaKeys=function(){var e=new Ih(this.keySystem);return Promise.resolve(e)},Sh.prototype.getConfiguration=function(){return this.a},Ih.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new Ch(this.a,e)},Ih.prototype.setServerCertificate=function(){return Promise.resolve(!1)},m(Ch,Qi),(r=Ch.prototype).generateRequest=function(e,t){var n=this;this.a=new fr;try{this.f=this.g.createSession("video/mp4",oe(t),null),this.b.s(this.f,"mskeymessage",(function(e){n.a&&(n.a.resolve(),n.a=null),e=new Xi("message",{messageType:null==n.keyStatuses.a?"license-request":"license-renewal",message:ae(e.message)}),n.dispatchEvent(e)})),this.b.s(this.f,"mskeyadded",(function(){n.a?(Dh(n,"usable"),n.a.resolve(),n.a=null):n.c&&(Dh(n,"usable"),n.c.resolve(),n.c=null)})),this.b.s(this.f,"mskeyerror",(function(){var e=Error("EME PatchedMediaKeysMs key error");if(e.errorCode=n.f.error,null!=n.a)n.a.reject(e),n.a=null;else if(null!=n.c)n.c.reject(e),n.c=null;else switch(n.f.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Dh(n,"output-not-allowed");break;default:Dh(n,"internal-error")}})),Dh(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},r.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},r.update=function(e){this.c=new fr;try{this.f.update(oe(e))}catch(e){this.c.reject(e)}return this.c},r.close=function(){try{this.f.close(),this.closed.resolve(),this.b.hb()}catch(e){this.closed.reject(e)}return this.closed},r.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(r=Mh.prototype).forEach=function(e){this.a&&e(this.a,Ga.value())},r.get=function(e){if(this.has(e))return this.a},r.has=function(e){var t=Ga.value();return!(!this.a||!re(e,t))},r.entries=function(){},r.keys=function(){},r.values=function(){},sh((function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,e.MediaKeys=Ih,e.MediaKeySystemAccess=Sh,navigator.requestMediaKeySystemAccess=bh,HTMLMediaElement.prototype.setMediaKeys=wh)})),xh.prototype.createSession=function(){},xh.prototype.setServerCertificate=function(){},Oh.prototype.getConfiguration=function(){},Oh.prototype.createMediaKeys=function(){},sh((function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=Lh,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Nh,e.MediaKeys=xh,e.MediaKeySystemAccess=Oh)}),-10),Uh.prototype.createMediaKeys=function(){var e=new Bh(this.a);return Promise.resolve(e)},Uh.prototype.getConfiguration=function(){return this.b},Bh.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.a||document.createElement("video");return t.src||(t.src="about:blank"),e=new Hh(t,this.g,e),this.c.push(e),e},Bh.prototype.setServerCertificate=function(){return Promise.resolve(!1)},m(Hh,Qi),(r=Hh.prototype).handleError=function(e){var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.b?(45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Yh(this,"output-restricted"):Yh(this,1==t?"expired":"internal-error"))},r.generateRequest=function(e,t){return Kh(this,t,null)},r.load=function(e){return"persistent-license"==this.g?Kh(this,null,e):Promise.reject(Error("Not a persistent session."))},r.update=function(e){var t=new fr;return function e(t,n,r){if(t.a)t.a.then((function(){return e(t,n,r)})).catch((function(){return e(t,n,r)}));else{if(t.a=n,"webkit-org.w3.clearkey"==t.c){var i=fe(r),a=JSON.parse(i);"oct"!=a.keys[0].kty&&(t.a.reject(Error("Response is not a valid JSON Web Key Set.")),t.a=null),i=et(a.keys[0].k),a=et(a.keys[0].kid)}else i=oe(r),a=null;var o=Ph("addKey");try{t.f[o](t.c,i,a,t.sessionId)}catch(e){t.a.reject(e),t.a=null}}}(this,t,e),t},r.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Ph("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},r.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(r=Vh.prototype).forEach=function(e){this.a&&e(this.a,Ga.value())},r.get=function(e){if(this.has(e))return this.a},r.has=function(e){var t=Ga.value();return!(!this.a||!re(e,t))},r.entries=function(){},r.keys=function(){},r.values=function(){};var qh="";function Wh(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function zh(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Xh(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Qh(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Jh(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Zh(){return new Promise((function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota((function(t,n){e({usage:t,quota:n})}),t)}))}function $h(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function ep(t,n,r){return new e.TextTrackCue(t,n,r)}function tp(t,n,r){return new e.TextTrackCue(t+"-"+n+"-"+r,t,n,r)}function np(){}sh((function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)qh="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=kh,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Fh,e.MediaKeys=Bh,e.MediaKeySystemAccess=Uh}})),sh((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=zh,Object.defineProperty(t,"disablePictureInPicture",{get:Qh,set:Jh,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Xh,document.addEventListener("webkitpresentationmodechanged",Wh,!0))}})),sh((function(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=Zh)})),sh((function(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}})),sh((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=$h)}})),sh((function(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=ep;else if(6==n)t=tp;else{try{var r=!!ep(1,2,"")}catch(e){r=!1}r&&(t=ep)}t&&(e.VTTCue=function(e,n,r){return t(e,n,r)})}})),np.prototype.parseInit=function(){},np.prototype.parseMedia=function(e,t){for(var n=null,r=[],i=fe(e).split(/\r?\n/),a=(i=l(i)).next();!a.done;a=i.next())if((a=a.value)&&!/^\s+$/.test(a)&&(a=rp.exec(a))){var o=ip.exec(a[1]);a=new dt(o=60*parseInt(o[1],10)+parseFloat(o[2].replace(",",".")),t.segmentEnd?t.segmentEnd:o+2,a[2]),n&&(n.endTime=o,r.push(n)),n=a}return n&&r.push(n),r},G("shaka.text.LrcTextParser",np),np.prototype.parseMedia=np.prototype.parseMedia,np.prototype.parseInit=np.prototype.parseInit;var rp=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,ip=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function ap(){}function op(e,t,n,r,i,a,o,s,u,c){var d=e.parentNode;if(e.nodeType==Node.TEXT_NODE){var f=document.createElement("span");f.textContent=e.textContent,e=f}if(s="default"==(e.getAttribute("xml:space")||(s?"default":"preserve")),f=/\S/.test(e.textContent),!(e.hasAttribute("begin")||e.hasAttribute("end")||e.hasAttribute("dur")||f||"br"==e.tagName||u&&!s))return null;var h=pp(e,n);for(f=h.start,h=h.end;d&&d.nodeType==Node.ELEMENT_NODE&&"tt"!=d.tagName;)f=(h=hp(d,n,f,h)).start,h=h.end,d=d.parentNode;if(null==f&&(f=0),f+=t,h=null==h?1/0:h+t,"br"==e.tagName)return(r=new dt(f,h,"")).lineBreak=!0,r;var p="";if(d=[],Array.from(e.childNodes).every((function(e){return e.nodeType==Node.TEXT_NODE})))p=e.textContent,s&&(p=(p=p.trim()).replace(/\s+/g," "));else for(var g=l(e.childNodes),m=g.next();!m.done;m=g.next())(m=op(m.value,t,n,r,i,a,o,s,!0,c))&&d.push(m);if((t=new dt(f,h,p)).nestedCues=d,c&&(t.cellResolution=c),(a=fp(e,"region",a,"")[0])&&a.getAttribute("xml:id")){var v=a.getAttribute("xml:id");t.region=o.filter((function(e){return e.id==v}))[0]}for(o=null,n=(c=l(Mp)).next();!n.done&&!(o=fp(e,"backgroundImage",r,"#",n.value)[0]);n=c.next());return function(e,t,n,r,i,a,o){if("rtl"==up(t,n,i,"direction",a=a||o)&&(e.direction="rtl"),"tb"==(o=up(t,n,i,"writingMode",a))||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=yt),(o=up(t,n,i,"textAlign",a))?(e.positionAlign=Dp[o],e.lineAlign=Cp[o],e.textAlign=gt[o.toUpperCase()]):e.textAlign="start",(o=up(t,n,i,"displayAlign",a))&&(e.displayAlign=vt[o.toUpperCase()]),(o=up(t,n,i,"color",a))&&(e.color=o),(o=up(t,n,i,"backgroundColor",a))&&(e.backgroundColor=o),(o=up(t,n,i,"border",a))&&(e.border=o),(o=up(t,n,i,"fontFamily",a))&&(e.fontFamily=o),(o=up(t,n,i,"fontWeight",a))&&"bold"==o&&(e.fontWeight=700),o=up(t,n,i,"wrapOption",a),e.wrapLine=!o||"noWrap"!=o,(o=up(t,n,i,"lineHeight",a))&&o.match(Tp)&&(e.lineHeight=o),(o=up(t,n,i,"fontSize",a))&&(o.match(Tp)||o.match(Ep))&&(e.fontSize=o),(o=up(t,n,i,"fontStyle",a))&&(e.fontStyle=Rt[o.toUpperCase()]),r){o=r.getAttribute("imageType")||r.getAttribute("imagetype");var s=r.getAttribute("encoding");r=r.textContent.trim(),"PNG"==o&&"Base64"==s&&r&&(e.backgroundImage="data:image/png;base64,"+r)}(r=up(t,n,i,"letterSpacing",a))&&r.match(Tp)&&(e.letterSpacing=r),(r=up(t,n,i,"linePadding",a))&&r.match(Tp)&&(e.linePadding=r),(a=up(t,n,i,"opacity",a))&&(e.opacity=parseFloat(a)),(n=lp(n,i,"textDecoration"))&&sp(e,n),(t=cp(t,i,"textDecoration"))&&sp(e,t)}(t,e,a,o,i,u,0==d.length),t}function sp(e,t){for(var n=l(t.split(" ")),r=n.next();!r.done;r=n.next())switch(r.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&ut(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&ut(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&ut(e.textDecoration,"overline")}}function up(e,t,n,r,i){return i=void 0===i||i,(e=cp(e,n,r))?e:i?lp(t,n,r):null}function lp(e,t,n){return e?Kl(e,"http://www.w3.org/ns/ttml#styling",n)||dp(e,t,n):null}function cp(e,t,n){return Kl(e,"http://www.w3.org/ns/ttml#styling",n)||dp(e,t,n)}function dp(e,t,n){e=fp(e,"style",t,"");for(var r=null,i=0;i<e.length;i++){var a=Kl(e[i],"urn:ebu:tt:style",n);a||(a=Kl(e[i],"http://www.w3.org/ns/ttml#styling",n)),a||(a=cp(e[i],t,n)),a&&(r=a)}return r}function fp(e,t,n,r,i){var a=[];if(!e||1>n.length)return a;var o=e;for(e=null;o&&!(e=i?Kl(o,i,t):o.getAttribute(t))&&(o=o.parentNode)instanceof Element;);if(t=e)for(i=(t=l(t.split(" "))).next();!i.done;i=t.next())for(i=i.value,o=(e=l(n)).next();!o.done;o=e.next())if(r+(o=o.value).getAttribute("xml:id")==i){a.push(o);break}return a}function hp(e,t,n,r){return e=pp(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==r?r=e.end:null!=e.start&&(r+=e.start),{start:n,end:r}}function pp(e,t){var n=gp(e.getAttribute("begin"),t),r=gp(e.getAttribute("end"),t),i=gp(e.getAttribute("dur"),t);return null==r&&null!=i&&(r=n+i),{start:n,end:r}}function gp(e,t){var n=null;if(bp.test(e)){n=bp.exec(e);var r=Number(n[1]),i=Number(n[2]),a=Number(n[3]),o=Number(n[4]);n=(a+=(o+=(Number(n[5])||0)/t.b)/t.frameRate)+60*i+3600*r}else if(Ap.test(e))n=mp(Ap,e);else if(Sp.test(e))n=mp(Sp,e);else if(wp.test(e))n=wp.exec(e),n=Number(n[1])/t.frameRate;else if(Ip.test(e))n=Ip.exec(e),n=Number(n[1])/t.a;else if(Rp.test(e))n=mp(Rp,e);else if(e)throw new le(2,2,2001,"Could not parse cue time range in TTML");return n}function mp(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function vp(e,t,n,r){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(r),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}Cr["application/x-subtitle-lrc"]=function(){return new np},ap.prototype.parseInit=function(){},ap.prototype.parseMedia=function(e,t){var n=fe(e),r=[],i=new DOMParser,a=null;if(""==n)return r;try{a=i.parseFromString(n,"text/xml")}catch(e){throw new le(2,2,2005,"Failed to parse TTML.")}if(a){if(n=a.getElementsByTagName("parsererror")[0])throw new le(2,2,2005,n.textContent);var o=a.getElementsByTagName("tt")[0];if(!o)throw new le(2,2,2005,"TTML does not contain <tt> tag.");if(!(i=o.getElementsByTagName("body")[0]))return[];n=Kl(o,"http://www.w3.org/ns/ttml#parameter","frameRate");var s=Kl(o,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=Kl(o,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=Kl(o,"http://www.w3.org/ns/ttml#parameter","tickRate"),d=Kl(o,"http://www.w3.org/ns/ttml#parameter","cellResolution");a=o.getAttribute("xml:space")||"default";var f=Kl(o,"http://www.w3.org/ns/ttml#styling","extent");if("default"!=a&&"preserve"!=a)throw new le(2,2,2005,"Invalid xml:space value: "+a);a="default"==a,n=new vp(n,s,u,c),d=d&&(d=/^(\d+) (\d+)$/.exec(d))?{columns:parseInt(d[1],10),rows:parseInt(d[2],10)}:null,s=(s=o.getElementsByTagName("metadata")[0])?function(e){return Array.from(e.childNodes).filter((function(e){return e instanceof Element}))}(s):[],u=Array.from(o.getElementsByTagName("style")),c=[];for(var h=l(o=Array.from(o.getElementsByTagName("region"))),p=h.next();!p.done;p=h.next()){var g=p.value;p=new Ct;var m=g.getAttribute("xml:id");if(m){p.id=m;var v,y,E=null;f&&(E=yp.exec(f)||_p.exec(f)),m=E?Number(E[1]):null,E=E?Number(E[2]):null,(v=lp(g,u,"extent"))&&null!=(v=(y=yp.exec(v))||_p.exec(v))&&(p.width=Number(v[1]),p.height=Number(v[2]),y||(null!=m&&(p.width=100*p.width/m),null!=E&&(p.height=100*p.height/E)),p.widthUnits=y||null!=m?Dt:0,p.heightUnits=y||null!=E?Dt:0),(g=lp(g,u,"origin"))&&null!=(v=(y=yp.exec(g))||_p.exec(g))&&(p.viewportAnchorX=Number(v[1]),p.viewportAnchorY=Number(v[2]),y||(null!=E&&(p.viewportAnchorY=100*p.viewportAnchorY/E),null!=m&&(p.viewportAnchorX=100*p.viewportAnchorX/m)),p.viewportAnchorUnits=y||null!=m?Dt:0)}else p=null;p&&c.push(p)}if(jl(i,"p").length)throw new le(2,2,2001,"<p> can only be inside <div> in TTML");for(f=(i=l(jl(i,"div"))).next();!f.done;f=i.next()){if(jl(f=f.value,"span").length)throw new le(2,2,2001,"<span> can only be inside <p> in TTML");if((h=jl(f,"p"))&&h.length)for(h=(f=l(h)).next();!h.done;h=f.next())(h=op(h.value,t.periodStart,n,s,u,o,c,a,!1,d))&&r.push(h);else(f=op(f,t.periodStart,n,s,u,o,c,a,!1,d))&&r.push(f)}}return r},G("shaka.text.TtmlTextParser",ap),ap.prototype.parseMedia=ap.prototype.parseMedia,ap.prototype.parseInit=ap.prototype.parseInit;var yp=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Ep=/^(\d{1,2}(?:\.\d+)?|100)%$/,Tp=/^(\d+px|\d+em|\d*\.?\d+c)$/,_p=/^(\d+)px (\d+)px$/,bp=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ap=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Sp=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,wp=/^(\d*(?:\.\d*)?)f$/,Ip=/^(\d*(?:\.\d*)?)t$/,Rp=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Cp={left:_t,center:"center",right:"end",start:_t,end:"end"},Dp={left:"line-left",center:"center",right:"line-right"},Mp=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function Lp(){this.j=new ap}function Np(){}function xp(e){for(var t=l(Object.entries(At)),n=t.next();!n.done;n=t.next()){var r=l(n.value);n=r.next().value,r=r.next().value;var i=new dt(0,0,"");i.color=r,e.set(n,i)}for(n=(t=l(Object.entries(St))).next();!n.done;n=t.next())n=(r=l(n.value)).next().value,r=r.next().value,(i=new dt(0,0,"")).backgroundColor=r,e.set(n,i)}function Op(e,t,n){0===n.size&&xp(n);e:{var r=e;e=[];for(var i=-1,a="",o=0;o<r.length;o++)if("/"===r[o]){var s=r.indexOf(">",o);if(s<=o){e=r;break e}s=r.substring(o+1,s);var u=e.pop();if(u===s)a+="/"+s+">";else{if(!u.startsWith("c.")||"c"!==s){e=r;break e}a+="/"+u+">"}o+=s.length+1}else"<"===r[o]?i=o+1:">"===r[o]&&0<i&&(e.push(r.substr(i,o-i)),i=-1),a+=r[o];e=a}if(i=tc("<span>"+e+"</span>","span")){if(r=[],1==(i=i.childNodes).length&&((a=i[0]).nodeType==Node.TEXT_NODE||a.nodeType==Node.CDATA_SECTION_NODE))return void(t.payload=e);for(i=(e=l(i)).next();!i.done;i=e.next())kp(i.value,t,r,n);t.nestedCues=r}else t.payload=e}function Pp(e,t){return e&&0<e.length?e:t}function kp(e,t,n,r){var i=t.clone();if(e.nodeType===Node.ELEMENT_NODE&&e.nodeName)for(var a=l(e.nodeName.split(/[ .]+/)),o=a.next();!o.done;o=a.next()){if(o=o.value,r.has(o)){var s=r.get(o);s&&(i.backgroundColor=Pp(s.backgroundColor,i.backgroundColor),i.color=Pp(s.color,i.color),i.fontFamily=Pp(s.fontFamily,i.fontFamily),i.fontSize=Pp(s.fontSize,i.fontSize),i.fontWeight=s.fontWeight,i.fontStyle=s.fontStyle,i.opacity=s.opacity,i.wrapLine=s.wrapLine)}switch(o){case"b":i.fontWeight=700;break;case"i":i.fontStyle="italic";break;case"u":i.textDecoration.push("underline")}}if(Vl(e))for(a=!0,r=l(e.textContent.split("\n")),e=r.next();!e.done;e=r.next())e=e.value,a||((a=t.clone()).lineBreak=!0,n.push(a)),0<e.length&&((a=i.clone()).payload=e,n.push(a)),a=!1;else for(e=(t=l(e.childNodes)).next();!e.done;e=t.next())kp(e.value,i,n,r)}function Fp(e,t,n){var r;(r=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=r[1],e.textAlign="middle"==t?pt:gt[t.toUpperCase()]):(r=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==r[1]?"vertical-lr":"vertical-rl":(r=/^size:([\d.]+)%$/.exec(t))?e.size=Number(r[1]):(r=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))?(e.position=Number(r[1]),r[2]&&(t=r[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center")):(r=/^region:(.*)$/.exec(t))?(t=function(e,t){var n=e.filter((function(e){return e.id==t}));return n.length?n[0]:null}(n,r[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=bt[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=Tt,e.line=Number(n[1]),n[2]&&(e.lineAlign=bt[n[2].toUpperCase()]))}function Up(e){if(null==(e=yd(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function Bp(){this.a=null}function Gp(e,t,n){var r,i,a;return(new Me).box("payl",xe((function(e){r=fe(e)}))).box("iden",xe((function(e){i=fe(e)}))).box("sttg",xe((function(e){a=fe(e)}))).parse(e),r?function(e,t,n,r,i){if(Op(e,r=new dt(r,i,""),new Map),t&&(r.id=t),n)for(t=Ed(e=new md(n));t;)Fp(r,t,[]),vd(e),t=Ed(e);return r}(r,i,a,t,n):null}function jp(){}function Hp(e){if(null==(e=yd(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function Kp(){this.j=new Np}function Yp(e){var t="WEBVTT\n\n";if(""==e)return t;for(var n=(e=l((e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!n.done;n=e.next())(n=n.value.split(/\n/))[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n")+"\n\n";return t}function Vp(){}function qp(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=Wp(n))&&(e.color=n),(n=t.BackColour)&&(n=Wp(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=700),t.Italic&&(e.fontStyle="italic"),t.Underline&&e.textDecoration.push("underline"),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=mt,e.textAlign="start";break;case 2:e.displayAlign=mt,e.textAlign=pt;break;case 3:e.displayAlign=mt,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=pt;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=pt;break;case 11:e.displayAlign="center",e.textAlign="end"}(n=t.AlphaLevel)&&(e.opacity=parseFloat(n))}function Wp(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function zp(e){return 3600*((e=eg.exec(e))[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}Cr["application/ttml+xml"]=function(){return new ap},Lp.prototype.parseInit=function(e){var t=!1;if((new Me).box("moov",Le).box("trak",Le).box("mdia",Le).box("minf",Le).box("stbl",Le).S("stsd",Ne).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new le(2,2,2007)},Lp.prototype.parseMedia=function(e,t){var n=this,r=!1,i=[];if((new Me).box("mdat",xe((function(e){r=!0,i=i.concat(n.j.parseMedia(e,t))}))).parse(e,!1),!r)throw new le(2,2,2007);return i},G("shaka.text.Mp4TtmlParser",Lp),Lp.prototype.parseMedia=Lp.prototype.parseMedia,Lp.prototype.parseInit=Lp.prototype.parseInit,Cr['application/mp4; codecs="stpp"']=function(){return new Lp},Cr['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new Lp},Cr['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new Lp},Np.prototype.parseInit=function(){},Np.prototype.parseMedia=function(e,t){var n=fe(e),r=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(r[0]))throw new le(2,2,2e3);if(n=t.periodStart,r[0].includes("X-TIMESTAMP-MAP")){var i=r[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=r[0].match(/MPEGTS:(\d+)/m);if(i&&a){if(null==(n=Up(new md(i[1]))))throw new le(2,2,2e3);for(a=Number(a[1]),i=t.segmentStart;95443.7176888889<=i;)i-=95443.7176888889,a+=8589934592;n=t.periodStart+a/9e4-n}}a=[];for(var o=(i=l(r[0].split("\n"))).next();!o.done;o=i.next())if(o=o.value,/^Region:/.test(o)){o=new md(o);var s=new Ct;Ed(o),vd(o);for(var u=Ed(o);u;){var c=s,d=u;(u=/^id=(.*)$/.exec(d))?c.id=u[1]:(u=/^width=(\d{1,2}|100)%$/.exec(d))?c.width=Number(u[1]):(u=/^lines=(\d+)$/.exec(d))?(c.height=Number(u[1]),c.heightUnits=2):(u=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.regionAnchorX=Number(u[1]),c.regionAnchorY=Number(u[2])):(u=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(d))?(c.viewportAnchorX=Number(u[1]),c.viewportAnchorY=Number(u[2])):/^scroll=up$/.exec(d)&&(c.scroll="up"),vd(o),u=Ed(o)}a.push(s)}for(xp(i=new Map),o=[],s=(r=l(r.slice(1))).next();!s.done;s=r.next()){if((1!=(s=s.value.split("\n")).length||s[0])&&!/^NOTE($|[ \t])/.test(s[0])&&"STYLE"==s[0]&&s[1].includes("::cue")){c="global",(u=s[1].match(/\((.*)\)/))&&(c=u.pop()),u=s.slice(2,-1),s[1].includes("}")&&(d=/\{(.*?)\}/.exec(s[1]))&&(u=d[1].split(";")),d=new dt(0,0,"");for(var f=!1,h=0;h<u.length;h++){var p=/^\s*([^:]+):\s*(.*)/.exec(u[h]);if(p){var g=p[2].trim().replace(";","");switch(p[1].trim()){case"background-color":f=!0,d.backgroundColor=g;break;case"color":f=!0,d.color=g;break;case"font-family":f=!0,d.fontFamily=g;break;case"font-size":f=!0,d.fontSize=g;break;case"font-weight":700<=parseInt(g,10)&&(f=!0,d.fontWeight=700);break;case"font-style":switch(g){case"normal":f=!0,d.fontStyle=It;break;case"italic":f=!0,d.fontStyle="italic";break;case"oblique":f=!0,d.fontStyle="oblique"}break;case"opacity":f=!0,d.opacity=parseFloat(g);break;case"white-space":f=!0,d.wrapLine="noWrap"!=g}}}f&&i.set(c,d)}if(h=n,1==s.length&&!s[0]||/^NOTE($|[ \t])/.test(s[0])||"STYLE"==s[0])s=null;else{if(c=null,s[0].includes("--\x3e")||(c=s[0],s.splice(0,1)),d=Up(u=new md(s[0])),p=yd(u,/[ \t]+--\x3e[ \t]+/g),f=Up(u),null==d||null==p||null==f)throw new le(2,2,2001,"Could not parse cue time range in WebVTT");for(d+=h,f+=h,h=s.slice(1).join("\n").trim(),i.has("global")?((s=i.get("global").clone()).startTime=d,s.endTime=f,s.payload=""):s=new dt(d,f,""),Op(h,s,i),vd(u),d=Ed(u);d;)Fp(s,d,a),vd(u),d=Ed(u);null!=c&&(s.id=c)}s&&o.push(s)}return o},G("shaka.text.VttTextParser",Np),Np.prototype.parseMedia=Np.prototype.parseMedia,Np.prototype.parseInit=Np.prototype.parseInit,Cr["text/vtt"]=function(){return new Np},Cr['text/vtt; codecs="vtt"']=function(){return new Np},Cr['text/vtt; codecs="wvtt"']=function(){return new Np},Bp.prototype.parseInit=function(e){var t=this,n=!1;if((new Me).box("moov",Le).box("trak",Le).box("mdia",Le).S("mdhd",(function(e){e=kn(e.reader,e.version),t.a=e.timescale})).box("minf",Le).box("stbl",Le).S("stsd",Ne).box("wvtt",(function(){n=!0})).parse(e),!this.a)throw new le(2,2,2008);if(!n)throw new le(2,2,2008)},Bp.prototype.parseMedia=function(e,t){if(!this.a)throw new le(2,2,2008);var n,r=0,i=[],a=[],o=!1,s=!1,u=!1,c=null;if((new Me).box("moof",Le).box("traf",Le).S("tfdt",(function(e){o=!0,r=Pn(e.reader,e.version).cd})).S("tfhd",(function(e){c=On(e.reader,e.flags).Pd})).S("trun",(function(e){s=!0,i=Fn(e.reader,e.version,e.flags).ge})).box("mdat",xe((function(e){u=!0,n=e}))).parse(e,!1),!u&&!o&&!s)throw new le(2,2,2008);for(var d=r,f=new ye(n,0),h=l(i),p=h.next();!p.done;p=h.next()){var g=(p=p.value).yd||c,m=p.Dc?r+p.Dc:d;d=m+(g||0);var v=0;do{var y=f.I();v+=y;var E=null;"vttc"==Pe(f.I())?8<y&&(E=f.Va(y-8)):f.skip(y-8),g&&E&&(y=Gp(E,t.periodStart+m/this.a,t.periodStart+d/this.a),a.push(y))}while(p.sampleSize&&v<p.sampleSize)}return a.filter(Ce)},G("shaka.text.Mp4VttParser",Bp),Bp.prototype.parseMedia=Bp.prototype.parseMedia,Bp.prototype.parseInit=Bp.prototype.parseInit,Cr['application/mp4; codecs="wvtt"']=function(){return new Bp},jp.prototype.parseInit=function(){},jp.prototype.parseMedia=function(e){var t=fe(e).replace(/\r+/g,"");if(e=[],""==(t=t.trim()))return e;for(var n=(t=l(t.split("\n\n"))).next();!n.done;n=t.next()){var r=new md((n=n.value.split("\n"))[0]),i=Hp(r),a=yd(r,/,/g);if(r=Hp(r),null==i||null==a||null==r)throw new le(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new dt(i,r,n.slice(1).join("\n").trim()))}return e},G("shaka.text.SbvTextParser",jp),jp.prototype.parseMedia=jp.prototype.parseMedia,jp.prototype.parseInit=jp.prototype.parseInit,Cr["text/x-subviewer"]=function(){return new jp},Kp.prototype.parseInit=function(){},Kp.prototype.parseMedia=function(e,t){var n=fe(e);return n=oe(ge(n=Yp(n))),this.j.parseMedia(n,t)},G("shaka.text.SrtTextParser",Kp),Kp.srt2webvtt=Yp,Kp.prototype.parseMedia=Kp.prototype.parseMedia,Kp.prototype.parseInit=Kp.prototype.parseInit,Cr["text/srt"]=function(){return new Kp},Vp.prototype.parseInit=function(){},Vp.prototype.parseMedia=function(e){for(var t="",n="",r=(e=l(e=fe(e).split(/\r?\n\s*\r?\n/))).next();!r.done;r=e.next()){var i=Jp.exec(r.value);i&&(r=i[1],i=i[2],"V4 Styles"==r||"V4+ Styles"==r?t=i:"Events"==r&&(n=i))}e=[],r=null;for(var a=(t=l(t.split(/\r?\n/))).next();!a.done;a=t.next())if(i=a.value,!/^\s*;/.test(i)&&(a=Zp.exec(i)))if(i=a[1].trim(),a=a[2].trim(),"Format"==i)r=a.split($p);else if("Style"==i){i=a.split($p),a={};for(var o=0;o<r.length&&o<i.length;o++)a[r[o]]=i[o];e.push(a)}for(r=[],t=null,i={},a=(n=l(n.split(/\r?\n/))).next();!a.done;i={Uc:i.Uc},a=n.next())if(a=a.value,!/^\s*;/.test(a)&&(o=Zp.exec(a)))if(a=o[1].trim(),o=o[2].trim(),"Format"==a)t=o.split($p);else if("Dialogue"==a){o=o.split($p),a={};for(var s=0;s<t.length&&s<o.length;s++)a[t[s]]=o[s];o=new dt(s=zp(a.Start),zp(a.End),o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),i.Uc=a.Style,(a=e.find(function(e){return function(t){return t.Name==e.Uc}}(i)))&&qp(o,a),r.push(o)}return r},G("shaka.text.SsaTextParser",Vp),Vp.prototype.parseMedia=Vp.prototype.parseMedia,Vp.prototype.parseInit=Vp.prototype.parseInit;var Xp,Qp,Jp=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,Zp=/^\s*([^:]+):\s*(.*)/,$p=/\s*,\s*/,eg=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;
/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function tg(){}function ng(){Xp?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Xp=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=rg):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function rg(e,t){var n,r=this;return x((function(i){return 1==i.a?(console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),T(i,Xp.call(r,e,t),2)):fg(n=i.b)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Xp,i.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=ig,i.return(ig.call(r,e,t)))}))}function ig(e,t){var n,r,i,a,o,s,u,c,d,f,h=this;return x((function(p){if(1==p.a){for(console.assert(h==navigator,'bad "this" for requestMediaKeySystemAccess'),n=dg(e),r=[],i=l(t),a=i.next();!a.done;a=i.next())o=a.value,s=ag(o.videoCapabilities,n),u=ag(o.audioCapabilities,n),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!u.length||((c=Object.assign({},o)).videoCapabilities=s,c.audioCapabilities=u,r.push(c));if(!r.length)throw(d=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",d.code=DOMException.NOT_SUPPORTED_ERR,d;return T(p,Xp.call(h,e,r),2)}return f=p.b,p.return(new cg(f,n))}))}function ag(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e}function og(){}function sg(){Qp?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(Qp=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=ug):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function ug(e){var t,n,r=this;return x((function(i){return 1==i.a?(console.assert(r==navigator.mediaCapabilities,'bad "this" for decodingInfo'),T(i,Qp.call(r,e),2)):(t=i.b,e.keySystemConfiguration?(n=t.keySystemAccess)&&fg(n)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Qp,i.return(t)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=lg,i.return(lg.call(r,e))):i.return(t))}))}function lg(e){var t,n,r,i,a,o,s,u,l,c=this;return x((function(d){switch(d.a){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,e.keySystemConfiguration&&(n=e.keySystemConfiguration,r=n.keySystem,i=n.audio&&n.audio.encryptionScheme,a=n.video&&n.video.encryptionScheme,t=dg(r),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},i&&i!=t||a&&a!=t)?d.return(o):T(d,Qp.call(c,e),2);case 2:if((s=d.b).keySystemAccess){s.keySystemAccess=new cg(s.keySystemAccess,t),d.m(3);break}if(!e.keySystemConfiguration){d.m(3);break}var f=e.keySystemConfiguration,h=[],p=[];return f.audio&&h.push({robustness:f.audio.robustness||"",contentType:e.audio.contentType}),f.video&&p.push({robustness:f.video.robustness||"",contentType:e.video.contentType}),f={initDataTypes:f.initDataType?[f.initDataType]:[],distinctiveIdentifier:f.distinctiveIdentifier,persistentState:f.persistentState,sessionTypes:f.sessionTypes},h.length&&(f.audioCapabilities=h),p.length&&(f.videoCapabilities=p),u=f,l=s,T(d,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[u]),5);case 5:l.keySystemAccess=d.b;case 3:return d.return(s)}}))}function cg(e,t){this.b=e,this.a=t,this.keySystem=e.keySystem}function dg(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function fg(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function hg(){}function pg(){ng(),sg()}Cr["text/x-ssa"]=function(){return new Vp},G("EmeEncryptionSchemePolyfill",tg),tg.install=ng,G("McEncryptionSchemePolyfill",og),og.install=sg,cg.prototype.getConfiguration=function(){var e=this.b.getConfiguration();if(e.videoCapabilities)for(var t=l(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.a;if(e.audioCapabilities)for(n=(t=l(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.a;return e},cg.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},G("EncryptionSchemePolyfills",hg),hg.install=pg,void 0!==n&&n.exports&&(n.exports=hg)}.call(r,n,n,void 0),r.shaka)t[i]=r.shaka[i]}()}).call(this,n(13))},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(5),i=(n(25),n(19)),a=n.n(i),o={capLevelOnFPSDrop:!0,capLevelToPlayerSize:!0},s=function(e){function t(t){var n;return(n=e.call(this,t)||this).playlistDuration=0,n.hls=new a.a(o),n.hls.attachMedia(n.video),n.hls.on(a.a.Events.AUDIO_TRACK_SWITCHED,n.onAudioTrackChange.bind(Object(r.g)(n))),n.hls.on(a.a.Events.SUBTITLE_TRACK_SWITCH,n.onTextTrackChange.bind(Object(r.g)(n))),n.hls.on(a.a.Events.LEVEL_LOADED,n.onLevelLoaded.bind(Object(r.g)(n))),n}Object(r.d)(t,e),t.isSupported=function(){return a.a.isSupported()};var n=t.prototype;return n.load=function(e){var t=this;return this.state.playbackState!==r.b.IDLE&&this.stop(),this.updateState({playbackState:r.b.LOADING}),new Promise((function(n){t.hls.loadSource(e),t.hls.once(a.a.Events.MANIFEST_PARSED,(function(){n()}))}))},n.onTimeUpdate=function(){this.updateState({currentTime:this.currentTime,duration:this.duration,isAtLiveEdge:this.currentTime>=this.hls.liveSyncPosition-5,isSeekable:!this.isLive||this.playlistDuration>=300}),this.emit(r.e.TIME_UPDATE,{currentTime:this.currentTime,duration:this.duration})},n.onLevelLoaded=function(e,t){var n,r,i=null==t||null==(n=t.details)?void 0:n.live;this.isLiveFlag!==i&&(this.isLiveFlag=i,this.updateState({isLive:i})),this.playlistDuration=null==t||null==(r=t.details)?void 0:r.totalduration},n.getVideoLevels=function(){if(this.hls)return this.hls.levels.map((function(e,t){return{id:t,width:e.width,height:e.height,bitrate:e.bitrate}}))},n.seekToLive=function(){this.currentTime=this.hls.liveSyncPosition},n.destroy=function(){this.hls&&(this.hls.destroy(),this.hls=null),e.prototype.destroy.call(this)},Object(r.f)(t,[{key:"currentLevel",get:function(){var e=this;if(this.hls)return this.getVideoLevels().find((function(t){return t.id===e.hls.currentLevel}))},set:function(e){this.hls&&(e?this.hls.currentLevel=e.id:this.hls.nextLevel=-1)}},{key:"currentTime",get:function(){return this.video.currentTime},set:function(e){var t;this.state.isSeekable&&(this.video.currentTime=this.isLive?Math.min(e,null!=(t=this.hls.liveSyncPosition)?t:e):e)}},{key:"isLive",get:function(){return this.hls?this.isLiveFlag:isNaN(this.video.duration)}},{key:"audioTrack",get:function(){var e,t;return null==(e=this.hls)||null==(t=e.audioTrack)?void 0:t.toString()},set:function(e){this.hls&&(this.hls.audioTrack=parseInt(e))}},{key:"audioTracks",get:function(){var e,t=this;return(null==(e=this.hls)?void 0:e.audioTracks.map((function(e){return{id:e.id.toString(),label:e.name,language:e.lang,enabled:t.audioTrack===e.id.toString()}})))||[]}},{key:"textTrack",get:function(){var e,t;return null==(e=this.hls)||null==(t=e.subtitleTrack)?void 0:t.toString()},set:function(e){this.hls&&(this.hls.subtitleTrack=e?parseInt(e):-1)}},{key:"textTracks",get:function(){var e,t=this;return(null==(e=this.hls)?void 0:e.subtitleTracks.map((function(e){return{id:e.id.toString(),label:e.name,language:e.lang,enabled:t.textTrack===e.id.toString()}})))||[]}}]),t}(r.a);t.default=s},function(e,t,n){"use strict";n.r(t);var r=n(5),i=(n(25),n(96)),a=function(e){function t(t){var n;return(n=e.call(this,t)||this).shakaPlayer=new i.Player(n.video),n.shakaPlayer.addEventListener("variantchanged",n.onAudioTrackChange=n.onAudioTrackChange.bind(Object(r.g)(n))),n}Object(r.d)(t,e);var n=t.prototype;return n.load=function(e){return this.updateState({playbackState:r.b.LOADING}),this.shakaPlayer.load(e).catch((function(){}))},n.getVideoLevels=function(){if(this.shakaPlayer)return this.shakaPlayer.getVariantTracks().map((function(e){return{id:e.id,width:e.width,height:e.height,bitrate:e.bandwidth}}))},n.destroy=function(){this.shakaPlayer&&this.shakaPlayer.destroy(),e.prototype.destroy.call(this)},Object(r.f)(t,[{key:"isLive",get:function(){return this.shakaPlayer.isLive()}},{key:"audioTrack",get:function(){var e,t,n;return null==(e=this.shakaPlayer)||null==(t=e.getVariantTracks())||null==(n=t.find((function(e){return e.active})))?void 0:n.language},set:function(e){this.shakaPlayer&&this.shakaPlayer.selectAudioLanguage(e)}},{key:"audioTracks",get:function(){var e,t=this;return null==(e=this.shakaPlayer)?void 0:e.getAudioLanguages().map((function(e){return{id:e,language:e,label:e,enabled:t.audioTrack===e}}))}},{key:"currentLevel",set:function(e){if(this.shakaPlayer)if(e){this.shakaPlayer.configure({abr:{enabled:!1}});var t=this.shakaPlayer.getVariantTracks().find((function(t){return t.id==e.id}));this.shakaPlayer.selectVariantTrack(t,!0)}else this.shakaPlayer.configure({abr:{enabled:!0}})},get:function(){if(this.shakaPlayer){var e=this.shakaPlayer.getVariantTracks().find((function(e){return 1==e.active}));return{id:e.id,width:e.width,height:e.height,bitrate:e.bandwidth}}}}]),t}(r.a);t.default=a},function(e,t,n){"use strict";n.r(t);var r=n(5),i=(n(25),n(41)),a=function(e){function t(t){var n;return(n=e.call(this,t)||this).mediaPlayer=Object(i.MediaPlayer)().create(),n.mediaPlayer.initialize(),n.mediaPlayer.attachView(n.video),n}Object(r.d)(t,e);var n=t.prototype;return n.load=function(e){var t=this;return this.updateState({playbackState:r.b.LOADING}),new Promise((function(n,r){t.mediaPlayer.attachSource(e),t.mediaPlayer.on(i.MediaPlayer.events.MANIFEST_LOADED,(function(){n()})),t.mediaPlayer.on(i.MediaPlayer.events.ERROR,(function(e){r("Failed to load Mss Player")}))}))},n.destroy=function(){this.mediaPlayer&&(this.mediaPlayer.reset(),this.mediaPlayer=null),e.prototype.destroy.call(this)},Object(r.f)(t,[{key:"isLive",get:function(){return this.mediaPlayer.isDynamic()}}]),t}(r.a);t.default=a},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.FactoryMaker=t.MediaPlayer=void 0;var r=s(n(64)),i=s(n(0)),a=s(n(2)),o=n(92);function s(e){return e&&e.__esModule?e:{default:e}}var u="undefined"!=typeof window&&window||e,l=u.dashjs;l||(l=u.dashjs={}),l.MediaPlayer=r.default,l.FactoryMaker=i.default,l.Debug=a.default,l.Version=(0,o.getVersionString)(),t.default=l,t.MediaPlayer=r.default,t.FactoryMaker=i.default,t.Debug=a.default}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(1)),i=l(n(9)),a=l(n(3)),o=l(n(4)),s=l(n(0)),u=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=this.context,n=(0,a.default)(t).getInstance(),s=void 0,l=void 0,c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0,M=void 0;function L(e){if(!p||!isNaN(g)){var t=g;if(isNaN(t))if(E){t=e.liveStartTime;var r=c.getCurrentDVRInfo(),i=r?r.range:null;if(i){var a=q(!0);isNaN(a)||(s.info("Start time from URI parameters: "+a),t=Math.max(Math.min(t,a),i.start))}}else{t=y.start;var u=q(!1);!isNaN(u)&&u<t+y.duration&&(s.info("Start time from URI parameters: "+u),t=Math.max(t,u))}isNaN(t)||t===f.getTime()||(n.trigger(o.default.PLAYBACK_SEEKING,{seekTime:t}),U(t,!1,!0))}}function N(){return parseFloat((x()-B()).toFixed(5))}function x(){return y.start+y.duration}function O(){y&&f&&f.getElement()?f.play():_=!0}function P(){return y&&f?f.isPaused():null}function k(){y&&f&&f.pause()}function F(){return y&&f?f.isSeeking():null}function U(e,t,r){y&&f&&e!==(isNaN(S)?f.getTime():S)&&((w=!0===r)||(S=e,n.trigger(o.default.PLAYBACK_SEEK_ASKED)),s.info("Requesting seek to time: "+e+(w?" (internal)":"")),f.setCurrentTime(e,t))}function B(){return y&&f?f.getTime():null}function G(){var e=B();if(E&&!isNaN(A)){var t=A/1e3;e>t&&(e-=t)}return e}function j(){return y&&f?f.getPlaybackRate():null}function H(){return y&&f?f.getEnded():null}function K(){return E}function Y(){if(!E||isNaN(A))return NaN;var e=G();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*h.getClientTimeOffset();return Math.max(((t-A-1e3*e)/1e3).toFixed(3),0)}function V(){_=!1,p=!1,g=NaN,v=0,A=0,S=NaN,f&&(n.off(o.default.STREAM_INITIALIZED,L,this),n.off(o.default.DATA_UPDATE_COMPLETED,Q,this),n.off(o.default.BUFFER_LEVEL_STATE_CHANGED,ve,this),n.off(o.default.LOADING_PROGRESS,me,this),n.off(o.default.PLAYBACK_PROGRESS,de,this),n.off(o.default.PLAYBACK_TIME_UPDATED,de,this),n.off(o.default.PLAYBACK_ENDED,le,this),n.off(o.default.STREAM_INITIALIZING,Ee,this),z(),f.removeEventListener("canplay",J),f.removeEventListener("play",Z),f.removeEventListener("waiting",$),f.removeEventListener("playing",ee),f.removeEventListener("pause",te),f.removeEventListener("error",ce),f.removeEventListener("seeking",ne),f.removeEventListener("seeked",re),f.removeEventListener("timeupdate",ie),f.removeEventListener("progress",ae),f.removeEventListener("ratechange",oe),f.removeEventListener("loadedmetadata",se),f.removeEventListener("stalled",ye),f.removeEventListener("ended",ue)),m=null,f=null,y=null,E=null}function q(e){var t=D.getURIFragmentData();if(!t||!t.t)return NaN;var n=l.getStreams()[0].getStreamInfo().start;t.t=t.t.split(",")[0];var r=-1!==t.t.indexOf("posix:")?"now"===t.t.substring(6)?Date.now()/1e3:parseInt(t.t.substring(6)):NaN;return e&&!isNaN(r)?r-A/1e3:parseInt(t.t)+n}function W(){null===m&&(m=setInterval((function(){var e;n.trigger(o.default.WALLCLOCK_TIME_UPDATED,{isDynamic:E,time:new Date}),K()&&P()&&(e=Date.now(),(!b||e>b+500)&&(b=e,ie()))}),M.get().streaming.wallclockTimeUpdateInterval))}function z(){clearInterval(m),m=null}function X(e){if(!P()&&E&&0!==f.getReadyState()){var t=G(),n=function(e,t){var n=c.getCurrentDVRInfo(t),r=n?n.range:null;return r?(s.debug("Checking DVR window for at "+e+" with DVR window range "+r.start+" - "+r.end),e>r.end?Math.max(r.end-v,r.start):e>0&&e+.25<r.start&&Math.abs(e-r.start)<31536e4?r.start:e):NaN}(t,e);!isNaN(n)&&n!==t&&!F()&&(s.debug("UpdateCurrentTime: Seek to actual time: "+n+" from currentTime: "+t),U(n))}}function Q(e){if(!e.error){var t=d.convertDataToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&y.id===n.id&&(y=n,X())}}function J(){n.trigger(o.default.CAN_PLAY)}function Z(){s.info("Native video element event: play"),X(),W(),n.trigger(o.default.PLAYBACK_STARTED,{startTime:B()})}function $(){s.info("Native video element event: waiting"),n.trigger(o.default.PLAYBACK_WAITING,{playingTime:B()})}function ee(){s.info("Native video element event: playing"),n.trigger(o.default.PLAYBACK_PLAYING,{playingTime:B()})}function te(){s.info("Native video element event: pause"),n.trigger(o.default.PLAYBACK_PAUSED,{ended:H()})}function ne(){if(w)w=!1;else{var e=B();isNaN(S)||S===e||(e=S),S=NaN,s.info("Seeking to: "+e),W(),n.trigger(o.default.PLAYBACK_SEEKING,{seekTime:e})}}function re(){s.info("Native video element event: seeked"),n.trigger(o.default.PLAYBACK_SEEKED)}function ie(){y&&n.trigger(o.default.PLAYBACK_TIME_UPDATED,{timeToEnd:N(),time:B()})}function ae(){n.trigger(o.default.PLAYBACK_PROGRESS)}function oe(){var e=j();s.info("Native video element event: ratechange: ",e),n.trigger(o.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function se(){s.info("Native video element event: loadedmetadata"),n.trigger(o.default.PLAYBACK_METADATA_LOADED),W()}function ue(){s.info("Native video element event: ended"),k(),z();var e=l?l.getActiveStreamInfo():null;e&&n.trigger(o.default.PLAYBACK_ENDED,{isLast:e.isLast})}function le(e){if(m&&e.isLast){s.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var t=e.seekTime?e.seekTime:x();f.setCurrentTime(t),k(),z()}}function ce(e){var t=e.target||e.srcElement;n.trigger(o.default.PLAYBACK_ERROR,{error:t.error})}function de(){E&&fe()&&M.get().streaming.liveCatchup.playbackRate>0&&!P()&&!F()&&(function(){try{if(fe()&&M.get().streaming.liveCatchup.playbackRate>0&&B()>0){var e=pe(),t=Y(),n=T.getLiveDelay(),i=T.getLiveCatchupLatencyThreshold(),a=M.get().streaming.liveCatchup.minDrift;return e===r.default.LIVE_CATCHUP_MODE_LOLP?function(e,t,n,r,i,a){try{var o=Math.abs(e-t);return(isNaN(a)||e<=a)&&(o>n||r<i)}catch(e){return!1}}(t,n,a,he(),M.get().streaming.liveCatchup.playbackBufferMin,i):function(e,t,n,r){try{return Math.abs(e-t)>r&&(isNaN(n)||e<=n)}catch(e){return!1}}(t,n,i,a)}}catch(e){return!1}}()?function(){if(f){var e=void 0,t=f.getPlaybackRate(),n=M.get().streaming.liveCatchup.playbackRate,i=Y(),a=T.getLiveDelay(),o=he();pe()===r.default.LIVE_CATCHUP_MODE_LOLP?(M.get().streaming.liveCatchup.minDrift,e=function(e,t,n,r,i,a,o){var u=e,l=void 0;if(a<i){var c=5*(a-i);l=1-u+2*u/(1+Math.pow(Math.E,-c)),s.debug("[LoL+ playback control_buffer-based] bufferLevel: "+a+", newRate: "+l)}else{if(Math.abs(t-n)<=.02*n)l=1;else{var d=5*(t-n);l=1-u+2*u/(1+Math.pow(Math.E,-d))}s.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+l)}return R&&a>n/2&&(R=!1),Math.abs(o-l)<=C&&(l=null),{newRate:l}}(n,i,a,0,M.get().streaming.liveCatchup.playbackBufferMin,o,t)):e=function(e,t,n,r,i){var a=t-n,o=5*a,s=1-e+2*e/(1+Math.pow(Math.E,-o));return R&&(r>n/2?R=!1:a>0&&(s=1)),Math.abs(i-s)<=C&&(s=null),{newRate:s}}(n,i,a,o,t);var u=e.newRate;u&&f.setPlaybackRate(u);var l=i-a;M.get().streaming.liveCatchup.maxDrift>0&&!I&&l>M.get().streaming.liveCatchup.maxDrift?(s.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),I=!0,U(((d=c.getCurrentDVRInfo())?d.range:null).end-T.getLiveDelay(),!0,!1)):I=!1}var d}():ge())}function fe(){return M.get().streaming.liveCatchup.enabled||M.get().streaming.lowLatencyEnabled}function he(){var e=null;return l.getActiveStreamProcessors().forEach((function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)})),e}function pe(){var e=M.get().streaming.liveCatchup.playbackBufferMin;return M.get().streaming.liveCatchup.mode!==r.default.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?r.default.LIVE_CATCHUP_MODE_DEFAULT:r.default.LIVE_CATCHUP_MODE_LOLP}function ge(){f&&f.setPlaybackRate(1)}function me(e){if(!1===e.stream&&M.get().streaming.lowLatencyEnabled&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;if(t>T.getLiveDelay()){s.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2));var n={streaming:{liveDelay:t}};M.update(n)}}}function ve(e){e.streamId===y.id&&(fe()?e.state!==i.default.BUFFER_EMPTY||F()||R||(R=!0,ge()):f.setStallState(e.mediaType,e.state===i.default.BUFFER_EMPTY))}function ye(e){n.trigger(o.default.PLAYBACK_STALLED,{e:e})}function Ee(e){!function(e,t){if(e&&e.manifestInfo&&e.manifestInfo.serviceDescriptions){for(var n=void 0,i=0;i<e.manifestInfo.serviceDescriptions.length;i++){var a=e.manifestInfo.serviceDescriptions[i];if(a.schemeIdUri===r.default.SERVICE_DESCRIPTION_LL_SCHEME){n=a;break}}n&&t&&t.supplementalProperties&&"true"===t.supplementalProperties[r.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(n.latency&&n.latency.target>0&&(s.debug("Apply LL properties coming from service description. Target Latency (ms):",n.latency.target),M.update({streaming:{lowLatencyEnabled:!0,liveDelay:n.latency.target/1e3,liveCatchup:{minDrift:n.latency.max>n.latency.target?(n.latency.max-n.latency.target)/1e3:void 0}}})),n.playbackRate&&n.playbackRate.max>1&&(s.debug("Apply LL properties coming from service description. Max PlaybackRate:",n.playbackRate.max),M.update({streaming:{lowLatencyEnabled:!0,liveCatchup:{playbackRate:n.playbackRate.max-1}}})))}}(e.streamInfo,e.mediaInfo)}return e={initialize:function(e,t,r){y=e,f.addEventListener("canplay",J),f.addEventListener("play",Z),f.addEventListener("waiting",$),f.addEventListener("playing",ee),f.addEventListener("pause",te),f.addEventListener("error",ce),f.addEventListener("seeking",ne),f.addEventListener("seeked",re),f.addEventListener("timeupdate",ie),f.addEventListener("progress",ae),f.addEventListener("ratechange",oe),f.addEventListener("loadedmetadata",se),f.addEventListener("stalled",ye),f.addEventListener("ended",ue),E=y.manifestInfo.isDynamic,I=!1,R=!1,p=!0===t,g=r,w=!1;var i="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",s=/safari/.test(i)&&!/chrome/.test(i);C=s?.25:.02,n.on(o.default.STREAM_INITIALIZED,L,this),n.on(o.default.DATA_UPDATE_COMPLETED,Q,this),n.on(o.default.LOADING_PROGRESS,me,this),n.on(o.default.BUFFER_LEVEL_STATE_CHANGED,ve,this),n.on(o.default.PLAYBACK_PROGRESS,de,this),n.on(o.default.PLAYBACK_TIME_UPDATED,de,this),n.on(o.default.PLAYBACK_ENDED,le,this,{priority:a.default.EVENT_PRIORITY_HIGH}),n.on(o.default.STREAM_INITIALIZING,Ee,this),_&&(_=!1,O())},setConfig:function(e){e&&(e.streamController&&(l=e.streamController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(T=e.mediaPlayerModel),e.adapter&&(d=e.adapter),e.videoModel&&(f=e.videoModel),e.timelineConverter&&(h=e.timelineConverter),e.uriFragmentModel&&(D=e.uriFragmentModel),e.settings&&(M=e.settings))},getStartTimeFromUriParameters:q,getTimeToStreamEnd:N,getTime:B,getNormalizedTime:G,getPlaybackRate:j,getPlayedRanges:function(){return y&&f?f.getPlayedRanges():null},getEnded:H,getIsDynamic:K,getStreamController:function(){return l},computeAndSetLiveDelay:function(e,t,n){var r,i,a=void 0,o=!isNaN(e)&&isFinite(e)?e:NaN,s=d.getSuggestedPresentationDelay();if(i=M.get().streaming.lowLatencyEnabled?0:T.getLiveDelay()?T.getLiveDelay():null===M.get().streaming.liveDelayFragmentCount||isNaN(M.get().streaming.liveDelayFragmentCount)||isNaN(o)?!0===M.get().streaming.useSuggestedPresentationDelay&&null!==s&&!isNaN(s)&&s>0?s:isNaN(o)?isNaN(n)?4*y.manifestInfo.minBufferTime:4*n:4*o:o*M.get().streaming.liveDelayFragmentCount,null!==(r=d.getAvailabilityStartTime())&&(A=r),t>0){var u=Math.max(t-10,t/2);a=Math.min(i,u)}else a=i;return v=a,a},getLiveDelay:function(){return v},setLiveDelay:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&e<v||(v=e)},getCurrentLiveLatency:Y,play:O,isPaused:P,pause:k,isSeeking:F,getStreamEndTime:x,seek:U,updateCurrentTime:X,reset:V},s=(0,u.default)(t).getInstance().getLogger(e),V(),e}c.__dashjs_factory_name="PlaybackController",t.default=s.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INBAND_EVENTS="inbandEvents",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATE_STARTED="representationUpdateStarted",e.REPRESENTATION_UPDATE_COMPLETED="representationUpdateCompleted",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEGMENTBASE_INIT_REQUEST_NEEDED="segmentBaseInitRequestNeeded",e.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED="segmentBaseSegmentsListRequestNeeded",e.SEEK_TARGET="seekTarget",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(33))&&r.__esModule?r:{default:r}).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=_(n(1)),i=_(n(9)),a=_(n(105)),o=_(n(87)),s=_(n(3)),u=_(n(4)),l=_(n(0)),c=n(54),d=_(n(2)),f=_(n(51)),h=_(n(12)),p=_(n(20)),g=_(n(177)),m=_(n(178)),v=_(n(6)),y=_(n(10)),E=_(n(179)),T=_(n(76));function _(e){return e&&e.__esModule?e:{default:e}}function b(){var e=this.context,t=(0,s.default)(e).getInstance(),n=void 0,l=void 0,_=void 0,b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0,M=void 0,L=void 0,N=void 0,x=void 0,O=void 0,P=void 0,k=void 0,F=void 0,U=void 0,B=void 0,G=void 0,j=void 0,H=void 0,K=void 0,Y=void 0,V=void 0,q=void 0,W=void 0,z=void 0,X=void 0,Q=void 0,J=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0;function ae(){if(Ie()){var e=z.getPlaybackQuality();e&&R.addDroppedFrames(e)}}function oe(e){var t=pe(e.seekTime);t===G&&ne&&ne.length>0&&ne.forEach((function(e){e.deactivate(!0)})),t&&t!==G?(Ce(c.PlayListTrace.END_OF_PERIOD_STOP_REASON),ye(t,G,e.seekTime)):Ce(c.PlayListTrace.USER_REQUEST_STOP_REASON),De(c.PlayList.SEEK_START_REASON)}function se(e){var t=ve();Ce(c.PlayListTrace.END_OF_PERIOD_STOP_REASON),ye(t,G,e.seekTime),De(c.PlayList.SEEK_START_REASON)}function ue(){l.debug("[onPlaybackStarted]"),Z?(Z=!1,De(c.PlayList.INITIAL_PLAYOUT_START_REASON)):J&&(J=!1,De(c.PlayList.RESUME_FROM_PAUSE_START_REASON))}function le(e){l.debug("[onPlaybackPaused]"),e.ended||(J=!0,Ce(c.PlayListTrace.USER_REQUEST_STOP_REASON))}function ce(){$&&(clearInterval($),$=null)}function de(e){try{if(!e)return!1;var t=e.getProcessors().filter((function(e){return e.getType()===r.default.AUDIO||e.getType()===r.default.VIDEO}));if(!t||0===t.length)return!1;var n=t.filter((function(e){return!e.isBufferingCompleted()}));return n&&0===n.length}catch(e){return!1}}function fe(){var e=Le().isLast;W&&e&&(l.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),C.signalEndOfStream(W))}function he(e,t){try{return ie.get().streaming.reuseExistingSourceBuffers&&t.isProtectionCompatible(e,t)&&(re||t.isMediaCodecCompatible(e,t))&&!function(e){try{var t=e.getStreamInfo(),n=I.getAdaptationForType(t.index,r.default.FRAGMENTED_TEXT,t);return!!n&&(-1!==n.codecs.indexOf("stpp")||-1!==n.codecs.indexOf("wvtt"))}catch(e){return!1}}(e)}catch(e){return!1}}function pe(e){if(isNaN(e))return null;var t=0,n=null,r=B.length;r>0&&(t+=B[0].getStartTime());for(var i=0;i<r;i++)if(n=B[i],e<(t=parseFloat((t+n.getDuration()).toFixed(5))))return n;return null}function ge(){return G?G.getProcessors():[]}function me(e){if(!G.getIsEndedEventSignaled()){G.setIsEndedEventSignaled(!0);var t=ve();t?(l.debug("StreamController onEnded, found next stream with id "+t.getStreamInfo().id),ye(t,G,NaN)):(l.debug("StreamController no next stream found"),G.setIsEndedEventSignaled(!1)),Ce(t?c.PlayListTrace.END_OF_PERIOD_STOP_REASON:c.PlayListTrace.END_OF_CONTENT_STOP_REASON)}e&&e.isLast&&ce()}function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||G||null;if(t){for(var n=t.getStreamInfo().start,r=t.getStreamInfo().duration,i=parseFloat((n+r).toFixed(5)),a=0,o=-1,s=NaN;a<B.length;){var u=B[a],l=u.getStreamInfo().start-i;l>=0&&(isNaN(s)||l<s)&&(s=l,o=a),a+=1}return o>=0?B[o]:null}return null}function ye(e,n,r){if(!(Y||!e||n===e&&e.isActive())){Y=!0,t.trigger(u.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var i=!1;n&&(i=he(e,n),n.deactivate(i)),r=isNaN(r)?!i&&n?e.getStreamInfo().start:NaN:r,l.info("Switch to stream "+e.getId()+". Seektime is "+r+", current playback time is "+X.getTime()),l.info("Seamless period switch is set to "+i),G=e,ne=ne.filter((function(e){return e.getId()!==G.getId()})),X.initialize(Le(),!!n,r),z.getElement()?Ee(r,null===n,!1,i):Te(r,i)}}function Ee(e,n,r,i){var a=void 0;function o(){W&&"open"===W.readyState&&(l.debug("MediaSource is open!"),window.URL.revokeObjectURL(a),W.removeEventListener("sourceopen",o),W.removeEventListener("webkitsourceopen",o),_e(),n||t.trigger(u.default.SOURCE_INITIALIZED),r?G.setMediaSource(W):Te(e,i))}W?i?(Te(e,i),n||t.trigger(u.default.SOURCE_INITIALIZED)):(C.detachMediaSource(z),W.addEventListener("sourceopen",o,!1),W.addEventListener("webkitsourceopen",o,!1),a=C.attachMediaSource(W,z),l.debug("MediaSource attached to element.  Waiting on open...")):((W=C.createMediaSource()).addEventListener("sourceopen",o,!1),W.addEventListener("webkitsourceopen",o,!1),a=C.attachMediaSource(W,z),l.debug("MediaSource attached to element.  Waiting on open..."))}function Te(e,n){if(te=G.activate(W,n?te:void 0)){var r=Object.keys(te);r.length>0&&te[r[0]].changeType&&(re=!0)}Z||isNaN(e)||(e===X.getTime()?t.trigger(u.default.SEEK_TARGET,{time:e},{streamId:G.getId()}):X.seek(e)),!K&&Z||X.play(),Y=!1,t.trigger(u.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Le()})}function _e(e){var t=e||Le().manifestInfo.duration;C.setDuration(W,t)}function be(e){for(var t=0,n=B.length;t<n;t++)if(B[t].getId()===e.id)return B[t];return null}function Ae(){try{var n=I.getStreamsInfo();if(0===n.length)throw new Error("There are no streams");R.updateManifestUpdateInfo({currentTime:X.getTime(),buffered:z.getBufferRange(),presentationStartTime:n[0].start,clientTimeOffset:U.getClientTimeOffset()}),B.length>0&&(B=B.filter((function(e){var t=n.filter((function(t){return t.id===e.getId()})).length>0||e.getId()===G.getId();return t||l.debug("Removing stream "+e.getId()),t})));for(var i=0,o=n.length;i<o;i++){var s=n[i],c=be(s);c?c.updateData(s):(c=(0,a.default)(e).create({manifestModel:w,mediaPlayerModel:Q,dashMetrics:R,manifestUpdater:A,adapter:I,timelineConverter:U,capabilities:_,capabilitiesFilter:b,errHandler:F,baseURLController:M,abrController:L,playbackController:X,eventController:x,mediaController:N,textController:O,protectionController:j,videoModel:z,streamInfo:s,settings:ie}),B.push(c),c.initialize()),R.addManifestUpdateStreamInfo(s)}if(!G){if(I.getIsDynamic()&&B.length){var d=n[0].manifestInfo,f=function(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var i=e[0],a=[r.default.VIDEO,r.default.AUDIO,r.default.FRAGMENTED_TEXT].reduce((function(e,t){var n=I.getMediaInfoForType(i,t);return n&&e.push(n),e}),[]).reduce((function(e,t){var n=I.getVoRepresentations(t);return n&&n.length>0&&n.forEach((function(t){t&&e.push(t)})),e}),[]).reduce((function(e,t){var n=I.convertDataToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e}),[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a))}return isFinite(n)?n:NaN}catch(e){return NaN}}(n,d);X.computeAndSetLiveDelay(f,d.DVRWindowSize,d.minBufferTime)}var h=null;!(h=pe(X.getStartTimeFromUriParameters(I.getIsDynamic())))&&I.getIsDynamic()&&B.length&&(l.debug("Dynamic stream: Trying to find the correct starting period"),h=function(){try{return pe(U.calcPresentationTimeFromWallTime(new Date,I.getRegularPeriods()[0])-X.getLiveDelay())}catch(e){return null}}()),ye(null!==h?h:B[0],null,NaN),$||($=setInterval((function(){!Y&&X.getTimeToStreamEnd()<=0&&t.trigger(u.default.PLAYBACK_ENDED,{isLast:Le().isLast})}),200)),ee||(ee=setInterval((function(){!function(){if(G&&de(G))for(var e=function(e){try{var t=e||G||null;if(t){var n=t.getStreamInfo().start;return B.filter((function(e){return e.getStreamInfo().start>n}))}}catch(e){return[]}}(G),t=0,n=function(){var n=e[t],i=0===t?G:e[t-1];if(!n.getPreloadingScheduled()&&de(i)&&W){var a=[r.default.VIDEO,r.default.AUDIO],o=!0;a.forEach((function(e){var t=I.getMediaInfoForType(n.getStreamInfo(),e);I.getVoRepresentations(t).forEach((function(e){var t=I.getIsDynamic(),n=U.calcSegmentAvailabilityRange(e,t);n.end<n.start&&(o=!1)}))})),o&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(W&&!e.getPreloaded()){var n=he(e,t);n&&(e.setPreloadingScheduled(!0),l.info("[onStreamCanLoadNext] Preloading next stream with id "+e.getId()),e.preload(W,te),ne.push(e),e.getProcessors().forEach((function(t){t.setBufferingTime(e.getStartTime())})))}}(n,i)}t+=1};t<e.length;)n()}()}),500))}t.trigger(u.default.STREAMS_COMPOSED)}catch(e){F.error(new v.default(y.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",w.getValue())),q=!0,Pe()}}function Se(){var e=w.getValue();j&&(t.trigger(u.default.PROTECTION_CREATED,{controller:j,manifest:e}),j.setMediaElement(z.getElement()),H&&j.setProtectionData(H)),Ae()}function we(e){if(e.error)q=!0,Pe();else{var n=e.manifest;I.updatePeriods(n);var r=I.getUTCTimingSources();!I.getIsDynamic()||r&&0!==r.length||t.trigger(p.default.CONFORMANCE_VIOLATION,{level:T.default.LEVELS.WARNING,event:T.default.EVENTS.NO_UTC_TIMING_ELEMENT});var i=I.getIsDynamic()?r.concat(Q.getUTCTimingSources()):r,a=k.isHTTPS(e.manifest.url);i.forEach((function(e){e.value.replace(/.*?:\/\//g,"")===Q.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(a?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),a?"https://":"http://"),l.debug("Matching default timing source protocol to manifest protocol: ",e.value))})),M.initialize(n),D.attemptSync(i)}}function Ie(){return!!G&&G.getHasVideoTrack()}function Re(){return!!G&&G.getHasAudioTrack()}function Ce(e,t){t=t||new Date,ge().forEach((function(n){n.finalisePlayList(t,e)})),R.addPlayList()}function De(e){R.createPlaylistMetrics(1e3*X.getTime(),e)}function Me(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}V=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),l.fatal("Video Element Error: "+t),e.error&&l.fatal(e.error),F.error(new v.default(e.error.code,t)),Pe()}}function Le(){return G?G.getStreamInfo():null}function Ne(){if(!(S&&S.hasOwnProperty("load")&&U&&U.hasOwnProperty("initialize")&&U.hasOwnProperty("reset")&&U.hasOwnProperty("getClientTimeOffset")&&w&&F&&R&&X))throw new Error(r.default.MISSING_CONFIG_ERROR)}function xe(e){isNaN(e.newDuration)||_e(e.newDuration)}function Oe(){B=[],j=null,Y=!1,G=null,V=!1,q=!1,Z=!0,J=!1,K=!0,$=null,ee=null,ne=[]}function Pe(){Ne(),D.reset(),Ce(V||q?c.PlayListTrace.FAILURE_STOP_REASON:c.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,r=B?B.length:0;e<r;e++)B[e].reset(V);t.off(u.default.PLAYBACK_TIME_UPDATED,ae,n),t.off(u.default.PLAYBACK_SEEKING,oe,n),t.off(u.default.GAP_CAUSED_SEEK_TO_PERIOD_END,se,n),t.off(u.default.PLAYBACK_ERROR,Me,n),t.off(u.default.PLAYBACK_STARTED,ue,n),t.off(u.default.PLAYBACK_PAUSED,le,n),t.off(u.default.PLAYBACK_ENDED,me,n),t.off(u.default.MANIFEST_UPDATED,we,n),t.off(u.default.STREAM_BUFFERING_COMPLETED,fe,n),t.off(u.default.MANIFEST_VALIDITY_CHANGED,xe,n),t.off(u.default.TIME_SYNCHRONIZATION_COMPLETED,Se,n),t.off(p.default.METRIC_ADDED,ke,n),M.reset(),A.reset(),x.reset(),R.clearAllCurrentMetrics(),w.setValue(null),S.reset(),U.reset(),P.reset(),W&&(C.detachMediaSource(z),W=null),z=null,j&&(j.setMediaElement(null),j=null,H=null,w.getValue()&&t.trigger(u.default.PROTECTION_DESTROYED,{data:w.getValue().url})),ce(),clearInterval(ee),ee=null,t.trigger(u.default.STREAM_TEARDOWN_COMPLETE),Oe()}function ke(e){if(e.metric===i.default.DVR_INFO){var t=Re()?r.default.AUDIO:r.default.VIDEO;e.mediaType===t&&C.setSeekable(W,e.value.range.start,e.value.range.end)}}return n={initialize:function(r,i){Ne(),K=r,H=i,U.initialize(),(A=(0,o.default)(e).create()).setConfig({manifestModel:w,adapter:I,manifestLoader:S,errHandler:F,settings:ie}),A.initialize(),(x=(0,E.default)(e).getInstance()).setConfig({manifestUpdater:A,playbackController:X,settings:ie}),x.start(),D.setConfig({dashMetrics:R,baseURLController:M,settings:ie}),D.initialize(),t.on(u.default.PLAYBACK_TIME_UPDATED,ae,n),t.on(u.default.PLAYBACK_SEEKING,oe,n),t.on(u.default.GAP_CAUSED_SEEK_TO_PERIOD_END,se,n),t.on(u.default.PLAYBACK_ERROR,Me,n),t.on(u.default.PLAYBACK_STARTED,ue,n),t.on(u.default.PLAYBACK_PAUSED,le,n),t.on(u.default.PLAYBACK_ENDED,me,n,{priority:s.default.EVENT_PRIORITY_HIGH}),t.on(u.default.MANIFEST_UPDATED,we,n),t.on(u.default.STREAM_BUFFERING_COMPLETED,fe,n),t.on(u.default.MANIFEST_VALIDITY_CHANGED,xe,n),t.on(u.default.TIME_SYNCHRONIZATION_COMPLETED,Se,n),t.on(p.default.METRIC_ADDED,ke,n)},getActiveStreamInfo:Le,hasVideoTrack:Ie,hasAudioTrack:Re,switchToVideoElement:function(e){G&&(X.initialize(Le()),Ee(e,!1,!0,!1))},getStreamById:function(e){return B.filter((function(t){return t.getId()===e}))[0]},getStreamForTime:pe,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=0;o<B.length;o++){if(i=(n=B[o]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null},load:function(e){Ne(),S.load(e)},loadWithManifest:function(e){!function(){if(!A||!A.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),A.setManifest(e)},getActiveStreamProcessors:ge,setConfig:function(e){e&&(e.capabilities&&(_=e.capabilities),e.capabilitiesFilter&&(b=e.capabilitiesFilter),e.manifestLoader&&(S=e.manifestLoader),e.manifestModel&&(w=e.manifestModel),e.mediaPlayerModel&&(Q=e.mediaPlayerModel),e.protectionController&&(j=e.protectionController),e.adapter&&(I=e.adapter),e.dashMetrics&&(R=e.dashMetrics),e.errHandler&&(F=e.errHandler),e.timelineConverter&&(U=e.timelineConverter),e.videoModel&&(z=e.videoModel),e.playbackController&&(X=e.playbackController),e.abrController&&(L=e.abrController),e.mediaController&&(N=e.mediaController),e.textController&&(O=e.textController),e.settings&&(ie=e.settings),e.baseURLController&&(M=e.baseURLController))},setProtectionData:function(e){H=e},getIsStreamSwitchInProgress:function(){return Y},getHasMediaOrIntialisationError:function(){return V||q},hasStreamFinishedBuffering:de,getStreams:function(){return B},getActiveStream:function(){return G},reset:Pe},l=(0,d.default)(e).getInstance().getLogger(n),D=(0,g.default)(e).getInstance(),C=(0,m.default)(e).getInstance(),P=(0,f.default)(e).getInstance(),k=(0,h.default)(e).getInstance(),Oe(),n}b.__dashjs_factory_name="StreamController",t.default=l.default.getSingletonFactory(b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(n(1)),i=m(n(8)),a=m(n(106)),o=m(n(162)),s=m(n(175)),u=m(n(3)),l=m(n(4)),c=m(n(2)),d=m(n(10)),f=m(n(0)),h=m(n(6)),p=m(n(27)),g=m(n(12));function m(e){return e&&e.__esModule?e:{default:e}}function v(e){e=e||{};var t=this.context,n=(0,u.default)(t).getInstance(),f=(0,g.default)(t).getInstance(),m=e.manifestModel,v=e.mediaPlayerModel,y=e.manifestUpdater,E=e.adapter,T=e.capabilities,_=e.capabilitiesFilter,b=e.errHandler,A=e.timelineConverter,S=e.dashMetrics,w=e.abrController,I=e.playbackController,R=e.eventController,C=e.mediaController,D=e.textController,M=e.protectionController,L=e.videoModel,N=e.settings,x=e.streamInfo,O=void 0,P=void 0,k=void 0,F=void 0,U=void 0,B=void 0,G=void 0,j=void 0,H=void 0,K=void 0,Y=void 0,V=void 0,q=void 0,W=void 0,z=void 0,X=void 0,Q=void 0,J=void 0;function Z(e){for(var t=k?k.length:0,r=0;r<t;r++)k[r].getFragmentModel().removeExecutedRequestsBeforeTime(ne()+te()),k[r].reset(!1,e);k=[],U=!1,B=!1,be(!1),n.off(l.default.CURRENT_TRACK_CHANGED,le,O)}function $(){Z(),F=!1,G=!1,j=!1,H={},K=!1,z=!1,Q=!1}function ee(){I&&I.pause(),Y&&(Y.reset(),Y=null),x=null,$(),n.off(l.default.DATA_UPDATE_COMPLETED,ge,O),n.off(l.default.BUFFERING_COMPLETED,pe,O),n.off(l.default.INBAND_EVENTS,me,O),M&&(n.off(l.default.KEY_ERROR,se,O),n.off(l.default.SERVER_CERTIFICATE_UPDATED,se,O),n.off(l.default.LICENSE_REQUEST_COMPLETE,se,O),n.off(l.default.KEY_SYSTEM_SELECTED,se,O),n.off(l.default.KEY_SESSION_CREATED,se,O),n.off(l.default.KEY_STATUSES_CHANGED,se,O)),be(!1)}function te(){return x?x.duration:NaN}function ne(){return x?x.start:NaN}function re(){if(!x.manifestInfo.isDynamic)return NaN;for(var e=0;e<k.length;e++)if(k[e].getType()===r.default.AUDIO||k[e].getType()===r.default.VIDEO)return k[e].getLiveStartTime();return NaN}function ie(){return x?x.id:null}function ae(){return x}function oe(){if(!(L&&w&&w.hasOwnProperty("getBitrateList")&&E&&E.hasOwnProperty("getAllMediaInfoForType")&&E.hasOwnProperty("getEventsFor")))throw new Error(r.default.MISSING_CONFIG_ERROR)}function se(e){e.error&&(b.error(e.error),P.fatal(e.error.message),ee())}function ue(e){var t,n=e?e.type:null,i=void 0;if(n===r.default.MUXED)return i="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",P.fatal(i),b.error(new h.default(d.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,i,m.getValue())),!1;if(n===r.default.TEXT||n===r.default.FRAGMENTED_TEXT||n===r.default.EMBEDDED_TEXT||n===r.default.IMAGE)return!0;if(t=e.codec,P.debug(n+" codec: "+t),e.contentProtection&&!T.supportsEncryptedMedia())b.error(new h.default(d.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,d.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!T.supportsCodec(t))return i=n+"Codec ("+t+") is not supported.",P.error(i),!1;return!0}function le(e){if(x&&e.newMediaInfo.streamInfo.id===x.id){var t=e.newMediaInfo,n=m.getValue();E.setCurrentMediaInfo(x.id,t.type,t);var i=ve(t);if(i){var a=I.getTime();P.info("Stream -  Process track changed at current time "+a),P.debug("Stream -  Update stream controller"),n.refreshManifestOnSwitchTrack?(P.debug("Stream -  Refreshing manifest for switch track"),J=e,y.refreshManifest()):(i.selectMediaInfo(t),t.type!==r.default.FRAGMENTED_TEXT?(w.updateTopQualityIndex(t),i.switchTrackAsked(),i.getFragmentModel().abortRequests()):(i.getScheduleController().setSeekTarget(a),i.setBufferingTime(a),i.resetIndexHandler()))}}}function ce(o,u){var c,d=E.getAllMediaInfoForType(x,o),f=null;if(d&&0!==d.length){o===r.default.VIDEO&&(G=!0),o===r.default.AUDIO&&(j=!0);for(var h=0,p=d.length;h<p;h++)if(f=d[h],o===r.default.EMBEDDED_TEXT)D.addEmbeddedTrack(f);else{if(!ue(f))continue;C.addTrack(f)}o!==r.default.EMBEDDED_TEXT&&0!==C.getTracksFor(o,x).length&&(o!==r.default.IMAGE?(C.checkInitialMediaSettingsForType(o,x),c=C.getCurrentTrackFor(o,x),n.trigger(l.default.STREAM_INITIALIZING,{streamInfo:x,mediaInfo:f}),function(n,i,o,s){var u=Y.getModel(n?n.type:null),l=(0,a.default)(t).create({streamInfo:x,type:n?n.type:null,mimeType:n?n.mimeType:null,timelineConverter:A,adapter:E,manifestModel:m,mediaPlayerModel:v,fragmentModel:u,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,abrController:w,playbackController:I,mediaController:C,textController:D,errHandler:b,settings:N,boxParser:W});if(l.initialize(o,G),w.updateTopQualityIndex(n),k.push(l),!n||n.type!==r.default.TEXT&&n.type!==r.default.FRAGMENTED_TEXT)l.addMediaInfo(n,!0);else{for(var c=void 0,d=0;d<i.length;d++)i[d].index===n.index&&(c=d),l.addMediaInfo(i[d]);l.selectMediaInfo(i[c])}}(c,d,u)):V=(0,s.default)(t).create({streamInfo:x,adapter:E,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:X,eventBus:n,events:l.default,dashConstants:i.default}))}else P.info("No "+o+" data.")}function de(){if(R){var e=E.getEventsFor(x);R.addInlineEvents(e)}}function fe(){for(var e=k.length,t=H.audio||H.video?new h.default(d.default.DATA_UPDATE_FAILED_ERROR_CODE,d.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,i=0;i<e;i++)if(k[i].isUpdating()||K)return;if(B){if(M){M.clearMediaInfoArrayByStreamId(ie());for(var a=0;a<e&&k[a];a++){var o=k[a].getType();if(o===r.default.AUDIO||o===r.default.VIDEO||o===r.default.FRAGMENTED_TEXT){var s=k[a].getMediaInfo();s&&M.initializeForMedia(s)}}}t?b.error(t):F||(F=!0,n.trigger(l.default.STREAM_INITIALIZED,{streamInfo:x,liveStartTime:q?NaN:re()}));for(var u=0;u<e&&k[u];u++)k[u].getScheduleController().start()}}function he(e){for(var t={},n=0,r=k.length;n<r;n++){var i=k[n].createBuffer(e);i&&(t[k[n].getType()]=i.getBuffer())}return t}function pe(){var e=ye(),t=e.length;if(0!==t){for(var i=0;i<t;i++)if(!e[i].isBufferingCompleted()&&(e[i].getType()===r.default.AUDIO||e[i].getType()===r.default.VIDEO))return void P.warn("onBufferingCompleted - One streamProcessor has finished but",e[i].getType(),"one is not buffering completed");P.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),n.trigger(l.default.STREAM_BUFFERING_COMPLETED,{streamInfo:x})}else P.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function ge(e){H[e.mediaType]=e.error,fe()}function me(e){var t;t=e.events,R&&R.addInbandEvents(t)}function ve(e){return e?ye().filter((function(t){return t.getType()===e.type}))[0]:null}function ye(){for(var e=[],t=void 0,n=void 0,i=0;i<k.length;i++)(t=(n=k[i]).getType())!==r.default.AUDIO&&t!==r.default.VIDEO&&t!==r.default.FRAGMENTED_TEXT&&t!==r.default.TEXT||e.push(n);return e}function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return!1;var r=e.getStreamInfo(),i=n?n.getStreamInfo():ae();if(!r||!i)return!1;var a=E.getAdaptationForType(r.index,t,r),o=E.getAdaptationForType(i.index,t,i);return a&&o?!(!Te(o)&&Te(a)):!a&&!o}function Te(e){return!!e&&!!(e.ContentProtection||e.Representation&&e.Representation.length>0&&e.Representation[0].ContentProtection)}function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var r=e.getStreamInfo(),i=n?n.getStreamInfo():ae();if(!r||!i)return!1;var a=E.getAdaptationForType(r.index,t,r),o=E.getAdaptationForType(i.index,t,i);if(!a||!o)return!a&&!o;var s=a&&o&&a.mimeType===o.mimeType,u=o.Representation_asArray.map((function(e){return e.codecs})),l=a.Representation_asArray.map((function(e){return e.codecs})),c=l.some((function(e){return u.indexOf(e)>-1})),d=l.some((function(e){return u.some((function(t){return T.codecRootCompatibleWithCodec(t,e)}))}));return c||d&&s}function be(e){q=e}function Ae(){return q}return O={initialize:function(){n.on(l.default.BUFFERING_COMPLETED,pe,O),n.on(l.default.DATA_UPDATE_COMPLETED,ge,O),n.on(l.default.INBAND_EVENTS,me,O),M&&(n.on(l.default.KEY_ERROR,se,O),n.on(l.default.SERVER_CERTIFICATE_UPDATED,se,O),n.on(l.default.LICENSE_REQUEST_COMPLETE,se,O),n.on(l.default.KEY_SYSTEM_SELECTED,se,O),n.on(l.default.KEY_SESSION_CREATED,se,O),n.on(l.default.KEY_STATUSES_CHANGED,se,O)),n.trigger(l.default.STREAM_UPDATED,{streamInfo:x})},getStreamId:function(){return x?x.id:null},activate:function(e,t){if(!U){var i=void 0;return n.on(l.default.CURRENT_TRACK_CHANGED,le,O),Ae()?(function(){if(K=!0,oe(),_.filterUnsupportedFeaturesOfPeriod(x),B=!0,K=!1,0===k.length){var e="No streams to play.";b.error(new h.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e,m.getValue())),P.debug(e)}else fe()}(),i=t):i=function(e,t){oe();var n=L.getElement();de(),K=!0,_.filterUnsupportedFeaturesOfPeriod(x),(!n||n&&/^VIDEO$/i.test(n.nodeName))&&ce(r.default.VIDEO,e),ce(r.default.AUDIO,e),ce(r.default.TEXT,e),ce(r.default.FRAGMENTED_TEXT,e),ce(r.default.EMBEDDED_TEXT,e),ce(r.default.MUXED,e),ce(r.default.IMAGE,e);var i=he(t);if(B=!0,K=!1,0===k.length){var a="No streams to play.";b.error(new h.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,m.getValue())),P.fatal(a)}else fe();return i}(e,t),U=!0,i}return t},deactivate:Z,isActive:function(){return U},getDuration:te,getStartTime:ne,getId:ie,getStreamInfo:ae,getHasAudioTrack:function(){return j},getHasVideoTrack:function(){return G},preload:function(e,t){if(!Ae()){de(),ce(r.default.VIDEO,e),ce(r.default.AUDIO,e),ce(r.default.TEXT,e),ce(r.default.FRAGMENTED_TEXT,e),ce(r.default.EMBEDDED_TEXT,e),ce(r.default.MUXED,e),ce(r.default.IMAGE,e),he(t),n.on(l.default.CURRENT_TRACK_CHANGED,le,O);for(var i=0;i<k.length&&k[i];i++)k[i].getScheduleController().start();be(!0)}},getThumbnailController:function(){return V},getBitrateListFor:function(e){if(oe(),e===r.default.IMAGE)return V?V.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<k.length;n++)if((t=k[n]).getType()===e)return t.getMediaInfo();return null}(e);return w.getBitrateList(t)},updateData:function(e){P.info("Manifest updated... updating data system wide."),U=!1,K=!0,x=e,n.trigger(l.default.STREAM_UPDATED,{streamInfo:x}),R&&de(),_.filterUnsupportedFeaturesOfPeriod(x);for(var t=0,i=k.length;t<i;t++){var a=k[t];a.updateStreamInfo(x);var o=E.getMediaInfoForType(x,a.getType());o&&(w.updateTopQualityIndex(o),a.addMediaInfo(o,!0))}if(J&&J.newMediaInfo.type!==r.default.FRAGMENTED_TEXT){var s=ve(J.oldMediaInfo);if(!s)return;s.switchTrackAsked(),J=void 0}K=!1,fe()},reset:ee,getProcessors:ye,setMediaSource:function(e){for(var t=0;t<k.length;)ue(k[t].getMediaInfo())?(k[t].setMediaSource(e),t++):(k[t].reset(),k.splice(t,1));for(var n=0;n<k.length;n++)k[n].dischargePreBuffer();if(0===k.length){var r="No streams to play.";b.error(new h.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,r+"nostreams",m.getValue())),P.fatal(r)}},isMediaCodecCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _e(e,r.default.VIDEO,t)&&_e(e,r.default.AUDIO,t)},isProtectionCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ee(e,r.default.VIDEO,t)&&Ee(e,r.default.AUDIO,t)},getPreloaded:Ae,getPreloadingScheduled:function(){return z},setPreloadingScheduled:function(e){z=e},getIsEndedEventSignaled:function(){return Q},setIsEndedEventSignaled:function(e){Q=e}},X=(0,c.default)(t).getInstance(),P=X.getLogger(O),$(),W=(0,p.default)(t).getInstance(),Y=(0,o.default)(t).create({streamInfo:x,mediaPlayerModel:v,dashMetrics:S,errHandler:b,settings:N,boxParser:W,dashConstants:i.default,urlUtils:f}),O}v.__dashjs_factory_name="Stream",t.default=f.default.getClassFactory(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=w(n(1)),i=w(n(8)),a=w(n(9)),o=w(n(26)),s=w(n(66)),u=w(n(150)),l=w(n(152)),c=w(n(154)),d=w(n(155)),f=w(n(0)),h=n(14),p=w(n(3)),g=w(n(4)),m=w(n(80)),v=w(n(10)),y=w(n(6)),E=w(n(2)),T=w(n(53)),_=w(n(12)),b=w(n(27)),A=w(n(15)),S=n(54);function w(e){return e&&e.__esModule?e:{default:e}}function I(e){e=e||{};var t=this.context,n=(0,p.default)(t).getInstance(),f=e.streamInfo,w=e.type,I=e.errHandler,R=e.mimeType,C=e.timelineConverter,D=e.adapter,M=e.manifestModel,L=e.mediaPlayerModel,N=e.fragmentModel,x=e.abrController,O=e.playbackController,P=e.mediaController,k=e.textController,F=e.dashMetrics,U=e.settings,B=e.boxParser,G=void 0,j=void 0,H=void 0,K=void 0,Y=void 0,V=void 0,q=void 0,W=void 0,z=void 0,X=void 0,Q=void 0,J=void 0;function Z(){return w}function $(){Y=[],K=null,Q=0}function ee(e){e.error||q.setCurrentRepresentation(D.convertDataToRepresentationInfo(e.currentRepresentation)),e.error&&e.error.code!==v.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE||O.getStreamController().getActiveStreamInfo().id===f.id&&ae()}function te(e){var t=le(e.newQuality);q.setCurrentRepresentation(t),F.pushPlayListTraceMetrics(new Date,S.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),F.createPlaylistTraceMetrics(t.id,1e3*O.getTime(),O.getPlaybackRate())}function ne(e){F.addBufferLevel(w,new Date,1e3*e.bufferLevel);var t=O.getStreamController().getActiveStreamInfo().id;M.getValue().doNotUpdateDVRWindowOnBufferUpdated||f.id!==t||ae()}function re(e){F.addBufferState(w,e.state,q.getBufferTarget()),e.state!==a.default.BUFFER_EMPTY||O.isSeeking()||F.pushPlayListTraceMetrics(new Date,S.PlayListTrace.REBUFFERING_REASON)}function ie(e){N.syncExecutedRequestsWithBufferedRange(V.getBuffer().getAllBufferRanges(),f.duration),e.from>O.getTime()&&(Q=e.from,J=!0)}function ae(){var e=f.manifestInfo,t=e.isDynamic,n=C.calcSegmentAvailabilityRange(W.getCurrentRepresentation(),t);F.addDVRInfo(Z(),O.getTime(),e,n)}function oe(){return V?V.getBuffer():null}function se(){return Y}function ue(){return K}function le(e){var t=void 0;return void 0!==e?((0,h.checkInteger)(e),t=W?W.getRepresentationForQuality(e):null):t=W?W.getCurrentRepresentation():null,D.convertDataToRepresentationInfo(t)}function ce(e){if(e.sender&&(!D.getIsTextTrack(R)||k.isTextEnabled())&&V&&e.representationId&&!V.appendInitSegment(e.representationId)){var t=X?X.getInitRequest(ue(),W.getCurrentRepresentation()):null;q.processInitRequest(t)}}function de(e){var t=void 0;V.getIsPruningInProgress()||(t=function(e,t){var n=le(),i=!isNaN(e),a=O.getNormalizedTime(),o=i?e:Q,s=!1,u=void 0;if(isNaN(o)||Z()===r.default.FRAGMENTED_TEXT&&!k.isTextEnabled())return null;if(V){var l=V.getRangeAt(o),c=V.getRangeAt(a);null===l&&null===c||i||(!l||c&&c.start!=l.start&&c.end!=l.end)&&V.getBuffer().hasDiscontinuitiesAfter(a)&&Z()!==r.default.FRAGMENTED_TEXT&&(N.removeExecutedRequestsAfterTime(c.end),s=!0)}if(t)u=pe(n,o=t.startTime+t.duration/2,{timeThreshold:0,ignoreIsFinished:!0});else{var d=i||J||s;for(u=pe(n,d?o:void 0,{keepIdx:!d}),J=!1;u&&u.action!==A.default.ACTION_COMPLETE&&N.isFragmentLoaded(u);)u=pe(n)}return u}(e.seekTarget,e.replacement))&&(q.setSeekTarget(NaN),e.replacement||(isNaN(t.startTime+t.duration)||(Q=t.startTime+t.duration),t.delayLoadingTime=(new Date).getTime()+q.getTimeToLoadDelay(),q.setTimeToLoadDelay(0))),q.processMediaRequest(t)}function fe(e){var r=e.chunk,i=r.bytes,a=r.quality,s=le(a),u=W&&s?W.getRepresentationForQuality(s.quality):null,l=D.getEventsFor(s.mediaInfo),c=D.getEventsFor(s,u);if(l&&l.length>0||c&&c.length>0){var d=function(e,n,r,i){try{for(var a={},o=[],s=r.concat(i),u=0,l=s.length;u<l;u++)a[s[u].schemeIdUri+"/"+s[u].value]=s[u];var c=(0,b.default)(t).getInstance().parse(e),d=c.getBoxes("emsg");if(!d||0===d.length)return o;for(var f=c.getBox("sidx"),h=!f||isNaN(f.earliest_presentation_time)||isNaN(f.timescale)?n&&!isNaN(n.mediaStartTime)?n.mediaStartTime:0:f.earliest_presentation_time/f.timescale,p=Math.max(h,0),g=W.getCurrentRepresentation(),m=0,v=d.length;m<v;m++){var y=D.getEvent(d[m],a,p,g);y&&o.push(y)}return o}catch(e){return[]}}(i,N.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,quality:a,index:r.index})[0],l,c);n.trigger(g.default.INBAND_EVENTS,{events:d},{streamId:f.id})}}function he(e){Q=e.time,q.setSeekTarget(e.time)}function pe(e,t,n){var r=null;if(X){var i=W&&e?W.getRepresentationForQuality(e.quality):null;r=void 0!==t&&void 0!==n?X.getSegmentRequestForTime(ue(),i,t,n):X.getNextSegmentRequest(ue(),i)}return r}return G={initialize:function(a,o){X=(0,m.default)(t).create({streamInfo:f,type:w,timelineConverter:C,dashMetrics:F,mediaPlayerModel:L,baseURLController:e.baseURLController,errHandler:I,settings:U,boxParser:B,events:g.default,eventBus:n,errors:v.default,debug:(0,E.default)(t).getInstance(),requestModifier:(0,T.default)(t).getInstance(),dashConstants:i.default,constants:r.default,urlUtils:(0,_.default)(t).getInstance()}),(H=f.manifestInfo.isDynamic)&&(z=(0,d.default)(t).create({timelineConverter:C})),X.initialize(H),x.registerStreamType(w,G),W=(0,c.default)(t).create({streamInfo:f,type:w,abrController:x,dashMetrics:F,playbackController:O,timelineConverter:C,dashConstants:i.default,events:g.default,eventBus:n,errors:v.default}),(V=function(e){return e?e===r.default.VIDEO||e===r.default.AUDIO?(0,s.default)(t).create({streamInfo:f,type:e,mediaPlayerModel:L,manifestModel:M,fragmentModel:N,errHandler:I,mediaController:P,representationController:W,adapter:D,textController:k,abrController:x,playbackController:O,settings:U}):(0,u.default)(t).create({streamInfo:f,type:e,mimeType:R,mediaPlayerModel:L,manifestModel:M,fragmentModel:N,errHandler:I,mediaController:P,representationController:W,adapter:D,textController:k,abrController:x,playbackController:O,settings:U}):(I.error(new y.default(v.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,v.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}(w))&&V.initialize(a),(q=(0,l.default)(t).create({streamInfo:f,type:w,mimeType:R,adapter:D,dashMetrics:F,mediaPlayerModel:L,fragmentModel:N,abrController:x,playbackController:O,textController:k,mediaController:P,bufferController:V,settings:U})).initialize(o),Q=0,J=!1},getStreamId:function(){return f.id},getType:Z,isUpdating:function(){return!!W&&W.isUpdating()},getBufferController:function(){return V},getFragmentModel:function(){return N},getScheduleController:function(){return q},getRepresentationController:function(){return W},getRepresentationInfo:le,getBufferLevel:function(){return V?V.getBufferLevel():0},isBufferingCompleted:function(){return!!V&&V.getIsBufferingCompleted()},createBuffer:function(e){return oe()||V?V.createBuffer(Y,e):null},updateStreamInfo:function(e){f=e,U.get().streaming.useAppendWindow&&V.updateAppendWindow()},getStreamInfo:function(){return f},selectMediaInfo:function(e){e===K||e&&K&&e.type!==K.type||(K=e);var t=D.getRealAdaptation(f,K),n=D.getVoRepresentations(K);if(W){var i=W.getData(),a=x.getTopQualityIndexFor(w,f.id),o=x.getMinAllowedIndexFor(w),s=void 0,u=null;null!==i&&i.id==t.id||w===r.default.FRAGMENTED_TEXT?s=x.getQualityFor(w):(u=x.getThroughputHistory().getAverageThroughput(w)||x.getInitialBitrateFor(w),s=x.getQualityForBitrate(K,u)),void 0!==o&&s<o&&(s=o),s>a&&(s=a),X.setMimeType(K?K.mimeType:null),W.updateData(t,n,w,s)}},addMediaInfo:function(e,t){-1===Y.indexOf(e)&&Y.push(e),t&&this.selectMediaInfo(e)},getLiveStartTime:function(){if(!H)return NaN;if(!z)return NaN;var e=NaN,t=le(),n=z.getLiveEdge(t);if(isNaN(n))return NaN;var r=function(e,t){try{var n=null,r=O.getLiveDelay(),i=isNaN(f.manifestInfo.DVRWindowSize)?r:f.manifestInfo.DVRWindowSize,a=.1*i,o=void 0;if(!isFinite(i)||pe(t,e-i+a,{ignoreIsFinished:!0}))for(;!n&&r<=i;)(n=pe(t,o=e-r,{ignoreIsFinished:!0}))||(r+=1);return n&&O.setLiveDelay(r,!0),j.debug("live edge: "+e+", live delay: "+r+", live target: "+o),n}catch(e){return null}}(n,t);return r&&(e=U.get().streaming.lowLatencyEnabled?r.duration<L.getLiveDelay()?r.startTime:r.startTime+r.duration-L.getLiveDelay():r.startTime),e},switchTrackAsked:function(){q.switchTrackAsked()},getMediaInfoArr:se,getMediaInfo:ue,getMediaSource:function(){return V.getMediaSource()},setMediaSource:function(e){V.setMediaSource(e,se())},dischargePreBuffer:function(){V.dischargePreBuffer()},getBuffer:oe,setBuffer:function(e){V.setBuffer(e)},setBufferingTime:function(e){Q=e},resetIndexHandler:function(){X&&X.resetIndex()},getInitRequest:function(e){(0,h.checkInteger)(e);var t=W?W.getRepresentationForQuality(e):null;return X?X.getInitRequest(ue(),t):null},getFragmentRequest:pe,finalisePlayList:function(e,t){F.pushPlayListTraceMetrics(e,t)},probeNextRequest:function(){var e=le(),t=W&&e?W.getRepresentationForQuality(e.quality):null;return X.getNextSegmentRequestIdempotent(ue(),t)},reset:function(e,t){X&&X.reset(),V&&(V.reset(e,t),V=null),q&&(q.reset(),q=null),W&&(W.reset(),W=null),z&&(z.reset(),z=null),x&&!t&&x.unRegisterStreamType(w),n.off(g.default.DATA_UPDATE_COMPLETED,ee,G),n.off(g.default.QUALITY_CHANGE_REQUESTED,te,G),n.off(g.default.INIT_FRAGMENT_NEEDED,ce,G),n.off(g.default.MEDIA_FRAGMENT_NEEDED,de,G),n.off(g.default.MEDIA_FRAGMENT_LOADED,fe,G),n.off(g.default.BUFFER_LEVEL_UPDATED,ne,G),n.off(g.default.BUFFER_LEVEL_STATE_CHANGED,re,G),n.off(g.default.BUFFER_CLEARED,ie,G),n.off(g.default.SEEK_TARGET,he,G),$(),w=null,f=null}},j=(0,E.default)(t).getInstance().getLogger(G),$(),n.on(g.default.DATA_UPDATE_COMPLETED,ee,G,{priority:p.default.EVENT_PRIORITY_HIGH}),n.on(g.default.QUALITY_CHANGE_REQUESTED,te,G),n.on(g.default.INIT_FRAGMENT_NEEDED,ce,G),n.on(g.default.MEDIA_FRAGMENT_NEEDED,de,G),n.on(g.default.MEDIA_FRAGMENT_LOADED,fe,G),n.on(g.default.BUFFER_LEVEL_UPDATED,ne,G),n.on(g.default.BUFFER_LEVEL_STATE_CHANGED,re,G),n.on(g.default.BUFFER_CLEARED,ie,G),n.on(g.default.QUOTA_EXCEEDED,(function(e){Q=e.quotaExceededTime,J=!0}),G),n.on(g.default.SEEK_TARGET,he,G),G}I.__dashjs_factory_name="StreamProcessor",t.default=f.default.getClassFactory(I)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(1)),i=n(7),a=y(n(108)),o=y(n(27)),s=y(n(68)),u=y(n(0)),l=y(n(2)),c=y(n(44)),d=y(n(130)),f=y(n(43)),h=y(n(65)),p=y(n(3)),g=y(n(4)),m=y(n(6)),v=y(n(10));function y(e){return e&&e.__esModule?e:{default:e}}function E(){var e=this.context,t=(0,p.default)(e).getInstance(),n=!1,u=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0,M=void 0,L=void 0,N=void 0,x=void 0,O=void 0,P=void 0,k=void 0,F=void 0,U=void 0,B=void 0,G=void 0,j=void 0,H=void 0;function K(){D=null,L=NaN,N=[],P=null,M=!1}function Y(){K(),R=[],S=null}function V(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&X(t.bytes,t)}function q(){F=[],(C=(0,c.default)(e).getInstance()).setConfig({videoModel:x}),C.initialize(),E=(0,o.default)(e).getInstance(),k=null,U=0,G=[],B=null,n=!0,j=(0,d.default)(e).getInstance();var r=O.getActiveStreamProcessors();for(var i in r)if("video"===r[i].getType()){H=r[i].getRepresentationInfo().MSETimeOffset;break}t.on(g.default.VIDEO_CHUNK_RECEIVED,V,this),t.on(g.default.BUFFER_CLEARED,J,this)}function W(e){k=e}function z(e,t){var n,i,o=new a.default,s={subtitle:"subtitles",caption:"captions"};o.captionData=e,o.lang=t.lang,o.labels=t.labels,o.id=t.id?t.id:t.index,o.index=t.index,o.isTTML=(n=!1,t.codec&&t.codec.search(r.default.STPP)>=0&&(n=!0),t.mimeType&&t.mimeType.search(r.default.TTML)>=0&&(n=!0),n),o.defaultTrack=function(e){var t=!1;return F.length>1&&e.isEmbedded?t=e.id&&e.id===r.default.CC1:1===F.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===F.length&&(t=e.index===R[0].index),t}(t),o.isFragmented=!_.getIsTextTrack(t.mimeType),o.isEmbedded=!!t.isEmbedded,o.kind=i=(i=t.roles.length>0?s[t.roles[0]]:s.caption)===s.caption||i===s.subtitle?i:s.caption,o.roles=t.roles,o.accessibility=t.accessibility;var u=(R?R.length:0)+F.length;C.addTextTrack(o,u)}function X(e,t){var n=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=t.mediaInfo,p=d.type,g=d.mimeType,_=d.codec||g;if(_){if(p===r.default.FRAGMENTED_TEXT)if(M||"InitializationSegment"!==t.segmentType){if(!M)return;if(a=(l=E.getSamplesInfo(e)).sampleList,null===P&&a.length>0&&(P=a[0].cts-t.start*L),_.search(r.default.STPP)>=0)for(S=null!==S?S:Q(_),o=0;o<a.length;o++){var A=a[o],w=A.cts,I=w-P;this.buffered.add(I/L,(I+A.duration)/L);var R=new DataView(e,A.offset,A.subSizes[0]);c=f.default.Utils.dataViewToString(R,r.default.UTF8);var N=[],O=A.offset+A.subSizes[0];for(s=1;s<A.subSizes.length;s++){var K=new Uint8Array(e,O,A.subSizes[s]),Y=String.fromCharCode.apply(null,K);N.push(Y),O+=A.subSizes[s]}try{var V=b.getValue().ttmlTimeIsRelative?w/L:0;n=S.parse(c,V,w/L,(w+A.duration)/L,N),C.addCaptions(k,P/L,n)}catch(e){D.removeExecutedRequestsBeforeTime(),this.remove(),y.error("TTML parser error: "+e.message)}}else{var q=[];for(o=0;o<a.length;o++){var W=a[o];W.cts-=P,this.buffered.add(W.cts/L,(W.cts+W.duration)/L);var X=e.slice(W.offset,W.offset+W.size),J=f.default.parseBuffer(X);for(s=0;s<J.boxes.length;s++){var Z=J.boxes[s];if(y.debug("VTT box1: "+Z.type),"vtte"!==Z.type&&"vttc"===Z.type)for(y.debug("VTT vttc boxes.length = "+Z.boxes.length),u=0;u<Z.boxes.length;u++){var $=Z.boxes[u];if(y.debug("VTT box2: "+$.type),"payl"===$.type){var ee=$.cue_text;y.debug("VTT cue_text = "+ee);var te=W.cts/L,ne=(W.cts+W.duration)/L;q.push({start:te,end:ne,data:ee,styles:{}}),y.debug("VTT "+te+"-"+ne+" : "+ee)}}}}q.length>0&&C.addCaptions(k,0,q)}}else M=!0,L=E.getMediaTimescaleFromMoov(e);else if(p===r.default.TEXT){var re=new DataView(e,0,e.byteLength);c=f.default.Utils.dataViewToString(re,r.default.UTF8);try{n=Q(_).parse(c,0),C.addCaptions(C.getCurrentTrackIdx(),0,n)}catch(e){T.error(new m.default(v.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,v.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,c))}}else if(p===r.default.VIDEO)if(t.segmentType===i.HTTPRequest.INIT_SEGMENT_TYPE){if(0===U)for(U=E.getMediaTimescaleFromMoov(e),o=0;o<F.length;o++)z(null,F[o])}else{if(0===U)return void y.warn("CEA-608: No timescale for embeddedTextTrack yet");var ie=function(e,t){return function(e,n,r){var i;(i=x.getTTMLRenderingDiv()?j.createHTMLCaptionsFromScreen(x.getElement(),e,n,r):[{start:e,end:n,data:r.getDisplayText(),styles:{}}])&&C.addCaptions(t,0,i)}},ae=(l=E.getSamplesInfo(e)).lastSequenceNumber;if(!G[0]&&!G[1]){var oe=void 0,se=void 0;for(o=0;o<F.length;o++){if(F[o].id===r.default.CC1?se=C.getTrackIdxForId(r.default.CC1):F[o].id===r.default.CC3&&(se=C.getTrackIdxForId(r.default.CC3)),-1===se)return void y.warn("CEA-608: data before track is ready.");oe=ie(0,se),G[o]=new h.default.Cea608Parser(o+1,{newCue:oe},null)}}if(U){if(null!==B&&ae!==B+l.numSequences)for(o=0;o<G.length;o++)G[o]&&G[o].reset();for(var ue=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=h.default.findCea608Nalus(r,a.offset,a.size),s=null,u=0,l=0;l<o.length;l++)for(var c=h.default.extractCea608DataFromRange(r,o[l]),d=0;d<2;d++)c[d].length>0&&(a.cts!==s?u=0:u+=1,n.fields[d].push([a.cts+H*U,c[d],u]),s=a.cts);return n.fields.forEach((function(e){e.sort((function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]}))})),n}(e,l.sampleList),le=0;le<G.length;le++){var ce=ue.fields[le],de=G[le];if(de)for(o=0;o<ce.length;o++)de.addData(ce[o][0]/U,ce[o][1])}B=ae}}}else y.error("No text type defined")}function Q(e){var t=void 0;return e.search(r.default.VTT)>=0?t=w:(e.search(r.default.TTML)>=0||e.search(r.default.STPP)>=0)&&(t=I),t}function J(e){F.forEach((function(t){var n=C.getTrackIdxForId(t.id);n>=0&&C.deleteCuesFromTrackIdx(n,e.from,e.to)}))}return u={initialize:function(t,i,a,l){n||q(),C.setConfig({videoModel:x}),C.initialize(),E||(E=(0,o.default)(e).getInstance()),function(t,n,i,a){var o=!_.getIsTextTrack(t);if(R=R.concat(i),o){D=a,u.buffered=(0,s.default)(e).create(),N=A.getTracksFor(r.default.FRAGMENTED_TEXT,n);for(var l=A.getCurrentTrackFor(r.default.FRAGMENTED_TEXT,n),c=0;c<N.length;c++)if(N[c]===l){W(c);break}}for(var d=0;d<R.length;d++)z(null,R[d])}(t,i,a,l)},append:X,abort:function(){C.deleteAllTextTracks(),K(),E=null,R=[]},addEmbeddedTrack:function(e){if(n||q(),e)if(e.id===r.default.CC1||e.id===r.default.CC3){for(var t=0;t<F.length;t++)if(F[t].id===e.id)return;F.push(e)}else y.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(g.default.VIDEO_CHUNK_RECEIVED,V,this),t.off(g.default.BUFFER_CLEARED,J,this),C&&C.deleteAllTextTracks(),n=!1,F=[],G=[null,null],B=null},setConfig:function(e){e&&(e.errHandler&&(T=e.errHandler),e.adapter&&(_=e.adapter),e.manifestModel&&(b=e.manifestModel),e.mediaController&&(A=e.mediaController),e.videoModel&&(x=e.videoModel),e.streamController&&(O=e.streamController),e.textTracks&&(C=e.textTracks),e.vttParser&&(w=e.vttParser),e.ttmlParser&&(I=e.ttmlParser))},getConfig:function(){return{fragmentModel:D,fragmentedTracks:N,videoModel:x}},setCurrentFragmentedTrackIdx:W,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)},reset:function(){Y(),O=null,x=null,C=null}},y=(0,l.default)(e).getInstance().getLogger(u),Y(),u}E.__dashjs_factory_name="TextSourceBuffer",t.default=u.default.getSingletonFactory(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(110)),i=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;function t(t){var r=[];if(!t||!e||"function"!=typeof e.fetchAll)return r;for(var i=e.fetchAll(t),a=void 0,o=0,s=i.length;o<s;o++)(a=n(i[o]))&&r.push(a);return r}function n(e){if(!e)return null;var t=new r.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}o.__dashjs_factory_name="IsoFile",t.default=i.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var r=0;r<t.references.length;r++){var i={reference_type:t.references[r].reference_type,referenced_size:t.references[r].referenced_size,subsegment_duration:t.references[r].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}}}return r(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r}},function(e,t,n){!function(e,t,n,r){e.generateISD=function(e,t,n){var r=new o(e),i={};for(var s in e.head.layout.regions){var u=a(e,t,e.head.layout.regions[s],e.body,null,"",e.head.layout.regions[s],n,i);null!==u&&r.contents.push(u.element)}return r};var i=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function a(e,t,o,l,c,d,f,h,p){if(t<f.begin||t>=f.end)return null;var g="regionID"in f&&""!==f.regionID?f.regionID:d;if(null!==c&&g!==o.id&&(!("contents"in f)||"contents"in f&&0===f.contents.length||""!==g))return null;var m=new s(f);for(var v in f.sets)t<f.sets[v].begin||t>=f.sets[v].end||(m.styleAttrs[f.sets[v].qname]=f.sets[v].value);var y,E={};for(var T in m.styleAttrs)if(E[T]=!0,T===n.byName.writingMode.qname&&!(n.byName.direction.qname in m.styleAttrs)){var _=m.styleAttrs[T];"lrtb"===_||"lr"===_?m.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==_&&"rl"!==_||(m.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==c)for(var b in n.all){var A=n.all[b];if(A.qname===n.byName.textDecoration.qname){var S=c.styleAttrs[A.qname],w=m.styleAttrs[A.qname],I=[];void 0===w?I=S:-1===w.indexOf("none")?((-1===w.indexOf("noUnderline")&&-1!==S.indexOf("underline")||-1!==w.indexOf("underline"))&&I.push("underline"),(-1===w.indexOf("noLineThrough")&&-1!==S.indexOf("lineThrough")||-1!==w.indexOf("lineThrough"))&&I.push("lineThrough"),(-1===w.indexOf("noOverline")&&-1!==S.indexOf("overline")||-1!==w.indexOf("overline"))&&I.push("overline")):I.push("none"),m.styleAttrs[A.qname]=I}else if(A.qname!==n.byName.fontSize.qname||A.qname in m.styleAttrs||"span"!==m.kind||"textContainer"!==m.styleAttrs[n.byName.ruby.qname])if(A.qname!==n.byName.fontSize.qname||A.qname in m.styleAttrs||"span"!==m.kind||"text"!==m.styleAttrs[n.byName.ruby.qname])A.inherit&&A.qname in c.styleAttrs&&!(A.qname in m.styleAttrs)&&(m.styleAttrs[A.qname]=c.styleAttrs[A.qname]);else{var R=c.styleAttrs[n.byName.fontSize.qname];"textContainer"===c.styleAttrs[n.byName.ruby.qname]?m.styleAttrs[A.qname]=R:m.styleAttrs[A.qname]=new r.ComputedLength(.5*R.rw,.5*R.rh)}else{var C=c.styleAttrs[n.byName.fontSize.qname];m.styleAttrs[A.qname]=new r.ComputedLength(.5*C.rw,.5*C.rh)}}for(var D in n.all){var M=n.all[D];if(!(M.qname in m.styleAttrs)&&!(M.qname===n.byName.position.qname&&n.byName.origin.qname in m.styleAttrs||M.qname===n.byName.origin.qname&&n.byName.position.qname in m.styleAttrs)){var L=e.head.styling.initials[M.qname]||M.initial;("region"===m.kind||!1===M.inherit&&null!==L)&&(m.styleAttrs[M.qname]=M.parse(L),E[M.qname]=!0)}}for(var N in n.all){var x=n.all[N];if(x.qname in E&&null!==x.compute){var O=x.compute(e,c,m,m.styleAttrs[x.qname],p);null!==O?m.styleAttrs[x.qname]=O:(m.styleAttrs[x.qname]=x.compute(e,c,m,x.parse(x.initial),p),u(h,"Style '"+x.qname+"' on element '"+m.kind+"' cannot be computed"))}}if("none"===m.styleAttrs[n.byName.display.qname])return null;for(var P in null===c?y=null===l?[]:[l]:"contents"in f&&(y=f.contents),y){var k=a(e,t,o,l,m,g,y[P],h,p);null!==k&&m.contents.push(k.element)}for(var F in m.styleAttrs){var U=!1;if("span"===m.kind){var B=m.styleAttrs[n.byName.ruby.qname];(U=("container"===B||"textContainer"===B||"baseContainer"===B)&&-1!==i.indexOf(F))||(U="container"!==B&&F===n.byName.rubyAlign.qname),U||(U=!("textContainer"===B||"text"===B)&&F===n.byName.rubyPosition.qname)}U||(U=-1===n.byQName[F].applies.indexOf(m.kind)),U&&delete m.styleAttrs[F]}if("span"===m.kind&&m.text&&"default"===m.space){var G=m.text.replace(/[\t\r\n ]+/g," ");m.text=G}if("p"===m.kind){var j=[];!function e(t,n){if("contents"in t)for(var r in t.contents)e(t.contents[r],n);else"span"!==t.kind&&"br"!==t.kind||n.push(t)}(m,j);for(var H=0,K="after_br",Y=0;;)if("after_br"===K)H>=j.length||"br"===j[H].kind?(K="before_br",Y=H,H--):("preserve"!==j[H].space&&(j[H].text=j[H].text.replace(/^[\t\r\n ]+/g,"")),j[H].text.length>0?(K="looking_br",H++):j.splice(H,1));else if("before_br"===K)if(H<0||"br"===j[H].kind){if(K="after_br",(H=Y+1)>=j.length)break}else if("preserve"!==j[H].space&&(j[H].text=j[H].text.replace(/[\t\r\n ]+$/g,"")),j[H].text.length>0){if(K="after_br",(H=Y+1)>=j.length)break}else j.splice(H,1),H--;else H>=j.length||"br"===j[H].kind?(K="before_br",Y=H,H--):H++;!function e(t){if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)e(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}(m)}return"div"===m.kind&&n.byName.backgroundImage.qname in m.styleAttrs||"br"===m.kind||"image"===m.kind||"contents"in m&&m.contents.length>0||"span"===m.kind&&null!==m.text||"region"===m.kind&&"always"===m.styleAttrs[n.byName.showBackground.qname]?{region_id:g,element:m}:null}function o(e){this.contents=[],this.aspectRatio=e.aspectRatio}function s(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function u(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?n(34):imscNames,"undefined"==typeof imscStyles?n(45):imscStyles,"undefined"==typeof imscUtils?n(35):imscUtils)},function(e,t,n){!function(e,t,n,r,i){function a(e,t,n,r){var i=r&&"seq"===r.timeContainer,o=0;r&&(o=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+o:o;var s=t.begin,u=null;for(var l in t.sets)a(e,t.sets[l],u,t),s="seq"===t.timeContainer?t.sets[l].end:Math.max(s,t.sets[l].end),u=t.sets[l];if("contents"in t)for(var c in t.contents)a(e,t.contents[c],u,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),u=t.contents[c];else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,o+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=o+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function o(e){this.node=e}function s(){this.events=[],this.head=new u,this.body=null}function u(){this.styling=new l,this.layout=new f}function l(){this.styles={},this.initials={}}function c(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function d(){this.styleAttrs=null}function f(){this.regions={}}function h(e,t){p.call(this,"image"),this.src=e,this.type=t}function p(e){this.kind=e}function g(e){this.id=e}function m(e){this.regionID=e}function v(e){this.styleAttrs=e}function y(e){this.sets=e}function E(e){this.contents=e}function T(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function _(){p.call(this,"body")}function b(){p.call(this,"div")}function A(){p.call(this,"p")}function S(){p.call(this,"span")}function w(){p.call(this,"span")}function I(){p.call(this,"br")}function R(){}function C(){}function D(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function M(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function L(e,t){var n={};if(null!==e)for(var i in e.attributes){var a=e.attributes[i].uri+" "+e.attributes[i].local,o=r.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[i].value);null!==s?(n[a]=s,o===r.byName.zIndex&&F(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):U(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[i].value)}}return n}function N(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function x(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i}function O(e,t,n){for(;t.styleRefs.length>0;){var r=t.styleRefs.pop();r in e.styles?(O(e,e.styles[r],n),k(e.styles[r].styleAttrs,t.styleAttrs)):U(n,"Non-existant style id referenced")}}function P(e,t,n,r){for(var i=t.length-1;i>=0;i--){var a=t[i];a in e.styles?k(e.styles[a].styleAttrs,n):U(r,"Non-existant style id referenced")}}function k(e,t){for(var n in e)n in t||(t[n]=e[n])}function F(e,t){if(e&&e.warn&&e.warn(t))throw t}function U(e,t){if(e&&e.error&&e.error(t))throw t}function B(e,t){throw e&&e.fatal&&e.fatal(t),t}function G(e,t){for(var n,r=0,i=e.length-1;r<=i;){var a=e[n=Math.floor((r+i)/2)];if(a<t)r=n+1;else{if(!(a>t))return{found:!0,index:n};i=n-1}}return{found:!1,index:r}}e.fromXML=function(e,i,p){var g=t.parser(!0,{xmlns:!0}),m=[],v=[],y=[],E=0,T=null;g.onclosetag=function(e){if(m[0]instanceof l)for(var t in m[0].styles)O(m[0],m[0].styles[t],i);else if(m[0]instanceof A||m[0]instanceof S){if(m[0].contents.length>1){var r,a=[m[0].contents[0]];for(r=1;r<m[0].contents.length;r++)m[0].contents[r]instanceof w&&a[a.length-1]instanceof w?a[a.length-1].text+=m[0].contents[r].text:a.push(m[0].contents[r]);m[0].contents=a}m[0]instanceof S&&1===m[0].contents.length&&m[0].contents[0]instanceof w&&(m[0].text=m[0].contents[0].text,delete m[0].contents)}else m[0]instanceof o&&(m[0].node.uri===n.ns_tt&&"metadata"===m[0].node.local?E--:E>0&&p&&"onCloseTag"in p&&p.onCloseTag());y.shift(),v.shift(),m.shift()},g.ontext=function(e){if(void 0===m[0]);else if(m[0]instanceof S||m[0]instanceof A){if(m[0]instanceof S){var t=m[0].styleAttrs[r.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return}var n=new w;n.initFromText(T,m[0],e,y[0],i),m[0].contents.push(n)}else m[0]instanceof o&&E>0&&p&&"onText"in p&&p.onText(e)},g.onopentag=function(e){var t=e.attributes["xml:space"];t?y.unshift(t.value):0===y.length?y.unshift("default"):y.unshift(y[0]);var a=e.attributes["xml:lang"];if(a?v.unshift(a.value):0===v.length?v.unshift(""):v.unshift(v[0]),e.uri===n.ns_tt)if("tt"===e.local)null!==T&&B(i,"Two <tt> elements at ("+this.line+","+this.column+")"),(T=new s).initFromNode(e,i),m.unshift(T);else if("head"===e.local)m[0]instanceof s||B(i,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),m.unshift(T.head);else if("styling"===e.local)m[0]instanceof u||B(i,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),m.unshift(T.head.styling);else if("style"===e.local){var g;m[0]instanceof l?((g=new c).initFromNode(e,i),g.id?T.head.styling.styles[g.id]=g:U(i,"<style> element missing @id attribute"),m.unshift(g)):m[0]instanceof R?((g=new c).initFromNode(e,i),k(g.styleAttrs,m[0].styleAttrs),m.unshift(g)):B(i,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var w;if(m[0]instanceof l){for(var D in(w=new d).initFromNode(e,i),w.styleAttrs)T.head.styling.initials[D]=w.styleAttrs[D];m.unshift(w)}else B(i,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)m[0]instanceof u||B(i,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),m.unshift(T.head.layout);else if("region"===e.local){m[0]instanceof f||B(i,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var M=new R;M.initFromNode(T,e,i),!M.id||M.id in T.head.layout.regions?U(i,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):T.head.layout.regions[M.id]=M,m.unshift(M)}else if("body"===e.local){m[0]instanceof s||B(i,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==T.body&&B(i,"Second <body> element at "+this.line+","+this.column+")");var L=new _;L.initFromNode(T,e,i),T.body=L,m.unshift(L)}else if("div"===e.local){m[0]instanceof b||m[0]instanceof _||B(i,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var N=new b;N.initFromNode(T,m[0],e,i);var x=N.styleAttrs[r.byName.backgroundImage.qname];x&&(N.contents.push(new h(x)),delete N.styleAttrs[r.byName.backgroundImage.qname]),m[0].contents.push(N),m.unshift(N)}else if("image"===e.local){m[0]instanceof b||B(i,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var O=new h;O.initFromNode(T,m[0],e,i),m[0].contents.push(O),m.unshift(O)}else if("p"===e.local){m[0]instanceof b||B(i,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var P=new A;P.initFromNode(T,m[0],e,i),m[0].contents.push(P),m.unshift(P)}else if("span"===e.local){m[0]instanceof S||m[0]instanceof A||B(i,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var F=new S;F.initFromNode(T,m[0],e,y[0],i),m[0].contents.push(F),m.unshift(F)}else if("br"===e.local){m[0]instanceof S||m[0]instanceof A||B(i,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var G=new I;G.initFromNode(T,m[0],e,i),m[0].contents.push(G),m.unshift(G)}else if("set"===e.local){m[0]instanceof S||m[0]instanceof A||m[0]instanceof b||m[0]instanceof _||m[0]instanceof R||m[0]instanceof I||B(i,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var j=new C;j.initFromNode(T,m[0],e,i),m[0].sets.push(j),m.unshift(j)}else m.unshift(new o(e));else m.unshift(new o(e));if(m[0]instanceof o)if(e.uri===n.ns_tt&&"metadata"===e.local)E++;else if(E>0&&p&&"onOpenTag"in p){var H=[];for(var K in e.attributes)H[e.attributes[K].uri+" "+e.attributes[K].local]={uri:e.attributes[K].uri,local:e.attributes[K].local,value:e.attributes[K].value};p.onOpenTag(e.uri,e.local,H)}},g.write(e).close(),delete T.head.styling.styles;var D=!1;for(var M in T.head.layout.regions){D=!0;break}if(!D){var L=R.prototype.createDefaultRegion();T.head.layout.regions[L.id]=L}for(var N in T.head.layout.regions)a(T,T.head.layout.regions[N],null,null);return T.body&&a(T,T.body,null,null),T.body&&function e(t){if("contents"in t)for(var n=("styleAttrs"in t?t.styleAttrs[r.byName.ruby.qname]:null),i="span"===t.kind&&("container"===n||"textContainer"===n||"baseContainer"===n),a=t.contents.length-1;a>=0;a--)!i||"styleAttrs"in t.contents[a]&&r.byName.ruby.qname in t.contents[a].styleAttrs?e(t.contents[a]):delete t.contents[a]}(T.body),T},s.prototype.initFromNode=function(e,t){var r=function(e,t){var r=N(e,n.ns_ttp,"cellResolution"),i=15,a=32;if(null!==r){var o=/(\d+) (\d+)/.exec(r);null!==o?(a=parseInt(o[1]),i=parseInt(o[2])):F(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:i}}(e,t);this.cellLength={h:new i.ComputedLength(0,1/r.h),w:new i.ComputedLength(1/r.w,0)};var a=function(e,t){var r,i=N(e,n.ns_ttp,"frameRate"),a=30;null!==i&&(null!==(r=/(\d+)/.exec(i))?a=parseInt(r[1]):F(t,"Malformed frame rate attribute (using initial value instead)"));var o=N(e,n.ns_ttp,"frameRateMultiplier"),s=1;null!==o&&(null!==(r=/(\d+) (\d+)/.exec(o))?s=parseInt(r[1])/parseInt(r[2]):F(t,"Malformed frame rate multiplier attribute (using initial value instead)"));var u=s*a,l=1,c=N(e,n.ns_ttp,"tickRate");return null===c?null!==i&&(l=u):null!==(r=/(\d+)/.exec(c))?l=parseInt(r[1]):F(t,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:u,tickRate:l}}(e,t);this.effectiveFrameRate=a.effectiveFrameRate,this.tickRate=a.tickRate,this.aspectRatio=function(e,t){var r=N(e,n.ns_ittp,"aspectRatio");null===r&&(r=N(e,n.ns_ttp,"displayAspectRatio"));var i=null;if(null!==r){var a=/(\d+)\s+(\d+)/.exec(r);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?i=o/s:U(t,"Illegal aspectRatio values (ignoring)")}else U(t,"Malformed aspectRatio attribute (ignoring)")}return i}(e,t);var o=N(e,n.ns_ttp,"timeBase");null!==o&&"media"!==o&&B(t,"Unsupported time base");var s=function(e,t){var r=N(e,n.ns_tts,"extent");if(null===r)return null;var a=r.split(" ");if(2!==a.length)return F(t,"Malformed extent (ignoring)"),null;var o=i.parseLength(a[0]),s=i.parseLength(a[1]);return s&&o?{h:s,w:o}:(F(t,"Malformed extent values (ignoring)"),null)}(e,t);null===s?this.pxLength={h:null,w:null}:("px"===s.h.unit&&"px"===s.w.unit||B(t,"Extent on TT must be in px or absent"),this.pxLength={h:new i.ComputedLength(0,1/s.h.value),w:new i.ComputedLength(1/s.w.value,0)}),this.dimensions={h:new i.ComputedLength(0,1),w:new i.ComputedLength(1,0)}},s.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=G(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=G(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},s.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},s.prototype.getMediaTimeEvents=function(){return this.events},c.prototype.initFromNode=function(e,t){this.id=D(e),this.styleAttrs=L(e,t),this.styleRefs=M(e)},d.prototype.initFromNode=function(e,t){for(var r in this.styleAttrs={},e.attributes)if(e.attributes[r].uri===n.ns_itts||e.attributes[r].uri===n.ns_ebutts||e.attributes[r].uri===n.ns_tts){var i=e.attributes[r].uri+" "+e.attributes[r].local;this.styleAttrs[i]=e.attributes[r].value}},h.prototype.initFromNode=function(e,t,n,r){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||U(r,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||U(r,"Invalid image@type attribute"),v.prototype.initFromNode.call(this,e,t,n,r),T.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),m.prototype.initFromNode.call(this,e,t,n,r)},g.prototype.initFromNode=function(e,t,n,r){this.id=D(n)},m.prototype.initFromNode=function(e,t,n,r){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},v.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=L(n,r),null!==e.head&&null!==e.head.styling&&P(e.head.styling,M(n),this.styleAttrs,r)},y.prototype.initFromNode=function(e,t,n,r){this.sets=[]},E.prototype.initFromNode=function(e,t,n,r){this.contents=[]},T.prototype.initFromNode=function(e,t,n,r){var i=function(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=x(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&F(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=x(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&F(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;return n&&"end"in n.attributes&&null===(o=x(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&F(r,"Malformed end value (ignoring)"),{explicit_begin:i,explicit_end:o,explicit_dur:a}}(e,0,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(U(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,r)},_.prototype.initFromNode=function(e,t,n){v.prototype.initFromNode.call(this,e,null,t,n),T.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),m.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n)},b.prototype.initFromNode=function(e,t,n,r){v.prototype.initFromNode.call(this,e,t,n,r),T.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),m.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r)},A.prototype.initFromNode=function(e,t,n,r){v.prototype.initFromNode.call(this,e,t,n,r),T.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),m.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r)},S.prototype.initFromNode=function(e,t,n,r,i){v.prototype.initFromNode.call(this,e,t,n,i),T.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),m.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),this.space=r},w.prototype.initFromText=function(e,t,n,r,i){T.prototype.initFromNode.call(this,e,t,null,i),this.text=n,this.space=r},I.prototype.initFromNode=function(e,t,n,r){m.prototype.initFromNode.call(this,e,t,n,r),T.prototype.initFromNode.call(this,e,t,n,r)},R.prototype.createDefaultRegion=function(){var e=new R;return g.call(e,""),v.call(e,{}),y.call(e,[]),T.call(e,0,Number.POSITIVE_INFINITY,null),e},R.prototype.initFromNode=function(e,t,n){g.prototype.initFromNode.call(this,e,null,t,n),v.prototype.initFromNode.call(this,e,null,t,n),T.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),null!==e.head&&null!==e.head.styling&&P(e.head.styling,M(t),this.styleAttrs,n)},C.prototype.initFromNode=function(e,t,n,r){T.prototype.initFromNode.call(this,e,t,n,r);var i=L(n,r);for(var a in this.qname=null,this.value=null,i){if(this.qname){U(r,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}}(t,"undefined"==typeof sax?n(114):sax,"undefined"==typeof imscNames?n(34):imscNames,"undefined"==typeof imscStyles?n(45):imscStyles,"undefined"==typeof imscUtils?n(35):imscUtils)},function(e,t,n){(function(e){!function(t){t.parser=function(e,t){return new a(e,t)},t.SAXParser=a,t.SAXStream=s,t.createStream=function(e,t){return new s(e,t)},t.MAX_BUFFER_LENGTH=65536;var r,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(e,n){if(!(this instanceof a))return new a(e,n);!function(e){for(var t=0,n=i.length;t<n;t++)e[i[t]]=""}(this),this.q=this.c="",this.bufferCheckPosition=t.MAX_BUFFER_LENGTH,this.opt=n||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!e,this.noscript=!(!e&&!this.opt.noscript),this.state=w.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(p)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),R(this,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),a.prototype={end:function(){N(this)},write:function(e){if(this.error)throw this.error;if(this.closed)return L(this,"Cannot write after close. Assign an onready handler.");if(null===e)return N(this);"object"==typeof e&&(e=e.toString());for(var n=0,r="";r=j(e,n++),this.c=r,r;)switch(this.trackPosition&&(this.position++,"\n"===r?(this.line++,this.column=0):this.column++),this.state){case w.BEGIN:if(this.state=w.BEGIN_WHITESPACE,"\ufeff"===r)continue;G(this,r);continue;case w.BEGIN_WHITESPACE:G(this,r);continue;case w.TEXT:if(this.sawRoot&&!this.closedRoot){for(var a=n-1;r&&"<"!==r&&"&"!==r;)(r=j(e,n++))&&this.trackPosition&&(this.position++,"\n"===r?(this.line++,this.column=0):this.column++);this.textNode+=e.substring(a,n-1)}"<"!==r||this.sawRoot&&this.closedRoot&&!this.strict?(!_(u,r)||this.sawRoot&&!this.closedRoot||x(this,"Text data outside of root node."),"&"===r?this.state=w.TEXT_ENTITY:this.textNode+=r):(this.state=w.OPEN_WAKA,this.startTagPosition=this.position);continue;case w.SCRIPT:"<"===r?this.state=w.SCRIPT_ENDING:this.script+=r;continue;case w.SCRIPT_ENDING:"/"===r?this.state=w.CLOSE_TAG:(this.script+="<"+r,this.state=w.SCRIPT);continue;case w.OPEN_WAKA:if("!"===r)this.state=w.SGML_DECL,this.sgmlDecl="";else if(T(u,r));else if(T(g,r))this.state=w.OPEN_TAG,this.tagName=r;else if("/"===r)this.state=w.CLOSE_TAG,this.tagName="";else if("?"===r)this.state=w.PROC_INST,this.procInstName=this.procInstBody="";else{if(x(this,"Unencoded <"),this.startTagPosition+1<this.position){var o=this.position-this.startTagPosition;r=new Array(o).join(" ")+r}this.textNode+="<"+r,this.state=w.TEXT}continue;case w.SGML_DECL:"[CDATA["===(this.sgmlDecl+r).toUpperCase()?(C(this,"onopencdata"),this.state=w.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+r==="--"?(this.state=w.COMMENT,this.comment="",this.sgmlDecl=""):"DOCTYPE"===(this.sgmlDecl+r).toUpperCase()?(this.state=w.DOCTYPE,(this.doctype||this.sawRoot)&&x(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===r?(C(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=w.TEXT):T(d,r)?(this.state=w.SGML_DECL_QUOTED,this.sgmlDecl+=r):this.sgmlDecl+=r;continue;case w.SGML_DECL_QUOTED:r===this.q&&(this.state=w.SGML_DECL,this.q=""),this.sgmlDecl+=r;continue;case w.DOCTYPE:">"===r?(this.state=w.TEXT,C(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=r,"["===r?this.state=w.DOCTYPE_DTD:T(d,r)&&(this.state=w.DOCTYPE_QUOTED,this.q=r));continue;case w.DOCTYPE_QUOTED:this.doctype+=r,r===this.q&&(this.q="",this.state=w.DOCTYPE);continue;case w.DOCTYPE_DTD:this.doctype+=r,"]"===r?this.state=w.DOCTYPE:T(d,r)&&(this.state=w.DOCTYPE_DTD_QUOTED,this.q=r);continue;case w.DOCTYPE_DTD_QUOTED:this.doctype+=r,r===this.q&&(this.state=w.DOCTYPE_DTD,this.q="");continue;case w.COMMENT:"-"===r?this.state=w.COMMENT_ENDING:this.comment+=r;continue;case w.COMMENT_ENDING:"-"===r?(this.state=w.COMMENT_ENDED,this.comment=M(this.opt,this.comment),this.comment&&C(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+r,this.state=w.COMMENT);continue;case w.COMMENT_ENDED:">"!==r?(x(this,"Malformed comment"),this.comment+="--"+r,this.state=w.COMMENT):this.state=w.TEXT;continue;case w.CDATA:"]"===r?this.state=w.CDATA_ENDING:this.cdata+=r;continue;case w.CDATA_ENDING:"]"===r?this.state=w.CDATA_ENDING_2:(this.cdata+="]"+r,this.state=w.CDATA);continue;case w.CDATA_ENDING_2:">"===r?(this.cdata&&C(this,"oncdata",this.cdata),C(this,"onclosecdata"),this.cdata="",this.state=w.TEXT):"]"===r?this.cdata+="]":(this.cdata+="]]"+r,this.state=w.CDATA);continue;case w.PROC_INST:"?"===r?this.state=w.PROC_INST_ENDING:T(u,r)?this.state=w.PROC_INST_BODY:this.procInstName+=r;continue;case w.PROC_INST_BODY:if(!this.procInstBody&&T(u,r))continue;"?"===r?this.state=w.PROC_INST_ENDING:this.procInstBody+=r;continue;case w.PROC_INST_ENDING:">"===r?(C(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=w.TEXT):(this.procInstBody+="?"+r,this.state=w.PROC_INST_BODY);continue;case w.OPEN_TAG:T(m,r)?this.tagName+=r:(O(this),">"===r?F(this):"/"===r?this.state=w.OPEN_TAG_SLASH:(_(u,r)&&x(this,"Invalid character in tag name"),this.state=w.ATTRIB));continue;case w.OPEN_TAG_SLASH:">"===r?(F(this,!0),U(this)):(x(this,"Forward-slash in opening tag not followed by >"),this.state=w.ATTRIB);continue;case w.ATTRIB:if(T(u,r))continue;">"===r?F(this):"/"===r?this.state=w.OPEN_TAG_SLASH:T(g,r)?(this.attribName=r,this.attribValue="",this.state=w.ATTRIB_NAME):x(this,"Invalid attribute name");continue;case w.ATTRIB_NAME:"="===r?this.state=w.ATTRIB_VALUE:">"===r?(x(this,"Attribute without value"),this.attribValue=this.attribName,k(this),F(this)):T(u,r)?this.state=w.ATTRIB_NAME_SAW_WHITE:T(m,r)?this.attribName+=r:x(this,"Invalid attribute name");continue;case w.ATTRIB_NAME_SAW_WHITE:if("="===r)this.state=w.ATTRIB_VALUE;else{if(T(u,r))continue;x(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",C(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===r?F(this):T(g,r)?(this.attribName=r,this.state=w.ATTRIB_NAME):(x(this,"Invalid attribute name"),this.state=w.ATTRIB)}continue;case w.ATTRIB_VALUE:if(T(u,r))continue;T(d,r)?(this.q=r,this.state=w.ATTRIB_VALUE_QUOTED):(x(this,"Unquoted attribute value"),this.state=w.ATTRIB_VALUE_UNQUOTED,this.attribValue=r);continue;case w.ATTRIB_VALUE_QUOTED:if(r!==this.q){"&"===r?this.state=w.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=r;continue}k(this),this.q="",this.state=w.ATTRIB_VALUE_CLOSED;continue;case w.ATTRIB_VALUE_CLOSED:T(u,r)?this.state=w.ATTRIB:">"===r?F(this):"/"===r?this.state=w.OPEN_TAG_SLASH:T(g,r)?(x(this,"No whitespace between attributes"),this.attribName=r,this.attribValue="",this.state=w.ATTRIB_NAME):x(this,"Invalid attribute name");continue;case w.ATTRIB_VALUE_UNQUOTED:if(_(f,r)){"&"===r?this.state=w.ATTRIB_VALUE_ENTITY_U:this.attribValue+=r;continue}k(this),">"===r?F(this):this.state=w.ATTRIB;continue;case w.CLOSE_TAG:if(this.tagName)">"===r?U(this):T(m,r)?this.tagName+=r:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=w.SCRIPT):(_(u,r)&&x(this,"Invalid tagname in closing tag"),this.state=w.CLOSE_TAG_SAW_WHITE);else{if(T(u,r))continue;_(g,r)?this.script?(this.script+="</"+r,this.state=w.SCRIPT):x(this,"Invalid tagname in closing tag."):this.tagName=r}continue;case w.CLOSE_TAG_SAW_WHITE:if(T(u,r))continue;">"===r?U(this):x(this,"Invalid characters in closing tag");continue;case w.TEXT_ENTITY:case w.ATTRIB_VALUE_ENTITY_Q:case w.ATTRIB_VALUE_ENTITY_U:var s,l;switch(this.state){case w.TEXT_ENTITY:s=w.TEXT,l="textNode";break;case w.ATTRIB_VALUE_ENTITY_Q:s=w.ATTRIB_VALUE_QUOTED,l="attribValue";break;case w.ATTRIB_VALUE_ENTITY_U:s=w.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===r?(this[l]+=B(this),this.entity="",this.state=s):T(this.entity.length?y:v,r)?this.entity+=r:(x(this,"Invalid character in entity name"),this[l]+="&"+this.entity+r,this.entity="",this.state=s);continue;default:throw new Error(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(e){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,a=0,o=i.length;a<o;a++){var s=e[i[a]].length;if(s>n)switch(i[a]){case"textNode":D(e);break;case"cdata":C(e,"oncdata",e.cdata),e.cdata="";break;case"script":C(e,"onscript",e.script),e.script="";break;default:L(e,"Max buffer length exceeded: "+i[a])}r=Math.max(r,s)}var u=t.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=u+e.position}(this),this}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;D(e=this),""!==e.cdata&&(C(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(C(e,"onscript",e.script),e.script="")}};try{r=n(117).Stream}catch(e){r=function(){}}var o=t.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function s(e,t){if(!(this instanceof s))return new s(e,t);r.apply(this),this._parser=new a(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(r.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(t)){if(!this._decoder){var r=n(50).StringDecoder;this._decoder=new r("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===o.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),r.prototype.on.call(n,e,t)};var u="\r\n\t ",l="0124356789",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",d="'\"",f=u+">",h="http://www.w3.org/XML/1998/namespace",p={xml:h,xmlns:"http://www.w3.org/2000/xmlns/"};u=E(u),l=E(l),c=E(c);var g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function E(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}function T(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function _(e,t){return!T(e,t)}d=E(d),f=E(f);var b,A,S,w=0;for(var I in t.STATE={BEGIN:w++,BEGIN_WHITESPACE:w++,TEXT:w++,TEXT_ENTITY:w++,OPEN_WAKA:w++,SGML_DECL:w++,SGML_DECL_QUOTED:w++,DOCTYPE:w++,DOCTYPE_QUOTED:w++,DOCTYPE_DTD:w++,DOCTYPE_DTD_QUOTED:w++,COMMENT_STARTING:w++,COMMENT:w++,COMMENT_ENDING:w++,COMMENT_ENDED:w++,CDATA:w++,CDATA_ENDING:w++,CDATA_ENDING_2:w++,PROC_INST:w++,PROC_INST_BODY:w++,PROC_INST_ENDING:w++,OPEN_TAG:w++,OPEN_TAG_SLASH:w++,ATTRIB:w++,ATTRIB_NAME:w++,ATTRIB_NAME_SAW_WHITE:w++,ATTRIB_VALUE:w++,ATTRIB_VALUE_QUOTED:w++,ATTRIB_VALUE_CLOSED:w++,ATTRIB_VALUE_UNQUOTED:w++,ATTRIB_VALUE_ENTITY_Q:w++,ATTRIB_VALUE_ENTITY_U:w++,CLOSE_TAG:w++,CLOSE_TAG_SAW_WHITE:w++,SCRIPT:w++,SCRIPT_ENDING:w++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var n=t.ENTITIES[e],r="number"==typeof n?String.fromCharCode(n):n;t.ENTITIES[e]=r})),t.STATE)t.STATE[t.STATE[I]]=I;function R(e,t,n){e[t]&&e[t](n)}function C(e,t,n){e.textNode&&D(e),R(e,t,n)}function D(e){e.textNode=M(e.opt,e.textNode),e.textNode&&R(e,"ontext",e.textNode),e.textNode=""}function M(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function L(e,t){return D(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,R(e,"onerror",t),e}function N(e){return e.sawRoot&&!e.closedRoot&&x(e,"Unclosed root tag"),e.state!==w.BEGIN&&e.state!==w.BEGIN_WHITESPACE&&e.state!==w.TEXT&&L(e,"Unexpected end"),D(e),e.c="",e.closed=!0,R(e,"onend"),a.call(e,e.strict,e.opt),e}function x(e,t){if("object"!=typeof e||!(e instanceof a))throw new Error("bad call to strictFail");e.strict&&L(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,C(e,"onopentagstart",n)}function P(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function k(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=P(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==h)x(e,"xml: prefix must be bound to "+h+"\nActual: "+e.attribValue);else if("xmlns"===r&&"http://www.w3.org/2000/xmlns/"!==e.attribValue)x(e,"xmlns: prefix must be bound to http://www.w3.org/2000/xmlns/\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,C(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function F(e,t){if(e.opt.xmlns){var n=e.tag,r=P(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(x(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){C(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],u=s[0],l=s[1],c=P(u,!0),d=c.prefix,f=c.local,h=""===d?"":n.ns[d]||"",p={name:u,value:l,prefix:d,local:f,uri:h};d&&"xmlns"!==d&&!h&&(x(e,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),e.tag.attributes[u]=p,C(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),C(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=w.TEXT:e.state=w.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function U(e){if(!e.tagName)return x(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=w.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=w.SCRIPT);C(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)x(e,"Unexpected close tag");if(t<0)return x(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=w.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,C(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach((function(t){var n=a.ns[t];C(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=w.TEXT}function B(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(x(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function G(e,t){"<"===t?(e.state=w.OPEN_WAKA,e.startTagPosition=e.position):_(u,t)&&(x(e,"Non-whitespace before first tag."),e.textNode=t,e.state=w.TEXT)}function j(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}w=t.STATE,String.fromCodePoint||(b=String.fromCharCode,A=Math.floor,S=function(){var e,t,n=16384,r=[],i=-1,a=arguments.length;if(!a)return"";for(var o="";++i<a;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||A(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(i+1===a||r.length>n)&&(o+=b.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:S,configurable:!0,writable:!0}):String.fromCodePoint=S)}(t)}).call(this,n(46).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=l(e),o=r[0],s=r[1],u=new a(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),c=0,d=s>0?o-4:o;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(c(e,o,o+16383>s?s:o+16383));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,d=n?i-1:0,f=n?-1:1,h=e[t+d];for(d+=f,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=f,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=l}return(h?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,d=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(o++,u/=2),o+d>=c?(s=0,o=c):o+d>=1?(s=(t*u-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&s,h+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+h]=255&o,h+=p,o/=256,l-=8);e[n+h-p]|=128*g}},function(e,t,n){e.exports=i;var r=n(47).EventEmitter;function i(){r.call(this)}n(21)(i,r),i.Readable=n(48),i.Writable=n(125),i.Duplex=n(126),i.Transform=n(127),i.PassThrough=n(128),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",u));var o=!1;function s(){o||(o=!0,e.end())}function u(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(c(),0===r.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",i),e.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",l),e.on("error",l),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},function(e,t){},function(e,t,n){"use strict";var r=n(38).Buffer,i=n(120);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i=r.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=i,n=o,a.data.copy(t,n),o+=a.data.length,a=a.next;return i},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(122),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(13))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,a,o,s,u=1,l={},c=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){a.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(p,0,e)},f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[u]=i,r(u),u++},f.clearImmediate=h}function h(e){delete l[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(13),n(36))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(13))},function(e,t,n){"use strict";e.exports=a;var r=n(74),i=Object.create(n(28));function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}i.inherits=n(21),i.inherits(a,r),a.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(49)},function(e,t,n){e.exports=n(16)},function(e,t,n){e.exports=n(48).Transform},function(e,t,n){e.exports=n(48).PassThrough},function(e,t,n){!function(e,t,n){function r(e,t,s){var l;if("region"===s.kind)(l=document.createElement("div")).style.position="absolute";else if("body"===s.kind)l=document.createElement("div");else if("div"===s.kind)l=document.createElement("div");else if("image"===s.kind){if(l=document.createElement("img"),null!==e.imgResolver&&null!==s.src){var c=e.imgResolver(s.src,l);c&&(l.src=c),l.height=e.regionH,l.width=e.regionW}}else if("p"===s.kind)l=document.createElement("p");else if("span"===s.kind){if("container"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("ruby"),e.ruby=!0;else if("base"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rb");else if("text"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rt");else if("baseContainer"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rbc");else if("textContainer"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rtc");else{if("delimiter"===s.styleAttrs[n.byName.ruby.qname])return;l=document.createElement("span")}var d=s.styleAttrs[n.byName.textEmphasis.qname];d&&"none"!==d.style&&(e.textEmphasis=!0)}else"br"===s.kind&&(l=document.createElement("br"));if(l){for(var f in t.appendChild(l),l.style.margin="0",u){var h=u[f],p=s.styleAttrs[h.qname];void 0!==p&&null!==h.map&&h.map(e,l,s,p)}var g=l;if("region"===s.kind){var m=s.styleAttrs[n.byName.writingMode.qname];"lrtb"===m||"lr"===m?(e.ipd="lr",e.bpd="tb"):"rltb"===m||"rl"===m?(e.ipd="rl",e.bpd="tb"):"tblr"===m?(e.ipd="tb",e.bpd="lr"):"tbrl"!==m&&"tb"!==m||(e.ipd="tb",e.bpd="rl")}var v=s.styleAttrs[n.byName.linePadding.qname];if(v&&!v.isZero()){var y=v.toUsedLength(e.w,e.h);if(y>0){var E=Math.ceil(y)+"px";"tb"===e.bpd?(g.style.paddingLeft=E,g.style.paddingRight=E):(g.style.paddingTop=E,g.style.paddingBottom=E),e.lp=v}}var T=s.styleAttrs[n.byName.multiRowAlign.qname];if(T&&"auto"!==T){var _=document.createElement("span");_.style.display="inline-block",_.style.textAlign=T,l.appendChild(_),g=_,e.mra=T}var b=s.styleAttrs[n.byName.rubyReserve.qname];if(b&&"none"!==b[0]&&(e.rubyReserve=b),s.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===s.kind&&s.text)if(n.byName.textCombine.qname in s.styleAttrs&&"all"===s.styleAttrs[n.byName.textCombine.qname][0])l.textContent=s.text;else for(var A="",S=0;S<s.text.length;S++){A+=s.text.charAt(S);var w=s.text.charCodeAt(S);if(w<55296||w>56319||S===s.text.length){var I=document.createElement("span");I.textContent=A,l.appendChild(I),A=""}}for(var R in s.contents)r(e,g,s.contents[R]);var C=[];if((e.lp||e.mra||e.flg||e.ruby||e.textEmphasis||e.rubyReserve)&&"p"===s.kind&&(o(e,g,C,null),e.rubyReserve&&(function(e,t){for(var n=0;n<e.length;n++){var r,i,a=document.createElement("ruby"),o=document.createElement("rb");o.textContent="​",a.appendChild(o);var s=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]?((r=document.createElement("rtc")).style.rubyPosition="under",r.textContent="​",r.style.fontSize=s,(i=document.createElement("rtc")).style.rubyPosition="over",i.textContent="​",i.style.fontSize=s,a.appendChild(r),a.appendChild(i)):((r=document.createElement("rtc")).textContent="​",r.style.fontSize=s,"after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?r.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"under":"over":r.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"over":"under",a.appendChild(r)),e[n].elements[0].node.parentElement.insertBefore(a,e[n].elements[0].node)}}(C,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].rbc.length;r++){var i;e[n].rbc[r].style.rubyPosition||(i="tb"===t.bpd||"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[r].style.rubyPosition=i)}}(C,e),e.ruby=null),e.textEmphasis&&(function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].te.length;r++){var i;e[n].te[r].style.textEmphasisPosition&&"none"!==e[n].te[r].style.textEmphasisPosition||(i="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[r].style.textEmphasisPosition=i)}}(C,e),e.textEmphasis=null),e.mra&&(function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling)}}}(C),e.mra=null),e.lp&&(function(e,t,n){for(var r in e){var i=e[r].elements.length,a=e[r].elements[e[r].start_elem],o=e[r].elements[e[r].end_elem],s=Math.ceil(t)+"px",u="-"+Math.ceil(t)+"px";0!==i&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=u):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=u):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=u),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=u):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=u):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=u))}}(C,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),e.flg)){var D=a(g.getBoundingClientRect(),e);!function(e,t,n,r){for(var i=Math.sign(n-t),a=0;a<=e.length;a++){var o,s,u;if(o=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2,a>0)for(var l=0;l<e[a-1].elements.length;l++)null!==e[a-1].elements[l].bgcolor&&i*((u=e[a-1].elements[l]).after-o)<0&&(s=Math.ceil(Math.abs(o-u.after))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingRight=s:"rl"===r.bpd?u.node.style.paddingLeft=s:"tb"===r.bpd&&(u.node.style.paddingBottom=s));if(a<e.length)for(var c=0;c<e[a].elements.length;c++)null!==(u=e[a].elements[c]).bgcolor&&i*(u.before-o)>0&&(s=Math.ceil(Math.abs(u.before-o))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingLeft=s:"rl"===r.bpd?u.node.style.paddingRight=s:"tb"===r.bpd&&(u.node.style.paddingTop=s))}}(C,D.before,D.after,e),e.flg=null}if("region"===s.kind&&(o(e,g,C),"tb"===e.bpd&&e.enableRollUp&&s.contents.length>0&&"after"===s.styleAttrs[n.byName.displayAlign.qname])){var M=new i(""===s.id?"_":s.id,C);if(e.currentISDState[M.id]=M,e.previousISDState&&M.id in e.previousISDState&&e.previousISDState[M.id].plist.length>0&&M.plist.length>1&&M.plist[M.plist.length-2].text===e.previousISDState[M.id].plist[e.previousISDState[M.id].plist.length-1].text){var L=l.firstElementChild,N=M.plist[M.plist.length-1].after-M.plist[M.plist.length-1].before;L.style.bottom="-"+N+"px",L.style.transition="transform 0.4s",L.style.position="relative",L.style.transform="translateY(-"+N+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+s.kind)}function i(e,t){this.id=e,this.plist=t}function a(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function o(e,t,n,r){if("rt"!==t.localName&&"rtc"!==t.localName){var i,s,u,l,c=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var d=t.getBoundingClientRect();if(0===d.height||0===d.width)return;var f=a(d,e);if(0!==n.length&&(i=f.before,s=f.after,u=n[n.length-1].before,s<(l=n[n.length-1].after)&&i>u||l<=s&&u>=i)){var h=Math.sign(f.after-f.before),p=Math.sign(f.end-f.start);h*(f.before-n[n.length-1].before)<0&&(n[n.length-1].before=f.before),h*(f.after-n[n.length-1].after)>0&&(n[n.length-1].after=f.after),p*(f.start-n[n.length-1].start)<0&&(n[n.length-1].start=f.start,n[n.length-1].start_elem=n[n.length-1].elements.length),p*(f.end-n[n.length-1].end)>0&&(n[n.length-1].end=f.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:f.before,after:f.after,start:f.start,end:f.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:c,before:f.before,after:f.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var g=t.firstChild;g;)g.nodeType===Node.ELEMENT_NODE&&(o(e,g,n,c),"ruby"===g.localName||"rtc"===g.localName?n.length>0&&n[n.length-1].rbc.push(g):"span"===g.localName&&g.style.textEmphasisStyle&&"none"!==g.style.textEmphasisStyle&&n.length>0&&n[n.length-1].te.push(g)),g=g.nextSibling}}function s(e,t){this.qname=e,this.map=t}e.render=function(e,t,n,i,a,o,s,u,l){var c=i||t.clientHeight,d=a||t.clientWidth;if(null!==e.aspectRatio){var f=c*e.aspectRatio;f>d?c=Math.round(d/e.aspectRatio):d=f}var h=document.createElement("div");h.style.position="relative",h.style.width=d+"px",h.style.height=c+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var p={h:c,w:d,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:u,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};for(var g in t.appendChild(h),e.contents)r(p,h,e.contents[g]);return p.currentISDState};var u=[new s("http://www.w3.org/ns/ttml#styling backgroundColor",(function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")})),new s("http://www.w3.org/ns/ttml#styling color",(function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"})),new s("http://www.w3.org/ns/ttml#styling direction",(function(e,t,n,r){t.style.direction=r})),new s("http://www.w3.org/ns/ttml#styling display",(function(e,t,n,r){})),new s("http://www.w3.org/ns/ttml#styling displayAlign",(function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end")})),new s("http://www.w3.org/ns/ttml#styling extent",(function(e,t,n,r){e.regionH=r.h.toUsedLength(e.w,e.h),e.regionW=r.w.toUsedLength(e.w,e.h);var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px"})),new s("http://www.w3.org/ns/ttml#styling fontFamily",(function(e,t,n,r){var i=[];for(var a in r)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);t.style.fontFamily=i.join(",")})),new s("http://www.w3.org/ns/ttml#styling shear",(function(e,t,n,r){if(0!==r){var i=-.9*r;"tb"===e.bpd?t.style.transform="skewX("+i+"deg)":t.style.transform="skewY("+i+"deg)"}})),new s("http://www.w3.org/ns/ttml#styling fontSize",(function(e,t,n,r){t.style.fontSize=r.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling fontStyle",(function(e,t,n,r){t.style.fontStyle=r})),new s("http://www.w3.org/ns/ttml#styling fontWeight",(function(e,t,n,r){t.style.fontWeight=r})),new s("http://www.w3.org/ns/ttml#styling lineHeight",(function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling opacity",(function(e,t,n,r){t.style.opacity=r})),new s("http://www.w3.org/ns/ttml#styling origin",(function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling overflow",(function(e,t,n,r){t.style.overflow=r})),new s("http://www.w3.org/ns/ttml#styling padding",(function(e,t,n,r){var i=[];i[0]=r[0].toUsedLength(e.w,e.h)+"px",i[1]=r[3].toUsedLength(e.w,e.h)+"px",i[2]=r[2].toUsedLength(e.w,e.h)+"px",i[3]=r[1].toUsedLength(e.w,e.h)+"px",t.style.padding=i.join(" ")})),new s("http://www.w3.org/ns/ttml#styling position",(function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling rubyAlign",(function(e,t,n,r){t.style.rubyAlign=r})),new s("http://www.w3.org/ns/ttml#styling rubyPosition",(function(e,t,n,r){var i;"before"!==r&&"after"!==r||(i="tb"===e.bpd||"rl"===e.bpd?"before"===r?"over":"under":"before"===r?"under":"over",t.parentElement.style.rubyPosition=i)})),new s("http://www.w3.org/ns/ttml#styling showBackground",null),new s("http://www.w3.org/ns/ttml#styling textAlign",(function(e,t,r,i){var a,o=r.styleAttrs[n.byName.direction.qname];a="start"===i?"rtl"===o?"right":"left":"end"===i?"rtl"===o?"left":"right":i,t.style.textAlign=a})),new s("http://www.w3.org/ns/ttml#styling textDecoration",(function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through")})),new s("http://www.w3.org/ns/ttml#styling textOutline",(function(e,t,n,r){})),new s("http://www.w3.org/ns/ttml#styling textShadow",(function(e,t,r,i){var a=r.styleAttrs[n.byName.textOutline.qname];if("none"===i&&"none"===a)t.style.textShadow="";else{var o=[];if("none"!==a&&o.push("rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+") 0px 0px "+a.thickness.toUsedLength(e.w,e.h)+"px"),"none"!==i)for(var s in i)o.push(i[s].x_off.toUsedLength(e.w,e.h)+"px "+i[s].y_off.toUsedLength(e.w,e.h)+"px "+i[s].b_radius.toUsedLength(e.w,e.h)+"px rgba("+i[s].color[0].toString()+","+i[s].color[1].toString()+","+i[s].color[2].toString()+","+(i[s].color[3]/255).toString()+")");t.style.textShadow=o.join(",")}})),new s("http://www.w3.org/ns/ttml#styling textCombine",(function(e,t,n,r){t.style.textCombineUpright=r.join(" ")})),new s("http://www.w3.org/ns/ttml#styling textEmphasis",(function(e,t,n,r){var i;"none"!==r.style?("auto"===r.style?t.style.textEmphasisStyle="filled":t.style.textEmphasisStyle=r.style+" "+r.symbol,("before"===r.position||"after"===r.position)&&(i="tb"===e.bpd?"before"===r.position?"left over":"left under":"rl"===e.bpd?"before"===r.position?"right under":"left under":"before"===r.position?"left under":"right under",t.style.textEmphasisPosition=i)):t.style.textEmphasisStyle="none"})),new s("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i})),new s("http://www.w3.org/ns/ttml#styling visibility",(function(e,t,n,r){t.style.visibility=r})),new s("http://www.w3.org/ns/ttml#styling wrapOption",(function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"})),new s("http://www.w3.org/ns/ttml#styling writingMode",(function(e,t,n,r){"lrtb"===r||"lr"===r||"rltb"===r||"rl"===r?e.writingMode="horizontal-tb":"tblr"===r?e.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(e.writingMode="vertical-rl"),t.style.writingMode=e.writingMode})),new s("http://www.w3.org/ns/ttml#styling zIndex",(function(e,t,n,r){t.style.zIndex=r})),new s("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden")}))],l={};for(var c in u)l[u[c].qname]=u[c]}(t,"undefined"==typeof imscNames?n(34):imscNames,"undefined"==typeof imscStyles?n(45):imscStyles,"undefined"==typeof imscUtils?n(35):imscUtils)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n)t+=e[n].uchar;return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function i(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(r,s,u,l){var c=null,d=!1,f=-1,h={start:s,end:u,spans:[]},p="style_cea608_white_black",g={},m={},v=[],y=void 0,E=void 0;for(y=0;y<15;++y){var T=l.rows[y],_="",b=null;if(!1===T.isEmpty()){var A=t(T.chars);null===c&&(c={x:A,y1:y,y2:y+1,p:[]}),A!==f&&d&&(c.p.push(h),h={start:s,end:u,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===g.hasOwnProperty(c.name)?(v.push(c),g[c.name]=c):g[c.name].p.contat(c.p),c={x:A,y1:y,y2:y+1,p:[]});for(var S=0;S<T.chars.length;++S){var w=T.chars[S],I=w.penState;if(null===b||!I.equals(b)){_.trim().length>0&&(h.spans.push({name:p,line:_,row:y}),_="");var R="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(R+="_underline"),I.italics&&(R+="_italics"),m.hasOwnProperty(R)||(m[R]=JSON.parse(JSON.stringify(I))),b=I,p=R}_+=w.uchar}_.trim().length>0&&h.spans.push({name:p,line:_,row:y}),d=!0,f=A}else d=!1,f=-1,c&&(c.p.push(h),h={start:s,end:u,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===g.hasOwnProperty(c.name)?(v.push(c),g[c.name]=c):g[c.name].p.contat(c.p),c=null)}c&&(c.p.push(h),c.y2=y+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===g.hasOwnProperty(c.name)?(v.push(c),g[c.name]=c):g[c.name].p.contat(c.p),c=null);var C=[];for(y=0;y<v.length;++y){var D=v[y],M="sub_cea608_"+e++,L=document.createElement("div");L.id=M;var N=n(D);L.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+N;var x=document.createElement("div");x.className="paragraph bodyStyle",x.style.cssText=i(r);var O=document.createElement("div");O.className="cueUniWrapper",O.style.cssText="unicode-bidi: normal; direction: ltr;";for(var P=0;P<D.p.length;++P){var k=D.p[P],F=0;for(E=0;E<k.spans.length;++E){var U=k.spans[E];if(U.line.length>0){if(0!==E&&F!=U.row){var B=document.createElement("br");B.className="lineBreak",O.appendChild(B)}var G=!1;F===U.row&&(G=!0),F=U.row;var j=m[U.name],H=document.createElement("span");H.className="spanPadding "+U.name+" customSpanColor",H.style.cssText=i(r,j),0!==E&&G?E===k.spans.length-1?H.textContent=o(U.line):H.textContent=U.line:k.spans.length>1&&E<k.spans.length-1&&U.row===k.spans[E+1].row?H.textContent=a(U.line):H.textContent=U.line.trim(),O.appendChild(H)}}}x.appendChild(O),L.appendChild(x);var K={bodyStyle:["%",90]};for(var Y in m)m.hasOwnProperty(Y)&&(K[Y]=["%",90]);C.push({type:"html",start:s,end:u,cueHTMLElement:L,cueID:M,cellResolution:[32,15],isFromCEA608:!0,fontSize:K,lineHeight:{},linePadding:{}})}return C}}}a.__dashjs_factory_name="EmbeddedTextHtmlRender",t.default=i.default.getSingletonFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e,t=this.context,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0;function u(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(a),n=t[1].split(s);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:c(n)}}function c(e){var t={};return e.forEach((function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}})),t}function d(e,t){for(var n,r=t,i="",o="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var s=0;s<n;s++){if((o=e[t+s]).match(a)){i="";break}i+=o,s!==n-1&&(i+="\n")}else(o=e[t]).match(a)||(i=o);return i}return e={parse:function(e){var t,i=[],s=void 0;if(!e)return i;t=(e=e.split(r)).length,s=-1;for(var c=0;c<t;c++){var f=e[c];if(f.length>0&&"WEBVTT"!==f&&f.match(a)){var h=l(f),p=h.cuePoints,g=h.styles,m=d(e,c+1),v=u(p[0].replace(o,"")),y=u(p[1].replace(o,""));!isNaN(v)&&!isNaN(y)&&v>=s&&y>v?""!==m?(s=v,i.push({start:v,end:y,data:m,styles:g})):n.error("Skipping cue due to empty/malformed cue text"):n.error("Skipping cue due to incorrect cue timing")}}return i}},n=(0,i.default)(t).getInstance().getLogger(e),r=/(?:\r\n|\r|\n)/gm,a=/-->/,o=/(^[\s]+|[\s]+$)/g,s=/\s\b/g,e}o.__dashjs_factory_name="VTTParser",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(0)),i=c(n(2)),a=c(n(3)),o=c(n(4)),s=n(69),u=c(n(20)),l=c(n(76));function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e,t=this.context,n=(0,a.default)(t).getInstance(),r=void 0,c=0;return e={parse:function(e,t,i,a,d){var f="",h=[],p=void 0,g=void 0,m=void 0,v={},y={},E="",T="",_={onOpenTag:function(e,t,i){if(i[" imagetype"]&&!i[" imageType"]&&(n.trigger(u.default.CONFORMANCE_VIOLATION,{level:l.default.LEVELS.ERROR,event:l.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),i[" imageType"]=i[" imagetype"]),"image"===t&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!i[" imageType"]||"PNG"!==i[" imageType"].value)return void r.warn("smpte-tt imageType != PNG. Discarded");E=i["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){E&&(y[E]=T.trim()),T="",E=""},onText:function(e){E&&(T+=e)}};if(!e)throw f="no ttml data to parse",new Error(f);v.data=e,n.trigger(o.default.TTML_TO_PARSE,v);var b=(0,s.fromXML)(v.data,(function(e){f=e}),_);n.trigger(o.default.TTML_PARSED,{ttmlString:v.data,ttmlDoc:b});var A,S=b.getMediaTimeEvents();for(m=0;m<S.length;m++){var w=(0,s.generateISD)(b,S[m],(function(e){f=e}));w.contents.some((function(e){return e.contents.length}))&&(p=S[m]+t<i?i:S[m]+t)<(g=S[m+1]+t>a?a:S[m+1]+t)&&h.push({start:p,end:g,type:"html",cueID:(A="cue_TTML_"+c,c++,A),isd:w,images:d,embeddedImages:y})}if(""!==f)throw r.error(f),new Error(f);return h}},r=(0,i.default)(t).getInstance().getLogger(e),e}d.__dashjs_factory_name="TTMLParser",t.default=r.default.getSingletonFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t,n=this.context,i=void 0,a=void 0,o=[],s=e;function u(e,t){o=o.filter((function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))}))}return t={getAllBufferRanges:function(){for(var e=[],t=0;t<o.length;t++){var n=o[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var r={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(r,"length",{get:function(){return e.length}}),r},append:function(e){"InitializationSegment"!==e.segmentType?(o.push(e),o.sort((function(e,t){return e.start-t.start})),a=null):a=e,i.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),s&&s({chunk:e})},remove:u,abort:function(){},discharge:function(e,t){var n=function(e,t){return o.filter((function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)}))}(e,t);return a&&(n.push(a),a=null),u(e,t),n},reset:function(){o=[],a=null,s=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},i=(0,r.default)(n).getInstance().getLogger(t),t}o.__dashjs_factory_name="PreBufferSink";var s=i.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(0)),i=u(n(2)),a=u(n(11)),o=u(n(1)),s=u(n(9));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t,n=this.context,r=e.dashMetrics,u=void 0;return t={getMaxIndex:function(e){var t=(0,a.default)(n).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return t;!function(){if(!r||!r.hasOwnProperty("getCurrentBufferState"))throw new Error(o.default.MISSING_CONFIG_ERROR)}();var i=e.getMediaInfo(),l=e.getMediaType(),c=r.getCurrentBufferState(l),d=e.getScheduleController(),f=e.getAbrController(),h=e.getStreamInfo(),p=h&&h.manifestInfo?h.manifestInfo.isDynamic:null,g=f.getThroughputHistory(),m=g.getSafeAverageThroughput(l,p),v=g.getAverageLatency(l),y=e.useBufferOccupancyABR();return isNaN(m)||!c||y||f.getAbandonmentStateFor(l)!==s.default.ABANDON_LOAD&&(c.state===s.default.BUFFER_LOADED||p)&&(t.quality=f.getQualityForBitrate(i,m,v),d.setTimeToLoadDelay(0),u.debug("["+l+"] requesting switch to index: ",t.quality,"Average throughput",Math.round(m),"kbps"),t.reason={throughput:m,latency:v}),t},reset:function(){}},u=(0,i.default)(n).getInstance().getLogger(t),t}l.__dashjs_factory_name="ThroughputRule",t.default=r.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(3)),i=c(n(4)),a=c(n(0)),o=c(n(2)),s=c(n(11)),u=c(n(1)),l=c(n(9));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=(0,r.default)(t).getInstance(),a=e.dashMetrics,c=void 0,d=void 0,f=void 0;function h(){(f={})[u.default.VIDEO]={ignoreCount:2},f[u.default.AUDIO]={ignoreCount:2}}function p(){h()}function g(e){isNaN(e.startTime)||e.mediaType!==u.default.AUDIO&&e.mediaType!==u.default.VIDEO||f[e.mediaType].ignoreCount>0&&f[e.mediaType].ignoreCount--}return c={getMaxIndex:function(e){var n=(0,s.default)(t).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;!function(){if(!a||!a.hasOwnProperty("getCurrentBufferLevel")||!a.hasOwnProperty("getCurrentBufferState"))throw new Error(u.default.MISSING_CONFIG_ERROR)}();var r=e.getMediaType(),i=a.getCurrentBufferState(r),o=e.getRepresentationInfo().fragmentDuration;if(function(e){return f[e].ignoreCount>0}(r)||!o)return n;if(i&&i.state===l.default.BUFFER_EMPTY)d.debug("["+r+"] Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var c=e.getMediaInfo(),h=e.getAbrController(),p=h.getThroughputHistory(),g=a.getCurrentBufferLevel(r),m=p.getAverageThroughput(r),v=p.getAverageLatency(r),y=m*(g/o)*.5;n.quality=h.getQualityForBitrate(c,y,v),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n},reset:function(){h(),n.off(i.default.PLAYBACK_SEEKING,p,c),n.off(i.default.BYTES_APPENDED_END_FRAGMENT,g,c)}},d=(0,o.default)(t).getInstance().getLogger(c),h(),n.on(i.default.PLAYBACK_SEEKING,p,c),n.on(i.default.BYTES_APPENDED_END_FRAGMENT,g,c),c}d.__dashjs_factory_name="InsufficientBufferRule",t.default=a.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(11)),i=o(n(0)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t,n=this.context,i=e.mediaPlayerModel,o=e.dashMetrics,u=e.settings,l=void 0,c=void 0,d=void 0,f=void 0;function h(){c={},d={},f=[]}return t={shouldAbandon:function(e){var t=(0,r.default)(n).create(r.default.NO_CHANGE,{name:s.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var a,h,p=e.getMediaInfo(),g=e.getMediaType(),m=e.getCurrentRequest();if(!isNaN(m.index)){a=g,h=m.index,c[a]=c[a]||{},c[a][h]=c[a][h]||{};var v=i.getStableBufferTime();if(o.getCurrentBufferLevel(g)>v)return t;var y=c[g][m.index];if(null===y||null===m.firstByteDate||d.hasOwnProperty(y.id))return t;if(void 0===y.firstByteTime&&(f[g]=[],y.firstByteTime=m.firstByteDate.getTime(),y.segmentDuration=m.duration,y.bytesTotal=m.bytesTotal,y.id=m.index),y.bytesLoaded=m.bytesLoaded,y.elapsedTime=(new Date).getTime()-y.firstByteTime,y.bytesLoaded>0&&y.elapsedTime>0&&function(e,t){f[e]=f[e]||[],f[e].push(t)}(g,Math.round(8*y.bytesLoaded/y.elapsedTime)),f[g].length>=5&&y.elapsedTime>500&&y.bytesLoaded<y.bytesTotal){var E=f[g].reduce((function(e,t){return e+t}),0);if(y.measuredBandwidthInKbps=Math.round(E/f[g].length),y.estimatedTimeOfDownload=+(8*y.bytesTotal/y.measuredBandwidthInKbps/1e3).toFixed(2),y.estimatedTimeOfDownload<1.8*y.segmentDuration||0===e.getRepresentationInfo().quality)return t;if(!d.hasOwnProperty(y.id)){var T=e.getAbrController(),_=y.bytesTotal-y.bytesLoaded,b=T.getBitrateList(p),A=T.getQualityForBitrate(p,y.measuredBandwidthInKbps*u.get().streaming.abr.bandwidthSafetyFactor),S=T.getMinAllowedIndexFor(g),w=void 0!==S?Math.max(S,A):A;_>y.bytesTotal*b[w].bitrate/b[T.getQualityFor(g)].bitrate&&(t.quality=w,t.reason.throughput=y.measuredBandwidthInKbps,t.reason.fragmentID=y.id,d[y.id]=y,l.debug("["+g+"] frag id",y.id," is asking to abandon and switch to quality to ",w," measured bandwidth was",y.measuredBandwidthInKbps),delete c[g][y.id])}}else y.bytesLoaded===y.bytesTotal&&delete c[g][y.id]}return t},reset:h},l=(0,a.default)(n).getInstance().getLogger(t),h(),t}s.__dashjs_factory_name="AbandonRequestsRule",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(11)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e,t=this.context,n=void 0;return e={getMaxIndex:function(e){var r=(0,i.default)(t).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return r;var a=e.getDroppedFramesHistory();if(a){for(var o=a.getFrameHistory(),s=0,u=0,l=i.default.NO_CHANGE,c=1;c<o.length;c++)if(o[c]&&(s=o[c].droppedVideoFrames,(u=o[c].totalVideoFrames)>375&&s/u>.15)){l=c-1,n.debug("index: "+l+" Dropped Frames: "+s+" Total Frames: "+u);break}return(0,i.default)(t).create(l,{droppedFrames:s})}return r}},n=(0,a.default)(t).getInstance().getLogger(e),e}s.__dashjs_factory_name="DroppedFramesRule",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(2)),a=o(n(11));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e,t=this.context,n=void 0;return e={getMaxIndex:function(e){for(var r=e?e.getSwitchHistory():null,i=r?r.getSwitchRequests():[],o=0,s=0,u=0,l=(0,a.default)(t).create(),c=0;c<i.length;c++)if(void 0!==i[c]&&(o+=i[c].drops,s+=i[c].noDrops,u+=i[c].dropSize,o+s>=6&&o/s>.075)){l.quality=c>0&&i[c].drops>0?c-1:c,l.reason={index:l.quality,drops:o,noDrops:s,dropSize:u},n.debug("Switch history rule index: "+l.quality+" samples: "+(o+s)+" drops: "+o);break}return l}},n=(0,i.default)(t).getInstance().getLogger(e),e}s.__dashjs_factory_name="SwitchHistoryRule",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(9)),i=c(n(11)),a=c(n(0)),o=n(7),s=c(n(3)),u=c(n(4)),l=c(n(2));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=e.dashMetrics,a=e.mediaPlayerModel,c=(0,s.default)(t).getInstance(),d=void 0,f=void 0,h=void 0;function p(e,t,n){var r=n.reduce((function(e,t,r){return t>n[e]?r:e}),0);if(0===r)return null;var i=Math.max(e,10+2*t.length),a=(n[r]-1)/(i/10-1);return{gp:a,Vp:10/a}}function g(e){var t={},n=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),r=function(e){return e.map((function(e){return Math.log(e)}))}(n);r=r.map((function(e){return e-r[0]+1}));var i=a.getStableBufferTime(),o=p(i,n,r);return o?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=o.Vp,t.gp=o.gp,t.lastQuality=0,m(t)):t.state=0,t}function m(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function v(e,t){var r=a.getStableBufferTime();if(e.stableBufferTime!==r){var i=p(r,e.bitrates,e.utilities);if(i.Vp!==e.Vp||i.gp!==e.gp){var o=n.getCurrentBufferLevel(t),s=o+e.placeholderBuffer;s-=10,s*=i.Vp/e.Vp,s+=10,e.stableBufferTime=r,e.Vp=i.Vp,e.gp=i.gp,e.placeholderBuffer=Math.max(0,s-o)}}}function y(e,t){return e.Vp*(e.utilities[t]+e.gp)}function E(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,u)}return i}function T(){for(var e in h)h.hasOwnProperty(e)&&2===h[e].state&&(h[e].placeholderBuffer=0)}function _(){for(var e in h)if(h.hasOwnProperty(e)){var t=h[e];0!==t.state&&(t.state=1,m(t))}}function b(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=h[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,S(t,e.chunk.mediaInfo.type)}}}function A(e){if(e&&e.metric===r.default.HTTP_REQUEST&&e.value&&e.value.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=h[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),S(t,e.mediaType))}}function S(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var r=n.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),i=y(e,e.lastQuality),a=Math.max(0,i-r);e.placeholderBuffer=Math.min(a,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function w(e){if(e){var t=h[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function I(e){if(e){var t=h[e.mediaType];if(t&&0!==t.state){var r,i=n.getCurrentBufferLevel(e.mediaType);r=t.abrQuality>0?E(t,t.abrQuality):10;var a=Math.max(0,r-i);t.placeholderBuffer=Math.min(t.placeholderBuffer,a)}}}function R(){h={}}return d={getMaxIndex:function(e){var r=(0,i.default)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return r;var a=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),u=e.getStreamInfo(),l=e.getAbrController(),c=l.getThroughputHistory(),d=u?u.id:null,p=u&&u.manifestInfo&&u.manifestInfo.isDynamic,T=e.useBufferOccupancyABR();if(r.reason=r.reason||{},!T)return r;s.setTimeToLoadDelay(0);var _=function(e){var t=e.getMediaType(),n=h[t];return n?0!==n.state&&v(n,t):(n=g(e),h[t]=n),n}(e);if(0===_.state)return r;var b=n.getCurrentBufferLevel(o),A=c.getAverageThroughput(o,p),S=c.getSafeAverageThroughput(o,p),w=c.getAverageLatency(o),I=void 0;if(r.reason.state=_.state,r.reason.throughput=A,r.reason.latency=w,isNaN(A))return r;switch(_.state){case 1:I=l.getQualityForBitrate(a,S,w),r.quality=I,r.reason.throughput=S,_.placeholderBuffer=Math.max(0,E(_,I)-b),_.lastQuality=I,!isNaN(_.lastSegmentDurationS)&&b>=_.lastSegmentDurationS&&(_.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,v(e,t)}(_,o),I=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a)}return r}(_,b+_.placeholderBuffer);var R=l.getQualityForBitrate(a,S,w);I>_.lastQuality&&I>R&&(I=Math.max(R,_.lastQuality));var C=Math.max(0,b+_.placeholderBuffer-y(_,I));C<=_.placeholderBuffer?(_.placeholderBuffer-=C,C=0):(C-=_.placeholderBuffer,_.placeholderBuffer=0,I<l.getTopQualityIndexFor(o,d)?s.setTimeToLoadDelay(1e3*C):C=0),r.quality=I,r.reason.throughput=A,r.reason.latency=w,r.reason.bufferLevel=b,r.reason.placeholderBuffer=_.placeholderBuffer,r.reason.delay=C,_.lastQuality=I;break;default:f.debug("BOLA ABR rule invoked in bad state."),r.quality=l.getQualityForBitrate(a,S,w),r.reason.state=_.state,r.reason.throughput=S,r.reason.latency=w,_.state=1,m(_)}return r},reset:function(){R(),c.off(u.default.BUFFER_EMPTY,T,d),c.off(u.default.PLAYBACK_SEEKING,_,d),c.off(u.default.MEDIA_FRAGMENT_LOADED,b,d),c.off(u.default.METRIC_ADDED,A,d),c.off(u.default.QUALITY_CHANGE_REQUESTED,w,d),c.off(u.default.FRAGMENT_LOADING_ABANDONED,I,d)}},f=(0,l.default)(t).getInstance().getLogger(d),R(),c.on(u.default.BUFFER_EMPTY,T,d),c.on(u.default.PLAYBACK_SEEKING,_,d),c.on(u.default.MEDIA_FRAGMENT_LOADED,b,d),c.on(u.default.METRIC_ADDED,A,d),c.on(u.default.QUALITY_CHANGE_REQUESTED,w,d),c.on(u.default.FRAGMENT_LOADING_ABANDONED,I,d),d}d.__dashjs_factory_name="BolaRule",t.default=a.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(9)),i=d(n(11)),a=d(n(0)),o=n(7),s=d(n(3)),u=d(n(4)),l=d(n(2)),c=d(n(1));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=e.dashMetrics,a=(0,s.default)(t).getInstance(),d=void 0,f=void 0,h=void 0,p=void 0;function g(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function m(){for(var e in f)if(f.hasOwnProperty(e)){var t=f[e];0!==t.state&&(t.state=1,g(t))}}function v(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=f[e.chunk.mediaInfo.type],n=h[e.chunk.mediaInfo.type];if(t&&0!==t.state){var r=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,E(t,n)}}}function y(e){if(e&&e.metric===r.default.HTTP_REQUEST&&e.value&&e.value.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=f[e.mediaType],n=h[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),E(t,n))}}function E(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function T(e){if(e&&e.mediaType){var t=f[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function _(e,t){if(e.length!==t.length)return-1;for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function b(){f={},h={}}return d={getMaxIndex:function(e){var r=(0,i.default)(t).create(),a=Math.pow(4,.99),o=Math.max(Math.pow(4,1),a*Math.sqrt(4)),s=e.getMediaInfo(),u=e.getMediaType(),l=s.bitrateList.map((function(e){return e.bandwidth})),d=l.length,m=e.getScheduleController(),v=e.getStreamInfo(),y=e.getAbrController(),E=y.getThroughputHistory(),T=v&&v.manifestInfo&&v.manifestInfo.isDynamic,b=e.useL2AABR(),A=n.getCurrentBufferLevel(u,!0),S=E.getSafeAverageThroughput(u,T),w=E.getAverageThroughput(u,T),I=E.getAverageLatency(u),R=void 0,C=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return r;if(r.reason=r.reason||{},!b||u===c.default.AUDIO)return r;m.setTimeToLoadDelay(0);var D=function(e){var t=e.getMediaType(),n=f[t];return n||(n=function(e){var t={},n=e.getMediaInfo(),r=n.bitrateList.map((function(e){return e.bandwidth/1e3}));return t.state=1,t.bitrates=r,t.lastQuality=0,function(e){e&&e.type&&(h[e.type]={},h[e.type].w=[],h[e.type].prev_w=[],h[e.type].Q=0,h[e.type].segment_request_start_s=0,h[e.type].segment_download_finish_s=0,h[e.type].B_target=1.5)}(n),g(t),t}(e),f[t]=n),n}(e);if(0===D.state)return r;var M=h[u];if(!M)return r;if(r.reason.state=D.state,r.reason.throughput=w,r.reason.latency=I,isNaN(w))return r;switch(D.state){case 1:if(R=y.getQualityForBitrate(s,S,I),r.quality=R,r.reason.throughput=S,D.lastQuality=R,!isNaN(D.lastSegmentDurationS)&&A>=M.B_target){D.state=2,M.Q=a;for(var L=0;L<d;++L)L===D.lastQuality?M.prev_w[L]=1:M.prev_w[L]=0}break;case 2:var N=[],x=n.getCurrentHttpRequest(u).trace.reduce((function(e,t){return e+t.d}),0),O=n.getCurrentHttpRequest(u).trace.reduce((function(e,t){return e+t.b[0]}),0),P=Math.round(8*O/x);P<1&&(P=1);for(var k=D.lastSegmentDurationS,F=1,U=0;U<d;++U)l[U]=l[U]/1e3,C*l[U]>P&&(F=-1),M.w[U]=M.prev_w[U]+F*(k/(2*o))*((M.Q+a)*(C*l[U]/P));M.w=function(e){for(var t=e.length,n=!1,r=[],i=0;i<t;++i)r[i]=e[i];for(var a=e.sort((function(e,t){return t-e})),o=0,s=0,u=[],l=0;l<t-1;++l)if((s=((o+=a[l])-1)/(l+1))>=a[l+1]){n=!0;break}n||(s=(o+a[t-1]-1)/t);for(var c=0;c<t;++c)u[c]=Math.max(r[c]-s,0);return u}(M.w);for(var B=0;B<d;++B)N[B]=M.w[B]-M.prev_w[B],M.prev_w[B]=M.w[B];M.Q=Math.max(0,M.Q-k+k*C*((_(l,M.prev_w)+_(l,N))/P));for(var G=[],j=0;j<d;++j)G[j]=Math.abs(l[j]-_(M.w,l));(R=G.indexOf(Math.min.apply(Math,G)))>D.lastQuality&&l[D.lastQuality+1]<=P&&(R=D.lastQuality+1),l[R]>=P&&(M.Q=2*Math.max(a,M.Q)),r.quality=R,r.reason.throughput=w,r.reason.latency=I,r.reason.bufferLevel=A,D.lastQuality=r.quality;break;default:p.debug("L2A ABR rule invoked in bad state."),r.quality=y.getQualityForBitrate(s,S,I),r.reason.state=D.state,r.reason.throughput=S,r.reason.latency=I,D.state=1,g(D)}return r},reset:function(){b(),a.off(u.default.PLAYBACK_SEEKING,m,d),a.off(u.default.MEDIA_FRAGMENT_LOADED,v,d),a.off(u.default.METRIC_ADDED,y,d),a.off(u.default.QUALITY_CHANGE_REQUESTED,T,d)}},p=(0,l.default)(t).getInstance().getLogger(d),b(),a.on(u.default.PLAYBACK_SEEKING,m,d),a.on(u.default.MEDIA_FRAGMENT_LOADED,v,d),a.on(u.default.METRIC_ADDED,y,d),a.on(u.default.QUALITY_CHANGE_REQUESTED,T,d),d}f.__dashjs_factory_name="L2ARule",t.default=a.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(2)),i=d(n(0)),a=d(n(142)),o=d(n(143)),s=d(n(11)),u=d(n(9)),l=d(n(145)),c=d(n(1));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){var t,n=(e=e||{}).dashMetrics,i=this.context,d=void 0,f=void 0,h=void 0;return t={getMaxIndex:function(e){try{var t=(0,s.default)(i).create(),r=e.getMediaInfo().type,a=e.getAbrController(),o=e.getStreamInfo(),p=a.getQualityFor(r,o),g=e.getMediaInfo(),m=n.getCurrentBufferState(r),v=e.getScheduleController(),y=n.getCurrentBufferLevel(r,!0),E=o&&o.manifestInfo?o.manifestInfo.isDynamic:null,T=v.getPlaybackController(),_=T.getCurrentLiveLatency();if(!e.useLoLPABR()||r===c.default.AUDIO)return t;_||(_=0);var b=T.getPlaybackRate(),A=a.getThroughputHistory().getSafeAverageThroughput(r,E);if(d.debug("Throughput "+Math.round(A)+" kbps"),isNaN(A)||!m)return t;if(a.getAbandonmentStateFor(r)===u.default.ABANDON_LOAD)return t;for(var S=g.bitrateList,w=e.getRepresentationInfo().fragmentDuration,I=S[0].bandwidth/1e3,R=S[S.length-1].bandwidth/1e3,C=0;C<S.length;C++){var D=S[C].bandwidth/1e3;D>R?R=D:D<I&&(I=D)}var M=S[p].bandwidth/1e3,L=n.getCurrentHttpRequest(r,!0),N=(L.tresponse.getTime()-L.trequest.getTime())/1e3,x=N>w?N-w:0;h.setupPerSegmentQoe(w,R,I),h.logSegmentMetrics(M,x,_,b);var O=(0,l.default)(i).create({targetLatency:1.5,bufferMin:.3,segmentDuration:w,qoeEvaluator:h});return t.quality=f.getNextQuality(g,1e3*A,_,y,b,p,O),t.reason={throughput:A,latency:_},t.priority=s.default.PRIORITY.STRONG,v.setTimeToLoadDelay(0),t.quality!==p&&console.log("[TgcLearningRule]["+r+"] requesting switch to index: ",t.quality,"Average throughput",Math.round(A),"kbps"),t}catch(e){throw e}},reset:function(){f.reset(),h.reset()}},d=(0,r.default)(i).getInstance().getLogger(t),f=(0,a.default)(i).create(),h=(0,o.default)(i).create(),t}f.__dashjs_factory_name="LoLPRule",t.default=i.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}var o="dynamic_weight_selection";function s(){var e,t=this.context,n=void 0,r=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0;function f(){r=null,a=1,s=100,u=0,l=null,c=null,d=o}function h(){var e=0;if(r)for(var t=0;t<r.length;t++){var n=r[t];n.state.throughput>e&&(e=n.state.throughput)}return e}function p(e,t,n){var r=e.map((function(e,r){return n[r]*Math.pow(e-t[r],2)})).reduce((function(e,t){return e+t}));return(r<0?-1:1)*Math.sqrt(Math.abs(r))}function g(e,t){return p([e.state.throughput,e.state.latency,e.state.rebuffer,e.state.switch],[t.state.throughput,t.state.latency,t.state.rebuffer,t.state.switch],[1,1,1,1])}function m(e,t,n){for(var r=0;r<t.length;r++){var i=t[r],a=g(i,e);v(i,n,Math.exp(-1*Math.pow(a,2)/(2*Math.pow(.1,2))))}}function v(e,t,n){var r=e.state,i=[.01,.01,.01,.01];r.throughput=r.throughput+(t[0]-r.throughput)*i[0]*n,r.latency=r.latency+(t[1]-r.latency)*i[1]*n,r.rebuffer=r.rebuffer+(t[2]-r.rebuffer)*i[2]*n,r.switch=r.switch+(t[3]-r.switch)*i[3]*n}function y(e,t,n,r,i,a,o){l||(l=c[c.length-1]);var s=e.findWeightVector(t,n,r,i,a,o);null!==s&&-1!==s&&(l=s)}return e={getNextQuality:function(e,t,i,f,g,v,E){var T=i,_=f,b=t,A=function(e){if(!r){r=[];var t=e.bitrateList,n=[];u=t[0].bandwidth,t.forEach((function(e){n.push(e.bandwidth),e.bandwidth<u&&(u=e.bandwidth)})),s=n.map((function(e){return Math.pow(e,2)})).reduce((function(e,t){return e+t})),a=Math.sqrt(s);for(var i=0;i<t.length;i++){var o={qualityIndex:i,bitrate:t[i].bandwidth,state:{throughput:t[i].bandwidth/a,latency:0,rebuffer:0,switch:0}};r.push(o)}c=function(e){var t=[],n=function(e){for(var t=[],n=0;n<e;n++){var r=[Math.random()*h(),Math.random(),Math.random(),Math.random()];t.push(r)}return t}(Math.pow(e.length,2));t.push(n[0]);for(var r=[1,1,1,1],i=1;i<e.length;i++){for(var a=null,o=null,s=0;s<n.length;s++){for(var u=n[s],l=null,c=0;c<t.length;c++){var d=p(u,t[c],r);(null===l||d<l)&&(l=d)}(null===o||l>o)&&(a=u,o=l)}t.push(a)}for(var f=null,g=null,m=0;m<t.length;m++){for(var v=0,y=0;y<t.length;y++)m!==y&&(v+=p(t[m],t[y],r));(null===f||v>f)&&(f=v,g=m)}var E=[];for(E.push(t[g]),t.splice(g,1);t.length>0;){for(var T=null,_=null,b=0;b<t.length;b++){var A=p(E[0],t[b],r);(null===T||A<T)&&(T=A,_=b)}E.push(t[_]),t.splice(_,1)}return E}(r)}var s;return r}(e),S=t/a;S>1&&(S=h()),i/=s,n.debug("getNextQuality called throughput:"+S+" latency:"+i+" bufferSize:"+f+" currentQualityIndex:"+v+" playbackRate:"+g);var w=A[v],I=w.bitrate*E.getSegmentDuration()/b,R=Math.max(0,I-_);if(_-I<E.getMinBuffer())return n.debug("Buffer is low for bitrate= "+w.bitrate+" downloadTime="+I+" currentBuffer="+_+" rebuffer="+R),function(e,t){var n=0,i=e;if(r)for(var a=0;a<r.length;a++){var o=r[a];o.bitrate<e.bitrate&&o.bitrate>n&&t>o.bitrate&&(n=o.bitrate,i=o)}return i}(w,b).qualityIndex;switch(d){case"manual_weight_selection":l=[.4,.4,.4,.4];break;case"random_weight_selection":!function(e){l=function(e,t){for(var n=[],r=Math.sqrt(2/e),i=0;i<4;i++)n.push(Math.random()*r);return l=n}(e.length)}(A);break;case o:y(E,A,T,_,R,b,g);break;default:y(E,A,T,_,R,b,g)}for(var C=null,D=null,M=null,L=0;L<A.length;L++){var N=A[L],x=N.state,O=[x.throughput,x.latency,x.rebuffer,x.switch],P=l.slice(),k=E.getNextBufferWithBitrate(N.bitrate,_,b),F=k<E.getMinBuffer();F&&n.debug("Buffer is low for bitrate="+N.bitrate+" downloadTime="+I+" currentBuffer="+_+" nextBuffer="+k),(N.bitrate>t-1e4||F)&&N.bitrate!==u&&(P[0]=100);var U=p(O,[S,0,0,0],P);(null===C||U<C)&&(C=U,D=N.qualityIndex,M=N)}var B=Math.abs(w.bitrate-M.bitrate)/a;return m(w,A,[S,i,R,B]),m(M,A,[S,0,0,B]),D},reset:function(){f()}},n=(0,i.default)(t).getInstance().getLogger(e),f(),e}s.__dashjs_factory_name="LearningAbrController",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(144));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e,t=void 0,n=void 0,r=void 0,a=void 0;function o(){t=null,n=null,r=null,a=null}function s(e,t,n,r){var a=new i.default;return a.type=e,a.weights.bitrateReward=t||1,a.weights.bitrateSwitchPenalty=1,a.weights.rebufferPenalty=n||1e3,a.weights.latencyPenalty=[],a.weights.latencyPenalty.push({threshold:1.1,penalty:.05*r}),a.weights.latencyPenalty.push({threshold:1e8,penalty:.1*n}),a.weights.playbackSpeedPenalty=r||200,a}function u(e,t,n,r,i){i.bitrateWSum+=i.weights.bitrateReward*e,i.lastBitrate&&(i.bitrateSwitchWSum+=i.weights.bitrateSwitchPenalty*Math.abs(e-i.lastBitrate)),i.lastBitrate=e,i.rebufferWSum+=i.weights.rebufferPenalty*t;for(var a=0;a<i.weights.latencyPenalty.length;a++){var o=i.weights.latencyPenalty[a];if(n<=o.threshold){i.latencyWSum+=o.penalty*n;break}}i.playbackSpeedWSum+=i.weights.playbackSpeedPenalty*Math.abs(1-r),i.totalQoe=i.bitrateWSum-i.bitrateSwitchWSum-i.rebufferWSum-i.latencyWSum-i.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,i,o){t=s("segment",e,i,o),n=e,r=i,a=o},logSegmentMetrics:function(e,n,r,i){t&&u(e,n,r,i,t)},getPerSegmentQoe:function(){return t},calculateSingleUseQoe:function(e,t,i,o){var l=null;return n&&r&&a&&(l=s("segment",n,r,a)),l?(u(e,t,i,o,l),l.totalQoe):0},reset:function(){o()}},o(),e}o.__dashjs_factory_name="LoLpQoeEvaluator",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(e){var t,n,r=e.targetLatency,i=e.bufferMin,a=e.segmentDuration,o=e.qoeEvaluator,s=void 0,u=void 0;function l(){return a}function c(e,t){var n=l();return t>n?e-n:e+n-t}return t={getMinBuffer:function(){return i},getSegmentDuration:l,getNextBufferWithBitrate:function(e,t,n){return c(t,e*a/n)},getNextBuffer:c,findWeightVector:function(e,t,n,l,d,f){var h=null,p=null,g=null,m=Math.abs(t-u);return e.forEach((function(e){s.forEach((function(s){s[0];var u=s[1],l=s[2],v=(s[3],e.bitrate*a/d),y=c(n,v),E=(0===l?10:1/l)*Math.max(1e-5,v-y),T=(0===u?10:1/u)*e.state.latency,_=o.calculateSingleUseQoe(e.bitrate,E,T,f);(null===h||_>h)&&function(e,t,n){return!(e>r+n)&&t>=i}(t,y,m)&&(h=_,p=s,g=e.bitrate)}))})),null===p&&null===g&&(p=-1),u=t,p}},s=function e(t,r,i){if(i===r)return t;for(var a=t.length,o=0;o<a;o++)for(var s=t.shift(),u=0;u<n.length;u++)t.push(s.concat(n[u]));return e(t,r,i+1)}((n=[.2,.4,.6,.8,1]).map((function(e){return[e]})),4,1),u=0,t}a.__dashjs_factory_name="LoLpWeightSelector",t.default=i.default.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,u=e.streamProcessor?e.streamProcessor.getScheduleController():null,l=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel?e.videoModel:null;function d(){return l?l.mediaInfo:null}return{getMediaType:function(){var e=d();return e?e.type:null},getMediaInfo:d,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=d();return e?e.streamInfo:null},getScheduleController:function(){return u},getAbrController:function(){return t},getRepresentationInfo:function(){return l},useBufferOccupancyABR:function(){return a},useL2AABR:function(){return o},useLoLPABR:function(){return s},getVideoModel:function(){return c}}}a.__dashjs_factory_name="RulesContext",t.default=i.default.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(11));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=[],t=[];return{push:function(n){n.newValue===i.default.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var r=n.newValue-n.oldValue,a=r<0?1:0,o=a?-r:0,s=a?0:1;if(e[n.oldValue].drops+=a,e[n.oldValue].dropSize+=o,e[n.oldValue].noDrops+=s,t.push({idx:n.oldValue,noDrop:s,drop:a,dropSize:o}),t.length>8){var u=t.shift();e[u.idx].drops-=u.drop,e[u.idx].dropSize-=u.dropSize,e[u.idx].noDrops-=u.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}o.__dashjs_factory_name="SwitchRequestHistory";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(){var e=[],t=0,n=0;return{push:function(r,i){var a=i&&i.droppedVideoFrames?i.droppedVideoFrames:0,o=i&&i.totalVideoFrames?i.totalVideoFrames:0,s=a-t;t=a;var u=o-n;n=o,isNaN(r)||(e[r]?(e[r].droppedVideoFrames+=s,e[r].totalVideoFrames+=u):e[r]={droppedVideoFrames:s,totalVideoFrames:u})},getFrameHistory:function(){return e},reset:function(r){e=[],t=r.droppedVideoFrames,n=r.totalVideoFrames}}}a.__dashjs_factory_name="DroppedFramesHistory";var o=i.default.getClassFactory(a);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(1)),i=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).settings,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0;function u(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function l(e,u,l){return t.get().streaming.abr.movingAverageMethod!==r.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?s.throughputHalfLife:s.latencyHalfLife,r=e?a[t]:o[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),u=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,u):Math.max(i,u)}(e,u):function(e,t,r){var a=function(e,t,r){var a=void 0,o=void 0;if(e?(a=n[t],o=r?3:4):(a=i[t],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var u=a[a.length-s]/a[a.length-s-1];if((u>=1.3||u<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,t,r),o=(e?n:i)[t];return 0!==a&&o&&0!==o.length?(o=o.slice(-a)).reduce((function(e,t){return e+t}))/o.length:NaN}(e,u,l)}function c(e,t){return l(!0,e,t)}function d(e){n[e]=n[e]||[],i[e]=i[e]||[],a[e]=a[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},o[e]=o[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function f(){n={},i={},a={},o={}}var h={push:function(e,l,c){if(l.trace&&l.trace.length){var f,h=l.tresponse.getTime()-l.trequest.getTime()||1,p=l._tfinish.getTime()-l.tresponse.getTime()||1,g=l.trace.reduce((function(e,t){return e+t.b[0]}),0);f=t.get().streaming.lowLatencyEnabled?l.trace.reduce((function(e,t){return e+t.d}),0):c?p:h+p;var m=Math.round(8*g/f);if(d(e),function(e,n,i){return e===r.default.VIDEO?i<t.get().streaming.cacheLoadThresholds[r.default.VIDEO]:e===r.default.AUDIO?i<t.get().streaming.cacheLoadThresholds[r.default.AUDIO]:void 0}(e,0,p)){if(n[e].length>0&&!n[e].hasCachedEntries)return;n[e].hasCachedEntries=!0}else n[e]&&n[e].hasCachedEntries&&function(e){delete n[e],delete i[e],delete a[e],delete o[e],d(e)}(e);n[e].push(m),n[e].length>20&&n[e].shift(),i[e].push(h),i[e].length>20&&i[e].shift(),u(a[e],m,.001*p,s.throughputHalfLife),u(o[e],h,1,s.latencyHalfLife)}},getAverageThroughput:c,getSafeAverageThroughput:function(e,n){var r=c(e,n);return isNaN(r)||(r*=t.get().streaming.abr.bandwidthSafetyFactor),r},getAverageLatency:function(e){return l(!1,e)},reset:f};return s={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},f(),h}o.__dashjs_factory_name="ThroughputHistory",t.default=i.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),i=s(n(0)),a=s(n(66)),o=s(n(151));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t,n=this.context,i=void 0;function s(){return i.getBuffer()}return t={getBufferControllerType:function(){return i.getBufferControllerType()},initialize:function(e,t){return i.initialize(e,t)},createBuffer:function(e,t){return i.createBuffer(e,t)},getType:function(){return i.getType()},getBuffer:s,setBuffer:function(e){i.setBuffer(e)},getBufferLevel:function(){return i.getBufferLevel()},setMediaSource:function(e){i.setMediaSource(e)},getMediaSource:function(){return i.getMediaSource()},getIsBufferingCompleted:function(){return i.getIsBufferingCompleted()},getIsPruningInProgress:function(){return i.getIsPruningInProgress()},dischargePreBuffer:function(){return i.dischargePreBuffer()},appendInitSegment:function(e){i.appendInitSegment(e)},getRangeAt:function(e){return i.getRangeAt(e)},reset:function(e){i.reset(e)},updateTimestampOffset:function(e){var t=s();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e)},updateAppendWindow:function(){i.updateAppendWindow()},getRepresentationInfo:function(e){return i.getRepresentationInfo(e)}},i=e.type===r.default.FRAGMENTED_TEXT?(0,a.default)(n).create({streamInfo:e.streamInfo,type:e.type,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,fragmentModel:e.fragmentModel,errHandler:e.errHandler,mediaController:e.mediaController,representationController:e.representationController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,settings:e.settings}):(0,o.default)(n).create({streamInfo:e.streamInfo,type:e.type,mimeType:e.mimeType,fragmentModel:e.fragmentModel,errHandler:e.errHandler}),t}u.__dashjs_factory_name="TextBufferController",t.default=i.default.getClassFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(1)),i=f(n(3)),a=f(n(4)),o=f(n(0)),s=f(n(51)),u=f(n(67)),l=f(n(42)),c=f(n(6)),d=f(n(10));function f(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=(0,i.default)(t).getInstance(),o=(0,l.default)(t).getInstance(),f=e.errHandler,h=e.streamInfo,p=e.type,g=e.mimeType,m=e.fragmentModel,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0;function A(e){T=e}function S(e){null===b.extract(h.id,e.currentRepresentation.id)&&(y=!1,n.trigger(a.default.INIT_FRAGMENT_NEEDED,{representationId:e.currentRepresentation.id,sender:v},{streamId:h.id,mediaType:p}))}function w(e){e.chunk.bytes&&(b.save(e.chunk),_.append(e.chunk),y=!0,n.trigger(a.default.STREAM_COMPLETED,{request:e.request},{streamId:h.id,mediaType:p}))}return v={getBufferControllerType:function(){return"NotFragmentedTextBufferController"},initialize:function(e){A(e),b=(0,s.default)(t).getInstance()},createBuffer:function(e){var n=e[0];try{if(_=(0,u.default)(t).create(T,n),!E){var i=_.getBuffer();i.hasOwnProperty(r.default.INITIALIZE)&&i.initialize(g,h,e,m),E=!0}return _}catch(e){if(n&&(n.isText||-1!==n.codec.indexOf('codecs="stpp')||-1!==n.codec.indexOf('codecs="wvtt')))try{_=o.getTextSourceBuffer()}catch(e){f.error(new c.default(d.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,d.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p+" : "+e.message))}else f.error(new c.default(d.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,d.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p))}},getStreamId:function(){return h.id},getType:function(){return p},getBuffer:function(){return _},getBufferLevel:function(){return 0},setMediaSource:A,getMediaSource:function(){return T},getIsBufferingCompleted:function(){return y},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},appendInitSegment:function(e){return null!==b.extract(h.id,e)},getRangeAt:function(){return null},reset:function(e){n.off(a.default.DATA_UPDATE_COMPLETED,S,v),n.off(a.default.INIT_FRAGMENT_LOADED,w,v),!e&&_&&(_.abort(),_.reset(),_=null)},updateTimestampOffset:function(e){_.timestampOffset===e||isNaN(e)||(_.timestampOffset=e)}},E=!1,T=null,y=!1,n.on(a.default.DATA_UPDATE_COMPLETED,S,v),n.on(a.default.INIT_FRAGMENT_LOADED,w,v),v}h.__dashjs_factory_name="NotFragmentedTextBufferController",t.default=o.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(1)),i=d(n(9)),a=d(n(153)),o=d(n(26)),s=d(n(3)),u=d(n(4)),l=d(n(0)),c=d(n(2));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=(0,s.default)(t).getInstance(),l=e.adapter,d=e.dashMetrics,f=e.mediaPlayerModel,h=e.fragmentModel,p=e.abrController,g=e.playbackController,m=e.textController,v=e.type,y=e.mimeType,E=e.mediaController,T=e.bufferController,_=e.settings,b=void 0,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0,M=void 0,L=void 0,N=void 0,x=void 0,O=void 0,P=void 0,k=void 0,F=void 0,U=void 0,B=void 0,G=void 0,j=void 0,H=void 0;function K(){return!1===R}function Y(){A&&(K()||w&&!T.getIsBufferingCompleted()&&(S.debug("Schedule Controller starts"),R=!1,d.createPlaylistTraceMetrics(w.id,1e3*g.getTime(),g.getPlaybackRate()),I&&(I=!1),W(0)))}function V(){R||(S.debug("Schedule Controller stops"),S.debug(v+" Schedule Controller stops"),R=!0,clearTimeout(M))}function q(){if(A)if(R||C||g.isPaused()&&!_.get().streaming.scheduleWhilePaused||(v===r.default.FRAGMENTED_TEXT||v===r.default.TEXT)&&!m.isTextEnabled()||T.getIsBufferingCompleted())V();else{!function(){if(isNaN(L)&&k){var e=g.getTime(),t=1.5;if(isNaN(k.fragmentDuration)){var n=d.getCurrentSchedulingInfo(w.mediaInfo.type);t=n?1.5*n.duration:1.5}var a=h.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(a&&-1===F.indexOf(a)&&!l.getIsTextTrack(y)){var s=_.get().streaming.fastSwitchEnabled,u=T.getBufferLevel(),c=p.getAbandonmentStateFor(v),f=!E.isCurrentTrack(a.mediaInfo)&&E.getSwitchMode(a.mediaInfo.type)===r.default.TRACK_SWITCH_MODE_NEVER_REPLACE,m=a.quality<k.quality;s&&(f||m)&&u>=t&&c!==i.default.ABANDON_LOAD?(X(a),H=!0,S.debug("Reloading outdated fragment at index: ",a.index)):a.quality>k.quality&&!B&&ce(g.getTime()+u)}}}();var e=F.length>0,t=k?k.quality:NaN;B||isNaN(t)||U||e||function(e,t){P[t]=P[t]||{};var n=p.getTopQualityIndexFor(e,t);return P[t][e]!=n&&(S.info("Top quality "+e+" index has changed from "+P[t][e]+" to "+n),P[t][e]=n,!0)}(v,A.id)||x.execute(v,w,N)?(z(!0),!e&&j&&p.checkPlaybackQuality(v),function(){if(w.quality===t&&!U||B){var e=F.shift();e&&e.isInitializationRequest()?(n.trigger(u.default.INIT_FRAGMENT_NEEDED,{representationId:e.representationId,sender:b},{streamId:A.id,mediaType:v}),j=!1):(n.trigger(u.default.MEDIA_FRAGMENT_NEEDED,{seekTarget:L,replacement:e},{streamId:A.id,mediaType:v}),j=!0)}else U?(S.debug("Switch track for "+v+", representation id = "+w.id),(B=E.getSwitchMode(v)===r.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE)&&T.replaceBuffer&&T.replaceBuffer(),U=!1):S.debug("Quality has changed, get init request for representationid = "+w.id),n.trigger(u.default.INIT_FRAGMENT_NEEDED,{representationId:w.id,sender:b},{streamId:A.id,mediaType:v}),j=!1}()):W(500)}}function W(e){clearTimeout(M),M=setTimeout(q,e)}function z(e){C!==e?C=e:S.debug("isFragmentProcessingInProgress is already equal to",e)}function X(e){F.push(e)}function Q(e){if(g&&h){var t=h.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:g.getTime(),threshold:0})[0];t&&g.getTime()>=t.startTime&&((!O.mediaInfo||t.mediaInfo.type===O.mediaInfo.type&&t.mediaInfo.id!==O.mediaInfo.id)&&e&&n.trigger(u.default.TRACK_CHANGE_RENDERED,{mediaType:v,oldMediaInfo:O.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===O.quality&&t.adaptationIndex===O.adaptationIndex||!e||n.trigger(u.default.QUALITY_CHANGE_RENDERED,{mediaType:v,oldQuality:O.quality,newQuality:t.quality}),O={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function J(){V(),z(!1),S.info("Stream "+A.id+" is complete")}function Z(e){e.request.mediaInfo.streamInfo.id===A.id&&e.request.mediaType===v&&(S.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),l.getIsTextTrack(y)&&z(!1),e.error&&e.request.serviceLocation&&!R&&(X(e.request),z(!1),W(0)),B&&(G=e.request))}function $(){Q(!0)}function ee(e){if(B&&!isNaN(e.startTime)&&(B=!1,h.addExecutedRequest(G)),z(!1),isNaN(e.index)&&(k=T.getRepresentationInfo(e.quality),S.info("["+v+"] lastInitializedRepresentationInfo changed to "+e.quality)),H&&!isNaN(e.startTime)){var t=g.getTime(),n=e.startTime+w.fragmentDuration,r=1.5*w.fragmentDuration;W(t+r>=n?0:1e3*(n-(t+r))),H=!1}else W(0)}function te(e){S.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),g.isSeeking()||U||(S.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),X(e.request)),z(!1),W(0)}function ne(){}function re(){V()}function ie(e){B&&_.get().streaming.flushBufferAtTrackSwitch&&g.seek(g.getTime()+.001,!1,!0),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&Y()}function ae(){V(),z(!1)}function oe(){h.abortRequests(),V()}function se(){!R&&_.get().streaming.scheduleWhilePaused||Y()}function ue(e){if(A){ce(e.seekTime),de(0),R&&Y();var t=w&&w.DVRWindow&&g?w.DVRWindow.end-g.getTime():NaN;d.updateManifestUpdateInfo({latency:t}),C?h.abortRequests():W(0)}}function le(e){d.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function ce(e){L=e}function de(e){D=e}function fe(){j=!0,C=!1,D=0,L=NaN,I=!0,k=void 0,O={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},P={},F=[],R=!0,U=!1,B=!1,G=null,H=!1}return b={initialize:function(e){N=e,x=(0,a.default)(t).create({abrController:p,dashMetrics:d,mediaPlayerModel:f,textController:m,settings:_}),n.on(u.default.DATA_UPDATE_STARTED,ne,this),n.on(u.default.FRAGMENT_LOADING_COMPLETED,Z,this),n.on(u.default.STREAM_COMPLETED,J,this),n.on(u.default.BUFFER_CLEARED,ie,this),n.on(u.default.BYTES_APPENDED_END_FRAGMENT,ee,this),n.on(u.default.QUOTA_EXCEEDED,ae,this),n.on(u.default.PLAYBACK_SEEKING,ue,this),n.on(u.default.PLAYBACK_STARTED,se,this),n.on(u.default.PLAYBACK_RATE_CHANGED,le,this),n.on(u.default.PLAYBACK_TIME_UPDATED,$,this),n.on(u.default.URL_RESOLUTION_FAILED,oe,this),n.on(u.default.FRAGMENT_LOADING_ABANDONED,te,this),n.on(u.default.BUFFERING_COMPLETED,re,this)},getType:function(){return v},getStreamId:function(){return A.id},setCurrentRepresentation:function(e){w=e},setSeekTarget:ce,setTimeToLoadDelay:de,getTimeToLoadDelay:function(){return D},switchTrackAsked:function(){U=!0},isStarted:K,start:Y,stop:V,reset:function(){n.off(u.default.DATA_UPDATE_STARTED,ne,this),n.off(u.default.FRAGMENT_LOADING_COMPLETED,Z,this),n.off(u.default.STREAM_COMPLETED,J,this),n.off(u.default.BUFFER_CLEARED,ie,this),n.off(u.default.BYTES_APPENDED_END_FRAGMENT,ee,this),n.off(u.default.QUOTA_EXCEEDED,ae,this),n.off(u.default.PLAYBACK_SEEKING,ue,this),n.off(u.default.PLAYBACK_STARTED,se,this),n.off(u.default.PLAYBACK_RATE_CHANGED,le,this),n.off(u.default.PLAYBACK_TIME_UPDATED,$,this),n.off(u.default.URL_RESOLUTION_FAILED,oe,this),n.off(u.default.FRAGMENT_LOADING_ABANDONED,te,this),n.off(u.default.BUFFERING_COMPLETED,re,this),V(),Q(!1),fe(),A=null},getBufferTarget:function(){return x.getBufferTarget(v,w,N)},processInitRequest:function(e){e&&(z(!0),h.executeRequest(e))},processMediaRequest:function(e){e?(S.debug("Next fragment request url is "+e.url),h.executeRequest(e)):(g.getIsDynamic()&&S.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling."),z(!1),W(_.get().streaming.lowLatencyEnabled?100:500))},getPlaybackController:function(){return g}},S=(0,c.default)(t).getInstance().getLogger(b),fe(),A=e.streamInfo,b}f.__dashjs_factory_name="ScheduleController",t.default=l.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),i=o(n(0)),a=o(n(9));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).dashMetrics,n=e.mediaPlayerModel,i=e.textController,o=e.abrController,s=e.settings;function u(e,u,l){var c=NaN;if(!e||!u)return c;if(e===r.default.FRAGMENTED_TEXT)if(i.isTextEnabled())if(isNaN(u.fragmentDuration)){var d=t.getCurrentSchedulingInfo(a.default.SCHEDULING_INFO);c=d?d.duration:0}else c=u.fragmentDuration;else c=0;else if(e===r.default.AUDIO&&l){var f=t.getCurrentBufferLevel(r.default.VIDEO);c=isNaN(u.fragmentDuration)?f:Math.max(f,u.fragmentDuration)}else{var h=u.mediaInfo.streamInfo;c=o.isPlayingAtTopQuality(h)?h.manifestInfo.duration>=s.get().streaming.longFormContentDurationThreshold?s.get().streaming.bufferTimeAtTopQualityLongForm:s.get().streaming.bufferTimeAtTopQuality:n.getStableBufferTime()}return c}return{execute:function(e,n,r){return!e||!n||t.getCurrentBufferLevel(e)<u(e,n,r)},getBufferTarget:u}}s.__dashjs_factory_name="BufferLevelRule",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),i=o(n(6)),a=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).eventBus,n=e.events,a=e.errors,o=e.abrController,s=e.dashMetrics,u=e.playbackController,l=e.timelineConverter,c=e.type,d=e.streamInfo,f=e.dashConstants,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0;function y(){return c}function E(){if(!(o&&s&&u&&l))throw new Error(r.default.MISSING_CONFIG_ERROR)}function T(){return g}function _(){return v}function b(){p=null,g=!0,m=[]}function A(){E();var e=new Date,t=_(),n=1e3*u.getTime();t&&s.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function S(e){return null==e||e>=m.length?null:m[e]}function w(e,t){var n;e.segmentAvailabilityRange=l.calcSegmentAvailabilityRange(e,t),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start?C(new i.default(a.SEGMENTS_UNAVAILABLE_ERROR_CODE,a.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end})):t&&(n=e.segmentAvailabilityRange.end,l.setExpectedLiveEdge(n),s.updateManifestUpdateInfo({presentationStartTime:n}))}function I(e,r){E();for(var i=0,a=m.length;i<a;i++)w(m[i],e),r&&t.trigger(n.REPRESENTATION_UPDATE_STARTED,{representation:m[i]},{streamId:d.id,mediaType:c})}function R(){g=!0,t.trigger(n.DATA_UPDATE_STARTED,{},{streamId:d.id,mediaType:c})}function C(e){g=!1,t.trigger(n.DATA_UPDATE_COMPLETED,{data:p,currentRepresentation:v,error:e},{streamId:d.id,mediaType:c})}function D(e){var r=e;t.trigger(n.AST_IN_FUTURE,{delay:r}),setTimeout((function(){T()||(R(),m.forEach((function(e){e.segmentAvailabilityRange=null})),I(u.getIsDynamic(),!0))}),r)}function M(e){if(T())if(e.error)C(e.error);else{var t,n=e.representation,r=s.getCurrentManifestUpdate(),l=!1,c=0,h=void 0;if(n.adaptation.period.mpd.manifest.type===f.DYNAMIC&&!n.adaptation.period.mpd.manifest.ignorePostponeTimePeriod&&u.getStreamController().getStreams().length<=1&&(c=function(e){try{var t=u.getStreamController().getActiveStreamInfo(),n=e.segmentAvailabilityRange.start;t&&t.id&&t.id!==d.id&&(n=Math.min(u.getTime(),n));var r=e.segmentAvailabilityRange.end-n;return 1e3*(u.getLiveDelay()-r)}catch(e){return 0}}(n)),c>0)return D(c),void C(new i.default(a.SEGMENTS_UPDATE_FAILED_ERROR_CODE,a.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE));if(r){for(var p=0;p<r.representationInfo.length;p++)if((h=r.representationInfo[p]).index===n.index&&h.mediaType===y()){l=!0;break}l||s.addManifestUpdateRepresentationInfo(n,y())}(function(){for(var e=0,t=m.length;e<t;e++){var n=m[e].segmentInfoType;if(null===m[e].segmentAvailabilityRange||!m[e].hasInitialization()||(n===f.SEGMENT_BASE||n===f.BASE_URL)&&!m[e].segments)return!1}return!0})()&&(o.setPlaybackQuality(y(),d,(t=v,m.indexOf(t))),s.updateManifestUpdateInfo({latency:v.segmentAvailabilityRange.end-u.getTime()}),s.getCurrentRepresentationSwitch(_().adaptation.type)||A(),C())}}function L(e){e.isDynamic&&I(e.isDynamic)}function N(e){v=S(e.newQuality),A()}function x(e){if(e.newDuration){var t=_();t&&t.adaptation.period&&(t.adaptation.period.duration=e.newDuration)}}return h={getStreamId:function(){return d.id},getType:y,getData:function(){return p},isUpdating:T,updateData:function(e,t,n,i){E(),R(),m=t,v=S(i),p=e,n===r.default.VIDEO||n===r.default.AUDIO||n===r.default.FRAGMENTED_TEXT?I(u.getIsDynamic(),!0):C()},updateRepresentation:w,getCurrentRepresentation:_,getRepresentationForQuality:S,reset:function(){t.off(n.QUALITY_CHANGE_REQUESTED,N,h),t.off(n.REPRESENTATION_UPDATE_COMPLETED,M,h),t.off(n.WALLCLOCK_TIME_UPDATED,L,h),t.off(n.MANIFEST_VALIDITY_CHANGED,x,h),b()}},b(),t.on(n.QUALITY_CHANGE_REQUESTED,N,h),t.on(n.REPRESENTATION_UPDATE_COMPLETED,M,h),t.on(n.WALLCLOCK_TIME_UPDATED,L,h),t.on(n.MANIFEST_VALIDITY_CHANGED,x,h),h}s.__dashjs_factory_name="RepresentationController",t.default=a.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).timelineConverter;return{getLiveEdge:function(e){return function(){if(!t||!t.hasOwnProperty("getExpectedLiveEdge"))throw new Error(i.default.MISSING_CONFIG_ERROR)}(),e.DVRWindow?e.DVRWindow.end:0},reset:function(){t=null}}}o.__dashjs_factory_name="LiveEdgeFinder",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(0)),i=u(n(157)),a=u(n(158)),o=u(n(159)),s=u(n(160));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t,n=this.context,r=e.events,u=e.eventBus,l=e.dashConstants,c=e.streamInfo,d=e.type,f=void 0;function h(e){return e?e.segments?f[l.SEGMENT_BASE]:f[e.segmentInfoType]:null}return t={initialize:function(t){f[l.SEGMENT_TIMELINE]=(0,i.default)(n).create(e,t),f[l.SEGMENT_TEMPLATE]=(0,a.default)(n).create(e,t),f[l.SEGMENT_LIST]=(0,o.default)(n).create(e,t),f[l.SEGMENT_BASE]=(0,s.default)(n).create(e,t)},update:function(e,t,n,i){n||u.trigger(r.SEGMENTBASE_INIT_REQUEST_NEEDED,{streamId:c.id,mediaType:d,mimeType:t,representation:e}),i||u.trigger(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{streamId:c.id,mediaType:d,mimeType:t,representation:e})},getSegmentByIndex:function(e,t,n){var r=h(e);return r?r.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=h(e);return n?n.getSegmentByTime(e,t):null}},f={},t}l.__dashjs_factory_name="SegmentsController";var c=r.default.getClassFactory(l);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(1)),a=n(22);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcMediaTimeFromPresentationTime")||!n.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(e,r){var i,a,o,s=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,u=s.SegmentTimeline,l=s.SegmentURL_asArray,c=0,d=0,f=-1,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0;o=e.timescale;var E=!1;for(p=0,a=(i=u.S_asArray).length;p<a&&!E;p++){if(m=0,(h=i[p]).hasOwnProperty("r")&&(m=h.r),h.hasOwnProperty("t")&&(d=(c=h.t)/o),m<0){if((y=i[p+1])&&y.hasOwnProperty("t"))v=y.t/o;else{var T=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:n.calcSegmentAvailabilityRange(e,t).end;v=n.calcMediaTimeFromPresentationTime(T,e),e.segmentDuration=h.d/o}m=Math.ceil((v-d)/(h.d/o))-1}for(g=0;g<=m&&!E;g++)(E=r(c,d,s,l,h,o,++f,p))&&(e.segmentDuration=h.d/o,(g<m-1||p<a-1)&&f++),d=(c+=h.d)/o}e.availableSegmentsNumber=f}return{getSegmentByIndex:function(e,i,s){if(r(),!e)return null;var u=null,l=!1;return o(e,(function(r,i,o,c,d,f,h,p){if(l||s<0){var g=o.media,m=d.mediaRange;return c&&(g=c[p].media||"",m=c[p].mediaRange),u=(0,a.getTimeBasedSegment)(n,t,e,r,d.d,f,g,m,h,d.tManifest),!0}return i>=s-.5*d.d/f&&(l=!0),!1})),u},getSegmentByTime:function(e,i){if(r(),!e)return null;void 0===i&&(i=null);var s=null,u=n.calcMediaTimeFromPresentationTime(i,e);return o(e,(function(r,i,o,l,c,d,f,h){if(u<i+c.d/d){var p=o.media,g=c.mediaRange;return l&&(p=l[h].media||"",g=l[h].mediaRange),s=(0,a.getTimeBasedSegment)(n,t,e,r,c.d,d,p,g,f,c.tManifest),!0}return!1})),s}}}s.__dashjs_factory_name="TimelineSegmentsGetter";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(1)),a=n(22);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(e,i){if(r(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;i=Math.max(i,0);var s=(0,a.getIndexBasedSegment)(n,t,e,i);if(s){s.replacementTime=Math.round((i-1)*e.segmentDuration*e.timescale,10);var u=o.media;u=(0,a.replaceTokenForTemplate)(u,"Number",s.replacementNumber),u=(0,a.replaceTokenForTemplate)(u,"Time",s.replacementTime),s.media=u}var l=e.segmentDuration,c=e.segmentAvailabilityRange;return isNaN(l)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((c.end-c.start)/l),s}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i))}}}s.__dashjs_factory_name="TemplateSegmentsGetter";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(1)),a=n(22);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(e,i){if(r(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,u=e&&!isNaN(e.startNumber)?e.startNumber:1,l=Math.max(u-1,0),c=Math.max(i-l,0),d=null;if(c<s){var f=o.SegmentURL_asArray[c];(d=(0,a.getIndexBasedSegment)(n,t,e,i))&&(d.replacementTime=(u+i-1)*e.segmentDuration,d.media=f.media?f.media:"",d.mediaRange=f.mediaRange,d.index=i,d.indexRange=f.indexRange)}return e.availableSegmentsNumber=s,d}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i))}}}s.__dashjs_factory_name="ListSegmentsGetter";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function r(e,t){if(n(),!e)return null;var r=e.segments?e.segments.length:-1,i=void 0;if(t<r&&(i=e.segments[t])&&i.availabilityIdx===t)return i;for(var a=0;a<r;a++)if((i=e.segments[a])&&i.availabilityIdx===t)return i;return null}return{getSegmentByIndex:r,getSegmentByTime:function(e,t){return n(),r(e,function(e,t){if(!e)return-1;var n=e.segments,r=n?n.length:null,i=-1,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0;if(n&&r>0)for(l=0;l<r;l++)if(s=(o=n[l]).presentationStartTime,t+(a=(u=o.duration)/2)>=s&&t-a<s+u){i=o.availabilityIdx;break}return i}(e,t))}}}o.__dashjs_factory_name="SegmentBaseGetter";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(){var e=void 0,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,r=/^https:\/\//i,i=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;d(e)&&(n=u),f(e)&&(n=l);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(i)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function u(e){var t=e.match(i);return t?t[1]:""}function l(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function d(e){return c(e)&&"/"===e.charAt(0)}function f(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y"),e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:c,isPathAbsolute:d,isSchemeRelative:f,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return r.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,n){return e(t,n)}}}a.__dashjs_factory_name="DefaultURLUtils",t.default=i.default.getSingletonFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(1)),i=h(n(163)),a=h(n(26)),o=h(n(164)),s=h(n(53)),u=h(n(3)),l=h(n(4)),c=h(n(10)),d=h(n(0)),f=h(n(2));function h(e){return e&&e.__esModule?e:{default:e}}function p(e){e=e||{};var t,n=this.context,d=(0,u.default)(n).getInstance(),h=e.errHandler,p=e.mediaPlayerModel,g=e.dashMetrics,m=(0,f.default)(n).getInstance(),v=e.streamInfo,y=void 0,E=void 0;function T(){for(var e in E)E[e].reset();E={}}function _(e){if(e.sender){var t=e.request,n=e.response,a=t.isInitializationRequest(),o=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType!==r.default.AUDIO&&t.mediaType!==r.default.VIDEO&&t.mediaType!==r.default.FRAGMENTED_TEXT||d.trigger(l.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),n&&o){var s=function(e,t,n,r){var a=new i.default;return a.streamId=n,a.mediaInfo=t.mediaInfo,a.segmentType=t.type,a.start=t.startTime,a.duration=t.duration,a.end=a.start+a.duration,a.bytes=e,a.index=t.index,a.quality=t.quality,a.representationId=t.representationId,a.endFragment=r,a}(n,t,v.id,e.type!==l.default.FRAGMENT_LOADING_PROGRESS);d.trigger(a?l.default.INIT_FRAGMENT_LOADED:l.default.MEDIA_FRAGMENT_LOADED,{chunk:s,request:t},{streamId:o.id,mediaType:t.mediaType})}else y.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return t={getStreamId:function(){return v.id},getModel:function(t){var r=E[t];return r||(r=(0,a.default)(n).create({streamInfo:v,type:t,dashMetrics:g,fragmentLoader:(0,o.default)(n).create({dashMetrics:g,mediaPlayerModel:p,errHandler:h,requestModifier:(0,s.default)(n).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:d,events:l.default,errors:c.default,dashConstants:e.dashConstants,urlUtils:e.urlUtils}),debug:m,eventBus:d,events:l.default}),E[t]=r),r},reset:function(){d.off(l.default.FRAGMENT_LOADING_COMPLETED,_,this),d.off(l.default.FRAGMENT_LOADING_PROGRESS,_,this),T()}},y=m.getLogger(t),T(),d.on(l.default.FRAGMENT_LOADING_COMPLETED,_,t),d.on(l.default.FRAGMENT_LOADING_PROGRESS,_,t),t}p.__dashjs_factory_name="FragmentController",t.default=d.default.getClassFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),i=u(n(29)),a=u(n(174)),o=u(n(6)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t=this.context,n=e.eventBus,s=e.events,u=e.urlUtils,l=e.errors,c=void 0,d=void 0;return c={checkForExistence:function(e){var t=function(t){n.trigger(s.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var r=new a.default(e.url);d.load({request:r,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var t=function(t,r){n.trigger(s.LOADING_COMPLETED,{request:e,response:t||null,error:r||null,sender:c})};e?d.load({request:e,progress:function(t){n.trigger(s.LOADING_PROGRESS,{request:e,stream:t.stream}),t.data&&n.trigger(s.LOADING_DATA_PROGRESS,{request:e,response:t.data||null,error:null,sender:c})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new o.default(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,n))},abort:function(e){e&&n.trigger(s.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:c})}}):t(void 0,new o.default(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){d&&d.abort()},reset:function(){d&&(d.abort(),d=null)}},d=(0,i.default)(t).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:u,constants:r.default,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),c}l.__dashjs_factory_name="FragmentLoader",t.default=s.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=g(n(55)),i=g(n(166)),a=n(7),o=g(n(0)),s=g(n(6)),u=g(n(82)),l=g(n(30)),c=g(n(2)),d=g(n(3)),f=g(n(4)),h=g(n(23)),p=g(n(1));function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){e=e||{};var t,n,o=this.context,g=e.errHandler,v=e.dashMetrics,y=e.mediaPlayerModel,E=e.requestModifier,T=e.boxParser,_=e.useFetch||!1,b=e.errors,A=e.requestTimeout||0,S=(0,d.default)(o).getInstance(),w=(0,h.default)(o).getInstance(),I=void 0,R=void 0,C=void 0,D=void 0,M=void 0,L=void 0;return n={load:function(e){e.request?function e(t,n){var u=t.request,c=[],d=!0,h=!0,m=new Date,b=m,N=0,x=void 0;if(!E||!v||!g)throw new Error("config object is not correct or missing");var O=function(e){h=!1,u.requestStartDate=m,u.requestEndDate=new Date,u.firstByteDate=u.firstByteDate||m,u.checkExistenceOnly||(v.addHttpRequest(u,x.response?x.response.responseURL:null,x.response?x.response.status:null,x.response&&x.response.getAllResponseHeaders?x.response.getAllResponseHeaders():x.response?x.response.responseHeaders:[],e?c:null),u.type===a.HTTPRequest.MPD_TYPE&&v.addManifestUpdate(u))},P=function(){if(-1!==I.indexOf(x)&&(I.splice(I.indexOf(x),1),h))if(O(!1),n>0){try{w.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&u.type===a.HTTPRequest.MEDIA_SEGMENT_TYPE&&y.getRetryAttemptsForType(a.HTTPRequest.MEDIA_SEGMENT_TYPE)===n&&S.trigger(f.default.ATTEMPT_BACKGROUND_SYNC)}catch(e){}n--;var r={config:t};C.push(r),r.timeout=setTimeout((function(){-1!==C.indexOf(r)&&(C.splice(C.indexOf(r),1),e(t,n))}),y.getRetryIntervalsForType(u.type))}else{if(u.type===a.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;g.error(new s.default(D[u.type],u.url+" is not available",{request:u,response:x.response})),t.error&&t.error(u,"error",x.response.statusText),t.complete&&t.complete(u,x.response.statusText)}},k=void 0;k=_&&window.fetch&&"arraybuffer"===u.responseType&&u.type===a.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,i.default)(o).create({requestModifier:E,boxParser:T}):(0,r.default)(o).create({requestModifier:E});var F=null,U=E.modifyRequestURL(u.url);if(w.get().streaming.cmcd&&w.get().streaming.cmcd.enabled){var B=w.get().streaming.cmcd.mode;if(B===p.default.CMCD_MODE_QUERY){var G=function(e){try{var t=[],n=M.getQueryParameter(e);return n&&t.push(n),t}catch(e){return[]}}(u);U=l.default.addAditionalQueryParameterToUrl(U,G)}else B===p.default.CMCD_MODE_HEADER&&(F=M.getHeaderParameters(u))}var j=u.checkExistenceOnly?a.HTTPRequest.HEAD:a.HTTPRequest.GET,H=y.getXHRWithCredentialsForType(u.type);x={url:U,method:j,withCredentials:H,request:u,onload:function(){x.response.status>=200&&x.response.status<=299&&(O(!0),t.success&&t.success(x.response.response,x.response.statusText,x.response.responseURL),t.complete&&t.complete(u,x.response.statusText))},onend:P,onerror:P,progress:function(e){var n=new Date;d&&(d=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(u.firstByteDate=n)),e.lengthComputable&&(u.bytesLoaded=e.loaded,u.bytesTotal=e.total),e.noTrace||(c.push({s:b,d:e.time?e.time:n.getTime()-b.getTime(),b:[e.loaded?e.loaded-N:0]}),b=n,N=e.loaded),t.progress&&e&&t.progress(e)},onabort:function(){t.abort&&t.abort(u)},ontimeout:function(e){var t=void 0;if(e.lengthComputable){var n=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+n.toFixed(3)+"% Completed"}else t="Request timeout: non-computable download size";L.warn(t)},loader:k,timeout:A,headers:F};var K=(new Date).getTime();if(isNaN(u.delayLoadingTime)||K>=u.delayLoadingTime)I.push(x),k.load(x);else{var Y={httpRequest:x};R.push(Y),Y.delayTimeout=setTimeout((function(){if(-1!==R.indexOf(Y)){R.splice(R.indexOf(Y),1);try{m=new Date,b=m,I.push(Y.httpRequest),k.load(Y.httpRequest)}catch(e){Y.httpRequest.onerror()}}}),u.delayLoadingTime-K)}}(e,y.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){C.forEach((function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)})),C=[],R.forEach((function(e){return clearTimeout(e.delayTimeout)})),R=[],I.forEach((function(e){e.request.type!==a.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e))})),I=[]}},L=(0,c.default)(o).getInstance().getLogger(n),I=[],R=[],C=[],M=(0,u.default)(o).getInstance(),m(t={},a.HTTPRequest.MPD_TYPE,b.DOWNLOAD_ERROR_ID_MANIFEST_CODE),m(t,a.HTTPRequest.XLINK_EXPANSION_TYPE,b.DOWNLOAD_ERROR_ID_XLINK_CODE),m(t,a.HTTPRequest.INIT_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),m(t,a.HTTPRequest.MEDIA_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),m(t,a.HTTPRequest.INDEX_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),m(t,a.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),m(t,a.HTTPRequest.OTHER_TYPE,b.DOWNLOAD_ERROR_ID_CONTENT_CODE),D=t,n}v.__dashjs_factory_name="HTTPLoader";var y=o.default.getClassFactory(v);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(23)),a=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=this.context,n=e.requestModifier,r=e.boxParser,o=(0,i.default)(t).getInstance();function s(e,t){e.reader.read().then(t).catch((function(t){e.onerror&&200===e.response.status&&e.onerror(t)}))}function u(e,t,n,r,i){switch(e){case a.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING:return function(e,t){try{var n,r;n=e.filter((function(t,n){return n>0&&n<e.length-1})),r=t.filter((function(e,n){return n>0&&n<t.length-1}));var i=0;if(n.length>1){for(var a=0;a<n.length;a++)n[a]&&r[a]&&(i+=r[a].ts-n[a].ts);return i}return null}catch(e){return null}}(t,n);case a.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA:default:return function(e,t){try{if((e=e.filter((function(n){return n.bytes>t/4/e.length}))).length>1){var n=0,r=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach((function(t,i){var a=e[i+1];if(a){var o=a.ts-t.ts;n+=o<r?o:0}})),n}return null}catch(e){return null}}(r,i)}}return{load:function(e){var t=new Date,i=e.request,l=new Headers;if(i.range&&l.append("Range","bytes="+i.range),e.headers)for(var c in e.headers){var d=e.headers[c];d&&l.append(c,d)}i.requestStartDate||(i.requestStartDate=t),n&&n.modifyRequestHeader({setRequestHeader:function(e,t){l.append(e,t)}});var f=void 0;"function"==typeof window.AbortController&&(f=new AbortController,e.abortController=f,f.signal.onabort=e.onabort);var h={method:e.method,headers:l,credentials:e.withCredentials?"include":void 0,signal:f?f.signal:void 0};fetch(e.url,h).then((function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,e.response.responseURL=t.url,t.ok||e.onerror();var n="",i=!0,l=!1,c=void 0;try{for(var d,f=t.headers.keys()[Symbol.iterator]();!(i=(d=f.next()).done);i=!0){var h=d.value;n+=h+": "+t.headers.get(h)+"\r\n"}}catch(e){l=!0,c=e}finally{try{!i&&f.return&&f.return()}finally{if(l)throw c}}if(e.response.responseHeaders=n,!t.body)return t.arrayBuffer().then((function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()}));var p=parseInt(t.headers.get("Content-Length"),10),g=0,m=!1,v=new Uint8Array,y=0;e.reader=t.body.getReader();var E=[],T=[],_=[],b=!0,A=o.get().streaming.abr.fetchThroughputCalculationMode;s(e,(function t(n){var i=n.value;if(n.done)return v&&(e.progress({loaded:g,total:isNaN(p)?g:p,lengthComputable:!0,time:u(A,T,_,E,g),stream:!0}),e.response.response=v.buffer),e.onload(),void e.onend();if(i&&i.length>0){v=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(v,i),g+=i.length,E.push({ts:Date.now(),bytes:i.length}),A===a.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&b&&r.findLastTopIsoBoxCompleted(["moof"],v,y).found&&(b=!1,T.push({ts:performance.now(),bytes:i.length}));var o=r.findLastTopIsoBoxCompleted(["moov","mdat"],v,y);if(o.found){var l=o.lastCompletedOffset+o.size;A===a.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&(b=!0,_.push({ts:performance.now(),bytes:v.length}));var c=void 0;l===v.length?(c=v,v=new Uint8Array):(c=new Uint8Array(v.subarray(0,l)),v=v.subarray(l)),e.progress({data:c.buffer,lengthComputable:!1,noTrace:!0}),y=0}else y=o.lastCompletedOffset,m||(e.progress({lengthComputable:!1,noTrace:!0}),m=!0)}s(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:u}}s.__dashjs_factory_name="FetchLoader";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(r=n(8))&&r.__esModule?r:{default:r},o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return i(e,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==a.default.BASE_URL&&this.segmentInfoType!==a.default.SEGMENT_BASE&&!this.indexRange}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};r.DEFAULT_ID="defaultId",t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0}},function(e,t,n){"use strict";var r=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var o,s,u,l=r(t),c=r(n);if(l&&c){if((s=t.length)!=n.length)return!1;for(o=s;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(l!=c)return!1;var d=t instanceof Date,f=n instanceof Date;if(d!=f)return!1;if(d&&f)return t.getTime()==n.getTime();var h=t instanceof RegExp,p=n instanceof RegExp;if(h!=p)return!1;if(h&&p)return t.toString()==n.toString();var g=i(t);if((s=g.length)!==i(n).length)return!1;for(o=s;0!=o--;)if(!a.call(n,g[o]))return!1;for(o=s;0!=o--;)if(!e(t[u=g[o]],n[u]))return!1;return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkForExistenceOnly=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(15))&&r.__esModule?r:{default:r}).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(0)),i=l(n(1)),a=l(n(176)),o=l(n(57)),s=l(n(79)),u=n(22);function l(e){return e&&e.__esModule?e:{default:e}}function c(e){var t,n=this.context,r=e.streamInfo,l=void 0;function c(){l&&l.reset()}return t={getStreamId:function(){return r.id},provide:function(e,t){if("function"==typeof t){var n,r=l.getCurrentTrack(),i=void 0;if(!r||r.segmentDuration<=0||null==e)t(null);else{isNaN(r.segmentDuration)&&(i=l.getThumbnailRequestForTime(e))&&(r.segmentDuration=i.duration),n=e%r.segmentDuration;var o=Math.floor(n*r.tilesHor*r.tilesVert/r.segmentDuration),s=new a.default;if(s.width=Math.floor(r.widthPerTile),s.height=Math.floor(r.heightPerTile),s.x=Math.floor(o%r.tilesHor)*r.widthPerTile,s.y=Math.floor(o/r.tilesHor)*r.heightPerTile,"readThumbnail"in r)return r.readThumbnail(e,(function(e){s.url=e,t(s)}));if(i)s.url=i.url,r.segmentDuration=NaN;else{var c=Math.floor(e/r.segmentDuration);s.url=function(e,t){var n=t+e.startNumber,r=(0,u.replaceTokenForTemplate)(e.templateUrl,"Number",n);return r=(0,u.replaceTokenForTemplate)(r,"Time",(n-1)*e.segmentDuration*e.timescale),r=(0,u.replaceTokenForTemplate)(r,"Bandwidth",e.bandwidth),(0,u.unescapeDollarsInTemplate)(r)}(r,c)}t(s)}}},setTrackByIndex:function(e){l.setTrackByIndex(e)},getCurrentTrackIndex:function(){return l.getCurrentTrackIndex()},getBitrateList:function(){var e=l.getTracks(),t=0;return e.map((function(e){var n=new s.default;return n.mediaType=i.default.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n}))},reset:c},c(),l=(0,o.default)(n).create({streamInfo:r,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants}),t}c.__dashjs_factory_name="ThumbnailController",t.default=r.default.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(6)),i=n(7),a=d(n(3)),o=d(n(4)),s=d(n(10)),u=d(n(0)),l=d(n(2)),c=d(n(12));function d(e){return e&&e.__esModule?e:{default:e}}function f(){var e=this.context,t=(0,a.default)(e).getInstance(),n=(0,c.default)(e).getInstance(),u=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0,A=void 0,S=void 0;function w(){v=[],y=[],E=null,T=null,b=null,_=NaN,f=!1,h=!1,A=p.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function I(){f||h||!b||!b.value||!b.schemeIdUri||isNaN(_)||isNaN(p.get().streaming.utcSynchronization.backgroundAttempts)||T&&(Date.now()-T)/1e3<30||(v=[],h=!0,function e(t){try{if(t<=0)return void U();var n=Date.now();g[b.schemeIdUri](b.value,(function(r){var i=Date.now(),a=R(n,i,r);v.push(a),e(t-1)}),(function(){U()}))}catch(e){U()}}(isNaN(p.get().streaming.utcSynchronization.backgroundAttempts)?2:p.get().streaming.utcSynchronization.backgroundAttempts))}function R(e,t,n){return n-(t-(t-e)/2)}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,t=isNaN(e);t&&p.get().streaming.useManifestDateHeaderTimeSource?k():F(t,e)}function D(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,n=void 0,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function M(e){return Date.parse(e)}function L(e){return Date.parse(e)}function N(e,t,n){n()}function x(e,t,n){var r=D(e);isNaN(r)?n():t(r)}function O(e,t,r,a,o){var s,u,l=!1,c=new XMLHttpRequest,d=o?i.HTTPRequest.HEAD:i.HTTPRequest.GET,f=t.match(/\S+/g);if(t=f.shift(),s=function(){l||(l=!0,f.length?O(e,f.join(" "),r,a,o):a())},u=function(){var t=void 0,n=void 0;200===c.status&&(t=o?c.getResponseHeader("Date"):c.response,n=e(t),isNaN(n)||(r(n),l=!0))},n.isRelative(t)){var h=S.resolve();h&&(t=n.resolve(t,h.url))}c.open(d,t),c.timeout=5e3,c.onload=u,c.onloadend=s,c.send()}function P(e,t,n){O(L,e,t,n,!0)}function k(){var e=m.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?F(!0):F(!1,t-Date.now())}function F(e,n){if(isNaN(_)||isNaN(n)||e||function(e){try{var t=B(e),n=isNaN(A)?30:A,r=isNaN(p.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:p.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,i=isNaN(p.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:p.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,a=isNaN(p.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:p.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts,o=void 0;t?(o=Math.min(n*r,i),d.debug("Increasing timeBetweenSyncAttempts to "+o)):(o=Math.max(n/r,a),d.debug("Decreasing timeBetweenSyncAttempts to "+o)),A=o}catch(e){}}(n),!e&&!isNaN(n)){E=Date.now(),f=!1;var i=isNaN(_);_=n,i&&I(),d.debug("Completed UTC sync. Setting client - server offset to "+n)}e&&(b=null),t.trigger(o.default.UPDATE_TIME_SYNC_OFFSET,{offset:n,error:e?new r.default(s.default.TIME_SYNC_FAILED_ERROR_CODE,s.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null}),t.trigger(o.default.TIME_SYNCHRONIZATION_COMPLETED)}function U(){if(v&&0!==v.length){var e=v.reduce((function(e,t){return e+t}),0)/v.length;B(e)?d.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(d.debug("Completed background UTC sync. Setting client - server offset to "+e),_=e,t.trigger(o.default.UPDATE_TIME_SYNC_OFFSET,{offset:_})),h=!1,T=Date.now()}}function B(e){try{if(isNaN(_))return!0;var t=p.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(p.get().streaming.utcSynchronization.maximumAllowedDrift)?p.get().streaming.utcSynchronization.maximumAllowedDrift:100;return e>=_-t&&e<=_+t}catch(e){return!0}}return u={initialize:function(){w(),g={"urn:mpeg:dash:utc:http-head:2014":P,"urn:mpeg:dash:utc:http-xsdate:2014":O.bind(null,D),"urn:mpeg:dash:utc:http-iso:2014":O.bind(null,M),"urn:mpeg:dash:utc:direct:2014":x,"urn:mpeg:dash:utc:http-head:2012":P,"urn:mpeg:dash:utc:http-xsdate:2012":O.bind(null,D),"urn:mpeg:dash:utc:http-iso:2012":O.bind(null,M),"urn:mpeg:dash:utc:direct:2012":x,"urn:mpeg:dash:utc:http-ntp:2014":N,"urn:mpeg:dash:utc:ntp:2014":N,"urn:mpeg:dash:utc:sntp:2014":N}},attemptSync:function(e){y=e,f||(function(){try{var e=isNaN(A)?30:A;return!(E&&e&&!isNaN(e))||(Date.now()-E)/1e3>=e}catch(e){return!0}}()?(f=!0,function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=t||0;if(!y||0===y.length||n>=y.length)C();else{var r=y[n];if(r)if(g.hasOwnProperty(r.schemeIdUri)){var i=(new Date).getTime();g[r.schemeIdUri](r.value,(function(e){var t=(new Date).getTime(),n=R(i,t,e);b=r,C(n)}),(function(){e(n+1)}))}else e(n+1);else C()}}()):t.trigger(o.default.TIME_SYNCHRONIZATION_COMPLETED))},setConfig:function(e){e&&(e.dashMetrics&&(m=e.dashMetrics),e.baseURLController&&(S=e.baseURLController),e.settings&&(p=e.settings))},reset:function(){w(),t.off(o.default.ATTEMPT_BACKGROUND_SYNC,I,u)}},d=(0,l.default)(e).getInstance().getLogger(u),t.on(o.default.ATTEMPT_BACKGROUND_SYNC,I,u),u}f.__dashjs_factory_name="TimeSyncController";var h=u.default.getSingletonFactory(f);h.HTTP_TIMEOUT_MS=5e3,u.default.updateSingletonFactory(f.__dashjs_factory_name,h),t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e,t=void 0,n=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n},detachMediaSource:function(e){e.setSource(null)},setDuration:function e(n,r){n&&"open"===n.readyState&&(null===r&&isNaN(r)||n.duration!==r&&(function(e){for(var t=e.sourceBuffers,n=0;n<t.length;n++)if(t[n].updating)return!0;return!1}(n)?setTimeout(e.bind(null,n,r),50):(t.info("Set MediaSource duration:"+r),n.duration=r)))},setSeekable:function(e,t,n){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var n=e.sourceBuffers,r=0;r<n.length;r++){if(n[r].updating)return;if(0===n[r].buffered.length)return}t.info("call to mediaSource endOfStream"),e.endOfStream()}}},t=(0,i.default)(n).getInstance().getLogger(e),e}o.__dashjs_factory_name="MediaSourceController",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(0)),i=u(n(2)),a=u(n(3)),o=u(n(20)),s=u(n(55));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e,t="discarded",n="updated",r="added",u=this.context,l=(0,a.default)(u).getInstance(),c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0;function T(){if(!g||!m)throw new Error("setConfig function has to be called previously")}function _(){E=!1,d={},f={},h=null,y=!1,p=Date.now()/1e3}function b(e,i){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.eventStream.schemeIdUri,s=e.eventStream.value,u=e.id,l=t;i[o]||(i[o]=[]);var c=i[o].findIndex((function(e){return(!s||e.eventStream.value&&e.eventStream.value===s)&&e.id===u}));return-1===c?(i[o].push(e),l=r):a&&(i[o][c]=e,l=n),l}function A(e){try{if(1==e.eventStream.value){var t,n=e.calculatedPresentationTime;t=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,l.trigger(o.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:n,newDuration:t,newManifestValidAfter:NaN},{mode:o.default.EVENT_MODE_ON_START})}}catch(e){}}function S(){try{if(!y){y=!0;var e=m.getTime(),t=e-p;t=p>0?Math.max(0,t):0,w(f,t,e),w(d,t,e),p=e,y=!1}}catch(e){y=!1}}function w(e,t,n){try{R(e,(function(r){if(void 0!==r){var i=isNaN(r.duration)?0:r.duration;r.calculatedPresentationTime<=n&&r.calculatedPresentationTime+t+i>=n?C(r,e,o.default.EVENT_MODE_ON_START):(function(e,t,n){try{return e-t>n}catch(e){return!1}}(n,i+t,r.calculatedPresentationTime)||function(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>t}catch(e){return!1}}(r))&&(c.debug("Deleting event "+r.id+" as it is expired or invalid"),D(e,r))}}))}catch(e){}}function I(e){try{var t=m.getTime();R(e,function(n){var r=n.eventStream&&n.eventStream.period&&!isNaN(n.eventStream.period.duration)?n.eventStream.period.duration:NaN,i=n.eventStream&&n.eventStream.period&&!isNaN(n.eventStream.period.start)?n.eventStream.period.start:NaN;if(!isNaN(r)&&!isNaN(i)){var a=n.calculatedPresentationTime;Math.abs(a-t)<300&&C(n,e,o.default.EVENT_MODE_ON_START)}}())}catch(e){}}function R(e,t){try{if(e)for(var n=Object.keys(e),r=0;r<n.length;r++)e[n[r]].forEach((function(e){void 0!==e&&t(e)}))}catch(e){}}function C(e,t,n){try{var r=m.getTime(),i=e.id;if(n===o.default.EVENT_MODE_ON_RECEIVE)return c.debug("Received event "+i),void l.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n});"urn:mpeg:dash:event:2012"===e.eventStream.schemeIdUri&&1===e.eventStream.value?0===e.duration&&0===e.presentationTimeDelta||(c.debug("Starting manifest refresh event "+i+" at "+r),D(t,e),function(){try{T(),g.refreshManifest()}catch(e){}}()):"urn:mpeg:dash:event:callback:2015"===e.eventStream.schemeIdUri&&1===e.eventStream.value?(c.debug("Starting callback event "+i+" at "+r),D(t,e),function(e){try{(0,s.default)(u).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){throw e}}(e.messageData)):(c.debug("Starting event "+i+" at "+r),D(t,e),l.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n}))}catch(e){}}function D(e,t){var n=t.eventStream.schemeIdUri,r=t.eventStream.value,i=t.id;e[n]=e[n].filter((function(e){return r&&e.eventStream.value&&e.eventStream.value!==r||e.id!==i})),0===e[n].length&&delete e[n]}return e={addInlineEvents:function(e){try{if(T(),e)for(var t=0;t<e.length;t++){var i=e[t],a=b(i,d,!0);a===r?(c.debug("Added inline event with id "+i.id),C(i,e,o.default.EVENT_MODE_ON_RECEIVE)):a===n&&c.debug("Updated inline event with id "+i.id)}c.debug("Added "+e.length+" inline events")}catch(e){throw e}},addInbandEvents:function(e){try{T();for(var t=0;t<e.length;t++){var n=e[t];b(n,f,!1)===r?("urn:mpeg:dash:event:2012"===n.eventStream.schemeIdUri&&void 0===f[n.id]&&A(n),c.debug("Added inband event with id "+n.id),C(n,e,o.default.EVENT_MODE_ON_RECEIVE)):c.debug("Inband event with scheme_id_uri "+n.eventStream.schemeIdUri+", value "+n.eventStream.value+" and id "+n.id+" was ignored because it has been added before.")}S()}catch(e){throw e}},getInbandEvents:function(){return f},getInlineEvents:function(){return d},start:function(){try{T(),c.debug("Start Event Controller");var e=v.get().streaming.eventControllerRefreshDelay;E||isNaN(e)||(E=!0,h=setInterval(S,e))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(g=e.manifestUpdater),e.playbackController&&(m=e.playbackController),e.settings&&(v=e.settings)}catch(e){throw e}},reset:function(){(function(){try{null!==h&&E&&(clearInterval(h),h=null,E=!1,function(){try{I(f),I(d)}catch(e){}}())}catch(e){throw e}})(),_()}},c=(0,i.default)(u).getInstance().getLogger(e),_(),e}l.__dashjs_factory_name="EventController",t.default=r.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(0)),i=s(n(2)),a=s(n(4)),o=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,o.default)(e).getInstance(),n=void 0,r=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0;function m(){g.debug("Stopping the gap controller"),l&&(clearInterval(l),l=null),function(){t.off(a.default.WALLCLOCK_TIME_UPDATED,E,this),t.off(a.default.PLAYBACK_SEEKING,y,this),t.off(a.default.BYTES_APPENDED_END_FRAGMENT,v,n)}(),l=null,c=NaN,u=0,p=null}function v(){l||function(){try{l||(g.debug("Starting the gap controller"),l=setInterval((function(){T()&&b(d.getTime())}),100))}catch(e){}}()}function y(){p&&(clearTimeout(p),p=null)}function E(){if(T()&&++u>=30){var e=d.getTime();r===e?b(e,!0):(r=e,c=NaN),u=0}}function T(){return s.get().streaming.jumpGaps&&f.getActiveStreamProcessors().length>0&&(!d.isSeeking()||f.hasStreamFinishedBuffering(f.getActiveStream()))&&!d.isPaused()&&!f.getIsStreamSwitchInProgress()&&!f.getHasMediaOrIntialisationError()}function _(e,t){try{if(!e||e.length<=1&&t>0)return NaN;for(var n=NaN,r=0;isNaN(n)&&r<e.length;){var i=r>0?e.end(r-1):0;t<e.start(r)&&i-t<.1&&(n=r),r+=1}return n}catch(e){return null}}function b(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=s.get().streaming.smallGapLimit,i=s.get().streaming.jumpLargeGaps,o=h.getBufferRange(),u=void 0,l=NaN,f=!1;if(u=_(o,e),!isNaN(u)){var m=o.start(u),v=m-e;v>0&&(v<=r||i)&&(l=m)}var y=d.getTimeToStreamEnd();if(isNaN(l)&&n&&isFinite(y)&&!isNaN(y)&&y<r&&(l=parseFloat(d.getStreamEndTime().toFixed(5)),f=!0),l>0&&c!==l&&l>e&&!p){var E=l-e;if(f)g.warn("Jumping to end of stream because of gap from "+e+" to "+l+". Gap duration: "+E),t.trigger(a.default.GAP_CAUSED_SEEK_TO_PERIOD_END,{seekTime:l,duration:E});else{var T=d.getIsDynamic(),b=u>0?o.end(u-1):e,A=T?1e3*E:0;p=window.setTimeout((function(){d.seek(l,!0,!0),g.warn("Jumping gap starting at "+b+" and ending at "+l+". Jumping by: "+E),t.trigger(a.default.GAP_CAUSED_INTERNAL_SEEK,{seekTime:l,duration:E}),p=null}),A)}c=l}}return n={reset:m,setConfig:function(e){e&&(e.settings&&(s=e.settings),e.playbackController&&(d=e.playbackController),e.streamController&&(f=e.streamController),e.videoModel&&(h=e.videoModel),e.timelineConverter&&e.timelineConverter,e.adapter&&e.adapter)},initialize:function(){!function(){t.on(a.default.WALLCLOCK_TIME_UPDATED,E,this),t.on(a.default.PLAYBACK_SEEKING,y,this),t.on(a.default.BYTES_APPENDED_END_FRAGMENT,v,n)}()}},g=(0,i.default)(e).getInstance().getLogger(n),m(),n}u.__dashjs_factory_name="GapController",t.default=r.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),i=u(n(4)),a=u(n(3)),o=u(n(0)),s=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e,t=this.context,n=(0,a.default)(t).getInstance(),o=void 0,u=void 0,l=void 0,c=void 0,d=void 0,f=[r.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,r.default.TRACK_SWITCH_MODE_NEVER_REPLACE],h=[r.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE,r.default.TRACK_SELECTION_MODE_FIRST_TRACK,r.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY,r.default.TRACK_SELECTION_MODE_WIDEST_RANGE];function p(e,t){if(!e||!t)return[];var n=t.id;return u[n]&&u[n][e]?u[n][e].list:[]}function g(e,t){return!e||!t||t&&!u[t.id]?null:u[t.id][e].current}function m(e,t){if(e&&e.streamInfo){var a=e.type,o=e.streamInfo,s=o.id,l=g(a,o);if(u[s]&&u[s][a]&&!b(e,l)&&(u[s][a].current=e,!u[s][a].current||t&&a===r.default.FRAGMENTED_TEXT||n.trigger(i.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:l,newMediaInfo:e,switchMode:E(a)}),!t)){var c=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);if(!c||!u[s][a].storeLastSettings)return;c.roles&&(c.role=c.roles[0],delete c.roles),c.accessibility&&(c.accessibility=c.accessibility[0]),c.audioChannelConfiguration&&(c.audioChannelConfiguration=c.audioChannelConfiguration[0]),d.setSavedMediaSettings(a,c)}}}function v(e,t){e&&t&&(c[e]=t)}function y(e){return e?c[e]:null}function E(e){return l.get().streaming.trackSwitchMode[e]}function T(){return l.get().streaming.selectionModeForInitialTrack}function _(e){return e===r.default.AUDIO||e===r.default.VIDEO||e===r.default.TEXT||e===r.default.FRAGMENTED_TEXT||e===r.default.IMAGE}function b(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function A(){u={},c={audio:null,video:null,fragmentedText:null}}function S(e,t){var n=!e.lang||t.lang.match(e.lang),r=void 0===e.index||null===e.index||t.index===e.index,i=!e.viewpoint||e.viewpoint===t.viewpoint,a=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],o=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],s=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return n&&r&&i&&a&&o&&s}function w(e){var t=0,n=[],r=void 0;return e.forEach((function(e){(r=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>t?(t=r,n=[e]):r===t&&n.push(e)})),n}function I(e){var t=1/0,n=[],r=void 0;return e.forEach((function(e){var i=e.bitrateList.reduce((function(e,t){var n=Math.max(1,t.width*t.height);return e+t.bandwidth/n}),0);(r=i/e.bitrateList.length)<t?(t=r,n=[e]):r===t&&n.push(e)})),n}function R(e){var t=0,n=[],r=void 0;return e.forEach((function(e){(r=e.representationCount)>t?(t=r,n=[e]):r===t&&n.push(e)})),n}return e={checkInitialMediaSettingsForType:function(e,t){var n=y(e),r=p(e,t),i=[];n||v(e,n=d.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&r.forEach((function(e){S(n,e)&&i.push(e)})),0===i.length?m(this.selectInitialTrack(e,r),!0):i.length>1?m(this.selectInitialTrack(e,i)):m(i[0]))},addTrack:function(e){if(e){var t=e.type;if(_(t)){var n=e.streamInfo.id;u[n]||(u[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var r=u[n][t].list,i=0,a=r.length;i<a;++i)if(b(r[i],e))return;r.push(e);var o=y(t);o&&S(o,e)&&!g(t,e.streamInfo)&&m(e)}}},getTracksFor:p,getCurrentTrackFor:g,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return u[n]&&u[n][t]&&b(u[n][t].current,e)},setTrack:m,setInitialSettings:v,getInitialSettings:y,setSwitchMode:function(e,t){if(o.warn("deprecated: Please use updateSettings({streaming: { trackSwitchMode: mode } }) instead"),-1!==f.indexOf(t)){var n={};n[e]=t,l.update({streaming:{trackSwitchMode:n}})}else o.warn("Track switch mode is not supported: "+t)},getSwitchMode:E,selectInitialTrack:function(e,t){if(e===r.default.FRAGMENTED_TEXT)return t[0];var n=T(),i=[];switch(n){case r.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:(i=w(t)).length>1&&(i=R(i));break;case r.default.TRACK_SELECTION_MODE_FIRST_TRACK:i.push(t[0]);break;case r.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:(i=I(t)).length>1&&(i=w(i));break;case r.default.TRACK_SELECTION_MODE_WIDEST_RANGE:(i=R(t)).length>1&&(i=w(t));break;default:o.warn("Track selection mode is not supported: "+n)}return i[0]},getTracksWithHighestBitrate:w,getTracksWithHighestEfficiency:I,getTracksWithWidestRange:R,setSelectionModeForInitialTrack:function(e){o.warn("deprecated: Please use updateSettings({streaming: { selectionModeForInitialTrack: mode } }) instead"),-1!==h.indexOf(e)?l.update({streaming:{selectionModeForInitialTrack:e}}):o.warn("Track selection mode is not supported: "+e)},getSelectionModeForInitialTrack:T,isMultiTrackSupportedByType:_,isTracksEqual:b,matchSettings:S,saveTextSettingsDisabled:function(){d.setSavedMediaSettings(r.default.FRAGMENTED_TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(d=e.domStorage),e.settings&&(l=e.settings))},reset:A},o=(0,s.default)(t).getInstance().getLogger(e),A(),e}l.__dashjs_factory_name="MediaController";var c=o.default.getSingletonFactory(l);o.default.updateSingletonFactory(l.__dashjs_factory_name,c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(183)),i=c(n(184)),a=c(n(12)),o=c(n(85)),s=c(n(0)),u=c(n(3)),l=c(n(4));function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e,t=void 0,n=this.context,s=(0,u.default)(n).getInstance(),c=(0,a.default)(n).getInstance(),d=void 0,f=void 0;return e={reset:function(){d.reset(),f.reset()},initialize:function(e){var n;d.setConfig({adapter:t}),n=e,d.update(n),f.chooseSelector(t.getIsDVB(n))},resolve:function(e){var t=d.getForPath(e).reduce((function(e,t){var n=f.select(t);return n?(c.isRelative(n.url)?e.url=c.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new o.default}),new o.default);if(!c.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(d=e.baseURLTreeModel),e.baseURLSelector&&(f=e.baseURLSelector),e.adapter&&(t=e.adapter)}},d=(0,r.default)(n).create(),f=(0,i.default)(n).create(),s.on(l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,(function(e){d.invalidateSelectedIndexes(e.entry)}),e),e}d.__dashjs_factory_name="BaseURLController",t.default=s.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(86)),i=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var o=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||NaN},this.children=[]};function s(){var e,t=void 0,n=void 0,i=this.context,a=(0,r.default)(i).getInstance();function s(e,t,r){var i=n.getBaseURLsFromElement(r);e[t]?a.areEqual(i,e[t].data.baseUrls)||(e[t].data.baseUrls=i,e[t].data.selectedIdx=NaN):e[t]=new o(i)}function u(){t=new o}return e={reset:u,update:function(e){!function(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var r=n.getBaseURLsFromElement(e);a.areEqual(r,t.data.baseUrls)||(t.data.baseUrls=r,t.data.selectedIdx=NaN),e&&e.Period_asArray&&e.Period_asArray.forEach((function(e,r){s(t.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,i){s(t.children[r].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach((function(e,n){s(t.children[r].children[i].children,n,e)}))}))}))}(e)},getForPath:function(e){var n=t,r=[n.data];return e&&e.forEach((function(e){(n=n.children[e])&&r.push(n.data)})),r.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){!function e(n,r){var i=r||t;n(i.data),i.children&&i.children.forEach((function(t){return e(n,t)}))}((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=NaN)}))},setConfig:function(e){e.adapter&&(n=e.adapter)}},u(),e}s.__dashjs_factory_name="BaseURLTreeModel",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(10)),i=f(n(3)),a=f(n(4)),o=f(n(185)),s=f(n(186)),u=f(n(187)),l=f(n(0)),c=f(n(6)),d=n(14);function f(e){return e&&e.__esModule?e:{default:e}}function h(){var e,t=this.context,n=(0,i.default)(t).getInstance(),l=void 0,f=void 0,h=void 0,p=void 0;function g(){l.reset()}return e={chooseSelector:function(e){(0,d.checkParameterType)(e,"boolean"),p=e?h:f},select:function(e){if(e){var t=e.baseUrls,i=e.selectedIdx;if(!isNaN(i))return t[i];var o=p.select(t);return o?(e.selectedIdx=t.indexOf(o),o):(n.trigger(a.default.URL_RESOLUTION_FAILED,{error:new c.default(r.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,r.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(p===f&&g()))}},reset:g,setConfig:function(e){e.selector&&(p=e.selector)}},l=(0,o.default)(t).create({updateEventName:a.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:a.default.SERVICE_LOCATION_BLACKLIST_ADD}),f=(0,u.default)(t).create({blacklistController:l}),h=(0,s.default)(t).create({blacklistController:l}),p=f,e}h.__dashjs_factory_name="BaseURLSelector",t.default=l.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),i=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t,n=[],r=(0,i.default)(this.context).getInstance(),a=e.updateEventName,o=e.addBlacklistEventName;function s(e){-1===n.indexOf(e)&&(n.push(e),r.trigger(a,{entry:e}))}return t={add:s,contains:function(e){return!!(n.length&&e&&e.length)&&-1!==n.indexOf(e)},reset:function(){n=[]}},o&&r.on(o,(function(e){s(e.entry)}),t),t}o.__dashjs_factory_name="BlackListController",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t=0,n=[],r=0,i=void 0,a=void 0;if((a=e.sort((function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n})).filter((function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority}))).length)return a.length>1&&(a.forEach((function(e){t+=e.dvb_weight,n.push(t)})),i=Math.floor(Math.random()*(t-1)),n.every((function(e,t){return r=t,!(i<e)}))),a[r]}((n=[],e.filter((function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)})).filter((function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)}))));var n}}}a.__dashjs_factory_name="DVBSelector",t.default=i.default.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n=0,r=void 0;return e&&e.some((function(e,r){return n=r,!t.contains(e.serviceLocation)}))&&(r=e[n]),r}}}a.__dashjs_factory_name="BasicSelector",t.default=i.default.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(n(1)),i=m(n(8)),a=m(n(189)),o=m(n(29)),s=m(n(12)),u=m(n(88)),l=m(n(6)),c=n(7),d=m(n(3)),f=m(n(4)),h=m(n(10)),p=m(n(0)),g=m(n(191));function m(e){return e&&e.__esModule?e:{default:e}}function v(e){e=e||{};var t=this.context,n=e.debug,p=(0,d.default)(t).getInstance(),m=(0,s.default)(t).getInstance(),v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=e.mssHandler,A=e.errHandler;function S(e){p.trigger(f.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return v={load:function(e){var i=new u.default(e,c.HTTPRequest.MPD_TYPE);E.load({request:i,success:function(i,a,o){if(T){var s=void 0,u=void 0,c=void 0;if(o&&o!==e?(u=m.parseBaseUrl(o),s=o):(m.isRelative(e)&&(e=m.resolve(e,window.location.href)),u=m.parseBaseUrl(e)),"No Content"!=a)if(null===_&&(_=function(e){var r=null;return e.indexOf("SmoothStreamingMedia")>-1?(b&&(r=b.createMssParser(),b.registerEvents()),r):e.indexOf("MPD")>-1||e.indexOf("Patch")>-1?(0,g.default)(t).create({debug:n}):r}(i)),null!==_){T.setMatchers(_.getMatchers()),T.setIron(_.getIron());try{c=_.parse(i)}catch(t){return void p.trigger(f.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}c?(c.url=s||e,c.originalUrl||(c.originalUrl=c.url),c.hasOwnProperty(r.default.LOCATION)&&(u=m.parseBaseUrl(c.Location_asArray[0]),y.debug("BaseURI set by Location to: "+u)),c.baseUri=u,c.loadedTime=new Date,T.resolveManifestOnLoad(c),p.trigger(f.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:i})):p.trigger(f.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}else p.trigger(f.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)});else p.trigger(f.default.INTERNAL_MANIFEST_LOADED,{manifest:null})}},error:function(t,n,r){p.trigger(f.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(h.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,h.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(e+", ")+r)})}})},reset:function(){p.off(f.default.XLINK_READY,S,v),b&&b.reset(),T&&(T.reset(),T=null),E&&(E.abort(),E=null)}},y=n.getLogger(v),p.on(f.default.XLINK_READY,S,v),E=(0,o.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:m,constants:r.default,dashConstants:i.default,errors:h.default}),T=(0,a.default)(t).create({errHandler:A,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),_=null,v}v.__dashjs_factory_name="ManifestLoader";var y=p.default.getClassFactory(v);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(190)),i=c(n(3)),a=c(n(4)),o=c(n(0)),s=c(n(89)),u=c(n(12)),l=c(n(8));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=(0,i.default)(t).getInstance(),o=(0,u.default)(t).getInstance(),c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0;function m(e,t,n){var r={},i=void 0,a=void 0;r.elements=e,r.type=t,r.resolveType=n,0===r.elements.length&&y(r);for(var s=0;s<r.elements.length;s++)i=r.elements[s],a=o.isHTTPURL(i.url)?i.url:i.originalContent.BaseURL+i.url,g.load(a,i,r)}function v(e){var t,n=void 0,r="";if(n=e.element,t=e.resolveObject,n.resolvedContent){var i=0;0===n.resolvedContent.indexOf("<?xml")&&(i=n.resolvedContent.indexOf("?>")+2),r=n.resolvedContent.substr(0,i)+"<response>"+n.resolvedContent.substr(i)+"</response>",n.resolvedContent=p.xml_str2json(r)}(function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(t)&&y(t)}function y(e){var t=[],r=void 0,i=void 0;if(function(e){var t=[],n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;for(a=e.elements.length-1;a>=0;a--){if(r=(n=e.elements[a]).type+"_asArray",n.resolvedContent){if(n.resolvedContent)for(o=0;o<n.resolvedContent[r].length;o++)i=n.resolvedContent[r][o],t.push(i)}else delete n.originalContent["xlink:actuate"],delete n.originalContent["xlink:href"],t.push(n.originalContent);for(n.parentElement[r].splice(n.index,1),s=0;s<t.length;s++)n.parentElement[r].splice(n.index+s,0,t[s]);t=[]}e.elements.length>0&&f.run(h)}(e),"onActuate"===e.resolveType&&n.trigger(a.default.XLINK_READY,{manifest:h}),"onLoad"===e.resolveType)switch(e.type){case l.default.PERIOD:for(r=0;r<h[l.default.PERIOD+"_asArray"].length;r++)(i=h[l.default.PERIOD+"_asArray"][r]).hasOwnProperty(l.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(E(i[l.default.ADAPTATION_SET+"_asArray"],i,l.default.ADAPTATION_SET,"onLoad"))),i.hasOwnProperty(l.default.EVENT_STREAM+"_asArray")&&(t=t.concat(E(i[l.default.EVENT_STREAM+"_asArray"],i,l.default.EVENT_STREAM,"onLoad")));m(t,l.default.ADAPTATION_SET,"onLoad");break;case l.default.ADAPTATION_SET:n.trigger(a.default.XLINK_READY,{manifest:h})}}function E(e,t,n,r){var i=[],a=void 0,o=void 0,s=void 0;for(o=e.length-1;o>=0;o--)(a=e[o]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===a["xlink:href"]&&e.splice(o,1);for(o=0;o<e.length;o++)(a=e[o]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===r&&(s=T(a["xlink:href"],t,n,o,r,a),i.push(s));return i}function T(e,t,n,r,i,a){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}return c={resolveManifestOnLoad:function(e){p=new s.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:d}),(h=e).Period_asArray?m(E(h.Period_asArray,h,l.default.PERIOD,"onLoad"),l.default.PERIOD,"onLoad"):n.trigger(a.default.XLINK_READY,{manifest:h})},setMatchers:function(e){e&&(d=e)},setIron:function(e){e&&(f=e)},reset:function(){n.off(a.default.XLINK_ELEMENT_LOADED,v,c),g&&(g.reset(),g=null)}},n.on(a.default.XLINK_ELEMENT_LOADED,v,c),g=(0,r.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),c}d.__dashjs_factory_name="XlinkController",t.default=o.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(6)),i=d(n(29)),a=n(7),o=d(n(88)),s=d(n(3)),u=d(n(4)),l=d(n(0)),c=d(n(10));function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=(0,s.default)(t).getInstance(),l=(0,i.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings?e.settings.get().streaming.lowLatencyEnabled:null,errors:c.default});return{load:function(e,t,i){var s=function(a,o){t.resolved=!0,t.resolvedContent=a||null,n.trigger(u.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:i,error:a||o?null:new r.default(c.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,c.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)s(null,!0);else{var d=new o.default(e,a.HTTPRequest.XLINK_EXPANSION_TYPE);l.load({request:d,success:function(e){s(e)},error:function(){s(null)}})}},reset:function(){l&&(l.abort(),l=null)}}}f.__dashjs_factory_name="XlinkLoader",t.default=l.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(0)),i=f(n(192)),a=f(n(89)),o=f(n(193)),s=f(n(194)),u=f(n(195)),l=f(n(196)),c=f(n(197)),d=f(n(199));function f(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t,n=this.context,r=e.debug,f=void 0,h=void 0,p=void 0,g=void 0;return t={parse:function(e){var t=void 0,n=window.performance.now();if(!(t=p.xml_str2json(e)))throw new Error("parsing the manifest failed");var r=window.performance.now();t.Patch?((t=t.Patch).add_asArray&&t.add_asArray.forEach((function(e){return g.run(e)})),t.replace_asArray&&t.replace_asArray.forEach((function(e){return g.run(e)}))):(t=t.MPD,g.run(t));var i=window.performance.now();return f.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(i-r).toPrecision(3)+"ms, total: "+((i-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return h},getIron:function(){return g}},f=r.getLogger(t),h=[new s.default,new u.default,new l.default,new o.default],p=new a.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:h}),g=(0,i.default)(n).create({adaptationset:new c.default,period:new d.default}),t}h.__dashjs_factory_name="DashParser",t.default=r.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=(r=n(0))&&r.__esModule?r:{default:r};function o(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,r){for(var a=0,o=e.length;a<o;++a){var s=e[a];if(n[s.name])if(r[s.name]){if(s.merge){var u=n[s.name],l=r[s.name];"object"===(void 0===u?"undefined":i(u))&&"object"===(void 0===l?"undefined":i(l))?t(u,l):r[s.name]=u+l}}else r[s.name]=n[s.name]}}function r(e,t){for(var i=0,a=e.children.length;i<a;++i){var o=e.children[i],s=t[o.name+"_asArray"];if(s)for(var u=0,l=s.length;u<l;++u){var c=s[u];n(e.properties,t,c),r(o,c)}}}return{run:function(t){if(null===t||"object"!==(void 0===t?"undefined":i(t)))return t;if(t.Period_asArray&&"period"in e)for(var n=e.period,a=t.Period_asArray,o=0,s=a.length;o<s;++o){var u=a[o];if(r(n,u),"adaptationset"in e){var l=u.AdaptationSet_asArray;if(l)for(var c=e.adaptationset,d=0,f=l.length;d<f;++d)r(c,l[d])}}return t}}}o.__dashjs_factory_name="ObjectIron";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(39)),i=a(n(8));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e,t){var n,r=(o(n={},i.default.MPD,[i.default.ID,i.default.PROFILES]),o(n,i.default.PERIOD,[i.default.ID]),o(n,i.default.BASE_URL,[i.default.SERVICE_LOCATION,i.default.BYTE_RANGE]),o(n,i.default.SEGMENT_BASE,[i.default.INDEX_RANGE]),o(n,i.default.INITIALIZATION,[i.default.RANGE]),o(n,i.default.REPRESENTATION_INDEX,[i.default.RANGE]),o(n,i.default.SEGMENT_LIST,[i.default.INDEX_RANGE]),o(n,i.default.BITSTREAM_SWITCHING,[i.default.RANGE]),o(n,i.default.SEGMENT_URL,[i.default.MEDIA_RANGE,i.default.INDEX_RANGE]),o(n,i.default.SEGMENT_TEMPLATE,[i.default.INDEX_RANGE,i.default.MEDIA,i.default.INDEX,i.default.INITIALIZATION_MINUS,i.default.BITSTREAM_SWITCHING_MINUS]),o(n,i.default.ASSET_IDENTIFIER,[i.default.VALUE,i.default.ID]),o(n,i.default.EVENT_STREAM,[i.default.VALUE]),o(n,i.default.ADAPTATION_SET,[i.default.PROFILES,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.CONTENT_TYPE]),o(n,i.default.FRAME_PACKING,[i.default.VALUE,i.default.ID]),o(n,i.default.AUDIO_CHANNEL_CONFIGURATION,[i.default.VALUE,i.default.ID]),o(n,i.default.CONTENT_PROTECTION,[i.default.VALUE,i.default.ID]),o(n,i.default.ESSENTIAL_PROPERTY,[i.default.VALUE,i.default.ID]),o(n,i.default.SUPPLEMENTAL_PROPERTY,[i.default.VALUE,i.default.ID]),o(n,i.default.INBAND_EVENT_STREAM,[i.default.VALUE,i.default.ID]),o(n,i.default.ACCESSIBILITY,[i.default.VALUE,i.default.ID]),o(n,i.default.ROLE,[i.default.VALUE,i.default.ID]),o(n,i.default.RATING,[i.default.VALUE,i.default.ID]),o(n,i.default.VIEWPOINT,[i.default.VALUE,i.default.ID]),o(n,i.default.CONTENT_COMPONENT,[i.default.CONTENT_TYPE]),o(n,i.default.REPRESENTATION,[i.default.ID,i.default.DEPENDENCY_ID,i.default.MEDIA_STREAM_STRUCTURE_ID]),o(n,i.default.SUBSET,[i.default.ID]),o(n,i.default.METRICS,[i.default.METRICS_MINUS]),o(n,i.default.REPORTING,[i.default.VALUE,i.default.ID]),n);if(r.hasOwnProperty(t)){var a=r[t];return void 0!==a&&a.indexOf(e.name)>=0}return!1}),(function(e){return String(e)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(39)),i=o(n(1)),a=o(n(8));function o(e){return e&&e.__esModule?e:{default:e}}var s=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){for(var t=[a.default.MIN_BUFFER_TIME,a.default.MEDIA_PRESENTATION_DURATION,a.default.MINIMUM_UPDATE_PERIOD,a.default.TIMESHIFT_BUFFER_DEPTH,a.default.MAX_SEGMENT_DURATION,a.default.MAX_SUBSEGMENT_DURATION,a.default.SUGGESTED_PRESENTATION_DELAY,a.default.START,i.default.START_TIME,a.default.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return s.test(e.value);return!1}),(function(e){var t=s.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(39))&&r.__esModule?r:{default:r},a=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){return a.test(e.value)}),(function(e){var t=a.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&1e3*parseFloat(t[7])||0),t[9]&&t[10]){var r=60*parseInt(t[9],10)+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*60*1e3}return new Date(n)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(39))&&r.__esModule?r:{default:r},a=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){return a.test(e.value)}),(function(e){return parseFloat(e)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(90)),i=a(n(8));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[i.default.PROFILES,i.default.WIDTH,i.default.HEIGHT,i.default.SAR,i.default.FRAMERATE,i.default.AUDIO_SAMPLING_RATE,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.MAXIMUM_SAP_PERIOD,i.default.START_WITH_SAP,i.default.MAX_PLAYOUT_RATE,i.default.CODING_DEPENDENCY,i.default.SCAN_TYPE,i.default.FRAME_PACKING,i.default.AUDIO_CHANNEL_CONFIGURATION,i.default.CONTENT_PROTECTION,i.default.ESSENTIAL_PROPERTY,i.default.SUPPLEMENTAL_PROPERTY,i.default.INBAND_EVENT_STREAM];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default.ADAPTATION_SET,e,[new r.default(i.default.REPRESENTATION,e,[new r.default(i.default.SUB_REPRESENTATION,e)])]))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}return r(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(90)),i=a(n(8));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[i.default.SEGMENT_BASE,i.default.SEGMENT_TEMPLATE,i.default.SEGMENT_LIST];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default.PERIOD,e,[new r.default(i.default.ADAPTATION_SET,e,[new r.default(i.default.REPRESENTATION,e)])]))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(3)),i=o(n(4)),a=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,r.default)(e).getInstance();return{error:function(e){t.trigger(i.default.ERROR,{error:e})}}}s.__dashjs_factory_name="ErrorHandler",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(2)),a=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e,t=this.context,n=void 0,r=void 0,o=void 0,s=void 0,u=void 0;function l(e,t){var i=n.getRealPeriodByIndex(t?t.index:null);i&&i.AdaptationSet_asArray&&0!==i.AdaptationSet_asArray.length&&(i.AdaptationSet_asArray=i.AdaptationSet_asArray.filter((function(t){return!t.Representation_asArray||0===t.Representation_asArray.length||!n.getIsTypeOf(t,e)||(t.Representation_asArray=t.Representation_asArray.filter((function(e,i){var a=n.getCodec(t,i,!0);return!!r.supportsCodec(a)||(s.error("[Stream] codec not supported: "+a),!1)})),t.Representation_asArray&&t.Representation_asArray.length>0)})))}return e={setConfig:function(e){e&&(e.adapter&&(n=e.adapter),e.capabilities&&(r=e.capabilities),e.settings&&(o=e.settings))},filterUnsupportedFeaturesOfPeriod:function(e){l(a.default.VIDEO,e),l(a.default.AUDIO,e),o.get().streaming.filterUnsupportedEssentialProperties&&function(e){var t=n.getRealPeriodByIndex(e?e.index:null);t&&t.AdaptationSet_asArray&&0!==t.AdaptationSet_asArray.length&&(t.AdaptationSet_asArray=t.AdaptationSet_asArray.filter((function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter((function(e){var t=n.getEssentialPropertiesForRepresentation(e);if(t&&t.length>0)for(var i=0;i<t.length;){if(!r.supportsEssentialProperty(t[i]))return s.debug("[Stream] EssentialProperty not supported: "+t[i].schemeIdUri),!1;i+=1}return!0})),e.Representation_asArray&&e.Representation_asArray.length>0)})))}(e),function(e){if(u&&0!==u.length){var t=n.getRealPeriodByIndex(e?e.index:null);t&&t.AdaptationSet_asArray&&0!==t.AdaptationSet_asArray.length&&(t.AdaptationSet_asArray=t.AdaptationSet_asArray.filter((function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter((function(e){return!u.some((function(t){return!t(e)}))})),e.Representation_asArray&&e.Representation_asArray.length>0)})))}}(e)},setCustomCapabilitiesFilters:function(e){u=e}},s=(0,i.default)(t).getInstance().getLogger(e),e}s.__dashjs_factory_name="CapabilitiesFilter",t.default=r.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(203)),i=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;return{initialize:function(t){if(e=new r.default,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var i=t.substr(n+1).split("&"),a=0,o=i.length;a<o;++a){var s=i[a],u=s.indexOf("=");if(-1!==u){var l=s.substring(0,u);e.hasOwnProperty(l)&&(e[l]=s.substr(u+1))}}},getURIFragmentData:function(){return e}}}o.__dashjs_factory_name="URIFragmentModel",t.default=i.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(3)),i=o(n(4)),a=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,r.default)(e).getInstance(),n=void 0;return{getValue:function(){return n},setValue:function(e){n=e,e&&t.trigger(i.default.MANIFEST_LOADED,{data:e})}}}s.__dashjs_factory_name="ManifestModel",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(83)),i=l(n(0)),a=l(n(1)),o=l(n(78)),s=l(n(23)),u=n(14);function l(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=void 0,n=void 0,i=void 0,l=this.context,c=(0,s.default)(l).getInstance();function d(e){var t=void 0;for(t=0;t<i.length;t++)if(i[t].rulename===e)return t;return-1}function f(){return c.get().streaming.lowLatencyEnabled?c.get().streaming.liveDelay||3:c.get().streaming.liveDelay}function h(e,n){p(e,n);var i=new r.default;i.schemeIdUri=e,i.value=n,t.push(i)}function p(e,n){(0,u.checkParameterType)(e,"string"),(0,u.checkParameterType)(n,"string"),t.forEach((function(r,i){r.schemeIdUri===e&&r.value===n&&t.splice(i,1)}))}return e={getABRCustomRules:function(){return i},addABRCustomRule:function(e,t,n){if("string"!=typeof e||e!==o.default.ABANDON_FRAGMENT_RULES&&e!==o.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw a.default.BAD_ARGUMENT_ERROR;var r=d(t);-1===r?i.push({type:e,rulename:t,rule:n}):(i[r].type=e,i[r].rule=n)},removeABRCustomRule:function(e){if(e){var t=d(e);-1!==t&&i.splice(t,1)}else i=[]},getStableBufferTime:function(){if(c.get().streaming.lowLatencyEnabled)return.6*f();var e=c.get().streaming.stableBufferTime;return e>-1?e:c.get().streaming.fastSwitchEnabled?20:12},getRetryAttemptsForType:function(e){var t=isNaN(c.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:c.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return c.get().streaming.lowLatencyEnabled?c.get().streaming.retryAttempts[e]*t:c.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(c.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:c.get().streaming.retryIntervals.lowLatencyReductionFactor;return c.get().streaming.lowLatencyEnabled?c.get().streaming.retryIntervals[e]/t:c.get().streaming.retryIntervals[e]},getLiveDelay:f,getLiveCatchupLatencyThreshold:function(){try{var e=c.get().streaming.liveCatchup.latencyThreshold,t=f();if(null!==e&&!isNaN(e))return Math.max(e,t);var n=c.get().streaming.liveCatchup.minDrift,r=!isNaN(t)&&t?isNaN(n)?f():c.get().streaming.liveCatchup.minDrift+f():NaN;return r&&!isNaN(r)?Math.max(4*r,5):NaN}catch(e){return NaN}},addUTCTimingSource:h,removeUTCTimingSource:p,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){var e=c.get().streaming.utcSynchronization.defaultTimingSource;h(e.scheme,e.value)},setXHRWithCredentialsForType:function e(t,r){t?n[t]=!!r:Object.keys(n).forEach((function(t){e(t,r)}))},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t},getDefaultUtcTimingSource:function(){return c.get().streaming.utcSynchronization.defaultTimingSource},reset:function(){}},t=[],n={default:!1},i=[],e}c.__dashjs_factory_name="MediaPlayerModel",t.default=i.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(0)),i=s(n(3)),a=s(n(4)),o=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e,t=void 0,n=void 0,r=void 0,s=void 0,u=this.context,l=(0,i.default)(u).getInstance(),c=[];function d(){n&&(n.playbackRate=s||1,n.removeEventListener("canplay",d))}function f(e){n&&(n.readyState<=2&&e>0?n.addEventListener("canplay",d):n.playbackRate=e)}function h(){return c.length>0}function p(){if(n&&h()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function g(){return n?n.buffered:null}function m(e,t,r,i,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===r&&n.textTracks[o].isTTML===i&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null}return e={initialize:function(){l.on(a.default.PLAYBACK_PLAYING,p,this)},setCurrentTime:function(e,t){if(n){if(n.currentTime==e)return;try{e=t?function(e){var t=g(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(e>=a&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o)}return n}(e):e,n.currentTime=e}catch(t){0===n.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout((function(){n.currentTime=e}),400)}}},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch((function(e){"NotAllowedError"===e.name&&l.trigger(a.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")")}))}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isStalled:h,isSeeking:function(){return n?n.seeking:null},getTime:function(){return n?n.currentTime:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:f,getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){var t=void 0;null!==e&&n&&!n.seeking&&-1===c.indexOf(e)&&(c.push(e),n&&1===c.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),s=n.playbackRate,f(0),n.dispatchEvent(t)))}(e):function(e){var t=c.indexOf(e),r=void 0;null!==e&&(-1!==t&&c.splice(t,1),n&&!1===h()&&0===n.playbackRate&&(f(s||1),n.paused||((r=document.createEvent("Event")).initEvent("playing",!0,!1),n.dispatchEvent(r))))}(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return r},setTTMLRenderingDiv:function(e){(r=e).style.position="absolute",r.style.display="flex",r.style.overflow="hidden",r.style.pointerEvents="none",r.style.top=0,r.style.left=0},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){n&&n.addEventListener(e,t)},removeEventListener:function(e,t){n&&n.removeEventListener(e,t)},getReadyState:function(){return n?n.readyState:NaN},getBufferRange:g,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:m,addTextTrack:function(e,t,r,i,a){if(!n)return null;var o=m(e,t,r,i,a);return o||((o=n.addTextTrack(e,t,r)).isEmbedded=a,o.isTTML=i),o},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},reset:function(){l.off(a.default.PLAYBACK_PLAYING,p,this)}},t=(0,o.default)(u).getInstance().getLogger(e),e}u.__dashjs_factory_name="VideoModel",t.default=r.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(2)),a=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}];function u(e){e=e||{};var t,n=this.context,r=e.settings,o=void 0,u=void 0;function l(e){if(void 0!==u)return u;u=!1;var t=void 0;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return o.warn("DOMStorage access denied: "+e.message),u}if(!t||"localStorage"!==e&&"sessionStorage"!==e)return u;try{t.setItem("1","1"),t.removeItem("1"),u=!0}catch(e){o.warn("DOMStorage is supported, but cannot be used: "+e.message)}return u}function c(){return 6e5*Math.round((new Date).getTime()/6e5)}function d(e,t){return l(e)&&r.get().streaming[t+"CachingInfo"].enabled}function f(){if(!r)throw new Error(a.default.MISSING_CONFIG_ERROR)}return t={getSavedBitrateSettings:function(e){var t=NaN;if(f(),d("localStorage","lastBitrate")){var n="dashjs_?_bitrate".replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(n))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=r.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(i.bitrate);isNaN(s)||a?a&&localStorage.removeItem(n):(t=s,o.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(d("localStorage","lastBitrate")&&t){var n="dashjs_?_bitrate".replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:c()}))}catch(e){o.error(e.message)}}},getSavedMediaSettings:function(e){var t=null;if(f(),d("localStorage","lastMediaSettings")){var n="dashjs_?_settings".replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(n))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=r.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=i.settings,a&&(localStorage.removeItem(n),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(d("localStorage","lastMediaSettings")){var n="dashjs_?_settings".replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:c()}))}catch(e){o.error(e.message)}}}},o=(0,i.default)(n).getInstance().getLogger(t),l("localStorage")&&s.forEach((function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){o.error(e.message)}}})),t}u.__dashjs_factory_name="DOMStorage";var l=r.default.getSingletonFactory(u);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),i=o(n(209)),a=o(n(210));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=this.context,n=e.eventBus,r=e.events,o=e.dashMetrics,s=e.mediaPlayerModel,u=e.errHandler,l=e.baseURLController,c=e.debug,d=e.boxParser,f=e.requestModifier,h=e.errors,p=void 0,g=void 0,m=void 0;function v(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}function y(e){v(e.mimeType)?m.loadInitialization(e.streamId,e.mediaType,e.representation):g.loadInitialization(e.streamId,e.mediaType,e.representation)}function E(e){v(e.mimeType)?m.loadSegments(e.streamId,e.mediaType,e.representation,e.representation?e.representation.indexRange:null,e.callback):g.loadSegments(e.streamId,e.mediaType,e.representation,e.representation?e.representation.indexRange:null,e.callback)}return p={initialize:function(){n.on(r.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.on(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,E,p),g.initialize(),m.initialize()},reset:function(){n.off(r.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.off(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,E,p)}},g=(0,i.default)(t).getInstance(),m=(0,a.default)(t).getInstance(),g.setConfig({baseURLController:l,dashMetrics:o,mediaPlayerModel:s,errHandler:u,eventBus:n,events:r,errors:h,debug:c,boxParser:d,requestModifier:f}),m.setConfig({baseURLController:l,dashMetrics:o,mediaPlayerModel:s,errHandler:u,eventBus:n,events:r,errors:h,debug:c,requestModifier:f}),p}s.__dashjs_factory_name="SegmentBaseController";var u=r.default.getSingletonFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(52)),i=u(n(6)),a=u(n(0)),o=u(n(15)),s=u(n(29));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context,t=void 0,n=void 0,a=void 0,u=void 0,l=void 0,c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0;function _(){if(!T||!T.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function b(e){if(e.url){var t=new o.default;return t.setInfo(e),t}}function A(e,t,n,r){g.trigger(p.SEGMENTS_LOADED,{segments:n,representation:r,error:n?void 0:new i.default(m.SEGMENT_BASE_LOADER_ERROR_CODE,m.SEGMENT_BASE_LOADER_ERROR_MESSAGE)},{streamId:e,mediaType:t})}return t={setConfig:function(e){e.baseURLController&&(T=e.baseURLController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(f=e.mediaPlayerModel),e.errHandler&&(a=e.errHandler),e.settings&&(d=e.settings),e.boxParser&&(u=e.boxParser),e.events&&(p=e.events),e.eventBus&&(g=e.eventBus),e.debug&&(n=e.debug.getLogger(t)),e.requestModifier&&(l=e.requestModifier),e.errors&&(m=e.errors),e.urlUtils&&(E=e.urlUtils),e.constants&&(v=e.constants),e.dashConstants&&(y=e.dashConstants)},initialize:function(){h=(0,s.default)(e).create({errHandler:a,dashMetrics:c,mediaPlayerModel:f,requestModifier:l,useFetch:d?d.get().streaming.lowLatencyEnabled:null,boxParser:u,errors:m,urlUtils:E,constants:v,dashConstants:y})},loadInitialization:function e(t,r,i,a){_();var o=null,s=i?T.resolve(i.path):null,l=a||{init:!0,url:s?s.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:r};n.debug("Start searching for initialization.");var c=b(l);h.load({request:c,success:function(n){l.bytesLoaded=l.range.end,(o=u.findInitRange(n))?(i.range=o,g.trigger(p.INITIALIZATION_LOADED,{representation:i},{streamId:t,mediaType:r})):(l.range.end=l.bytesLoaded+l.bytesToLoad,e(t,r,i,l))},error:function(){g.trigger(p.INITIALIZATION_LOADED,{representation:i},{streamId:t,mediaType:r})}}),n.debug("Perform init search: "+l.url)},loadSegments:function e(t,i,a,o,s,l){if(_(),o&&(void 0===o.start||void 0===o.end)){var c=o?o.toString().split("-"):null;o=c?{start:parseFloat(c[0]),end:parseFloat(c[1])}:null}s=s||A;var d=null,f=null,p=!!o,g=a?T.resolve(a.path):null,m={init:!1,url:g?g.url:void 0,range:p?o:{start:0,end:1500},searching:!p,bytesLoaded:l?l.bytesLoaded:0,bytesToLoad:1500,mediaType:i},v=b(m);h.load({request:v,success:function(o){var l=m.bytesToLoad,c=o.byteLength;if(m.bytesLoaded=m.range.end-m.range.start,d=u.parse(o),(f=d.getBox("sidx"))&&f.isComplete){var h=f.references,p=void 0,g=void 0;if(null!=h&&h.length>0&&(p=1===h[0].reference_type),p){n.debug("Initiate multiple SIDX load."),m.range.end=m.range.start+f.size;var v=void 0,y=void 0,E=void 0,T=void 0,_=[],b=0,A=(f.offset||m.range.start)+f.size,S=function(e,t,n){n?(_=_.concat(n),++b>=y&&(_.sort((function(e,t){return e.startTime-t.startTime<0?-1:0})),s(e,t,_,a))):s(e,t,null,a)};for(v=0,y=h.length;v<y;v++)E=A,T=A+h[v].referenced_size-1,A+=h[v].referenced_size,e(t,i,a,{start:E,end:T},S,m)}else n.debug("Parsing segments from SIDX. representation "+i+" - id: "+a.id+" for range : "+m.range.start+" - "+m.range.end),g=function(e,t){for(var n=e.references,i=n.length,a=e.timescale,o=e.earliest_presentation_time,s=t.range.start+e.offset+e.first_offset+e.size,u=[],l=void 0,c=void 0,d=void 0,f=void 0,h=0;h<i;h++)d=n[h].subsegment_duration,f=n[h].referenced_size,(l=new r.default).duration=d,l.startTime=o,l.timescale=a,c=s+f-1,l.mediaRange=s+"-"+c,u.push(l),o+=d,s+=f;return u}(f,m),s(t,i,g,a)}else{if(f)m.range.start=f.offset||m.range.start,m.range.end=m.range.start+(f.size||l);else{if(c<m.bytesLoaded)return void s(t,i,null,a);var w=d.getLastBox();w&&w.size?(m.range.start=w.offset+w.size,m.range.end=m.range.start+l):m.range.end+=l}e(t,i,a,m.range,s,m)}},error:function(){s(t,i,null,a)}}),n.debug("Perform SIDX load: "+m.url+" with range : "+m.range.start+" - "+m.range.end)},reset:function(){h.abort(),h=null,a=null,u=null,l=null}}}l.__dashjs_factory_name="SegmentBaseLoader",t.default=a.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(211)),i=c(n(1)),a=c(n(0)),o=c(n(52)),s=c(n(15)),u=c(n(29)),l=c(n(6));function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e=this.context,t=void 0,n=void 0,a=void 0,c=void 0,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0;function T(t,i,s,u){var l,c,d=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=void 0;for(f=[],p=0,c=(l=function(t){var n=[],i=(0,r.default)(e).create({data:t}),o=void 0,s=void 0;for(i.consumeTagAndSize(a.Segment.Cues);i.moreData()&&i.consumeTagAndSize(a.Segment.Cues.CuePoint,!0);){for((o={}).CueTime=i.parseTag(a.Segment.Cues.CuePoint.CueTime),o.CueTracks=[];i.moreData()&&i.consumeTag(a.Segment.Cues.CuePoint.CueTrackPositions,!0);){var u=i.getMatroskaCodedNum(),l=i.getPos();if((s={}).Track=i.parseTag(a.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===s.Track)throw new Error("Cue track cannot be 0");s.ClusterPosition=i.parseTag(a.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),o.CueTracks.push(s),i.setPos(l+u)}if(0===o.CueTracks.length)throw new Error("Mandatory cuetrack not found");n.push(o)}if(0===n.length)throw new Error("mandatory cuepoint not found");return n}(t)).length;p<c;p+=1)h=new o.default,d=0,d=p<l.length-1?l[p+1].CueTime-l[p].CueTime:u-l[p].CueTime,h.duration=d,h.startTime=l[p].CueTime,h.timescale=1e3,g=l[p].CueTracks[0].ClusterPosition+i,m=p<l.length-1?l[p+1].CueTracks[0].ClusterPosition+i-1:s-1,h.mediaRange=g+"-"+m,f.push(h);return n.debug("Parsed cues: "+f.length+" cues."),f}function _(){if(!E||!E.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function b(e,t,n,r){m.trigger(v.SEGMENTS_LOADED,{segments:n,representation:r,error:n?void 0:new l.default(y.SEGMENT_BASE_LOADER_ERROR_CODE,y.SEGMENT_BASE_LOADER_ERROR_MESSAGE)},{streamId:e,mediaType:t})}function A(e){var t=new s.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(i.default.MISSING_CONFIG_ERROR);E=e.baseURLController,f=e.dashMetrics,h=e.mediaPlayerModel,c=e.errHandler,g=e.settings,v=e.events,m=e.eventBus,y=e.errors,n=e.debug.getLogger(t),d=e.requestModifier},initialize:function(){p=(0,u.default)(e).create({errHandler:c,dashMetrics:f,mediaPlayerModel:h,requestModifier:d,useFetch:g?g.get().streaming.lowLatencyEnabled:null,errors:y})},loadInitialization:function(e,t,r,i){_();var a=null,o=r?E.resolve(r.path):null,s=r?r.range.split("-"):null,u=i||{range:{start:s?parseFloat(s[0]):null,end:s?parseFloat(s[1]):null},request:a,url:o?o.url:void 0,init:!0,mediaType:t};n.info("Start loading initialization."),a=A(u),p.load({request:a,success:function(){m.trigger(v.INITIALIZATION_LOADED,{representation:r},{streamId:e,mediaType:t})},error:function(){m.trigger(v.INITIALIZATION_LOADED,{representation:r},{streamId:e,mediaType:t})}}),n.debug("Perform init load: "+u.url)},loadSegments:function(t,i,o,s,u){_();var l=null,c=o?E.resolve(o.path):null,d=c?c.url:void 0;u=u||b,l=A({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:l,url:d,init:!1,mediaType:i}),n.debug("Parsing ebml header"),p.load({request:l,success:function(l){!function(t,i,o,s){if(t&&0!==t.byteLength){var u,l=(0,r.default)(e).create({data:t}),c=void 0,d=void 0,f=void 0,h=o?o.split("-"):null,g=null,m={url:i,range:{start:h?parseFloat(h[0]):null,end:h?parseFloat(h[1]):null},request:g};for(n.debug("Parse EBML header: "+m.url),l.skipOverElement(a.EBML),l.consumeTag(a.Segment),f=l.getMatroskaCodedNum(),f+=l.getPos(),u=l.getPos();l.moreData()&&!l.consumeTagAndSize(a.Segment.Info,!0);)if(!(l.skipOverElement(a.Segment.SeekHead,!0)||l.skipOverElement(a.Segment.Tracks,!0)||l.skipOverElement(a.Segment.Cues,!0)||l.skipOverElement(a.Void,!0)))throw new Error("no valid top level element found");for(;void 0===c;){var v=l.getMatroskaCodedNum(!0),y=l.getMatroskaCodedNum();switch(v){case a.Segment.Info.Duration.tag:c=l[a.Segment.Info.Duration.parse](y);break;default:l.setPos(l.getPos()+y)}}g=A(m),p.load({request:g,success:function(e){d=T(e,u,f,c),s(d)},error:function(){n.error("Download Error: Cues "+m.url),s(null)}}),n.debug("Perform cues load: "+m.url+" bytes="+m.range.start+"-"+m.range.end)}else s(null)}(l,d,s,(function(e){u(t,i,e,o)}))},error:function(){u(t,i,null,o)}})},reset:function(){c=null,d=null}},a={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}d.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=a.default.getSingletonFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(0))&&r.__esModule?r:{default:r};function a(e){e=e||{};var t=void 0,n=new DataView(e.data),r=0;function i(e,t){var i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(r)!==e.tag&&(i=!1),a=4):e.tag>65535?(256*n.getUint16(r)+n.getUint8(r+2)!==e.tag&&(i=!1),a=3):e.tag>255?(n.getUint16(r)!==e.tag&&(i=!1),a=2):(n.getUint8(r)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(r+=a),i}function a(e){var t=1,i=128,a=-1,o=0,s=n.getUint8(r),u=0;for(u=0;u<8;u+=1){if((s&i)===i){o=void 0===e?s&~i:s,a=u;break}i>>=1}for(u=0;u<a;u+=1,t+=1)o=o<<8|255&n.getUint8(r+t);return r+=t,o}return t={getPos:function(){return r},setPos:function(e){r=e},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n},parseTag:function(e){var n;return i(e),n=a(),t[e.parse](n)},skipOverElement:function(e,t){var n=i(e,t),o=void 0;return n&&(o=a(),r+=o),n},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t=void 0;switch(e){case 4:t=n.getFloat32(r),r+=4;break;case 8:t=n.getFloat64(r),r+=8}return t},getMatroskaUint:function(e){for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&n.getUint8(r+i);return r+=e,t},moreData:function(){return r<n.byteLength}}}a.__dashjs_factory_name="EBMLParser",t.default=i.default.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(8)),i=f(n(213)),a=f(n(214)),o=f(n(215)),s=f(n(216)),u=f(n(84)),l=f(n(0)),c=f(n(56)),d=f(n(217));function f(e){return e&&e.__esModule?e:{default:e}}function h(){var e,t=void 0,n=void 0,l=void 0,f=void 0,h=void 0,p=void 0,g=void 0,m=this.context;function v(e,n,i){var a,o=t.getAdaptationsForType(l[0].mpd.manifest,e,n);if(!o||0===o.length)return null;if(o.length>1&&i){var s=E(i,n);if(h[i.id]&&h[i.id][n])for(var u=0,c=o.length;u<c;u++)if(y(h[i.id][n],s[u]))return o[u];for(var d=0,f=o.length;d<f;d++)if(a=o[d],t.getRolesForAdaptation(a).filter((function(e){return e.value===r.default.MAIN}))[0])return o[d]}return o[0]}function y(e,t){if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function E(e,n,r){var i,a=l,o=r,s=[],u=void 0,c=void 0,d=void 0,h=void 0,g=void 0,m=void 0;if(o)D(),a=T(o);else{if(!(l.length>0))return s;o=l[0].mpd.manifest}var v=w(e,a);v&&(m=v.id);var y=t.getAdaptationsForType(o,e?e.index:null,n!==p.EMBEDDED_TEXT?n:p.VIDEO);if(!y||0===y.length)return s;for(f[m]=f[m]||t.getAdaptationsForPeriod(v),h=0,i=y.length;h<i;h++)if(u=y[h],d=t.getIndexForAdaptation(u,o,e.index),c=I(f[m][d]),n===p.EMBEDDED_TEXT){var E=c.accessibility.length;for(g=0;g<E;g++)if(c){var _=c.accessibility[g];if(0===_.indexOf("cea-608:")){var b=_.substring(8).split(";");if("CC"===b[0].substring(0,2))for(g=0;g<b.length;g++)c||(c=I.call(this,f[m][d])),R(c,b[g].substring(0,3),b[g].substring(4)),s.push(c),c=null;else for(g=0;g<b.length;g++)c||(c=I.call(this,f[m][d])),R(c,"CC"+(g+1),b[g]),s.push(c),c=null}else 0===_.indexOf("cea-608")&&(R(c,p.CC1,"eng"),s.push(c),c=null)}}else n===p.IMAGE?(c.type=p.IMAGE,s.push(c),c=null):c&&s.push(c);return s}function T(e){var n=_(e);return t.getRegularPeriods(n)}function _(e){var n=A(e);return t.getMpd(n)}function b(){l=[],f={},h={}}function A(e){return e||(l.length>0?l[0].mpd.manifest:null)}function S(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&f[e.streamInfo.id]?f[e.streamInfo.id][e.index]:null}function w(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i}return null}function I(e){if(!e)return null;var n,r=new a.default,i=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return r.id=e.id,r.index=e.index,r.type=e.type,r.streamInfo=C(e.period),r.representationCount=t.getRepresentationCount(i),r.labels=t.getLabelsForAdaptation(i),r.lang=t.getLanguageForAdaptation(i),n=t.getViewpointForAdaptation(i),r.viewpoint=n?n.value:void 0,r.accessibility=t.getAccessibilityForAdaptation(i).map((function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==g&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n})),r.audioChannelConfiguration=t.getAudioChannelConfigurationForAdaptation(i).map((function(e){return e.value})),0===r.audioChannelConfiguration.length&&Array.isArray(i.Representation_asArray)&&i.Representation_asArray.length>0&&(r.audioChannelConfiguration=t.getAudioChannelConfigurationForRepresentation(i.Representation_asArray[0]).map((function(e){return e.value}))),r.roles=t.getRolesForAdaptation(i).map((function(e){return e.value})),r.codec=t.getCodec(i),r.mimeType=t.getMimeType(i),r.contentProtection=t.getContentProtectionData(i),r.bitrateList=t.getBitrateListForAdaptation(i),r.contentProtection&&r.contentProtection.forEach((function(e){e.KID=t.getKID(e)})),r.isText=t.getIsTextTrack(r.mimeType),r.supplementalProperties=t.getSupplementalPropperties(i),r}function R(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=p.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function C(e){var n,r,i=new o.default;return i.id=e.id,i.index=e.index,i.start=e.start,i.duration=e.duration,i.manifestInfo=(n=e.mpd,(r=new s.default).DVRWindowSize=n.timeShiftBufferDepth,r.loadedTime=n.manifest.loadedTime,r.availableFrom=n.availabilityStartTime,r.minBufferTime=n.manifest.minBufferTime,r.maxFragmentDuration=n.maxSegmentDuration,r.duration=t.getDuration(n.manifest),r.isDynamic=t.getIsDynamic(n.manifest),r.serviceDescriptions=t.getServiceDescriptions(n.manifest),r.protocol=n.manifest.protocol,r),i.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(i.start+i.duration-i.manifestInfo.duration)<1,i}function D(){if(!p)throw new Error("setConfig function has to be called previously")}function M(e){return l.length>0?l[0].mpd.manifest.Period_asArray[e]:null}function L(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=L(M(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=L(e,t,!0);return null!==n?n:-1}(M(t),e)},getMaxIndexForBufferType:function(e,n){return function(e,n){var r,i=void 0,a=void 0,o=void 0;if(!e||!n)return-1;for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)if(a=(i=r[o]).Representation_asArray,t.getIsTypeOf(i,n))return a.length;return-1}(M(n),e)},convertDataToRepresentationInfo:function(e){if(e){var n=new i.default,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],a=t.getRepresentationFor(e.index,r);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(a),n.DVRWindow=e.segmentAvailabilityRange,n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.mediaInfo=I(e.adaptation),n}return null},getDataForMedia:S,getStreamsInfo:function(e,t){var n=[],r=l;if(e&&(D(),r=T(e)),r.length>0){(!t||t>r.length)&&(t=r.length);for(var i=0;i<t;i++)n.push(C(r[i]))}return n},getMediaInfoForType:function(e,n){if(0===l.length||!e)return null;var r=w(e,l);if(!r)return null;var i=r.id;f[i]=f[i]||t.getAdaptationsForPeriod(r);var a=v(e.index,n,e);if(!a)return null;var o=t.getIndexForAdaptation(a,l[0].mpd.manifest,e.index);return I(f[i][o])},getAllMediaInfoForType:E,getAdaptationForType:v,getRealAdaptation:function(e,n){var r,i=void 0,a=w(e,l);return r=n?n.id:null,l.length>0&&a&&(i=r?t.getAdaptationForId(r,l[0].mpd.manifest,a.index):t.getAdaptationForIndex(n?n.index:null,l[0].mpd.manifest,a.index)),i},getRealPeriodByIndex:function(e){return t.getRealPeriodForIndex(e,l[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(e){try{return t.getEssentialPropertiesForRepresentation(e)}catch(e){return[]}},getVoRepresentations:function(e){var n=S(e);return t.getRepresentationsForAdaptation(n)},getEventsFor:function(e,n){var r=[];if(l.length>0){var s=l[0].mpd.manifest;e instanceof o.default?r=t.getEventsForPeriod(w(e,l)):e instanceof a.default?r=t.getEventStreamForAdaptationSet(s,S(e)):e instanceof i.default&&(r=t.getEventStreamForRepresentation(s,n))}return r},getEvent:function(e,t,n,r){try{if(!e||!t||isNaN(n)||!r)return null;var i=e.scheme_id_uri,a=e.value;if(!t[i+"/"+a])return null;var o,s=new u.default,l=e.timescale||1,c=r.adaptation.period.start,d=t[i+"/"+a],f=isNaN(r.presentationTimeOffset)?isNaN(d.presentationTimeOffset)?0:d.presentationTimeOffset:r.presentationTimeOffset,h=e.presentation_time_delta/l;o=0===e.version?c+n-f+h:c-f+h;var p=e.event_duration,g=e.id,m=e.message_data;return s.eventStream=d,s.eventStream.value=a,s.eventStream.timescale=l,s.duration=p,s.id=g,s.calculatedPresentationTime=o,s.messageData=m,s.presentationTimeDelta=h,s}catch(e){return null}},getMpd:_,setConfig:function(e){e&&(e.constants&&(p=e.constants),e.cea608parser&&(g=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;D(),l=T(e),f={}},getIsTextTrack:function(e){return t.getIsTextTrack(e)},getUTCTimingSources:function(){var e=A();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=l.length>0?l[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var n=_(e);return t.getAvailabilityStartTime(n)},getIsTypeOf:function(e,n){return t.getIsTypeOf(e,n)},getIsDynamic:function(e){var n=A(e);return t.getIsDynamic(n)},getDuration:function(e){var n=A(e);return t.getDuration(n)},getRegularPeriods:T,getLocation:function(e){return t.getLocation(e)},getPatchLocation:function(e){var n=t.getPatchLocation(e),r=t.getPublishTime(e);if(!n||!r)return null;if(n.hasOwnProperty("ttl")&&r){var i=1e3*parseFloat(n.ttl);if(r.getTime()+i<=(new Date).getTime())return null}return n.__text},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n)},getPublishTime:function(e){return t.getPublishTime(e)},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(e){return n.getIsPatch(e)},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,n,r){return t.getCodec(e,n,r)},getVoAdaptations:function(){return f},getVoPeriods:function(){return l},getPeriodById:function(e){if(!e||0===l.length)return null;var t=l.filter((function(t){return t.id===e}));return t&&t.length>0?t[0]:null},setCurrentMediaInfo:function(e,t,n){h[e]=h[e]||{},h[e][t]=h[e][t]||{},h[e][t]=n},isPatchValid:function(e,r){var i=t.getId(e),a=n.getMpdId(r),o=t.getPublishTime(e),s=n.getPublishTime(r),u=n.getOriginalPublishTime(r);return!!(i&&a&&i==a&&o&&u&&o.getTime()==u.getTime()&&s&&o.getTime()<s.getTime())},applyPatchToManifest:function(e,t){n.getPatchOperations(t).forEach((function(t){var n=t.getMpdTarget(e);if(null!==n){var r=n.name,i=n.target,a=n.leaf;if(t.xpath.findsAttribute())switch(t.action){case"add":case"replace":i[r]=t.value;break;case"remove":delete i[r]}else{var o=(i[r+"_asArray"]||[]).indexOf(a),s="prepend"===t.position||"before"===t.position;if(("remove"===t.action||"replace"===t.action)&&(delete i[r],-1!=o)){var u=i[r+"_asArray"];u.splice(o,1),u.length>1?i[r]=u:1==u.length?i[r]=u[0]:delete i[r+"_asArray"]}"add"!==t.action&&"replace"!==t.action||Object.keys(t.value).forEach((function(e){var n=t.value[e],a=i[e+"_asArray"]||[];if(0===a.length&&i[e]&&a.push(i[e]),0===a.length)a=n;else{var u=a.length;u=e==r&&-1!=o?o+(s?0:1)+("replace"==t.action?-1:0):s?0:a.length,a.splice.apply(a,[u,0].concat(n))}i[e+"_asArray"]=a,i[e]=1==a.length?a[0]:a}))}}}))},reset:b},t=(0,c.default)(m).getInstance(),n=(0,d.default)(m).getInstance(),b(),e}h.__dashjs_factory_name="DashAdapter",t.default=l.default.getSingletonFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(8)),i=u(n(0)),a=u(n(2)),o=u(n(218)),s=u(n(219));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e,t=void 0,n=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(r.default.ORIGINAL_MPD_ID)||!1},getPublishTime:function(e){return e&&e.hasOwnProperty(r.default.PUBLISH_TIME)?new Date(e[r.default.PUBLISH_TIME]):null},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(r.default.ORIGINAL_PUBLISH_TIME)?new Date(e[r.default.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(e){return e&&e[r.default.ORIGINAL_MPD_ID]||null},getPatchOperations:function(e){return e?(e.__children||[]).map((function(e){var n=Object.keys(e)[0];if("add"!==n&&"remove"!==n&&"replace"!==n)return t.warn("Ignoring node of invalid action: "+n),null;var r=e[n],i=r.sel;if("add"===n&&r.type){if(!r.type.startsWith("@"))return t.warn("Ignoring add action for prefixed namespace declaration: "+r.type+"="+r.__text),null;i=i+"/"+r.type}var a=new o.default(i);if(!a.isValid())return t.warn("Ignoring action with invalid selector: "+n+" - "+i),null;var u=null;a.findsAttribute()?u=r.__text||"":"remove"!==n&&(u=r.__children.reduce((function(e,t){var n=Object.keys(t)[0];return"#text"!==n&&(e[n]=e[n]||[],e[n].push(t[n])),e}),{}));var l=new s.default(n,a,u);return"add"===n&&(l.position=r.pos),l})).filter((function(e){return!!e})):[]}},t=(0,a.default)(n).getInstance().getLogger(e),e}l.__dashjs_factory_name="PatchManifestModel",t.default=i.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valid="/"==t[0],this.path=t.split("/").filter((function(e){return 0!==e.length})).map((function(e){var t={name:e},r=e.indexOf("[");if(-1!=r){t.name=e.substring(0,r);var i=e.substring(r+1,e.length-1);n.valid=n.valid&&-1==i.indexOf("[");var a=i.indexOf("=");-1!=a?(t.attribute={name:i.substring(1,a),value:i.substring(a+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(i,10)-1}return t}))}return r(e,[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(e,t){for(var n=null,r=e,i=1,a="MPD";i<this.path.length&&null!==r;){n=r;var o=this.path[i];if(a=o.name,i!==this.path.length-1||!a.startsWith("@")){var s=n[a+"_asArray"]||[];0===s.length&&n[a]&&s.push(n[a]),o.position?r=s[o.position]||null:o.attribute?function(){var e=o.attribute;r=s.filter((function(t){return t[e.name]==e.value}))[0]||null}():r=s[0]||null}i++}return null===r?null:a.startsWith("@")?{name:a.substring(1),leaf:r,target:r}:{name:a,leaf:r,target:t?n:r}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=t,this.xpath=n,this.value=r,this.position=null}return r(e,[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(1)),i=n(7),a=d(n(0)),o=d(n(9)),s=d(n(221)),u=d(n(222)),l=d(n(30)),c=n(54);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t,n=this.context,a=void 0,d=void 0,f=void 0,h=e.metricsModel;function p(e){var t=h.getMetricsFor(e,!0);if(!t)return null;var n=t.HttpList,r=null,i=void 0;if(!n||n.length<=0)return null;for(i=n.length-1;i>=0;){if(n[i].responsecode){r=n[i];break}i--}return r}function g(e){var t=h.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function m(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}return t={getCurrentRepresentationSwitch:function(e){return m(h.getMetricsFor(e,!0),o.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return m(h.getMetricsFor(e,!0),o.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=m(h.getMetricsFor(e,!0),o.default.BUFFER_LEVEL);return t?s.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:p,getHttpRequests:g,getCurrentDroppedFrames:function(){return m(h.getMetricsFor(r.default.VIDEO,!0),o.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return m(h.getMetricsFor(e,!0),o.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return m(e?h.getMetricsFor(e,!0):h.getMetricsFor(r.default.VIDEO,!0)||h.getMetricsFor(r.default.AUDIO,!0),o.default.DVR_INFO)},getCurrentManifestUpdate:function(){return m(h.getMetricsFor(r.default.STREAM),o.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var n={},r=p(e);return r&&(n=l.default.parseHttpHeaders(r._responseHeaders)),void 0===n[t]?null:n[t]},getLatestMPDRequestHeaderValueByID:function(e){var t,n={},a=void 0,o=void 0;for(o=(t=g(r.default.STREAM)).length-1;o>=0;o--)if((a=t[o]).type===i.HTTPRequest.MPD_TYPE){n=l.default.parseHttpHeaders(a._responseHeaders);break}return void 0===n[e]?null:n[e]},addRepresentationSwitch:function(e,t,n,r,i){h.addRepresentationSwitch(e,t,n,r,i)},addDVRInfo:function(e,t,n,r){h.addDVRInfo(e,t,n,r)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();h.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();h.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();h.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){h.addManifestUpdate(r.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,r,i){h.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i)},addSchedulingInfo:function(e,t){h.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){h.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){h.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){h.addBufferState(e,t,n)},addDroppedFrames:function(e){h.addDroppedFrames(r.default.VIDEO,e)},addPlayList:function(){f&&(h.addPlayList(f),f=null)},addDVBErrors:function(e){h.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(f=new c.PlayList).start=new Date,f.mstart=e,f.starttype=t},createPlaylistTraceMetrics:function(e,t,n){!0===a&&(a=!1,(d=new c.PlayListTrace).representationid=e,d.start=new Date,d.mstart=t,d.playbackspeed=null!==n?n.toString():null)},updatePlayListTraceMetrics:function(e){if(d)for(var t in d)d[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===a&&f&&d&&d.start){var n=d.start,r=e.getTime()-n.getTime();d.duration=r,d.stopreason=t,f.trace.push(d),a=!0}},clearAllCurrentMetrics:function(){h.clearAllCurrentMetrics()}},h=h||(0,u.default)(n).getInstance({settings:e.settings}),a=!0,d=null,f=null,t}f.__dashjs_factory_name="DashMetrics",t.default=a.default.getSingletonFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"round10",value:function(e,t){return function(e,t,n){return void 0===n||0==+n?Math[e](t):(n=+n,null===(t=+t)||isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}("round",e,t)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(1)),i=y(n(9)),a=y(n(223)),o=n(7),s=y(n(224)),u=y(n(225)),l=y(n(226)),c=y(n(227)),d=y(n(228)),f=n(229),h=y(n(230)),p=y(n(3)),g=y(n(231)),m=y(n(4)),v=y(n(0));function y(e){return e&&e.__esModule?e:{default:e}}function E(e){var t,n=(e=e||{}).settings,v=this.context,y=(0,p.default)(v).getInstance(),E=void 0;function T(){y.trigger(m.default.METRICS_CHANGED)}function _(e){y.trigger(m.default.METRIC_CHANGED,{mediaType:e}),T()}function b(e,t,n){y.trigger(m.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),_(e)}function A(e,t,n){y.trigger(m.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),_(e)}function S(e,t){var n=null;return e?(E.hasOwnProperty(e)?n=E[e]:t||(n=new a.default,E[e]=n),n):n}function w(e,t,r){var i=S(e);null!==i&&(i[t].push(r),i[t].length>n.get().streaming.metricsMaxListDepth&&i[t].shift())}function I(e,t,n){w(e,t,n),A(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete E[e],_(e)},clearAllCurrentMetrics:function(){E={},T()},getMetricsFor:S,addHttpRequest:function e(t,n,r,a,s,u,l,c,d,f,h,p,g,m,v){var y=new o.HTTPRequest;u&&u!==a&&(e(t,null,r,a,s,null,null,c,d,null,null,null,g,null,null),y.actualurl=u),y.tcpid=n,y.type=r,y.url=a,y.range=c,y.trequest=d,y.tresponse=f,y.responsecode=p,y._tfinish=h,y._stream=t,y._mediaduration=g,y._quality=s,y._responseHeaders=m,y._serviceLocation=l,v?v.forEach((function(e){!function(e,t,n,r){var i=new o.HTTPRequestTrace;i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n}(y,e.s,e.d,e.b)})):(delete y.interval,delete y.trace),I(t,i.default.HTTP_REQUEST,y)},addRepresentationSwitch:function(e,t,n,r,a){var o=new s.default;o.t=t,o.mt=n,o.to=r,a?o.lto=a:delete o.lto,I(e,i.default.TRACK_SWITCH,o)},addBufferLevel:function(e,t,n){var r=new u.default;r.t=t,r.level=n,I(e,i.default.BUFFER_LEVEL,r)},addBufferState:function(e,t,n){var r=new l.default;r.target=n,r.state=t,I(e,i.default.BUFFER_STATE,r)},addDVRInfo:function(e,t,n,r){var a=new c.default;a.time=t,a.range=r,a.manifestInfo=n,I(e,i.default.DVR_INFO,a)},addDroppedFrames:function(e,t){var n=new d.default,r=S(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n||I(e,i.default.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,r,a,o,s,u,l){var c=new h.default;c.mediaType=e,c.t=t,c.type=n,c.startTime=r,c.availabilityStartTime=a,c.duration=o,c.quality=s,c.range=u,c.state=l,I(e,i.default.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var r=new g.default;r.loadingRequests=t,r.executedRequests=n,S(e).RequestsQueue=r,A(e,i.default.REQUESTS_QUEUE,r)},addManifestUpdate:function(e,t,n,a,o,s,u,l,c,d){var h=new f.ManifestUpdate;h.mediaType=e,h.type=t,h.requestTime=n,h.fetchTime=a,h.availabilityStartTime=o,h.presentationStartTime=s,h.clientTimeOffset=u,h.currentTime=l,h.buffered=c,h.latency=d,w(r.default.STREAM,i.default.MANIFEST_UPDATE,h),A(e,i.default.MANIFEST_UPDATE,h)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];b(e.mediaType,i.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,r,a){if(e){var o=new f.ManifestUpdateStreamInfo;o.id=t,o.index=n,o.start=r,o.duration=a,e.streamInfo.push(o),b(e.mediaType,i.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,r,a,o,s,u){if(e&&e.representationInfo){var l=new f.ManifestUpdateRepresentationInfo;l.id=t,l.index=n,l.streamIndex=r,l.mediaType=a,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.representationInfo.push(l),b(e.mediaType,i.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach((function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel})):delete e.trace,I(r.default.STREAM,i.default.PLAY_LIST,e)},addDVBErrors:function(e){I(r.default.STREAM,i.default.DVB_ERRORS,e)}},E={},t}E.__dashjs_factory_name="MetricsModel",t.default=v.default.getSingletonFactory(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(9))&&r.__esModule?r:{default:r};t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=i.default.BUFFER_EMPTY}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ManifestUpdate=function e(){r(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},t.ManifestUpdateStreamInfo=function e(){r(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},t.ManifestUpdateRepresentationInfo=function e(){r(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(3)),i=l(n(4)),a=l(n(0)),o=l(n(8)),s=l(n(56)),u=l(n(23));function l(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=this.context,n=(0,r.default)(t).getInstance(),a=(0,u.default)(t).getInstance(),l=void 0,c=void 0,d=void 0,f=void 0;function h(e){c=e}function p(e,t,n,r){return r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-c)):t.availabilityStartTime}function g(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*c)/1e3}function m(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function v(e){void 0!==e.offset&&(h(e.offset/1e3),d=!0)}function y(){c=0,d=!1,f=NaN}function E(){n.off(i.default.UPDATE_TIME_SYNC_OFFSET,v,this),y()}return e={initialize:function(){y(),n.on(i.default.UPDATE_TIME_SYNC_OFFSET,v,this)},getClientTimeOffset:function(){return c},setClientTimeOffset:h,getExpectedLiveEdge:function(){return f},setExpectedLiveEdge:function(e){f=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return p.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return p.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:g,calcPresentationTimeFromMediaTime:m,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!d&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0);if(e.segmentInfoType===o.default.SEGMENT_TIMELINE&&a.get().streaming.calcSegmentAvailabilityRangeFromTimeline)return function(e){var t,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=l.getRepresentationFor(e.index,n),i=r.SegmentTemplate.SegmentTimeline,a=r.SegmentTemplate.timescale,o=i.S_asArray,s={start:0,end:0},u=0,c=void 0,d=void 0,f=void 0;for(s.start=m(o[0].t/a,e),f=0,t=o.length;f<t;f++)d=0,(c=o[f]).hasOwnProperty("r")&&(d=c.r),u+=c.d/a*(1+d);return s.end=s.start+u,s}(e);var s=g(new Date,n),u=n.start+n.duration;r.start=Math.max(s-n.mpd.timeShiftBufferDepth,n.start);var c=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<i?i-e.availabilityTimeOffset:i;return r.end=s>=u&&s-c<u?u:s-c,r},getPeriodEnd:function(e,t){var n=e.adaptation.period;if(!t)return n.start+n.duration;if(!d&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var r=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),i=g(new Date,n),a=n.start+n.duration,o=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<r?r-e.availabilityTimeOffset:r;return Math.min(i-o,a)},calcWallTimeForSegment:function(e,t){var n=void 0,r=void 0,i=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},reset:E},l=(0,s.default)(t).getInstance(),E(),e}c.__dashjs_factory_name="TimelineConverter",t.default=a.default.getSingletonFactory(c)},function(e,t,n){"use strict";var r,i,o,u,l,c=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},d=function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")},f={};r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(e){for(var t=0,n=[],i=0|e.length/3;0<i--;){var a=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,n.push(r.charAt(63&a>>18)),n.push(r.charAt(63&a>>12)),n.push(r.charAt(63&a>>6)),n.push(r.charAt(63&a))}return 2==e.length-t?(a=(e[t]<<16)+(e[t+1]<<8),n.push(r.charAt(63&a>>18)),n.push(r.charAt(63&a>>12)),n.push(r.charAt(63&a>>6)),n.push("=")):1==e.length-t&&(a=e[t]<<16,n.push(r.charAt(63&a>>18)),n.push(r.charAt(63&a>>12)),n.push("==")),n.join("")},o=function(){for(var e=[],t=0;t<r.length;++t)e[r.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),u=function(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var i=(o[e.charCodeAt(t)]<<18)+(o[e.charCodeAt(t+1)]<<12)+(o[e.charCodeAt(t+2)]<<6)+o[e.charCodeAt(t+3)];n.push(255&i>>16),n.push(255&i>>8),n.push(255&i),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n},l={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},f.decodeArray=function(e){var t=u(e);return new Uint8Array(t)},f.encodeASCII=function(e){var t=l.encode(e);return i(t)},f.decodeASCII=function(e){var t=u(e);return l.decode(t)},f.encode=function(e){var t=c(e);return i(t)},f.decode=function(e){var t=u(e);return d(t)},t.decode=f.decode,t.decodeArray=f.decodeArray,t.encode=f.encode,t.encodeASCII=f.encodeASCII},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(235)),i=u(n(31)),a=u(n(237)),o=u(n(94)),s=u(n(93));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context;return{createMetricsReporting:function(t){return(0,r.default)(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}),(0,a.default)(e).create(t)},getReportingFactory:function(){return(0,s.default)(e).getInstance()},getMetricsHandlerFactory:function(){return(0,o.default)(e).getInstance()}}}l.__dashjs_factory_name="MetricsReporting";var c=dashjs.FactoryMaker.getClassFactory(l);c.events=i.default,dashjs.FactoryMaker.updateClassFactory(l.__dashjs_factory_name,c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(236)),i=a(n(31));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=void 0,n=void 0,a=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,u=e.events;function l(e){var t=new r.default;if(n){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function c(e){e.error||(n=e.manifest)}function d(e){l({errorcode:r.default.BASE_URL_CHANGED,servicelocation:e.entry})}function f(){l({errorcode:r.default.BECAME_REPORTER})}function h(e){switch(e.metric){case s.HTTP_REQUEST:(0===(t=e.value).responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&l({errorcode:t.responsecode||r.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}var t}function p(e){var t=void 0;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=r.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=r.default.CORRUPT_MEDIA_OTHER;break;default:return}l({errorcode:t})}function g(){a.on(u.MANIFEST_UPDATED,c,t),a.on(u.SERVICE_LOCATION_BLACKLIST_CHANGED,d,t),a.on(u.METRIC_ADDED,h,t),a.on(u.METRIC_UPDATED,h,t),a.on(u.PLAYBACK_ERROR,p,t),a.on(i.default.BECAME_REPORTING_PLAYER,f,t)}return t={initialise:g,reset:function(){a.off(u.MANIFEST_UPDATED,c,t),a.off(u.SERVICE_LOCATION_BLACKLIST_CHANGED,d,t),a.off(u.METRIC_ADDED,h,t),a.off(u.METRIC_UPDATED,h,t),a.off(u.PLAYBACK_ERROR,p,t),a.off(i.default.BECAME_REPORTING_PLAYER,f,t)}},g(),t}o.__dashjs_factory_name="DVBErrorsTranslator",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00",t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(238)),i=o(n(249)),a=o(n(31));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=void 0,n={},o=this.context,s=e.eventBus,u=e.events;function l(t){if(!t.error){var u=Object.keys(n);(0,i.default)(o).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(t.manifest).forEach((function(t){var i=JSON.stringify(t);if(n.hasOwnProperty(i))u.splice(i,1);else try{var a=(0,r.default)(o).create(e);a.initialize(t),n[i]=a}catch(e){}})),u.forEach((function(e){n[e].reset(),delete n[e]})),s.trigger(a.default.METRICS_INITIALISATION_COMPLETE)}}function c(){Object.keys(n).forEach((function(e){n[e].reset()})),n={}}return t={reset:function(){s.off(u.MANIFEST_UPDATED,l,t),s.off(u.STREAM_TEARDOWN_COMPLETE,c,t)}},s.on(u.MANIFEST_UPDATED,l,t),s.on(u.STREAM_TEARDOWN_COMPLETE,c,t),t}s.__dashjs_factory_name="MetricsCollectionController",t.default=dashjs.FactoryMaker.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(239)),i=o(n(240)),a=o(n(244));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=void 0,n=void 0,o=void 0,s=this.context;function u(){t&&t.reset(),n&&n.reset(),o&&o.reset()}return{initialize:function(l){try{(o=(0,r.default)(s).create({mediaElement:e.mediaElement})).initialize(l.Range),(n=(0,i.default)(s).create({debug:e.debug,metricsConstants:e.metricsConstants})).initialize(l.Reporting,o),(t=(0,a.default)(s).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(l.metrics,n)}catch(e){throw u(),e}},reset:u}}s.__dashjs_factory_name="MetricsController",t.default=dashjs.FactoryMaker.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(68))&&r.__esModule?r:{default:r};function a(e){e=e||{};var t,n=!1,r=this.context,a=void 0,o=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach((function(e){var t=e.starttime,n=t+e.duration;a.add(t,n)})),n=!!e[0]._useWallClockTime)},reset:function(){a.clear()},isEnabled:function(){var e,t=a.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:o.currentTime;for(var r=0;r<t;r+=1){var i=a.start(r),s=a.end(r);if(i<=e&&e<s)return!0}return!1}},a=(0,i.default)(r).create(),t}a.__dashjs_factory_name="RangeController",t.default=dashjs.FactoryMaker.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(93))&&r.__esModule?r:{default:r};function a(e){var t=[],n=(0,i.default)(this.context).getInstance(e);return{initialize:function(e,r){e.some((function(e){var i=n.create(e,r);if(i)return t.push(i),!0}))},reset:function(){t.forEach((function(e){return e.reset()})),t=[]},report:function(e,n){t.forEach((function(t){return t.report(e,n)}))}}}a.__dashjs_factory_name="ReportingController",t.default=dashjs.FactoryMaker.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(242)),i=a(n(243));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t,n=this.context,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=[],f=e.metricsConstants;function h(){s=!1,u=!1,l=null,c=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),u&&c.isEnabled()&&t.forEach((function(t){var n=a.serialise(t);e!==f.DVB_ERRORS&&(n="metricname="+e+"&"+n),function(e,t,n){var r=new XMLHttpRequest,i=function(){var e=d.indexOf(r);-1!==e&&(d.splice(e,1),!(r.status>=200&&r.status<300)&&n&&n())};d.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(e){r.onerror()}}(n=l+"?"+n,0,(function(){u=!1}))}))},initialize:function(e,t){var n=void 0;if(c=t,!(l=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");s||((n=e.dvb_probability)&&(1e3===n||n/1e3>=o.random())&&(u=!0),s=!0)},reset:function(){h()}},a=(0,r.default)(n).getInstance(),o=(0,i.default)(n).getInstance(),h(),t}o.__dashjs_factory_name="DVBReporting",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";function r(){return{serialise:function e(t){var n=[],r=[],i=void 0,a=void 0;for(i in t)if(t.hasOwnProperty(i)&&0!==i.indexOf("_")){if(null==(a=t[i])&&(a=""),Array.isArray(a)){if(!a.length)continue;r=[],a.forEach((function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);r.push(n?t:e(t))})),a=r.map(encodeURIComponent).join(",")}else"string"==typeof a?a=encodeURIComponent(a):a instanceof Date?a=a.toISOString():"number"==typeof a&&(a=Math.round(a));n.push(i+"="+a)}return n.join("&")}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="MetricSerialiser",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";function r(){var e,t=window.crypto||window.msCrypto,n=Uint32Array,r=Math.pow(2,8*n.BYTES_PER_ELEMENT)-1,i=void 0,a=void 0;function o(){t&&(i||(i=new n(10)),t.getRandomValues(i),a=0)}return e={random:function(e,n){var s=void 0;return e||(e=0),n||(n=1),t?(a===i.length&&o(),s=i[a]/r,a+=1):s=Math.random(),s*(n-e)+e}},o(),e}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="RNG",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(94))&&r.__esModule?r:{default:r};function a(e){e=e||{};var t=[],n=void 0,r=this.context,a=e.eventBus,o=e.events,s=(0,i.default)(r).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function u(e){t.forEach((function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)}))}return n={initialize:function(e,r){e.split(",").forEach((function(e,n,i){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var o=i[n+1];o&&-1===o.indexOf("(")&&-1!==o.indexOf(")")&&(e+=","+o,delete i[n+1])}(a=s.create(e,r))&&t.push(a)})),a.on(o.METRIC_ADDED,u,n),a.on(o.METRIC_UPDATED,u,n)},reset:function(){a.off(o.METRIC_ADDED,u,n),a.off(o.METRIC_UPDATED,u,n),t.forEach((function(e){return e.reset()})),t=[]}}}a.__dashjs_factory_name="MetricsHandlersController",t.default=dashjs.FactoryMaker.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(95))&&r.__esModule?r:{default:r};function a(e){e=e||{};var t=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=this.context,u=(0,i.default)(s).getInstance(),l=[],c=e.metricsConstants;function d(){var e=function(){try{return Object.keys(l).map((function(e){return l[e]})).reduce((function(e,t){return e.level<t.level?e:t}))}catch(e){return}}();e&&o!==e.t&&(o=e.t,t.report(r,e))}return{initialize:function(e,i,o){i&&(n=u.validateN(o),t=i,r=u.reconstructFullMetricName(e,o),a=setInterval(d,n))},reset:function(){clearInterval(a),a=null,n=0,t=null,o=null},handleNewMetric:function(e,t,n){e===c.BUFFER_LEVEL&&(l[n]=t)}}}a.__dashjs_factory_name="BufferLevelHandler",t.default=dashjs.FactoryMaker.getClassFactory(a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(31))&&r.__esModule?r:{default:r};t.default=dashjs.FactoryMaker.getClassFactory((function(e){var t=void 0,n=(e=e||{}).eventBus,r=e.metricsConstants;function a(){n.off(i.default.METRICS_INITIALISATION_COMPLETE,a,this),n.trigger(i.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,r){r&&(t=r,n.on(i.default.METRICS_INITIALISATION_COMPLETE,a,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===r.DVB_ERRORS&&t&&t.report(e,n)}}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(95))&&r.__esModule?r:{default:r};function a(e){e=e||{};var t=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=[],u=(0,i.default)(this.context).getInstance(),l=e.metricsConstants;function c(){var e=s;e.length&&t&&t.report(a,e),s=[]}return{initialize:function(e,i,s,l){i&&(n=u.validateN(s),t=i,l&&l.length&&(r=l),a=u.reconstructFullMetricName(e,s,l),o=setInterval(c,n))},reset:function(){clearInterval(o),o=null,n=null,r=null,s=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(r&&r!==t.type||s.push(t))}}}a.__dashjs_factory_name="HttpListHandler",t.default=dashjs.FactoryMaker.getClassFactory(a)},function(e,t,n){"use strict";function r(){var e=void 0,t=void 0;return{initialize:function(n,r){e=n,t=r},reset:function(){t=null,e=void 0},handleNewMetric:function(n,r){n===e&&t&&t.report(e,r)}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="GenericMetricHandler",t.default=dashjs.FactoryMaker.getClassFactory(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(250)),i=o(n(251)),a=o(n(252));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).adapter,n=e.constants;return{getMetrics:function(e){var o=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach((function(s){var u=new r.default,l=t.getIsDynamic(e);s.hasOwnProperty("metrics")&&(u.metrics=s.metrics,s.Range_asArray&&s.Range_asArray.forEach((function(r){var a=new i.default;a.starttime=function(e,r,i){var a=void 0,o=void 0,s=0;return r?s=t.getAvailabilityStartTime(e)/1e3:(a=t.getRegularPeriods(e)).length&&(s=a[0].start),o=s,i&&i.hasOwnProperty(n.START_TIME)&&(o+=i.starttime),o}(e,l,r),r.hasOwnProperty("duration")?a.duration=r.duration:a.duration=t.getDuration(e),a._useWallClockTime=l,u.Range.push(a)})),s.Reporting_asArray&&(s.Reporting_asArray.forEach((function(e){var t=new a.default;e.hasOwnProperty(n.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(n.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[n.DVB_REPORTING_URL]),e.hasOwnProperty(n.DVB_PROBABILITY)&&(t.dvb_probability=e[n.DVB_PROBABILITY]),u.Reporting.push(t))})),o.push(u)))})),o}}}s.__dashjs_factory_name="ManifestParsing",t.default=dashjs.FactoryMaker.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(254)),i=c(n(40)),a=c(n(266)),o=c(n(32)),s=c(n(267)),u=c(n(268)),l=c(n(269));function c(e){return e&&e.__esModule?e:{default:e}}var d=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],f=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function h(){var e=void 0,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}return e={createProtectionSystem:function(a){var o=null,c=(0,i.default)(t).getInstance();c.setConfig({debug:a.debug,BASE64:a.BASE64}),c.initialize();var h=function(r){var i=r.debug,a=i.getLogger(e),o=r.eventBus,c=r.errHandler,h=r.videoModel?r.videoModel.getElement():null;return h&&void 0===h.onencrypted||h&&void 0===h.mediaKeys?n(h,f)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,u.default)(t).create({debug:i,eventBus:o,events:r.events,api:n(h,f)})):n(h,d)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,l.default)(t).create({debug:i,eventBus:o,errHandler:c,events:r.events,api:n(h,d)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,s.default)(t).create({debug:i,eventBus:o,events:r.events}))}(a);return!o&&h&&(o=(0,r.default)(t).create({protectionModel:h,protectionKeyController:c,eventBus:a.eventBus,debug:a.debug,events:a.events,BASE64:a.BASE64,constants:a.constants,cmcdModel:a.cmcdModel,settings:a.settings}),a.capabilities.setEncryptedMediaSupported(!0)),o}}}h.__dashjs_factory_name="Protection";var p=dashjs.FactoryMaker.getClassFactory(h);p.events=a.default,p.errors=o.default,dashjs.FactoryMaker.updateClassFactory(h.__dashjs_factory_name,p),t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=p(n(24)),a=p(n(255)),o=p(n(58)),s=p(n(32)),u=p(n(6)),l=p(n(256)),c=p(n(257)),d=n(7),f=p(n(30)),h=p(n(1));function p(e){return e&&e.__esModule?e:{default:e}}function g(e){var t,n=(e=e||{}).protectionKeyController,p=e.protectionModel,g=e.eventBus,m=e.events,v=e.debug,y=e.BASE64,E=e.constants,T=[],_=e.cmcdModel,b=e.settings,A=void 0,S=void 0,w=void 0,I=void 0,R=void 0,C=void 0,D=void 0,M=void 0,L=void 0;function N(){if(!(g&&g.hasOwnProperty("on")&&n&&n.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function x(e,t){var n=i.default.getPSSHForKeySystem(D,e),r=F(D);if(n){if(O(n))return;try{p.createKeySession(n,r,B(D),t)}catch(e){g.trigger(m.KEY_SESSION_CREATED,{data:null,error:new u.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e?p.createKeySession(e,r,B(D),t):g.trigger(m.KEY_SESSION_CREATED,{data:null,error:new u.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(D?D.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function O(e){if(!e)return!1;try{for(var t=p.getAllInitData(),r=0;r<t.length;r++)if(n.initDataEquals(e,t[r]))return A.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch(e){return!1}}function P(e,t){N(),p.loadKeySession(e,t,B(D))}function k(e){N(),e?(p.setMediaElement(e),g.on(m.NEED_KEY,Y,this)):null===e&&(p.setMediaElement(e),g.off(m.NEED_KEY,Y,this))}function F(e){var t=null;if(e){var n=e.systemString;I&&(t=n in I?I[n]:null)}return t}function U(e){var t=F(e),n=[],r=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:C,s=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:C,u=B(e),l=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",c=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return w.forEach((function(e){e.type===E.AUDIO?n.push(new a.default(e.codec,i)):e.type===E.VIDEO&&r.push(new a.default(e.codec,s))})),new o.default(n,r,l,c,[u])}function B(e){var t=F(e);return t&&t.sessionType?t.sessionType:R}function G(e,t){e=e.sort((function(t,n){return(I&&I[t.ks.systemString]&&I[t.ks.systemString].priority>=0?I[t.ks.systemString].priority:e.length)-(I&&I[n.ks.systemString]&&I[n.ks.systemString].priority>=0?I[n.ks.systemString].priority:e.length)})),void 0===D?function(e,t){var r=this,i=[],a=void 0;D=null,S.push(e);for(var o=0;o<e.length;o++)i.push({ks:e[o].ks,configs:[U(e[o].ks)]});var l=void 0,c=function e(n){g.off(m.KEY_SYSTEM_ACCESS_COMPLETE,e,r),n.error?(D=void 0,g.off(m.INTERNAL_KEY_SYSTEM_SELECTED,d,r),t||g.trigger(m.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+n.error)})):(l=n.data,A.info("DRM: KeySystem Access Granted ("+l.keySystem.systemString+")!  Selecting key system..."),p.selectKeySystem(l))},d=function e(i){if(g.off(m.INTERNAL_KEY_SYSTEM_SELECTED,e,r),g.off(m.KEY_SYSTEM_ACCESS_COMPLETE,c,r),i.error)D=void 0,t||g.trigger(m.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+i.error)});else{if(!p)return;D=p.getKeySystem(),g.trigger(m.KEY_SYSTEM_SELECTED,{data:l});var o=F(D);o&&o.serverCertificate&&o.serverCertificate.length>0&&p.setServerCertificate(y.decodeArray(o.serverCertificate).buffer);for(var d=0;d<S.length;d++)for(a=0;a<S[d].length;a++)if(D===S[d][a].ks){if(n.isClearKey(D)&&o&&o.hasOwnProperty("clearkeys")){var f={kids:Object.keys(o.clearkeys)};S[d][a].initData=(new TextEncoder).encode(JSON.stringify(f))}S[d][a].sessionId?P(S[d][a].sessionId,S[d][a].initData):null!==S[d][a].initData&&x(S[d][a].initData,S[d][a].cdmData);break}}};g.on(m.INTERNAL_KEY_SYSTEM_SELECTED,d,r),g.on(m.KEY_SYSTEM_ACCESS_COMPLETE,c,r),p.requestKeySystemAccess(i)}(e,t):D?function(e,t){var r=this,a=[],o=e.findIndex((function(e){return e.ks===D}));-1!==o&&e[o].initData&&(O(i.default.getPSSHForKeySystem(D,e[o].initData))||(a.push({ks:e[o].ks,configs:[U(D)]}),g.on(m.KEY_SYSTEM_ACCESS_COMPLETE,(function i(a){if(g.off(m.KEY_SYSTEM_ACCESS_COMPLETE,i,r),a.error)t||g.trigger(m.KEY_SYSTEM_SELECTED,{error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+a.error)});else{A.info("DRM: KeySystem Access Granted"),g.trigger(m.KEY_SYSTEM_SELECTED,{data:a.data});var l=F(D);if(n.isClearKey(D)&&l&&l.hasOwnProperty("clearkeys")){var c={kids:Object.keys(l.clearkeys)};e[o].initData=(new TextEncoder).encode(JSON.stringify(c))}e[o].sessionId?P(e[o].sessionId,e[o].initData):e[o].initData&&x(e[o].initData,e[o].cdmData)}}),r),p.requestKeySystemAccess(a)))}(e,t):S.push(e)}function j(e,t){g.trigger(m.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function H(e){e.error?g.trigger(m.KEY_STATUSES_CHANGED,{data:null,error:e.error}):A.debug("DRM: key status = "+e.status)}function K(e){A.debug("DRM: onKeyMessage");var t=e.data;g.trigger(m.KEY_MESSAGE,{data:t});var a=t.messageType?t.messageType:"license-request",o=t.message,v=t.sessionToken,y=F(D),E=D?D.systemString:null,T=n.getLicenseServer(D,y,a),S={sessionToken:v,messageType:a};if(o&&0!==o.byteLength){if(!T)return A.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+v.getSessionID()),void j(S);if(n.isClearKey(D)){var I=n.processClearKeyLicenseRequest(D,y,o);if(I)return A.debug("DRM: ClearKey license request handled by application!"),j(S),void p.updateKeySession(v,I)}var R=null;if(y&&y.serverURL){var C=y.serverURL;"string"==typeof C&&""!==C?R=C:"object"===(void 0===C?"undefined":r(C))&&C.hasOwnProperty(a)&&(R=C[a])}else if(y&&y.laURL&&""!==y.laURL)R=y.laURL;else if(n.isClearKey(D))R=D.getLicenseServerUrlFromMediaInfo(w);else{var N=i.default.getPSSHData(v.initData);(R=D.getLicenseServerURLFromInitData(N))||(R=e.data.laURL)}if(R=T.getServerURLFromMessage(R,o,a)){var x={},O=!1,P=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(O=!0),x[t]=e[t]};y&&P(y.httpRequestHeaders),P(D.getRequestHeadersFromMessage(o)),y&&"boolean"==typeof y.withCredentials&&(O=y.withCredentials);var k=function(e,t,n,r){var i=e.response?T.getErrorResponse(e.response,n,r):"NONE";j(t,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i))},U=function(e){if(p)if(200===e.status){var t=new c.default(e.responseURL,f.default.parseHttpHeaders(e.getAllResponseHeaders?e.getAllResponseHeaders():null),e.response);V(L,t).then((function(){var n=T.getLicenseMessage(t.data,E,a);null!==n?(j(S),p.updateKeySession(v,n)):k(e,S,E,a)}))}else k(e,S,E,a)},B=function(e){j(S,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+E+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},G=function(e){j(S,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+E+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},H=D.getLicenseRequestFromMessage(o),K=T.getHTTPMethod(a),Y=T.getResponseType(E,a),q=y&&!isNaN(y.httpTimeout)?y.httpTimeout:8e3,W=v.getSessionID()||null,z=new l.default(R,K,Y,x,O,a,W,H);V(M,z).then((function(){!function e(t,n,r,i,a,o){var s=new XMLHttpRequest;if(b.get().streaming.cmcd&&b.get().streaming.cmcd.enabled&&b.get().streaming.cmcd.mode===h.default.CMCD_MODE_QUERY){var u=_.getQueryParameter({url:t.url,type:d.HTTPRequest.LICENSE});u&&(t.url=f.default.addAditionalQueryParameterToUrl(t.url,[u]))}for(var l in s.open(t.method,t.url,!0),s.responseType=t.responseType,s.withCredentials=t.withCredentials,r>0&&(s.timeout=r),t.headers)s.setRequestHeader(l,t.headers[l]);if(b.get().streaming.cmcd&&b.get().streaming.cmcd.enabled&&b.get().streaming.cmcd.mode===h.default.CMCD_MODE_HEADER){var c=_.getHeaderParameters({url:t.url,type:d.HTTPRequest.LICENSE});if(c)for(var p in c){var v=c[p];v&&s.setRequestHeader(p,v)}}var y=function(){n--,setTimeout((function(){e(t,n,r,i,a,o)}),1e3)};s.onload=function(){200===this.status||n<=0?i(this):(A.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+n),y())},s.ontimeout=s.onerror=function(){n<=0?o(this):(A.warn("License request network request failed . Retrying it... Pending retries: "+n),y())},s.onabort=function(){a(this)},g.trigger(m.LICENSE_REQUEST_SENDING,{url:t.url,headers:t.headers,payload:t.data,sessionId:t.sessionId}),s.send(t.data)}(z,3,q,U,B,G)}))}else j(S,new u.default(s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else j(S,new u.default(s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function Y(e,t){if(A.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===w.length&&(A.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))T.push(setTimeout((function(){Y(e,t)}),500));else{var r=e.key.initData;if(ArrayBuffer.isView(r)&&(r=r.buffer),D){var a=i.default.getPSSHForKeySystem(D,r);if(a&&O(a))return}A.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(r)));var o=n.getSupportedKeySystems(r,I);0!==o.length?G(o,!1):A.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else A.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}function V(e,t){return e?e.reduce((function(e,n){return e.then((function(){return n(t)}))}),Promise.resolve()):Promise.resolve()}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");N(),g.on(m.INTERNAL_KEY_MESSAGE,K,this),g.on(m.INTERNAL_KEY_STATUS_CHANGED,H,this),w.push(e);var t=n.getSupportedKeySystemsFromContentProtection(e.contentProtection);t&&t.length>0&&G(t,!0)},clearMediaInfoArrayByStreamId:function(e){w=w.filter((function(t){return t.streamInfo.id!==e}))},createKeySession:x,loadKeySession:P,removeKeySession:function(e){N(),p.removeKeySession(e)},closeKeySession:function(e){N(),p.closeKeySession(e)},setServerCertificate:function(e){N(),p.setServerCertificate(e)},setMediaElement:k,setSessionType:function(e){R=e},setRobustnessLevel:function(e){C=e},setProtectionData:function(e){I=e,n.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return N(),n.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return n?n.getKeySystems():[]},setKeySystems:function(e){n&&n.setKeySystems(e)},setLicenseRequestFilters:function(e){M=e},setLicenseResponseFilters:function(e){L=e},stop:function(){p&&p.stop()},reset:function(){N(),M=[],L=[],g.off(m.INTERNAL_KEY_MESSAGE,K,this),g.off(m.INTERNAL_KEY_STATUS_CHANGED,H,this),k(null),D=void 0,p&&(p.reset(),p=null),T.forEach((function(e){return clearTimeout(e)})),T=[],w=[]}},A=v.getLogger(t),S=[],w=[],R="temporary",C="",M=[],L=[],t}g.__dashjs_factory_name="ProtectionController",t.default=dashjs.FactoryMaker.getClassFactory(g)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r,i,a,o,s,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.method=n,this.responseType=r,this.headers=i,this.withCredentials=a,this.messageType=o,this.sessionId=s,this.data=u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.headers=n,this.data=r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(59)),i=s(n(60)),a=s(n(24)),o=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u="e2719d58-a985-b3c9-781a-b030af78d30e",l=o.default.CLEARKEY_KEYSTEM_STRING,c="urn:uuid:"+u;function d(e){var t=(e=e||{}).BASE64,n={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};return{uuid:u,schemeIdURI:c,systemString:l,getInitData:function(e,n){try{var r=a.default.parseInitDataFromContentProtection(e,t);if(!r&&n){var i={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map((function(e){return String.fromCharCode(parseInt(e,16))})).join(""))).replace(/=/g,"")}catch(e){return null}}(n["cenc:default_KID"])]};r=(new TextEncoder).encode(JSON.stringify(i))}return r}catch(e){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e)))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getLicenseServerUrlFromMediaInfo:function(e){try{if(!e||0===e.length)return null;for(var t=0,r=null;t<e.length&&!r;){var i=e[t];if(i&&i.contentProtection&&i.contentProtection.length>0){var a=i.contentProtection.filter((function(e){return e.schemeIdUri&&e.schemeIdUri===c}));if(a&&a.length>0)for(var o=0;o<a.length&&!r;){for(var s=a[o],u=0;u<n.attributes.length&&!r;){for(var l=0,d=n.attributes[u];l<n.prefixes.length&&!r;){var f=n.prefixes[l];s[d]&&s[d].__prefix&&s[d].__prefix===f&&s[d].__text&&(r=s[d].__text),l+=1}u+=1}o+=1}}t+=1}return r}catch(e){return null}},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],s=0;s<a.kids.length;s++){var u=a.kids[s],l=e.clearkeys&&e.clearkeys.hasOwnProperty(u)?e.clearkeys[u]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+u+") is not known!");o.push(new r.default(u,l))}n=new i.default(o)}return n}}}d.__dashjs_factory_name="KeySystemClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(59)),i=s(n(60)),a=s(n(24)),o=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=o.default.CLEARKEY_KEYSTEM_STRING;function l(e){var t=void 0,n=e.BASE64,o=e.debug.getLogger(t);return{uuid:"1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:u,getInitData:function(e){return a.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),s=[],u=0;u<a.kids.length;u++){var l=a.kids[u],c=e.clearkeys&&e.clearkeys.hasOwnProperty(l)?e.clearkeys[l]:null;if(!c)throw new Error("DRM: ClearKey keyID ("+l+") is not known!");s.push(new r.default(l,c))}n=new i.default(s),o.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}l.__dashjs_factory_name="KeySystemW3CClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(24)),i=a(n(17));function a(e){return e&&e.__esModule?e:{default:e}}var o=i.default.WIDEVINE_KEYSTEM_STRING;function s(e){var t=null,n=(e=e||{}).BASE64;return{uuid:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:o,init:function(e){e&&(t=e)},getInitData:function(e){return r.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return t&&t.sessionId?t.sessionId:e&&e.sessionId?e.sessionId:null}}}s.__dashjs_factory_name="KeySystemWidevine",t.default=dashjs.FactoryMaker.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(24)),i=a(n(17));function a(e){return e&&e.__esModule?e:{default:e}}var o=i.default.PLAYREADY_KEYSTEM_STRING,s=void 0;function u(e){var t="utf-16",n=(e=e||{}).BASE64;function i(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:"9a04f079-9840-4286-ab92-e65be0885f95",schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:o,getInitData:function(e){var t,a,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,c=null,d=void 0,f=void 0;if(i(),!e)return null;if("pssh"in e)return r.default.parseInitDataFromContentProtection(e,n);if("pro"in e)c=n.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;c=n.decodeArray(e.prheader.__text)}return t=c.length,a=4+s.length+u.length+4+t,o=new ArrayBuffer(a),d=new Uint8Array(o),(f=new DataView(o)).setUint32(l,a),l+=4,d.set(s,l),l+=s.length,d.set(u,l),l+=u.length,f.setUint32(l,t),l+=4,d.set(c,l),l+=t,d.buffer},getRequestHeadersFromMessage:function(e){var n,r=void 0,i={},a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,o);for(var s=(r=a.parseFromString(n,"application/xml")).getElementsByTagName("name"),u=r.getElementsByTagName("value"),l=0;l<s.length;l++)i[s[l].childNodes[0].nodeValue]=u[l].childNodes[0].nodeValue;return i.hasOwnProperty("Content")&&(i["Content-Type"]=i.Content,delete i.Content),i.hasOwnProperty("Content-Type")||(i["Content-Type"]="text/xml; charset=utf-8"),i},getLicenseRequestFromMessage:function(e){var r=null,a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);i();var s=String.fromCharCode.apply(null,o),u=a.parseFromString(s,"application/xml");if(!u.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var l=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return l&&(r=n.decode(l)),r},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),c=i.parseFromString(l,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var d=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(c.getElementsByTagName("LUI_URL")[0]){var f=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(f)return f}}else r+=s}return null},getCDMData:function(){var e=void 0,t=void 0,r=void 0,a=void 0;if(i(),s&&s.cdmData){for(e=[],a=0;a<s.cdmData.length;++a)e.push(s.cdmData.charCodeAt(a)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=n.encode(e),t='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",e),r=[],a=0;a<t.length;++a)r.push(t.charCodeAt(a)),r.push(0);return new Uint8Array(r).buffer}return null},getSessionId:function(e){return s&&s.sessionId?s.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e},init:function(e){e&&(s=e)}}}u.__dashjs_factory_name="KeySystemPlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(17))&&r.__esModule?r:{default:r};function a(e){var t=(e=e||{}).BASE64,n={};return n[i.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[i.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,r){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[r].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}a.__dashjs_factory_name="DRMToday",t.default=dashjs.FactoryMaker.getSingletonFactory(a)},function(e,t,n){"use strict";function r(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function n(n){if(window.DOMParser){var r=t(n),i=(new window.DOMParser).parseFromString(r,"text/xml"),a=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o&&o.getElementsByTagNameNS(e,"Fault")[0])return null}return n}function r(n){var r="",i="",a="",o=-1,s=-1;if(window.DOMParser){var u=t(n),l=(new window.DOMParser).parseFromString(u,"text/xml"),c=l?l.getElementsByTagNameNS(e,"Envelope")[0]:null,d=c?c.getElementsByTagNameNS(e,"Body")[0]:null,f=d?d.getElementsByTagNameNS(e,"Fault")[0]:null,h=f?f.getElementsByTagName("detail")[0]:null,p=h?h.getElementsByTagName("Exception")[0]:null,g=null;if(null===f)return u;r=(g=f.getElementsByTagName("faultstring")[0].firstChild)?g.nodeValue:null,null!==p&&(i=(g=p.getElementsByTagName("StatusCode")[0])?g.firstChild.nodeValue:null,o=(a=(g=p.getElementsByTagName("Message")[0])?g.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var m="code: "+i+", name: "+r;return a&&(m+=", message: "+a),m}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return n.call(this,e)},getErrorResponse:function(e){return r.call(this,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="PlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";function r(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="Widevine",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(59)),i=a(n(60));function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var a=e.keys[n],o=a.kid.replace(/=/g,""),s=a.k.replace(/=/g,"");t.push(new r.default(o,s))}return new i.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}o.__dashjs_factory_name="ClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=n(33))&&r.__esModule?r:{default:r}).default));t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(40)),i=c(n(61)),a=c(n(32)),o=c(n(6)),s=c(n(62)),u=c(n(63)),l=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t,n=this.context,c=e.eventBus,d=e.events,f=e.debug,h=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0;function T(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function _(e){for(var t=0;t<v.length;t++)if(v[t]===e){v.splice(t,1);break}}function b(e){var t=void 0,n=void 0;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function A(e,t,n,r){var i={session:e,initData:t,sessionId:r,handleEvent:function(e){switch(e.type){case"keystatuseschange":c.trigger(d.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach((function(){var e=b(arguments);switch(e.status){case"expired":c.trigger(d.INTERNAL_KEY_STATUS_CHANGED,{error:new o.default(a.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,a.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:c.trigger(d.INTERNAL_KEY_STATUS_CHANGED,e)}}));break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;c.trigger(d.INTERNAL_KEY_MESSAGE,{data:new s.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach((function(){var e=b(arguments);"usable"===e.status&&(t=!0)})),t},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",i),e.addEventListener("message",i),e.closed.then((function(){_(i),h.debug("DRM: Session closed.  SessionID = "+i.getSessionID()),c.trigger(d.KEY_SESSION_CLOSED,{data:i.getSessionID()})})),v.push(i),i}return t={getAllInitData:function(){for(var e=[],t=0;t<v.length;t++)v[t].initData&&e.push(v[t].initData);return e},requestKeySystemAccess:function(e){!function e(t,n){void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?function(n){var r=t[n].ks,i=t[n].configs,a=r.systemString;a===l.default.PLAYREADY_KEYSTEM_STRING&&"required"===i[0].persistentState&&(a+=".recommendation"),navigator.requestMediaKeySystemAccess(a,i).then((function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new u.default(r,t);n.mksa=e,c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:n})})).catch((function(r){++n<t.length?e(t,n):c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+r.message})}))}(n):c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"})}(e,0)},getKeySystem:function(){return p},selectKeySystem:function(e){e.mksa.createMediaKeys().then((function(t){p=e.keySystem,m=t,g?g.setMediaKeys(m).then((function(){c.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)})):c.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)})).catch((function(){c.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))},setMediaElement:function(e){g!==e&&(g&&(g.removeEventListener("encrypted",y),g.setMediaKeys&&g.setMediaKeys(null)),(g=e)&&(g.addEventListener("encrypted",y),g.setMediaKeys&&m&&g.setMediaKeys(m)))},setServerCertificate:function(e){if(!p||!m)throw new Error("Can not set server certificate until you have selected a key system");m.setServerCertificate(e).then((function(){h.info("DRM: License server certificate successfully updated."),c.trigger(d.SERVER_CERTIFICATE_UPDATED)})).catch((function(e){c.trigger(d.SERVER_CERTIFICATE_UPDATED,{error:new o.default(a.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,a.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})}))},createKeySession:function(e,t,n){if(!p||!m)throw new Error("Can not create sessions until you have selected a key system");var r=m.createSession(n),i=A(r,e,n),s=this.getKeySystem().systemString===l.default.CLEARKEY_KEYSTEM_STRING&&(e||t&&t.clearkeys)?"keyids":"cenc";r.generateRequest(s,e).then((function(){h.debug("DRM: Session created.  SessionID = "+i.getSessionID()),c.trigger(d.KEY_SESSION_CREATED,{data:i})})).catch((function(e){_(i),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})}))},updateKeySession:function(e,t){var n=e.session;E.isClearKey(p)&&(t=t.toJWK()),n.update(t).catch((function(t){c.trigger(d.KEY_ERROR,{data:new o.default(a.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})}))},loadKeySession:function(e,t,n){if(!p||!m)throw new Error("Can not load sessions until you have selected a key system");for(var r=0;r<v.length;r++)if(e===v[r].sessionId)return void h.warn("DRM: Ignoring session ID because we have already seen it!");var i=m.createSession(n),s=A(i,t,n,e);i.load(e).then((function(t){t?(h.debug("DRM: Session loaded.  SessionID = "+s.getSessionID()),c.trigger(d.KEY_SESSION_CREATED,{data:s})):(_(s),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))})).catch((function(t){_(s),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})}))},removeKeySession:function(e){e.session.remove().then((function(){h.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),c.trigger(d.KEY_SESSION_REMOVED,{data:e.getSessionID()})}),(function(t){c.trigger(d.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})}))},closeKeySession:function(e){T(e).catch((function(t){_(e),c.trigger(d.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})}))},stop:function(){for(var e=void 0,t=0;t<v.length;t++)(e=v[t]).getUsable()||T(e).catch((function(){_(e)}))},reset:function(){var e=v.length,t=void 0;0!==e?function(){for(var n=function(e){_(e),0===v.length&&(g?(g.removeEventListener("encrypted",y),g.setMediaKeys(null).then((function(){c.trigger(d.TEARDOWN_COMPLETE)}))):c.trigger(d.TEARDOWN_COMPLETE))},r=0;r<e;r++)!function(e){t.session.closed.then((function(){n(e)})),T(t).catch((function(){n(e)}))}(t=v[r])}():c.trigger(d.TEARDOWN_COMPLETE)}},h=f.getLogger(t),p=null,g=null,m=null,v=[],E=(0,r.default)(n).getInstance(),y={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;c.trigger(d.NEED_KEY,{key:new i.default(t,e.initDataType)})}}}},t}d.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=dashjs.FactoryMaker.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(40)),i=c(n(61)),a=c(n(6)),o=c(n(32)),s=c(n(62)),u=c(n(58)),l=c(n(63));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t,n=this.context,c=e.eventBus,d=e.events,f=e.debug,h=e.api,p=void 0,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0;function b(){try{for(var e=0;e<E.length;e++)A(E[e]);g&&g.removeEventListener(h.needkey,T),c.trigger(d.TEARDOWN_COMPLETE)}catch(e){c.trigger(d.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function A(e){var t=e.session;t.removeEventListener(h.error,e),t.removeEventListener(h.message,e),t.removeEventListener(h.ready,e),t.removeEventListener(h.close,e);for(var n=0;n<E.length;n++)if(E[n]===e){E.splice(n,1);break}t[h.release]()}function S(){var e=null,t=function(){g.removeEventListener("loadedmetadata",e),g[h.setMediaKeys](v),c.trigger(d.VIDEO_ELEMENT_SELECTED)};g.readyState>=1?t():(e=t.bind(this),g.addEventListener("loadedmetadata",e))}return t={getAllInitData:function(){for(var e=[],t=0;t<E.length;t++)e.push(E[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++)for(var r=e[n].ks.systemString,i=e[n].configs,a=null,o=null,s=0;s<i.length;s++){var f=i[s].audioCapabilities,p=i[s].videoCapabilities;if(f&&0!==f.length){a=[];for(var g=0;g<f.length;g++)window[h.MediaKeys].isTypeSupported(r,f[g].contentType)&&a.push(f[g])}if(p&&0!==p.length){o=[];for(var m=0;m<p.length;m++)window[h.MediaKeys].isTypeSupported(r,p[m].contentType)&&o.push(p[m])}if(!(!a&&!o||a&&0===a.length||o&&0===o.length)){t=!0;var v=new u.default(a,o),y=_.getKeySystemBySystemString(r);c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:new l.default(y,v)});break}}t||c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return m},selectKeySystem:function(e){try{v=e.mediaKeys=new window[h.MediaKeys](e.keySystem.systemString),m=e.keySystem,y=e,g&&S(),c.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){c.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+m.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(e){g!==e&&(g&&g.removeEventListener(h.needkey,T),(g=e)&&(g.addEventListener(h.needkey,T),v&&S()))},createKeySession:function(e,t,n,r){if(!m||!v||!y)throw new Error("Can not create sessions until you have selected a key system");var i=null;if(y.ksConfiguration.videoCapabilities&&y.ksConfiguration.videoCapabilities.length>0&&(i=y.ksConfiguration.videoCapabilities[0]),null===i&&y.ksConfiguration.audioCapabilities&&y.ksConfiguration.audioCapabilities.length>0&&(i=y.ksConfiguration.audioCapabilities[0]),null===i)throw new Error("Can not create sessions for unknown content types.");var u=i.contentType,l=v.createSession(u,new Uint8Array(e),r?new Uint8Array(r):null),f=function(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case h.error:c.trigger(d.KEY_ERROR,{data:new a.default(o.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case h.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;c.trigger(d.INTERNAL_KEY_MESSAGE,{data:new s.default(this,t,e.destinationURL)});break;case h.ready:p.debug("DRM: Key added."),c.trigger(d.KEY_ADDED);break;case h.close:p.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),c.trigger(d.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(l,e);l.addEventListener(h.error,f),l.addEventListener(h.message,f),l.addEventListener(h.ready,f),l.addEventListener(h.close,f),E.push(f),p.debug("DRM: Session created.  SessionID = "+f.getSessionID()),c.trigger(d.KEY_SESSION_CREATED,{data:f})},updateKeySession:function(e,t){var n=e.session;_.isClearKey(m)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:A,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:b,reset:b},p=f.getLogger(t),g=null,m=null,v=null,y=null,E=[],_=(0,r.default)(n).getInstance(),T={handleEvent:function(e){switch(e.type){case h.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;c.trigger(d.NEED_KEY,{key:new i.default(t,"cenc")})}}}},t}d.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=dashjs.FactoryMaker.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(40)),i=c(n(61)),a=c(n(6)),o=c(n(62)),s=c(n(58)),u=c(n(63)),l=c(n(32));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t,n=this.context,c=e.eventBus,d=e.events,f=e.debug,h=e.api,p=e.errHandler,g=void 0,m=void 0,v=void 0,y=void 0,E=void 0,T=void 0,_=void 0,b=void 0;function A(){m&&I();for(var e=0;e<T.length;e++)S(T[e]);c.trigger(d.TEARDOWN_COMPLETE)}function S(e){try{m[h.cancelKeyRequest](v.systemString,e.sessionID)}catch(t){c.trigger(d.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function w(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function I(){m.removeEventListener(h.keyerror,b),m.removeEventListener(h.needkey,b),m.removeEventListener(h.keymessage,b),m.removeEventListener(h.keyadded,b)}return t={getAllInitData:function(){for(var e=[],t=0;t<E.length;t++)e.push(E[t].initData);for(var n=0;n<T.length;n++)e.push(T[n].initData);return e},requestKeySystemAccess:function(e){var t=m;t||(t=document.createElement("video"));for(var n=!1,r=0;r<e.length;r++)for(var i=e[r].ks.systemString,a=e[r].configs,o=null,l=0;l<a.length;l++){var f=a[l].videoCapabilities;if(f&&0!==f.length){o=[];for(var h=0;h<f.length;h++)""!==t.canPlayType(f[h].contentType,i)&&o.push(f[h])}if(o&&(!o||0!==o.length)){n=!0;var p=new s.default(null,o),g=y.getKeySystemBySystemString(i);c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:new u.default(g,p)});break}}n||c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return v},selectKeySystem:function(e){v=e.keySystem,c.trigger(d.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(m!==e){if(m){I();for(var t=0;t<T.length;t++)S(T[t]);T=[]}(m=e)&&(m.addEventListener(h.keyerror,b),m.addEventListener(h.needkey,b),m.addEventListener(h.keymessage,b),m.addEventListener(h.keyadded,b),c.trigger(d.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!v)throw new Error("Can not create sessions until you have selected a key system");if(_||0===T.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return E.push(t),m[h.generateKeyRequest](v.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionID;if(y.isClearKey(v))for(var r=0;r<t.keyPairs.length;r++)m[h.addKey](v.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else m[h.addKey](v.systemString,new Uint8Array(t),new Uint8Array(e.initData),n)},closeKeySession:S,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:A,reset:A},g=f.getLogger(t),m=null,v=null,E=[],T=[],y=(0,r.default)(n).getInstance(),b={handleEvent:function(e){var t=null;switch(e.type){case h.needkey:var n=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;c.trigger(d.NEED_KEY,{key:new i.default(n,"cenc")});break;case h.keyerror:if((t=w(T,e.sessionId))||(t=w(E,e.sessionId)),t){var r=l.default.MEDIA_KEYERR_CODE,s="";switch(e.errorCode.code){case 1:r=l.default.MEDIA_KEYERR_UNKNOWN_CODE,s+="MEDIA_KEYERR_UNKNOWN - "+l.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:r=l.default.MEDIA_KEYERR_CLIENT_CODE,s+="MEDIA_KEYERR_CLIENT - "+l.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:r=l.default.MEDIA_KEYERR_SERVICE_CODE,s+="MEDIA_KEYERR_SERVICE - "+l.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:r=l.default.MEDIA_KEYERR_OUTPUT_CODE,s+="MEDIA_KEYERR_OUTPUT - "+l.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:r=l.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,s+="MEDIA_KEYERR_HARDWARECHANGE - "+l.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:r=l.default.MEDIA_KEYERR_DOMAIN_CODE,s+="MEDIA_KEYERR_DOMAIN - "+l.default.MEDIA_KEYERR_DOMAIN_MESSAGE}s+="  System Code = "+e.systemCode,c.trigger(d.KEY_ERROR,{data:new a.default(r,s,t)})}else g.error("No session token found for key error");break;case h.keyadded:(t=w(T,e.sessionId))||(t=w(E,e.sessionId)),t?(g.debug("DRM: Key added."),c.trigger(d.KEY_ADDED,{data:t})):g.debug("No session token found for key added");break;case h.keymessage:if((_=null!==e.sessionId&&void 0!==e.sessionId)?!(t=w(T,e.sessionId))&&E.length>0&&(t=E.shift(),T.push(t),t.sessionID=e.sessionId,c.trigger(d.KEY_SESSION_CREATED,{data:t})):E.length>0&&(t=E.shift(),T.push(t),0!==E.length&&p.error(new a.default(l.default.MEDIA_KEY_MESSAGE_ERROR_CODE,l.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var u=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=u,c.trigger(d.INTERNAL_KEY_MESSAGE,{data:new o.default(t,u,e.defaultURL)})}else g.warn("No session token found for key message")}}},t}d.__dashjs_factory_name="ProtectionModel_01b",t.default=dashjs.FactoryMaker.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n(64))&&r.__esModule?r:{default:r},a=function(){var e=void 0;function t(t,n,r){if(!t||!/^VIDEO$/i.test(t.nodeName))return null;if(t._dashjs_player)return t._dashjs_player;var a=void 0,o=t.id||t.name||"video element";if(!(n=n||[].slice.call(t.querySelectorAll("source")).filter((function(e){return"application/dash+xml"==e.type}))[0])&&t.src)(n=document.createElement("source")).src=t.src;else if(!n&&!t.src)return null;return r=r||{},(a=(0,i.default)(r).create()).initialize(t,n.src,t.autoplay),e||(e=a.getDebug().getLogger()),e.debug("Converted "+o+" to dash.js player and added content: "+n.src),t._dashjs_player=a,a}function n(e){return/^VIDEO$/i.test(e.nodeName)?e:n(e.parentNode)}return{create:t,createAll:function(e,r){var i=[];e=e||"[data-dashjs-player]";for(var a=(r=r||document).querySelectorAll(e),o=0;o<a.length;o++){var s=t(a[o],null);i.push(s)}for(var u=r.querySelectorAll('source[type="application/dash+xml"]'),l=0;l<u.length;l++){var c=t(n(u[l]),null);i.push(c)}return i}}}(),o=void 0;!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?a.createAll():o=window.setInterval((function(){window.dashjs&&(window.clearInterval(o),a.createAll())}),500):window.addEventListener("load",(function e(){window.removeEventListener("load",e),a.createAll()}))),t.default=a},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Fe}));var r,i,a,o,s,u=n(5),l=(n(25),{}),c=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function f(e,t){for(var n in t)e[n]=t[n];return e}function h(e){var t=e.parentNode;t&&t.removeChild(e)}function p(e,t,n){var r,i,a,o=arguments,s={};for(a in t)"key"==a?r=t[a]:"ref"==a?i=t[a]:s[a]=t[a];if(arguments.length>3)for(n=[n],a=3;a<arguments.length;a++)n.push(o[a]);if(null!=n&&(s.children=n),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===s[a]&&(s[a]=e.defaultProps[a]);return g(e,s,r,i,null)}function g(e,t,n,i,a){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:a};return null==a&&(o.__v=o),null!=r.vnode&&r.vnode(o),o}function m(e){return e.children}function v(e,t){this.props=e,this.context=t}function y(e,t){if(null==t)return e.__?y(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?y(e):null}function E(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return E(e)}}function T(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!_.__r++||o!==r.debounceRendering)&&((o=r.debounceRendering)||a)(_)}function _(){for(var e;_.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,n,r,i,a,o,s;e.__d&&(o=(a=(t=e).__v).__e,(s=t.__P)&&(n=[],(r=f({},a)).__v=r,i=R(s,a,r,t.__n,void 0!==s.ownerSVGElement,null,n,null==o?y(a):o),C(n,a),i!=o&&E(a)))}))}function b(e,t,n,r,i,a,o,s,u,d){var f,p,v,E,T,_,b,S=r&&r.__k||c,w=S.length;for(u==l&&(u=null!=o?o[0]:w?y(r,0):null),n.__k=[],f=0;f<t.length;f++)if(null!=(E=n.__k[f]=null==(E=t[f])||"boolean"==typeof E?null:"string"==typeof E||"number"==typeof E?g(null,E,null,null,E):Array.isArray(E)?g(m,{children:E},null,null,null):null!=E.__e||null!=E.__c?g(E.type,E.props,E.key,null,E.__v):E)){if(E.__=n,E.__b=n.__b+1,null===(v=S[f])||v&&E.key==v.key&&E.type===v.type)S[f]=void 0;else for(p=0;p<w;p++){if((v=S[p])&&E.key==v.key&&E.type===v.type){S[p]=void 0;break}v=null}T=R(e,E,v=v||l,i,a,o,s,u,d),(p=E.ref)&&v.ref!=p&&(b||(b=[]),v.ref&&b.push(v.ref,null,E),b.push(p,E.__c||T,E)),null!=T?(null==_&&(_=T),u=A(e,E,v,S,o,T,u),d||"option"!=n.type?"function"==typeof n.type&&(n.__d=u):e.value=""):u&&v.__e==u&&u.parentNode!=e&&(u=y(v))}if(n.__e=_,null!=o&&"function"!=typeof n.type)for(f=o.length;f--;)null!=o[f]&&h(o[f]);for(f=w;f--;)null!=S[f]&&M(S[f],S[f]);if(b)for(f=0;f<b.length;f++)D(b[f],b[++f],b[++f])}function A(e,t,n,r,i,a,o){var s,u,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(i==n||a!=o||null==a.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(a),s=null;else{for(u=o,l=0;(u=u.nextSibling)&&l<r.length;l+=2)if(u==a)break e;e.insertBefore(a,o),s=o}return void 0!==s?s:a.nextSibling}function S(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||d.test(t)?n:n+"px"}function w(e,t,n,r,i){var a,o;if(i&&"className"==t&&(t="class"),"style"===t)if("string"==typeof n)e.style=n;else{if("string"==typeof r&&(e.style=r=""),r)for(t in r)n&&t in n||S(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||S(e.style,t,n[t])}else"o"===t[0]&&"n"===t[1]?(a=t!==(t=t.replace(/Capture$/,"")),(o=t.toLowerCase())in e&&(t=o),t=t.slice(2),e.l||(e.l={}),e.l[t]=n,n?r||e.addEventListener(t,I,a):e.removeEventListener(t,I,a)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&!i&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,n))}function I(e){this.l[e.type](r.event?r.event(e):e)}function R(e,t,n,i,a,o,s,u,d){var h,p,g,y,E,T,_,S,I,R,C,D=t.type;if(void 0!==t.constructor)return null;(h=r.__b)&&h(t);try{e:if("function"==typeof D){if(S=t.props,I=(h=D.contextType)&&i[h.__c],R=h?I?I.props.value:h.__:i,n.__c?_=(p=t.__c=n.__c).__=p.__E:("prototype"in D&&D.prototype.render?t.__c=p=new D(S,R):(t.__c=p=new v(S,R),p.constructor=D,p.render=L),I&&I.sub(p),p.props=S,p.state||(p.state={}),p.context=R,p.__n=i,g=p.__d=!0,p.__h=[]),null==p.__s&&(p.__s=p.state),null!=D.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=f({},p.__s)),f(p.__s,D.getDerivedStateFromProps(S,p.__s))),y=p.props,E=p.state,g)null==D.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==D.getDerivedStateFromProps&&S!==y&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(S,R),!p.__e&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(S,p.__s,R)||t.__v===n.__v){p.props=S,p.state=p.__s,t.__v!==n.__v&&(p.__d=!1),p.__v=t,t.__e=n.__e,t.__k=n.__k,p.__h.length&&s.push(p),function e(t,n,r){var i,a;for(i=0;i<t.__k.length;i++)(a=t.__k[i])&&(a.__=t,a.__e&&("function"==typeof a.type&&a.__k.length>1&&e(a,n,r),n=A(r,a,a,t.__k,null,a.__e,n),"function"==typeof t.type&&(t.__d=n)))}(t,u,e);break e}null!=p.componentWillUpdate&&p.componentWillUpdate(S,p.__s,R),null!=p.componentDidUpdate&&p.__h.push((function(){p.componentDidUpdate(y,E,T)}))}p.context=R,p.props=S,p.state=p.__s,(h=r.__r)&&h(t),p.__d=!1,p.__v=t,p.__P=e,h=p.render(p.props,p.state,p.context),p.state=p.__s,null!=p.getChildContext&&(i=f(f({},i),p.getChildContext())),g||null==p.getSnapshotBeforeUpdate||(T=p.getSnapshotBeforeUpdate(y,E)),C=null!=h&&h.type==m&&null==h.key?h.props.children:h,b(e,Array.isArray(C)?C:[C],t,n,i,a,o,s,u,d),p.base=t.__e,p.__h.length&&s.push(p),_&&(p.__E=p.__=null),p.__e=!1}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=function(e,t,n,r,i,a,o,s){var u,d,f,h,p,g=n.props,m=t.props;if(i="svg"===t.type||i,null!=a)for(u=0;u<a.length;u++)if(null!=(d=a[u])&&((null===t.type?3===d.nodeType:d.localName===t.type)||e==d)){e=d,a[u]=null;break}if(null==e){if(null===t.type)return document.createTextNode(m);e=i?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,m.is&&{is:m.is}),a=null,s=!1}if(null===t.type)g!==m&&e.data!==m&&(e.data=m);else{if(null!=a&&(a=c.slice.call(e.childNodes)),f=(g=n.props||l).dangerouslySetInnerHTML,h=m.dangerouslySetInnerHTML,!s){if(null!=a)for(g={},p=0;p<e.attributes.length;p++)g[e.attributes[p].name]=e.attributes[p].value;(h||f)&&(h&&f&&h.__html==f.__html||(e.innerHTML=h&&h.__html||""))}(function(e,t,n,r,i){var a;for(a in n)"children"===a||"key"===a||a in t||w(e,a,null,n[a],r);for(a in t)i&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||n[a]===t[a]||w(e,a,t[a],n[a],r)})(e,m,g,i,s),h?t.__k=[]:(u=t.props.children,b(e,Array.isArray(u)?u:[u],t,n,r,"foreignObject"!==t.type&&i,a,o,l,s)),s||("value"in m&&void 0!==(u=m.value)&&u!==e.value&&w(e,"value",u,g.value,!1),"checked"in m&&void 0!==(u=m.checked)&&u!==e.checked&&w(e,"checked",u,g.checked,!1))}return e}(n.__e,t,n,i,a,o,s,d);(h=r.diffed)&&h(t)}catch(e){t.__v=null,r.__e(e,t,n)}return t.__e}function C(e,t){r.__c&&r.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){r.__e(e,t.__v)}}))}function D(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){r.__e(e,n)}}function M(e,t,n){var i,a,o;if(r.unmount&&r.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||D(i,null,t)),n||"function"==typeof e.type||(n=null!=(a=e.__e)),e.__e=e.__d=void 0,null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){r.__e(e,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&M(i[o],t,n);null!=a&&h(a)}function L(e,t,n){return this.constructor(e,n)}function N(e,t,n){var i,a,o;r.__&&r.__(e,t),a=(i=n===s)?null:n&&n.__k||t.__k,e=p(m,null,[e]),o=[],R(t,(i?t:n||t).__k=e,a||l,l,void 0!==t.ownerSVGElement,n&&!i?[n]:a?null:t.childNodes.length?c.slice.call(t.childNodes):null,o,n||l,i),C(o,e)}r={__e:function(e,t){for(var n,r;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(r=!0,n.setState(n.constructor.getDerivedStateFromError(e))),null!=n.componentDidCatch&&(r=!0,n.componentDidCatch(e)),r)return T(n.__E=n)}catch(t){e=t}throw e}},v.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=f({},this.state),"function"==typeof e&&(e=e(f({},n),this.props)),e&&f(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),T(this))},v.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),T(this))},v.prototype.render=m,i=[],a="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,_.__r=0,s=l;var x,O,P,k=0,F=[],U=r.__r,B=r.diffed,G=r.__c,j=r.unmount;function H(e,t){r.__h&&r.__h(O,e,k||t),k=0;var n=O.__H||(O.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function K(e){return k=1,function(e,t,n){var r=H(x++,2);return r.t=e,r.__c||(r.__c=O,r.__=[$(void 0,t),function(e){var t=r.t(r.__[0],e);r.__[0]!==t&&(r.__=[t,r.__[1]],r.__c.setState({}))}]),r.__}($,e)}function Y(e,t){var n=H(x++,3);!r.__s&&Z(n.__H,t)&&(n.__=e,n.__H=t,O.__H.__h.push(n))}function V(e){return k=5,q((function(){return{current:e}}),[])}function q(e,t){var n=H(x++,7);return Z(n.__H,t)?(n.__H=t,n.__h=e,n.__=e()):n.__}function W(e,t){return k=8,q((function(){return e}),t)}function z(){F.some((function(e){if(e.__P)try{e.__H.__h.forEach(Q),e.__H.__h.forEach(J),e.__H.__h=[]}catch(t){return e.__H.__h=[],r.__e(t,e.__v),!0}})),F=[]}r.__r=function(e){U&&U(e),x=0;var t=(O=e.__c).__H;t&&(t.__h.forEach(Q),t.__h.forEach(J),t.__h=[])},r.diffed=function(e){B&&B(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==F.push(t)&&P===r.requestAnimationFrame||((P=r.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),X&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);X&&(t=requestAnimationFrame(n))})(z))},r.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Q),e.__h=e.__h.filter((function(e){return!e.__||J(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],r.__e(n,e.__v)}})),G&&G(e,t)},r.unmount=function(e){j&&j(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(Q)}catch(e){r.__e(e,t.__v)}};var X="function"==typeof requestAnimationFrame;function Q(e){"function"==typeof e.u&&e.u()}function J(e){e.u=e.__()}function Z(e,t){return!e||t.some((function(t,n){return t!==e[n]}))}function $(e,t){return"function"==typeof t?t(e):t}var ee=n(18),te=n.n(ee);function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var re,ie,ae=function(){function e(){var e;this.emitter={all:e=e||new Map,on:function(t,n){var r=e.get(t);r&&r.push(n)||e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&r.splice(r.indexOf(n)>>>0,1)},emit:function(t,n){(e.get(t)||[]).slice().map((function(e){e(n)})),(e.get("*")||[]).slice().map((function(e){e(t,n)}))}}}var t=e.prototype;return t.on=function(e,t){this.emitter.on.apply(this,arguments)},t.off=function(e,t){this.emitter.on.apply(this,arguments)},t.emit=function(e,t){this.emitter.emit.apply(this,arguments)},t.destroy=function(){this.emitter.all.clear()},e}();(ie=re||(re={})).AVAILABILITY_CHANGED="airplay:availability_changed",ie.TARGET_CHANGED="airplay:target_changed";var oe,se,ue=function(e){var t,n;function r(t){var n;return(n=e.call(this)||this).video=t,window.WebKitPlaybackTargetAvailabilityEvent?(t.addEventListener("webkitplaybacktargetavailabilitychanged",n.onAvailabilityChanged=n.onAvailabilityChanged.bind(ne(n))),t.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",n.onTargetChanged=n.onTargetChanged.bind(ne(n)))):n.emit(re.AVAILABILITY_CHANGED,{available:!1}),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.onAvailabilityChanged=function(e){this.emit(re.AVAILABILITY_CHANGED,{available:"available"===e.availability})},i.onTargetChanged=function(e){this.emit(re.TARGET_CHANGED,{wireless:!0})},i.toggleAirPlay=function(){this.video.webkitShowPlaybackTargetPicker()},i.destroy=function(){this.video.removeEventListener("webkitplaybacktargetavailabilitychanged",this.onAvailabilityChanged)},r}(ae),le=function(){function e(){var e;this.emitter={all:e=e||new Map,on:function(t,n){var r=e.get(t);r&&r.push(n)||e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&r.splice(r.indexOf(n)>>>0,1)},emit:function(t,n){(e.get(t)||[]).slice().map((function(e){e(n)})),(e.get("*")||[]).slice().map((function(e){e(t,n)}))}}}var t=e.prototype;return t.on=function(e,t){this.emitter.on.apply(this,arguments)},t.off=function(e,t){this.emitter.on.apply(this,arguments)},t.emit=function(e,t){this.emitter.emit.apply(this,arguments)},t.destroy=function(){this.emitter.all.clear()},e}();(se=oe||(oe={})).CONNECTED="cast:connected",se.DISCONNECTED="cast:disconnected",se.STATE_CHANGE="cast:state_change";var ce=function(e){var t,n;function r(t,n){var r;return(r=e.call(this)||this).state={playbackState:u.b.IDLE,currentTime:0,duration:0,isLive:!1,isAtLiveEdge:!1,isSeekable:!0,isMuted:!1,audioTracks:[],textTracks:[]},function(e,t){return new Promise((function(n,r){window.__onGCastApiAvailable=function(i){i?(cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:e||chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:t||chrome.cast.AutoJoinPolicy.PAGE_SCOPED}),n()):r(new Error("[Cast] not available"))};var i=document.createElement("script");i.src="//www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",document.body.appendChild(i)}))}(t,n).then((function(){r.player=new cast.framework.RemotePlayer,r.playerController=new cast.framework.RemotePlayerController(r.player),r.setupListeners()}),(function(e){return console.error(e)})),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.setState=function(e){this.state=Object.assign({},this.state,e),this.emit(oe.STATE_CHANGE,{state:this.state})},i.getPlaybackStateFromPlayerState=function(e){switch(e){case chrome.cast.media.PlayerState.BUFFERING:return u.b.BUFFERING;case chrome.cast.media.PlayerState.PAUSED:return u.b.PAUSED;case chrome.cast.media.PlayerState.PLAYING:return u.b.PLAYING;case chrome.cast.media.PlayerState.IDLE:return u.b.IDLE}},i.getDuration=function(){return this.player.liveSeekableRange?this.player.liveSeekableRange.end:this.player.duration},i.setupListeners=function(){var e=this;cast.framework.CastContext.getInstance().addEventListener(cast.framework.CastContextEventType.SESSION_STATE_CHANGED,(function(t){switch(t.sessionState){case cast.framework.SessionState.SESSION_STARTED:case cast.framework.SessionState.SESSION_RESUMED:e.emit(oe.CONNECTED),e.setState({playbackState:u.b.READY,isMuted:e.player.isMuted});break;case cast.framework.SessionState.SESSION_ENDED:e.emit(oe.DISCONNECTED),e.setState({playbackState:u.b.IDLE})}})),this.playerController.addEventListener(cast.framework.RemotePlayerEventType.ANY_CHANGE,(function(t){var n=t.value;switch(t.field){case"currentTime":e.setState({currentTime:n,isAtLiveEdge:n>=e.state.duration-20});break;case"duration":e.setState({duration:n});break;case"playerState":var r=e.getPlaybackStateFromPlayerState(n);e.setState({playbackState:r}),r===u.b.IDLE&&e.stop();break;case"liveSeekableRange":e.setState(n?{isLive:!n.isLiveDone,duration:n.end-n.start,isSeekable:n.end-n.start>300}:{isLive:!1})}}))},i.load=function(e,t){void 0===t&&(t=null);var n=cast.framework.CastContext.getInstance().getCurrentSession(),r=new chrome.cast.media.MediaInfo(e,"video/mp4"),i=new chrome.cast.media.LoadRequest(r);return t&&(i.currentTime=t),n.loadMedia(i)},i.play=function(){this.playerController.playOrPause()},i.pause=function(){this.playerController.playOrPause()},i.stop=function(){this.playerController.stop()},i.mute=function(){this.playerController.muteOrUnmute()},i.unmute=function(){this.playerController.muteOrUnmute()},i.setAudioTrack=function(){},i.setTextTrack=function(){},i.seekTo=function(e){var t=e.position,n=e.change,r=e.percentage;r?t=Math.min(r,99.9)/100*this.getDuration():n&&(t=this.player.currentTime+n),this.player.currentTime=t,this.playerController.seek()},r}(le);function de(e){var t,n=e.onClick;return p("div",{class:te()("_1gDwG",(t={},t._22_VN=!e.isAtLiveEdge&&e.isSeekable,t)),onClick:n},"LIVE")}function fe(e){var t;return p("div",{class:"_-LGHu"},(void 0===(t=e.time)&&(t=0),[Math.floor(t/3600)%24,Math.floor(t/60)%60,Math.floor(t%60)].map((function(e){return e<10?"0"+e:e})).filter((function(e,t){return"00"!==e||t>0})).join(":")))}function he(e){var t,n=e.currentTime,r=void 0===n?0:n,i=e.duration,a=void 0===i?0:i,o=e.handleSeek,s=e.handleSeekToLive,u=e.isLive,l=e.isAtLiveEdge,c=e.isSeekable,d=W((function(e){c&&o(e.offsetX/e.currentTarget.offsetWidth*100)}),[o,c]),f=!u||!l&&c?r/a*100||0:100;return p("div",{class:te()("_2aAzG",(t={},t._3K51E=!c,t))},p(fe,{time:r}),p("div",{class:"_t3a1b",onClick:d},p("div",{class:"_K1UW_"},p("div",{class:"_1Xt9z",style:{width:f+"%"}}))),u?p(de,{onClick:s,isAtLiveEdge:l,isSeekable:c}):p(fe,{time:a}))}function pe(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M8 5v14l11-7z"}))}function ge(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}))}function me(e){return p("div",{class:"_3njg6",onClick:e.onClick},p(e.playbackState!==u.b.PLAYING?pe:ge,null))}function ve(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"}))}function ye(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"}))}function Ee(e){return p("div",{class:"_28pC9",onClick:e.onClick},p(e.muted?ye:ve,null))}function Te(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}))}function _e(e){var t,n=e.audioTracks,r=void 0===n?[]:n,i=e.onChange,a=K(!1),o=a[0],s=a[1],u=W((function(e){i(e.target.value)}),[i]);return p("div",{class:"_13aPK",onClick:W((function(){return s(!o)}),[o])},p(Te,null),p("ul",{class:te()("_16WrP",(t={},t._Ib345=o,t))},r.map((function(e){return p("li",null,p("label",null,p("input",{type:"radio",name:"audioTrack",value:e.id,checked:e.enabled,onClick:u}),p("span",null,e.label)))}))))}function be(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"}))}function Ae(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}))}function Se(e){return p("div",{class:"_34Jhj",onClick:e.onClick},p(e.isFullscreen?be:Ae,null))}function we(){return p("div",{class:"_2eFId"},p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"38",height:"38",viewBox:"0 0 38 38"},p("defs",null,p("linearGradient",{x1:"8.042%",y1:"0%",x2:"65.682%",y2:"23.865%",id:"a"},p("stop",{"stop-color":"#fff","stop-opacity":"0",offset:"0%"}),p("stop",{"stop-color":"#fff","stop-opacity":".631",offset:"63.146%"}),p("stop",{"stop-color":"#fff",offset:"100%"}))),p("g",{fill:"none","fill-rule":"evenodd"},p("g",{transform:"translate(1 1)"},p("path",{d:"M36 18c0-9.94-8.06-18-18-18",id:"Oval-2",stroke:"url(#a)","stroke-width":"2"},p("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.9s",repeatCount:"indefinite"})),p("circle",{fill:"#fff",cx:"36",cy:"18",r:"1"},p("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.9s",repeatCount:"indefinite"}))))))}function Ie(){return!(!document.fullscreenElement&&!document.webkitFullscreenElement)}function Re(){return p("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},p("path",{d:"M0 0h24v24H0z",fill:"none"}),p("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM4 12h4v2H4v-2zm10 6H4v-2h10v2zm6 0h-4v-2h4v2zm0-4H10v-2h10v2z"}))}function Ce(e){var t,n=e.textTracks,r=void 0===n?[]:n,i=e.onChange,a=K(!1),o=a[0],s=a[1],u=W((function(e){i(e.target.value),e.stopPropagation()}),[i]);return p("div",{class:"_4r-db",onClick:W((function(){return s(!o)}),[o])},p(Re,null),p("ul",{class:te()("_1b4Xq",(t={},t._8qwvr=o,t))},r.map((function(e){return p("li",null,p("label",null,p("input",{type:"radio",name:"audioTrack",value:e.id,checked:e.enabled,onClick:u}),p("span",null,e.label)))}))))}function De(){return p("svg",{xmlns:"http://www.w3.org/2000/svg","enable-background":"new 0 0 24 24",height:"24",viewBox:"0 0 24 24",width:"24"},p("rect",{fill:"none",height:"24",width:"24"}),p("g",null,p("polygon",{points:"6,22 18,22 12,16"}),p("path",{d:"M21,3H3C1.9,3,1,3.9,1,5v12c0,1.1,0.9,2,2,2h4v-2H3V5h18v12h-4v2h4c1.1,0,2-0.9,2-2V5C23,3.9,22.1,3,21,3z"})))}function Me(e){return p("div",{class:"_2XaiH",onClick:e.onClick},p(De,null))}function Le(){return p("div",{class:"_mM3Gy"},p("google-cast-launcher",null))}function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function xe(e){return p("img",{class:e.className,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAA5CAYAAABzlmQiAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH4gQUEh4aiyLHmgAAFqJJREFUeNrtXQt4VcW1zhsChgBJIMEA8iwBlAJikIdQBBEQKOYiFeStIJSrovhCi22hqDwEFdEW1ArISyAEFBCrcMGqgFJFFDQIBVEUeQhBCI+c0zX0H7/VYWb2OSf7nCS3e3/f+pIze2b2zN7rn1lrzZo1UVFhuJptPhlNVImoHdFwoj8SPU80n2gh0V+JniZ6iKgfUVOieKIo74r85ff7b/L/+yoiSvXeSHhAEUfUnmgK0Xai80T+IOgk0Vqiu4lqC5B5b9UDSFkHhaAaRI8R7WPM/hNAsoRoJtFEzCLTiRYQvU90gshnAMsForeJbiFK8N502AHyK6LdRLuIqnhvxB1wCGDMAhgEU39D9BRRB6KKAZRPILoG4PqMgUX8/SdRIX7nEw0VIpj31r2rLACjHNH9mAH8mCn6E5UvRp0xANYqzB5niZYSPUt0jD2nvaeneFdpBkcToq1gWCFS3Sp0D5dFNgGCD/GMHUSdMDMVQq+ZQZQYYREkmqgN0VSi5UR5RIuIZhLdSVRbI9NPIXpYlHUQbUS+PxDFKfdqo7x4ziqi14heIHqAqDWvl/6vh3oEpVmel8ry1WPpWUh7kqiiplwCUTui8UQLiN4ELUQbazm8vyS8k8nox1tEa4leIhpJVOn/g67RH4q0ZNKkMM9SQmc5R/QjUQ+iXxJtAXAEgOpECByxRLOgwMrL5//P6zhRI1bmNqSfJ6pmqXsx8m1T0vsSnbQ8T7TlDpa/GlEh7t1ieV5f5DnHgWRS0gVoicYS7fXbr2NE7TXPq0o0g+ioQ/nPiWqUVXAI8WcCRJ/viLpGQswBKLtDxCqEwi6AM5WoiOgQUXYEADIKH7GAaBBRA6J0ooZEQ4iO4P48VuYKgENcfQz1CuY7iDwzWHojolNIFzPWVUQZYpQmupHofdz7lqg8m+G2If05S19mIc9HgVixBIhYP/4mQImZtDFRS6KhrA97iBIN9YrrRaLfoFxj1CNmnzO4v4SoTIJjOhTnT4jqlkAbrib6HiC5EcAZQHQGelDHMIIjnmgfPuDvDHkexv3DQhRhDLsL6U8bymUx5unD0v+MtPeIYjTlrmTl2rP0J5C2U1cOeT5DnidDAEhPQ52d2QzX1wKQFE1ZQb/H/bNOolppA4dY7JsMcAizbEoJtqUVRK3jRFlI60xUAJC0DhNAWrGP38CQpyPuX+BiAhutd+j0EEobg/uFUgwDIL9G+j0Wke9H5BnO0jsxsa6WplwN1pfOLgJEtOcLOUsEAxDkqQWRT1xDyxJARgEcQt6vGgRTJYKxhkMpE4rYUqJlQgwhmg7mEIxVOYj29IKY97GwmGEm6YyZ5FA4ZjcmXv0gmNcBIIK5Mll6LwacTM3IuVLqH1K0gGIudZ12AQCE6yEVoQuJa5Cm3CDcO2kRhYIGCPL9FXk+DAEgYrbNV0XN0g6OdmA8Yam6PABGSoY8uprohEER82nShPy5meheossD0EmehJI+Cb+l8aAIQK7gMkCmop0fm+RjSh+MPKLfFVh6FaKfcG+wUqYcY/LJLL0DezeZFkuUvG5U7uUh/VVNuVdxb7XmXnEB8ijyfCMAHAxAkG8d8iwvC+CoTLSX6LRYyHNgoNoQJU6w6f19mAtvIWpOVB2zSnlYNbLw4h6FqfA0k0GFVae5pW2JWFQU+kh9BpwpAM5MlwHyEtr2tuF+OSiX4tqgggjmTHEt0ph35XUdS89hVqZkw2g7nA0uqcr9Ebh3SOpDzCBwGPdGhgEgdzJrXmIIAFlge8+lzZz7ApjtXpO1StitiaYx06JQ/u6CdYfniyFqRnQ78s8DCOZCObuZqC7Mov/HRJL5JrMfrGhC9FuomIW3wgTd3kWALGaK731EE4lmE+USbWfWJsFYN2nKj8X9IwrDTmOiWzmNefgs1jsmYK1lEWbaw2wmnm0YsKQ834alt2XtrBkGgAxhlr7LQgDIi8izqbQDJBty/ru6BUDIzjcQHWAKaG9uNUGemkSPM4VTilhFIC5uCUBsJBogRlOid5htfaCq4ALEmwCGeiy9GWaW7W65pTCA+DX9OA37/SIwgq58Q/RPXB3ZLCCV2gVK/oGG5/nAqPuxwDaWA05591s1opu0cH1oaGdxATKomACZW+oBApPuBjBeS4Ny+Ht88FP4SOrq72VYkZW2bQGkZzBTNMTMk4gXfzWm5pUs/5dQbvsRfYe0v/BRFm3tiVluipI+A+lDXQLIy2jDB1iPaIpV66omU6qGYXdwcy/9bcKYJkfJz0WsNnhmQ8zM8QG2eTyb1WMAyN1Ie8RQxgNIAAD5FZhrvqYDCRB75KyRpWGE5mxkFHn+J4iPKhjgT3jBPrwwwYhvo763uDsCtTGW6GtQLEuvDlPwF254AbORd5fNZcShDmnn388GGWlNSlLytmcM1SDE52VhEPMB0L9kM3YjDyCh6x6vY/Zoolksk4roGlV5BDi6QFEXsvMjuuk/wI9bl4lYmwAc+fI28pcPN3qfugbCFPYcFwAyhOkElUOsoykz3V7HBpHFmrwZTIe4JcTnRUM/8kNneiIAS5wHEAeA1IHusUbzsp9F41dK1wYlT1uIXMJseYMLTClmq+cw6m2Co5tcdMuVYh219QYA4RFNX4Q38PriusQAsJJBBhSDYT+WLh6MYXo55F0UqusFlbsfdexlriAPWvJ7AHEAyHgw281Kw4eDUTcbvDzT4RMk7P0dXLQexQAk4pqjzGLC81W0OQkz3mrNbLgGIKlZzHYIeh3PzddZ1gDoK7i5VpNnnKJ4f6/qVZrFSTGTdNWYjmPBuF0sddTGrOdn5veaHkBCA0c0FtmO84U2KIcnMALVMDDPcgBomNvtAuO9g4/WEwaAT/DB2qLdn4vFTE2fBgPwo1xoRx3oD37Mkhvgfr6e6B/M9LrBUkcGM4lbV4wxGOQxkGzDAuwarDEdQPpZ2+4/uvcGe94a22zkAcQOkOpYiV6mjOBv4oX1MHSqExhjVagKbADMWQ/K7G4syjWDxUusS4gdiW9gxT9R6VM6TL55LrUjA2LefqYjFKFtBwCaux3qeI2ZbZs65BV9vQcDwmlW7jSse9tg3Ut0YPojoJ4Oz+uKfGJdpipLT8VsJ+51tZTvhzz7uaSBJQHZBhuYZyLP6tIIkByMtqNZg3vhg7xqYn64P583WUZcBMnjYJD++D0Zv8dQm1+E7lRDI2ZthxdwgottESvSKXD8q4ZZLRBzbzRAJI0NwegvyQCoEGcrq6Z1h7LlQNEBiLSX5FXqiLGUj2X5HOs1vNdygVo9Iw2QxwGQlqyz26BX1DF0qCFG0BXhbp/w0cLIuQEfrBJGtYNt3yuYA0tWPU2/ZqNfDUr6HcOhUZpab47yrrJzCTEECm1FfEzpJ/TnAKwkfSLEYK9DtKmO3xcXwybvOfOtBSCjAJDeJQyOaMwaUtGP9biubAHkU6L97IPOx0JTMweGPR+pvcRs70QfJhsX7iy4IPepZ2j61QUAuaeEAdKLzR53eBxX9gByWOz1xsesAI/M7Q4y4364MkSKyVqDwR5jactJxvN133bqhC6iCgJMCIA8UYLgSGRuHntNZtkg67wOXrvdywqPYa/KrXBozSxrABHi1Tp0pLPKiAYzpDBZrongC87ErDaXpV30fJ31z8LPDP3KhPj1QgkyxgRm5hzoUp3S0+DlMgSQeuw9tC1rABGj7Crxf5Hv4iKc37boh5VtoQ8sieALTgEoF7G0uhf9xc/6Vhj6lQ7x66USZowmcDqM8QBSNgHys4vJ8kPnlqETtzqIDWKRamUEX3A1gJJHDuluc6FA5EexvjPHpTaUFmbzABJhgIhgCJvFynTOR6c+lesfNkbBos6WCOogTdCuaSxtFtJaGPpVH7PjjGI++0Fs5nrGA8h/J0C+lO7hzTefPJr/U9FZKOrJlg7/HavIcRF6wf24FQh60CEovjGGfrUBQMYX89lL8ezXPYD8dwLkbwhALc7zuDBjX6EMNDDC0mG5ZTQ7Qi/4eTzvSvyWG4v+aOlXfwDkNg8gHkCKA5DnYO1pLhiqy5aCt+CU97lpXwdbTJwWgZdbHtEy9mCVPxo7/KyBxhD5RACklUsA+QpRTiQN0OQVOw1/S/QKHA6XwRv5UXjfxhqeURVevC+jXC4CGTyNnZtZOoDAy2A49smvwJYEMZj0cHANiUNopvsRsmctfO/EFuPfOW3WgovNQDwrF06rM+BUGh8sQOCS0hHBPl5DP+Zix2mKQ1vSkG8OyuXCT028t2uUWAC/xrd7yMF5swvyTRKMdDsYaRhi4eayTTZ3WF7wXji3JYUZIAOkmzt+34zfcx2A/6acGV0CiHotVPJlA8jqXnJ+PaVxX9eVK1LKTdIA5IjiIazuY5+urmVhcBmBwc92ndIFoUAdLR1i9X6giQNmBAhch/IMYaFkYItuhrb0YqFfTdd+uegtvM5NEWGUepfL6JaCkRoDIMLx7yjRRubFecgUfFl4r6KSCWEERyK2uxbAQbASPk6BbX+DcNtHXz5wYdPUUhbwQKy9jEa40X4sTzILZLEUI1cmgld0wOh+yb4Mpdxq7EOvCefE+kTX4z331gDkNNzYx8Frtjmelcu8jTspfYll+0TeQ1/aI1ZuCwxG+WzPShWlfCoD82ZEfBc7Jq/FTJbP6o53AggAu5gBvi9Cq7bAaL+KAbaRxnBzig0GLfDOf4GyS9gzu6JMXQbEHpbB/3vkmSKDNRxAkLhdiIkVhUBwPnzwGIPokw+nxiZhAEcUtoxe1DXw+y/4Pc42RbL99ZNcaIejDoIVYhmPKklzPxmg/o+4VMyF5ttA3XYYQF4x3K/I4gkvswBkqGWGkHtARiv3JrH4V+maso3ZrJYTAEBasdnyVk198RiYdBFgZCC8dYbQrhms7q6s//k29QBbKiSIbpIMNRt6yEHso0hBZbnIfK8hXEwnrHDv5PsIXAJIL6x97MBHH4oOb3SynjG9KjvcAAFwZXCJOZZ6tkgxi5Vbj7RZbirpbEuAGo8rEIBEsQjyecpoL5nrBcuz16p77i0AmYK0ry367ggWuVJGs6/AwqwONJS7BCBIl4PsdgNPj70keB8OreFnBHZmU+oXyNzX8DJl2Ml33QIJRIaTiI3VFBt6zmB3Y6YDOCpiH8huNw73CQAgCZCTtVELWb4PkGcmm8plaKPbXAYI38l3RTAAQb6pzH8sBmnVWJ19LWUf1ZQ1AeRdnT6n1NeUlZVbMpqztF8ECZAcFogjQ1NuDRMTf2aqWGxf9asOfggj8x0YtK9GyYyBtUVcnxZH3EJdo/GsE5Cpu0E8EZa1qwOwyg1BHx52CaxOAEljU3JXQ55oiF/iuo8pp75gTZ8BAoQfrdAuBICMZMpsOaS1YXVeaSnbn43AFUwAwQDxje1oCTZb+HikF4SUknpY5SABksrisPXXiKcnuFGIM9ZoBpBdPN4UFKDvIZvep7GOxGDkkEHlJgRj3cJMdBXkSR8sD9fgQxUCHO0DAEc83PfFSVjVIwSQRuzjtzL0rQ37WNlIr8XKNXIZIDWYHtEjBIDksLZVQlpv3TEPmrI3srLpFoBUZKdo3enAG3Lb8Sikjcbvo5ao+yaARLEwt/M0kou8rtWJJgfZSbPtNIwgYzotV8/Cw4OvZ3LqYSwoZpt0Btj/+2F/iQx2tgiWiHn4fcDkTqIBiAzWMN1FXcgJIHy6n4zNXFOxFvI22l/EtttGo1wDZpKt6zJA0hgQeocAkB6sT6lI68cscTYTKY9QX8cCkCSm0A916LM8wm0sft/HLG3RwQAE9x5gxhEeG/kZpH+n5VlirJFsFlmimkjB0LnMPj1SE340EabJfeylnETMWLl4th5hRi8wk+RaLBYNZlPvep21xACOZERaPOrW7BEgQFpYbPA+vOyNsMhVYeXqs3z1ShlAurO2pSGtb4DnLnZkZWs5AOSMehCQoc5jyHc3ft9fTIA0ZmJbGyYF7bG+W4go8oRZsWh4lUGeHsxsxflYBU5WNuzHYsV9GpSxH/Byz+PF7MH6wF2waQ9nR4QdQ50xAYKD70G/22VrWjAi1m9gJszCKnc5S70ZrFyzMgCQbmwwqxOggaCKBSDlGePfY6kvmrV5mCJiHbNYv2wAiWW8No0NdD5TUD/ObFfD1OtHADbTeXdVIFL8yGIiLUGMpDpQwnR27UT8zcQus/lKHU/ZRihDm3vCtf3vbkV2Z21eYjp4BvdT2If4dZAuNIW6g3BKKUCasbRsS9lRLIZYggUg3Gz8hKW+dPXAICwESktUarAAwf0/sQE+jv0+rguSqDLcQ0wXGeTwwQRQ/heRUC6wzhyG7T8PfkULIJ69zyw6Uun7BIt/acEysIhaQnQEge8ahmHB8hWHGYSfVvuHIOrlUdfHlQGAJLKyt1vKyrM+trCj5UxmXnkM3RsBzEg/n20C8VSO9q1DBEhz5g7UjoF1fiBMF0e0EiARxzA3CuDDySiEw+A4tgUg+Qkv9iysET9gdfRl6DANQ91XQu2qBovbeTeCVRv6JT2Xt1qCPy9ki0+xQdQ9V1XeSzFA+IlZqw2LbElsbWdiAAuFo9kioOkMwwXsECM+KH1pMxEHAJBYLEvImMkScN0CZT6h9G4DSHaGcsotRsnLYHtOwwt0ZesptSeN6CPMcg9EheliZxAWwromxaN6imIqDwb6rcFJMBkjVRpLb8ecEwcazOcpiv9WiQBEY+q9TTmPMJbFUz6lLFCaAJLCjoabp0RllNa087rtF9jI5sfsnaa8s1rw2HVanxqvGFUOBhVYA/u6PwVIxKlTlaNKwUXtqEW0A+AQR1VHhxEgqUyZPAnnSeHCsU8BwDTG7Dswyq6GU99XzGKTrZSbzUSIXVgLykOgvD0A5qRSApBo5qrhw2r5BrjK72RWrtuV+mzevH3YuzmKFex12JQn27pCnZmxgLiNrdovQL5dDFTyut7Qz9qKR/SUUJgxHef/+fE3o4TB0Q7rNUIpnxBOcCjrAtwl/bR64CRGrv74wAVs9CoEoHZgjaemRocZA6sK/1hnoegKUWKwIreL+p51APW3yNdNaeMhpPe3lO/MYuqmaESTYWDOUwwsPwIonTTGmTqsvmzN87IxKBxlYtFpvLO7LIuBqRDVj7PB6TB03THsG1xrUQvyGLCzQmVKIW6tAEiE12/b4rqRh9CGBBzTUIgTeIdGsg0Qq+qDKlvs71IWz8CKdlX4awUijlaFeTgD4kcFgyUwweawiboSQOr5kZeka8rHsHy2flZCH9N1bTW0J9rhHVdHnZWD0MsqsHZI15hr2GBT19LPTWzNLbo4DBoH61Yh1kieJqoaAWBEAZBSHxL751tFGqDeVbYuLCHImSjOMlP6nI53CJZhWzJmFV6zD4ZDNwEwWohjGRCa6ByOXUvyPr93BQCQGWB80xn3sdAPpYUs3k3mjYdbyjfMFPwsRvaYYtZdCQEX3gEwhCK+DnvmvS/vXVysamrYA5/EjiA37RfJYbPHkHCJP8LBcQzWIuTC4lfYsNQPsaniHGYJod+0FkGmxXFqRAXM1WU5xKtojyW8S2MZ82EN5R9weF0MpXsvOx051gAuuTC4242YyU5AEftJOog4uMwj2A9L0ylsXtoE15XVOGBzK2agcyy/mDHeIxqH2LoeJ3iXCSCXY5bwGQI9TJH7UTRlJ3L/uUhbm8Qe96ZEI4ieJ9pAtIfoBADjR8Bsob98DOvYRKJeYjHSA4V3BQgQaR2riIXBJvAXqw39wlauPsSzK508H/4FoQjRzOaDDxUAAAAASUVORK5CYII="})}function Oe(e){return p("div",{class:"_2lVG2",style:{top:e.y+"px",left:e.x+"px"}},p("a",{href:"https://www.eyevinntechnology.se/",target:"_blank"},p("span",null,"Powered by the Eyevinn WebPlayer"),p(xe,{className:"_yCzmM"})))}function Pe(){return p("div",{class:"_xDOFW"},p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 48 48"},p("path",{d:"M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"})))}function ke(e){var t,n=e.player,r=e.castAppId,i=e.rootElement,a=V(),o=function(e,t){var n,r,i,a=K(null),o=a[0],s=a[1],l=K(null),c=l[0],d=l[1],f=function(e,t){var n=K(null),r=n[0],i=n[1],a=q((function(){return null!==t&&new ce(t)}),[]),o=V(null);return o.current=r,Y((function(){a&&(a.on(oe.CONNECTED,(function(){e.currentSrc&&a.load(e.currentSrc,e.currentTime)})),a.on(oe.DISCONNECTED,(function(){var t;i((function(e){return Ne({},e,{isCasting:!1})})),e.seekTo({position:null==(t=o.current)?void 0:t.currentTime})})),a.on(oe.STATE_CHANGE,(function(e){var t=e.state;i(Ne({isCasting:t.playbackState!==u.b.IDLE},t))})))}),[]),[a,r]}(e,t),h=f[0],p=f[1],g=V(!1);return g.current=null!=(n=null==p?void 0:p.isCasting)&&n,Y((function(){e.on(u.e.UNREADY,(function(){s(null),d(null)})),e.on(u.e.READYING,(function(){s(!1)})),e.on(u.e.READY,(function(){s(!0)})),e.on(u.e.STATE_CHANGE,(function(t){var n=t.state;g.current&&e.isPlaying&&e.pause(),d(Ne({isCasting:!1},n))}))}),[]),p&&p.playbackState!==u.b.IDLE?(i=h,r=p):(i=e,r=c),[o,r,W((function(){return i.isPlaying?i.pause():i.play()}),[i]),W((function(){return i.isMuted?i.unmute():i.mute()}),[i]),W((function(e){return i.setAudioTrack(e)}),[i]),W((function(e){return i.setTextTrack(e)}),[i]),W((function(e){return i.seekTo({percentage:e})}),[i]),W((function(e){return i.seekTo({change:e})}),[i]),W((function(){return i.seekToLive()}),[i])]}(n,r),s=o[0],l=o[1],c=o[2],d=o[3],f=o[4],h=o[5],g=o[6],m=o[7],v=o[8],y=function(e){var t=K(!1),n=t[0],r=t[1],i=q((function(){return new ue(e.video)}),[]),a=W((function(){return i.toggleAirPlay()}),[]);return Y((function(){i.on(re.AVAILABILITY_CHANGED,(function(e){return r(e.available)}))}),[]),[n,a]}(n),E=y[0],T=y[1],_=W((function(){return Ie()?void(null==(e=document.exitFullscreen||document.webkitExitFullscreen)||e.call(document)):function(e,t){var n,r=e.requestFullscreen||e.webkitRequestFullscreen?e:t;null==(n=r.requestFullscreen||r.webkitRequestFullscreen||r.webkitEnterFullscreen)||n.call(r)}(i,n.video);var e}),[]),b=K({visible:!1,x:0,y:0}),A=b[0],S=b[1],w=W((function(e){e.stopPropagation(),e.preventDefault(),S(e.target===e.currentTarget?{visible:!0,x:e.offsetX,y:e.offsetY}:{visible:!1,x:0,y:0})}),[]);Y((function(){document.addEventListener("click",(function(){S({visible:!1,x:0,y:0})}))}),[]),Y((function(){var e=a.current;if(e){var t=function(e){switch(e.code){case"Space":c();break;case"ArrowRight":m(5);break;case"ArrowLeft":m(-5)}};return e.addEventListener("keydown",t),function(){return e.removeEventListener("keydown",t)}}}),[a.current]);var I=V(null),R=K(!1),C=R[0],D=R[1],M=W((function(){clearTimeout(I.current),D(!0),I.current=setTimeout((function(){return D(!1)}),2500)}),[]),L=!C&&(null==l?void 0:l.playbackState)!==u.b.READY&&(null==l?void 0:l.playbackState)!==u.b.PAUSED,N=(null==l?void 0:l.playbackState)===u.b.LOADING||(null==l?void 0:l.playbackState)===u.b.BUFFERING||(null==l?void 0:l.playbackState)===u.b.SEEKING;return null===s?null:p("div",{ref:a,tabIndex:0,class:te()("_2jAm9"),onMouseMove:M,onContextMenu:w,onPointerUp:W((function(e){L||e.currentTarget!==e.target?D(!0):c()}),[L])},A.visible&&p(Oe,{x:A.x,y:A.y}),(N||!s)&&p(we,null),(null==l?void 0:l.isCasting)&&p(Pe,null),p("div",{class:te()("_SS6y-",(t={},t._1Wfm6=L,t))},p("div",{class:"_1pnfN"},p(me,{playbackState:null==l?void 0:l.playbackState,onClick:c}),(null==l?void 0:l.isLive)&&!(null!=l&&l.isSeekable)&&p(de,{onClick:v,isAtLiveEdge:null==l?void 0:l.isAtLiveEdge,isSeekable:null==l?void 0:l.isSeekable}),p("div",{class:"_3ju96"}),p(Le,null),E&&p(Me,{onClick:T}),!1===(null==l?void 0:l.isCasting)&&(null==l?void 0:l.textTracks.length)>1&&p(Ce,{textTracks:null==l?void 0:l.textTracks,onChange:h}),!1===(null==l?void 0:l.isCasting)&&(null==l?void 0:l.audioTracks.length)>1&&p(_e,{audioTracks:null==l?void 0:l.audioTracks,onChange:f}),p(Ee,{muted:null==l?void 0:l.isMuted,onClick:d}),p(Se,{isFullscreen:Ie(),onClick:_})),(!(null!=l&&l.isLive)||(null==l?void 0:l.isSeekable))&&p(he,{isLive:null==l?void 0:l.isLive,isAtLiveEdge:null==l?void 0:l.isAtLiveEdge,isSeekable:null==l?void 0:l.isSeekable,handleSeek:g,handleSeekToLive:v,currentTime:null==l?void 0:l.currentTime,duration:null==l?void 0:l.duration})))}function Fe(e,{castAppId:t}={}){const n=document.createElement("video");e.appendChild(n);const r=new u.c({video:n});return function(e){var t=e.root,n=e.player,r=e.castAppId;t.classList.add("_1Xl8W"),N(p(ke,{player:n,rootElement:t,castAppId:r}),t)}({root:e,player:r,castAppId:t}),r}n(97)}]).default},function(e,t,n){"use strict";var r=n(2),i=n.n(r)()(!0);i.push([e.i,"._2aAzG{position:relative;display:flex;align-items:center}._2aAzG>*{margin-right:1em}._2aAzG>:last-child{margin-right:0}._2aAzG._3K51E ._-LGHu,._2aAzG._3K51E ._t3a1b{visibility:hidden}._2aAzG ._-LGHu{color:#fff;white-space:nowrap}._2aAzG ._t3a1b{display:flex;justify-content:center;align-items:center;width:100%;padding:.5em 0;cursor:pointer}._2aAzG ._K1UW_{position:relative;width:100%;height:.25em;background:hsla(0,0%,100%,.3)}._2aAzG ._1Xt9z{position:absolute;top:0;left:0;width:0;height:100%;background:#fff}\n._1gDwG{cursor:pointer;background:#9f1e2b;color:#fff;padding:0 .5em;border-radius:.25em;white-space:nowrap}._1gDwG._22_VN{opacity:.5}\n._3njg6{width:1.5em;height:1.5em;cursor:pointer}._3njg6 svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._3njg6 svg:hover{fill:#fff}\n._28pC9{width:1.5em;height:1.5em;cursor:pointer}._28pC9 svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._28pC9 svg:hover{fill:#fff}\n._13aPK{position:relative;width:1.5em;height:1.5em;cursor:pointer}._13aPK svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._13aPK svg:hover{fill:#fff}._16WrP{list-style:none;position:absolute;bottom:1em;left:50%;transform:translateX(-50%);padding:.5em;white-space:nowrap;background:rgba(20,20,20,.6);display:none}._16WrP._Ib345{display:block}._16WrP li{margin:0}._16WrP input{display:none;margin-right:.25em}._16WrP label span{color:hsla(0,0%,100%,.8)}._16WrP :checked+span{color:#fff;text-decoration:underline}\n._34Jhj{width:1.5em;height:1.5em;cursor:pointer}._34Jhj svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._34Jhj svg:hover{fill:#fff}\n._2jAm9{top:0;width:100%;height:100%;z-index:1;opacity:1;transition:opacity .2s;outline:none;font-family:Helvetica,Arial;line-height:1.5}._2jAm9,._SS6y-{position:absolute;left:0}._SS6y-{bottom:0;width:calc(100% - 16px);box-sizing:content-box;padding:8px;background:linear-gradient(1turn,#000,transparent)}._SS6y-._1Wfm6{display:none}._1pnfN{display:flex;margin-bottom:.5em}._1pnfN>*{margin-right:.5em}._1pnfN>:last-child{margin-right:0}._3ju96{flex:1}\n._2eFId{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center}._2eFId svg{width:3em;height:3em}\n._4r-db{position:relative;width:1.5em;height:1.5em;cursor:pointer}._4r-db svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._4r-db svg:hover{fill:#fff}._1b4Xq{list-style:none;position:absolute;bottom:1em;left:50%;transform:translateX(-50%);padding:.5em;white-space:nowrap;background:rgba(20,20,20,.6);display:none}._1b4Xq._8qwvr{display:block}._1b4Xq li{margin:0}._1b4Xq input{display:none;margin-right:.25em}._1b4Xq :checked+span{color:#1e81a0}\n._2XaiH{width:1.5em;height:1.5em;cursor:pointer}._2XaiH svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._2XaiH svg:hover{fill:#fff}\n._mM3Gy{width:1.5em;height:1.5em;cursor:pointer}\n._2lVG2{position:absolute;top:0;left:0;background:#111;color:#fff;border:1px solid #ccc;border-radius:.2rem;padding:.2rem;font-size:.8rem}._2lVG2:hover{background:#222}._2lVG2 a{color:inherit;text-decoration:none;display:flex;align-items:center;white-space:nowrap;overflow:hidden}._yCzmM{height:1rem;margin-bottom:0;margin-left:.5rem}\n._xDOFW{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:#000;pointer-events:none}._xDOFW svg{width:33%;height:33%;fill:#fff}\n._1Xl8W{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:#000}._1Xl8W video{display:block;width:100%;height:100%}\n","",{version:3,sources:["webpack://node_modules/@eyevinn/web-player/dist/webplayer.css"],names:[],mappings:"AAAA,QAAQ,iBAAiB,CAAC,YAAY,CAAC,kBAAkB,CAAC,UAAU,gBAAgB,CAAC,oBAAoB,cAAc,CAAC,8CAA8C,iBAAiB,CAAC,gBAAgB,UAAU,CAAC,kBAAkB,CAAC,gBAAgB,YAAY,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,UAAU,CAAC,cAAc,CAAC,cAAc,CAAC,gBAAgB,iBAAiB,CAAC,UAAU,CAAC,YAAY,CAAC,6BAA6B,CAAC,gBAAgB,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,eAAe;AAChgB,QAAQ,cAAc,CAAC,kBAAkB,CAAC,UAAU,CAAC,cAAc,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,eAAe,UAAU;AACpI,QAAQ,WAAW,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,UAAU,CAAC,WAAW,CAAC,uBAAuB,CAAC,kBAAkB,SAAS;AACtI,QAAQ,WAAW,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,UAAU,CAAC,WAAW,CAAC,uBAAuB,CAAC,kBAAkB,SAAS;AACtI,QAAQ,iBAAiB,CAAC,WAAW,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,UAAU,CAAC,WAAW,CAAC,uBAAuB,CAAC,kBAAkB,SAAS,CAAC,QAAQ,eAAe,CAAC,iBAAiB,CAAC,UAAU,CAAC,QAAQ,CAAC,0BAA0B,CAAC,YAAY,CAAC,kBAAkB,CAAC,4BAA4B,CAAC,YAAY,CAAC,eAAe,aAAa,CAAC,WAAW,QAAQ,CAAC,cAAc,YAAY,CAAC,kBAAkB,CAAC,mBAAmB,wBAAwB,CAAC,sBAAsB,UAAU,CAAC,yBAAyB;AACjgB,QAAQ,WAAW,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,UAAU,CAAC,WAAW,CAAC,uBAAuB,CAAC,kBAAkB,SAAS;AACtI,QAAQ,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,SAAS,CAAC,sBAAsB,CAAC,YAAY,CAAC,2BAA2B,CAAC,eAAe,CAAC,gBAAgB,iBAAiB,CAAC,MAAM,CAAC,QAAQ,QAAQ,CAAC,uBAAuB,CAAC,sBAAsB,CAAC,WAAW,CAAC,kDAAkD,CAAC,eAAe,YAAY,CAAC,QAAQ,YAAY,CAAC,kBAAkB,CAAC,UAAU,iBAAiB,CAAC,oBAAoB,cAAc,CAAC,QAAQ,MAAM;AAClc,QAAQ,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,YAAY,SAAS,CAAC,UAAU;AACrJ,QAAQ,iBAAiB,CAAC,WAAW,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,UAAU,CAAC,WAAW,CAAC,uBAAuB,CAAC,kBAAkB,SAAS,CAAC,QAAQ,eAAe,CAAC,iBAAiB,CAAC,UAAU,CAAC,QAAQ,CAAC,0BAA0B,CAAC,YAAY,CAAC,kBAAkB,CAAC,4BAA4B,CAAC,YAAY,CAAC,eAAe,aAAa,CAAC,WAAW,QAAQ,CAAC,cAAc,YAAY,CAAC,kBAAkB,CAAC,sBAAsB,aAAa;AAC9b,QAAQ,WAAW,CAAC,YAAY,CAAC,cAAc,CAAC,YAAY,UAAU,CAAC,WAAW,CAAC,uBAAuB,CAAC,kBAAkB,SAAS;AACtI,QAAQ,WAAW,CAAC,YAAY,CAAC,cAAc;AAC/C,QAAQ,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,CAAC,UAAU,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,aAAa,CAAC,eAAe,CAAC,cAAc,eAAe,CAAC,UAAU,aAAa,CAAC,oBAAoB,CAAC,YAAY,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,eAAe,CAAC,QAAQ,WAAW,CAAC,eAAe,CAAC,iBAAiB;AAC7U,QAAQ,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,eAAe,CAAC,mBAAmB,CAAC,YAAY,SAAS,CAAC,UAAU,CAAC,SAAS;AACnM,QAAQ,iBAAiB,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,oBAAoB,CAAC,gBAAgB,CAAC,eAAe,CAAC,cAAc,aAAa,CAAC,UAAU,CAAC,WAAW",sourcesContent:["._2aAzG{position:relative;display:flex;align-items:center}._2aAzG>*{margin-right:1em}._2aAzG>:last-child{margin-right:0}._2aAzG._3K51E ._-LGHu,._2aAzG._3K51E ._t3a1b{visibility:hidden}._2aAzG ._-LGHu{color:#fff;white-space:nowrap}._2aAzG ._t3a1b{display:flex;justify-content:center;align-items:center;width:100%;padding:.5em 0;cursor:pointer}._2aAzG ._K1UW_{position:relative;width:100%;height:.25em;background:hsla(0,0%,100%,.3)}._2aAzG ._1Xt9z{position:absolute;top:0;left:0;width:0;height:100%;background:#fff}\n._1gDwG{cursor:pointer;background:#9f1e2b;color:#fff;padding:0 .5em;border-radius:.25em;white-space:nowrap}._1gDwG._22_VN{opacity:.5}\n._3njg6{width:1.5em;height:1.5em;cursor:pointer}._3njg6 svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._3njg6 svg:hover{fill:#fff}\n._28pC9{width:1.5em;height:1.5em;cursor:pointer}._28pC9 svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._28pC9 svg:hover{fill:#fff}\n._13aPK{position:relative;width:1.5em;height:1.5em;cursor:pointer}._13aPK svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._13aPK svg:hover{fill:#fff}._16WrP{list-style:none;position:absolute;bottom:1em;left:50%;transform:translateX(-50%);padding:.5em;white-space:nowrap;background:rgba(20,20,20,.6);display:none}._16WrP._Ib345{display:block}._16WrP li{margin:0}._16WrP input{display:none;margin-right:.25em}._16WrP label span{color:hsla(0,0%,100%,.8)}._16WrP :checked+span{color:#fff;text-decoration:underline}\n._34Jhj{width:1.5em;height:1.5em;cursor:pointer}._34Jhj svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._34Jhj svg:hover{fill:#fff}\n._2jAm9{top:0;width:100%;height:100%;z-index:1;opacity:1;transition:opacity .2s;outline:none;font-family:Helvetica,Arial;line-height:1.5}._2jAm9,._SS6y-{position:absolute;left:0}._SS6y-{bottom:0;width:calc(100% - 16px);box-sizing:content-box;padding:8px;background:linear-gradient(1turn,#000,transparent)}._SS6y-._1Wfm6{display:none}._1pnfN{display:flex;margin-bottom:.5em}._1pnfN>*{margin-right:.5em}._1pnfN>:last-child{margin-right:0}._3ju96{flex:1}\n._2eFId{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center}._2eFId svg{width:3em;height:3em}\n._4r-db{position:relative;width:1.5em;height:1.5em;cursor:pointer}._4r-db svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._4r-db svg:hover{fill:#fff}._1b4Xq{list-style:none;position:absolute;bottom:1em;left:50%;transform:translateX(-50%);padding:.5em;white-space:nowrap;background:rgba(20,20,20,.6);display:none}._1b4Xq._8qwvr{display:block}._1b4Xq li{margin:0}._1b4Xq input{display:none;margin-right:.25em}._1b4Xq :checked+span{color:#1e81a0}\n._2XaiH{width:1.5em;height:1.5em;cursor:pointer}._2XaiH svg{width:100%;height:100%;fill:hsla(0,0%,100%,.8)}._2XaiH svg:hover{fill:#fff}\n._mM3Gy{width:1.5em;height:1.5em;cursor:pointer}\n._2lVG2{position:absolute;top:0;left:0;background:#111;color:#fff;border:1px solid #ccc;border-radius:.2rem;padding:.2rem;font-size:.8rem}._2lVG2:hover{background:#222}._2lVG2 a{color:inherit;text-decoration:none;display:flex;align-items:center;white-space:nowrap;overflow:hidden}._yCzmM{height:1rem;margin-bottom:0;margin-left:.5rem}\n._xDOFW{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:#000;pointer-events:none}._xDOFW svg{width:33%;height:33%;fill:#fff}\n._1Xl8W{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:#000}._1Xl8W video{display:block;width:100%;height:100%}\n"],sourceRoot:""}]),t.a=i},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(o=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),a=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([i]).join("\n")}var o,s,u;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);r&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(0),i=n.n(r),a=n(1);class o extends HTMLElement{static get observedAttributes(){return["source"]}constructor(){super();let e=document.createElement("style");e.innerHTML=a.a,this.appendChild(e);const t=document.createElement("div");this.appendChild(t),this.player=i()(t)}attributeChangedCallback(){let e=this.getAttribute("source");this.player.load(e).then(()=>{this.player.play()})}disconnectedCallback(){this.player.reset(),console.log("Player destroyed")}}customElements.define("player-component",o)}]).default}));
//# sourceMappingURL=web-player.component.js.map